Tue Dec 25 23:33:55 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* development version 1.9.0 released.

Tue Dec 25 23:25:29 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* lib/rexml/node.rb (REXML::Node::indent): should initialize rv
	  variable.  a patch from Tadayoshi Funaba <tadf AT dotrb.org> in 
	  [ruby-dev:32783].

Tue Dec 25 23:16:01 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* ruby.c (proc_options): encoding option in shbang and RUBYOPT did not
	  work, do not store alloca()ed string in a parent scope struct.

Tue Dec 25 22:56:52 2007  NAKAMURA Usaku  <usa@ruby-lang.org>

	* win32/Makefile.sub (config.status): keep this file.

Tue Dec 25 22:55:42 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* configure.in (TIMEZONE_VOID): typo.

Tue Dec 25 22:45:10 2007  Koichi Sasada  <ko1@atdot.net>

	* insns2vm.rb: add encoding option to shbang.

Tue Dec 25 22:13:51 2007  Koichi Sasada  <ko1@atdot.net>

	* bootstraptest/pending.rb: add pending issue.

Tue Dec 25 22:12:40 2007  Koichi Sasada  <ko1@atdot.net>

	* thread.c: remove Thread.critical(=).

Tue Dec 25 21:44:50 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* tool/make-snapshot: add version number.

Tue Dec 25 21:32:54 2007  Koichi Sasada  <ko1@atdot.net>

	* compile.c (iseq_compile_each): fix stack consistency error
	  (break is compiled to throw instead of jump insn).
	  these problems are reported by Yusuke ENDOH <mame AT tsg.ne.jp>

	* bootstraptest/test_knownbug.rb, test_syntax.rb: move fixed test.

Tue Dec 25 21:32:44 2007  Tanaka Akira  <akr@fsij.org>

	* parse.y (struct parser_params): make parser_ruby_sourcefile common
	  field.  it is used by node_newnode.
	  new field parser_ruby_sourcefile_string for ripper.
	  (parser_initialize): initialize parser_ruby_sourcefile in ripper.
	  (ripper_initialize): initialize parser_ruby_sourcefile_string.

Tue Dec 25 21:26:09 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* common.mk (parse.c): depends on tool/ytab.sed.

	* tool/ytab.sed: hack for bison 2.1.

Tue Dec 25 20:24:58 2007  Technorama Ltd.  <oss-ruby@technorama.net>

	* ext/openssl/ossl_ssl.c: Only show a warning if the default 
	  DH callback is actually used.

	* ext/openssl/ossl_rand.c: New method: random_add().

Tue Dec 25 20:24:48 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* tool/make-snapshot: argument check, and cleanup exported directory.

Tue Dec 25 20:07:13 2007  WATANABE Hirofumi  <eban@ruby-lang.org>

	* tool/make-snapshot: more portable.

Tue Dec 25 19:01:04 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* encoding.h (rb_enc_mbc_to_codepoint): wrapper for
	  ONIGENC_MBC_TO_CODE().

	* string.c (rb_str_succ): deal with invalid sequence as binary.

Tue Dec 25 18:40:46 2007  Koichi Sasada  <ko1@atdot.net>

	* iseq.c: all methods need $SAFE < 1.

	 vm.c: comment out debug functions.

Tue Dec 25 18:37:42 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* io.c (appendline): move RS comparison to rb_io_getline_1().

Tue Dec 25 18:27:51 2007  Tanaka Akira  <akr@fsij.org>

	* string.c (rb_str_each_line): don't call rb_enc_codepoint with empty
	  string.

Tue Dec 25 18:06:04 2007  Tanaka Akira  <akr@fsij.org>
	
	* string.c (rb_str_inspect): don't call rb_enc_codepoint with empty
	  string.  fix '#'.inspect.

	* encoding.c (rb_enc_codepoint): raise on empty string.

Tue Dec 25 17:48:28 2007  Shugo Maeda  <shugo@ruby-lang.org>

	* vm.c (rb_frame_method_id_and_class): new function to get the
	  method id and class of the current frame.

Tue Dec 25 17:32:04 2007  Akinori MUSHA  <knu@iDaemons.org>

	* lib/mkmf.rb (create_makefile): Add a missing dependency on the
	  target directory for each .rb file.  This will hopefully fix
	  parallel make (-jN).  Tested on FreeBSD.

Tue Dec 25 16:51:07 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* enc/trans/japanese.c (rb_{from,to}_{SHIFT_JIS,EUC_JP}): inversed
	  from_encoding and to_encoding.

Tue Dec 25 16:41:57 2007  NAKAMURA Usaku  <usa@ruby-lang.org>

	* golf_prelude.rb (h): add new method for all golfers.

Tue Dec 25 16:37:12 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* enc/trans/japanese.c (rb_to_EUC_JP): fixed typo.

Tue Dec 25 16:34:58 2007  NAKAMURA Usaku  <usa@ruby-lang.org>

	* ext/dl/depend: add dependencies. [ruby-dev:32760]

Tue Dec 25 16:26:48 2007  Koichi Sasada  <ko1@atdot.net>

	* include/ruby/ruby.h, thread.c: rename is_ruby_native_thread() to
	  ruby_native_thread_p().

	* ext/tk/tcltklib.c: apply it.

Tue Dec 25 16:15:15 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* common.mk (clean-enc): clean encoding objects.

Tue Dec 25 16:04:28 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* trunk/common.mk, goruby.c, golf_prelude.rb: for golfers.

	* trunk/main.c (main): hook for embedding applications.

	* trunk/tool/compile_prelude.rb: can change initialize function name.

Tue Dec 25 15:59:51 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* encoding.c (rb_enc_register): do not use based_encoding to check if
	  dummy encoding.

Tue Dec 25 15:55:14 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* string.c (rb_str_succ): fix for string with non-alphanumeric chars.

Tue Dec 25 15:42:49 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* io.c (rb_io_external_encoding): should return nil for
	  pass-through write IO.  [ruby-dev:32740]

Tue Dec 25 15:24:57 2007  Tanaka Akira  <akr@fsij.org>

	* io.c (appendline): initialize rslen to 1 if rsptr is 0.
	  rslen is the length of the delimiter.
	  if only delim is given, it should be 1.
	  [ruby-dev:32746]

Tue Dec 25 15:21:33 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* transcode.c (transcode_dispatch): fix for multistep transcode.

Tue Dec 25 15:07:51 2007  NAKAMURA Usaku  <usa@ruby-lang.org>

	* enc/trans/single_byte.c (Init_single_byte): renamed.

Tue Dec 25 15:00:33 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* enum.c (enum_yield): when multiple values yielded from #each
	  pack them into an array.  [ruby-dev:32708]

	* enum.c: all method but all?, any?, one? and none? passed packed
	  multiple values to the block.

	* enum.c (collect_all): should pack all values.  [ruby-core:14410]

Tue Dec 25 14:57:00 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* common.mk (COMMONOBJS): transcode_data_*.c moved under enc/trans.

	* transcode_data.h (rb_transcoding, rb_transcoder): prefixed.

	* transcode.c (rb_register_transcoder, rb_declare_transcoder): split
	  declaration and registration.  [ruby-dev:32704]

	* transcode.c (transcode_dispatch): autoload pre-declared transcoder.

	* transcode.c (str_transcode): use rb_define_dummy_encoding().

	* transcode.c (Init_transcode): initialize transcoder tables.

	* enc/trans/single_byte.c, enc/trans/japanese.c: moved from top.

Tue Dec 25 14:20:13 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* lib/mkmf.rb (map_dir): should generate path including $top_srcdir.

Tue Dec 25 14:09:16 2007  James Edward Gray II  <jeg2@ruby-lang.org>

	* lib/csv.rb:  Fixed test failures caused by changes to Ruby.
	
	* test/csv/tc_serialization, test/csv/tc_csv_parsing, test/csv/tc_features:
	  Fixed test failures caused by changes to Ruby.

Tue Dec 25 14:11:57 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* io.c (io_encoding_set): missing return type.

Tue Dec 25 14:03:48 2007  NARUSE, Yui <naruse@ruby-lang.org>

	* test/rinda/test_rinda.rb (MockClock#{_forward, forwrd, sleep}):
	  Change default value of n as @reso from nil.  If default value is
	  nil, n.+ is not defined.

Tue Dec 25 13:54:01 2007  Tanaka Akira  <akr@fsij.org>

	* test/ruby/test_io_m17n.rb (test_pipe): fixed.
	  [ruby-dev:32743]

Tue Dec 25 13:44:51 2007  Koichi Sasada  <ko1@atdot.net>

	* thread.c (rb_thread_wait_fd_rw): should check EBADF on select().

Tue Dec 25 13:30:03 2007  Koichi Sasada  <ko1@atdot.net>

	* thread_pthread.c, thread_pthread.h, thread_win32.c,
	  thread_win32.c: make some functions static functions.
	  a patch from Tadashi Saito <shiba AT mail2.accsnet.ne.jp>
	  in [ruby-core:14407]

Tue Dec 25 13:23:13 2007  Tanaka Akira  <akr@fsij.org>

	* test/ruby/test_io_m17n.rb (test_write_noenc): don't mix text and
	  binary mode.  [ruby-dev:32743]

Tue Dec 25 13:13:09 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* README.EXT.ja, dir.c, eval.c, eval_intern.h, lex.c.src,
	  lex.c.blt, keywords, load.c, thread.c: more ANSI'ize.
	  a patch from Tadashi Saito <shiba AT mail2.accsnet.ne.jp>
	  in [ruby-dev:32725]

Tue Dec 25 13:07:56 2007  Koichi Sasada  <ko1@atdot.net>

	* vm_core.h, thread.c, cont.c: add RUBY_VM_SET_INTERRUPT(),
	  RUBY_VM_SET_TIMER_INTERRUPT(), RUBY_VM_INTERRUPTED().

	* thread.c, thread_pthread.c, thread_win32.c: fix to ignore time slice
	  event until sleep.

	* bootstraptest/test_thread.rb: add a test for time limited join test.

Tue Dec 25 12:42:59 2007  Koichi Sasada  <ko1@atdot.net>

	* vm.c (Init_VM): remove unused code.
	  [ruby-dev:32732]

Tue Dec 25 12:32:32 2007  Martin Duerst  <duerst@it.aoyama.ac.jp>

	* transcode.c: Moving a static counter from inside register_transcoder()
	  and register_functional_transcoder() to outside the functions, renaming
	  from n to next_transcoder_position. Fixes 3) in [ruby-dev:32715].

Tue Dec 25 12:22:17 2007  NARUSE, Yui <naruse@ruby-lang.org>

	* sample/from.rb: follow Ruby 1.9 libraries.

Tue Dec 25 12:21:56 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* proc.c (method_inspect): preserve encoding of the method name.

Tue Dec 25 12:07:52 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* configure.in (BASERUBY): delayed error until BASERUBY is used.

Tue Dec 25 11:48:35 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* sample/README: removed obsoleted files: dbmtest.rb,
	  getopts.test, mrshtest.rb, regx.rb.

Tue Dec 25 11:45:34 2007  James Edward Gray II  <jeg2@ruby-lang.org>

	* lib/csv.rb:  Import the FasterCSV source as the new CSV class.
	
	* test/csv/*:  Added all applicable tests from FasterCSV.

Tue Dec 25 11:33:52 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* error.c (report_bug): uses ruby_description.

Tue Dec 25 11:20:38 2007  Koichi Sasada  <ko1@atdot.net>

	* compile.c (iseq_compile_each): fix stack consistency error.
	  a patch from Yusuke ENDOH <mame AT tsg.ne.jp>  [ruby-dev:32720]

	* bootstraptest/test_syntax.rb: add 2 tests for above.

Tue Dec 25 11:14:20 2007  Koichi Sasada  <ko1@atdot.net>

	* iseq.c, vm_core.h: comment out unused fields.

Tue Dec 25 11:02:10 2007  Koichi Sasada  <ko1@atdot.net>

	* vm.c: check frame is FINAL when creating env.
	  [ruby-core:14395]

	* bootstraptest/test_block.rb: add a test for above.

Tue Dec 25 09:12:13 2007  Eric Hodel  <drbrain@segment7.net>

	* lib/rdoc/:  Enable RDoc debugging only with $DEBUG_RDOC.

Tue Dec 25 08:37:43 2007  James Edward Gray II  <jeg2@ruby-lang.org>

	* lib/csv.rb, test/csv/test_csv.rb:  Removed in preparation for
	FasterCSV code import.

Tue Dec 25 08:27:43 2007  Eric Hodel  <drbrain@segment7.net>

	* lib/rubygems.rb:  Fix test failures.

	* test/rubygems/test_gem.rb:  Fix test failure.

Tue Dec 25 06:23:40 2007  Koichi Sasada  <ko1@atdot.net>

	* bootstraptest/test_knownbug.rb, test_literal.rb: move fixed test.

Tue Dec 25 06:19:04 2007  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* sample/biorhythm.rb: follow Ruby 1.9 libraries.

Tue Dec 25 06:15:01 2007  Koichi Sasada  <ko1@atdot.net>

	* vm.c: add dummy toplevel frame.

Tue Dec 25 05:44:56 2007  Eric Hodel  <drbrain@segment7.net>

	* lib/net/http.rb:  Fix uninitialized variable warning.
	[ruby-talk:284582]

	* lib/irb/output-method.rb:  Remove unused #foo method.
	[ruby-talk:284582]

Tue Dec 25 05:24:12 2007  Koichi Sasada  <ko1@atdot.net>

	* compile.c (iseq_compile): clear local table if node == 0.
	  a patch from Yusuke ENDOH <mame AT tsg.ne.jp>  [ruby-dev:32530]

	* vm.c: clear VM stack.

Tue Dec 25 04:23:32 2007  Tanaka Akira  <akr@fsij.org>

	* parse.y (rb_id2str): fill klass of returned string as rb_cString.
	  some strings are allocated before rb_cString is created.
	  This prevents a "called on terminated object" error by
	  ObjectSpace.each_object(Module) {|m| p m.name }.

Tue Dec 25 03:51:55 2007  Koichi Sasada  <ko1@atdot.net>

	* compile.c (iseq_compile_each): fix stack consistency bug.
	  a patch from Yusuke ENDOH <mame AT tsg.ne.jp>

Tue Dec 25 03:19:47 2007  WATANABE Hirofumi  <eban@ruby-lang.org>

	* tool/make-snapshot: must create configure and lex.c.

Tue Dec 25 03:16:05 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* io.c (rb_io_s_pipe): now takes up to two arguments.  allow its
	  external/internal encoding by Encoding objects.

	* io.c (rb_io_set_encoding): new method to set encoding of the IO.

	* io.c (argf_set_encoding): ditto.

Tue Dec 25 03:08:53 2007  NAKAMURA Usaku  <usa@ruby-lang.org>

	* pack.c (pack_pack): use NUM2LONG instead of NUM2INT.

	* numeric.c (fix_lshift, fix_aref): use SIZEOF_LONG instead of
	  SIZEOF_VALUE.

	* bignum.c (big2ulong, rb_big_aref): ditto.

Tue Dec 25 02:55:26 2007  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* lib/rexml/element.rb (REXML::Elements#each): yield in each
	  should be called with one parameter. [ruby-dev:32708]

Tue Dec 25 02:15:39 2007  Koichi Sasada  <ko1@atdot.net>

	* compile.c (iseq_compile_each): add a "pop" insn after break
	  to fix stack consistency error.  [ruby-core:14385]

	* bootstraptest/test_syntax.rb: add tests for above.

	* bootstraptest/test_knownbug.rb: remove fixed bug.

Tue Dec 25 01:54:36 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* id.c (Init_id): remove several unused symbols. [ruby-core:14362]

	* compile.c (iseq_specialized_instruction): do not use
	  VM_CALL_SEND_BANG flag any longer.

Tue Dec 25 01:42:41 2007  Tanaka Akira  <akr@fsij.org>

	* lib/rdoc/rdoc.rb (parse_files): interpret coding cookie.

Tue Dec 25 01:38:04 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* proc.c (method_name): preserve Symbol's encoding.

	* numeric.c (fix_id2name): ditto.

Tue Dec 25 01:19:18 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* include/ruby/encoding.h (rb_enc_left_char_head): new utility macro.

	* include/ruby/encoding.h (rb_enc_right_char_head): ditto.

	* io.c (appendline): does multibyte RS search in the function.

	* io.c (prepare_getline_args): RS may be nil.

	* io.c (rb_io_getc): should process character based on external
	  encoding, when transcoding required.

Tue Dec 25 01:07:57 2007  Tanaka Akira  <akr@fsij.org>

	* lib/irb/output-method.rb: translate a comment to English to
	  avoid mix of EUC-JP comment and UTF-8 Date keyword.
	  svn substitute Date keyword with UTF-8 weekday on UTF-8 locale.

Tue Dec 25 00:27:28 2007  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* lib/webrick/httpservley/cgihandler.rb
	  (WEBrick::HTTPServlet::CGIHandler#do_GET): m17nized.

Mon Dec 24 23:55:29 2007  Tanaka Akira  <akr@fsij.org>

	* lib/cgi.rb (CGI::escape): m17nized.
	  (CGI::unescape): ditto.
	  (CGI::escapeHTML): ditto.
	  (CGI::unescapeHTML): ditto.

Mon Dec 24 23:32:24 2007  NAKAMURA Usaku  <usa@ruby-lang.org>

	* transcode_data_japanese.c (select_iso_2022_mode): '\e' is not valid.

Mon Dec 24 23:13:09 2007  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* lib/rdoc/diagram.rb (RDoc::Diagram#initialize): use fileuitls
	  instead of ftools.

Mon Dec 24 23:04:57 2007  NAKAMURA, Hiroshi  <nahi@ruby-lang.org>

	* lib/ftools.rb: removed obsoleted lib.  use fileutils instead (by eban).

	* lib/rdoc/rdoc.rb, lib/rdoc/generators/*, lib/rake.rb: let it use
	  fileutils instead of ftools.

	* lib/shell/command-processor.rb: removed unused references to ftools.

	* lib/parsedate.rb: removed.  see [ruby-core:12535], [ruby-dev:31969].

	* lib/README: updated.

Mon Dec 24 23:01:04 2007  Tanaka Akira  <akr@fsij.org>

	* lib/open-uri.rb (OpenURI::Buffer): use Meta ===.  [ruby-core:14295]

Mon Dec 24 22:46:42 2007  NARUSE, Yui <naruse@ruby-lang.org>

	* transocode.c: register_functional_transcoder() added.
	  (init_transcoder_table(: register ISO-2022-JP.
	  (str_transcode): add preprocessor and postprocessor.

	* transcode_data_japanese.c: add ISO-2022-JP support.

	* transcode_data.h: moved transcoder and transcoding difinition from
	  transcode.c.

Mon Dec 24 20:29:28 2007  Koichi Sasada  <ko1@atdot.net>

	* test/io/nonblock/test_flush.rb: fix test for 1.9.

Mon Dec 24 20:23:44 2007  Koichi Sasada  <ko1@atdot.net>

	* test/rinda/test_rinda.rb: revert last commit because this test seems
	  to have timing problem to halt all tests.

Mon Dec 24 20:18:52 2007  Koichi Sasada  <ko1@atdot.net>

	* test/rinda/test_rinda.rb: enable rinda test.

Mon Dec 24 20:16:54 2007  Koichi Sasada  <ko1@atdot.net>

	* instruby.rb: fix rdoc install dir.

Mon Dec 24 18:37:32 2007  Tanaka Akira  <akr@fsij.org>

	* re.c (rb_reg_prepare_re): show regexp encoding in the error message.

Mon Dec 24 18:23:32 2007  Tanaka Akira  <akr@fsij.org>

	* eval.c (rb_exc_raise): ANSI style.
	  (rb_exc_fatal): ditto.
	  (rb_raise_jump): ditto.
	  (rb_jump_tag): ditto.
	  (rb_block_given_p): ditto.

	* variable.c (original_module): ditto.

Mon Dec 24 18:05:09 2007  Koichi Sasada  <ko1@atdot.net>

	* iseq.c (Init_ISeq): disable ISeq.load() because there is no verifier.

	* iseq.c, proc.c: add ISeq.disasm(method).

Mon Dec 24 18:06:03 2007  Tanaka Akira  <akr@fsij.org>

	* eval_method.c (Init_eval_method): extracted from Init_eval
	  for rdoc to find rb_mod_remove_method, rb_mod_undef_method and
	  rb_mod_alias_method.

	* eval.c (Init_eval): call Init_eval_method.

Mon Dec 24 17:59:29 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* load.c (load_lock): reverted.

	* thread.c (rb_barrier_wait): check for recursive wait.

Mon Dec 24 17:50:54 2007  Tanaka Akira  <akr@fsij.org>

	* eval.c (function_call_may_return_twice_jmp_buf): removed.
	  (function_call_may_return_twice_false): removed.
	  [ruby-core:14335]

Mon Dec 24 17:40:57 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* common.mk (node_name.inc, miniprelude.c, prelude.c): nmake cannot
	  handle target vpath in other than implicit rules.

Mon Dec 24 17:20:34 2007  NAKAMURA, Hiroshi  <nahi@ruby-lang.org>

	* lib/{mailread.rb,getopts.rb,parsearg.rb}: removed.
	  see [ruby-core:12535], [ruby-dev:31969].

Mon Dec 24 17:12:57 2007  Tanaka Akira  <akr@fsij.org>

	* include/ruby/intern.h, random.c, array.c:
	  change exported name.
	  genrand_int32 -> rb_genrand_int32.
	  genrand_real -> rb_genrand_real.
	  [ruby-core:14335]

Mon Dec 24 17:06:37 2007  NAKAMURA, Hiroshi  <nahi@ruby-lang.org>

	* {lib,test}/{soap,wsdl,xsd}: removed soap4r along to the discussion
	  at ruby-core and ruby-dev.  see [ruby-core:12535], [ruby-dev:31969].

Mon Dec 24 17:06:14 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* load.c (rb_feature_p): returns loading path name too.

	* load.c (search_required): returns path too if feature is being
	  loaded.  [ruby-dev:32048]  [TODO: refactoring]

Mon Dec 24 16:29:12 2007  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* sample/openssl: reviewed and remove dependency on getopts.rb.

Mon Dec 24 16:18:57 2007  Koichi Sasada  <ko1@atdot.net>

	* mkconfig.rb: add teeny to CONFIG['ruby_version'].

Mon Dec 24 15:55:50 2007  Koichi Sasada  <ko1@atdot.net>

	* tool/compile.rb, getrev.rb, runruby.rb: remove unused tools.

Mon Dec 24 15:42:04 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* configure.in, cygwin/GNUmakefile.in, */Makefile.sub,
	  djgpp/config.hin.: version dependent directory names now contain
	  teeny.

Mon Dec 24 15:29:13 2007  Tanaka Akira  <akr@fsij.org>

	* tool/serb.rb: removed.

Mon Dec 24 13:55:35 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* proc.c (rb_proc_new), vm.c (invoke_block): removed u3.state magic.
	  [ruby-core:14310]

	* test/ruby/test_symbol.rb (test_to_proc): a test from Frederick
	  Cheung <frederick.cheung AT gmail.com>.

Mon Dec 24 13:43:36 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* thread.c (rb_thread_atfork): should not leave living_threads
	  referring freed table while allocating new table.

Mon Dec 24 12:49:54 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* Makefile.in, configure.in, lib/mkmf.rb, */Makefile.sub: specify
	  compiled output file name explicitly.

	* enc/Makefile.in, enc/depend: now makes compiler to put generated
	  files under directories corresnponding to the each source.
	  enc/trans supported.

	* enc/make_encmake.rb: evaluates depend file before Makefile.in so
	  that the former can influence to CONFIG.

Mon Dec 24 12:35:03 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* win{32,ce}/Makefile.sub (MFLAGS): defaulted to -l.

Mon Dec 24 12:08:10 2007  Eric Hodel  <drbrain@segment7.net>

	* /, ext/:  Add svn:ignore for OS X Xcode 3's conftest.dSYM
	  directories.

Mon Dec 24 11:56:31 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* common.mk: should not pass MAKEFLAGS to recursive make.
	  + normal make: MFLAGS are set and command line options and macros
	    are all passed silently.
	  + GNU make: ditto, and all options and macros in MAKEFLAGS are in
	    effect.
	  + nmake: MFLAGS is not set and MAKEFLAGS has only options without
	    hyphen, no macros exist in any variables.
	  + Borland make: ditto, and command line macros cannot override
	    macros in makefile, so passing them is vain.

	* {bcc32,win{32,ce}}/Makefile.sub (SET_MAKE): set MFLAGS which is not
	  set by default, to get rid of chaotic situation of MFLAGS/MAKEFLAGS.

Mon Dec 24 11:32:44 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* string.c (rb_str_comparable): fixed to keep transitivity.
	  [ruby-dev:32693]

Mon Dec 24 11:20:31 2007  Eric Hodel  <drbrain@segment7.net>

	* lib/rdoc/ri/ri_options.rb:  Fix display of GEMDIRS, make command
	  examples match ri's name.

	* lib/rdoc/ri/ri_paths.rb:  Only allow latest ri dirs in ri output.

Mon Dec 24 10:49:04 2007  Eric Hodel  <drbrain@segment7.net>

	* lib/uri/mailto.rb, lib/uri/common.rb:  Fix Regexp warnings.  Patch
	  #16524 from Kornelius Kalnbach, [ruby-core:14302].

Mon Dec 24 10:37:38 2007  Eric Hodel  <drbrain@segment7.net>

	* gem_prelude.rb:  Remove methods from Gem, not QuickLoader, to fix
	  warnings.

Mon Dec 24 09:45:45 2007  Martin Duerst  <duerst@it.aoyama.ac.jp>

	* transcode.c, transcode_data_one_byte.c, transcode_data_japanese.c:
	  added rb_ prefix to external data symbols.

Mon Dec 24 05:32:22 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* enum.c (enum_inject): updated documentation.  a patch from Keita
	  Yamaguchi <keita.yamaguchi AT gmail.com> in [ruby-dev:32686].

	* README.EXT: updated.  a patch from Tadashi Saito
	  <shiba AT mail2.accsnet.ne.jp> in [ruby-core:14328].

	* array.c (rb_ary_at): updated documentation. a patch from Tadashi
	  Saito <shiba AT mail2.accsnet.ne.jp> in [ruby-core:14330].

Mon Dec 24 05:13:04 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* string.c (tr_trans): should associate new encoding if modified.

Mon Dec 24 04:04:12 2007  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* test/net/http/test_https.rb: should rescue LoadError.

Mon Dec 24 03:57:28 2007  Koichi Sasada  <ko1@atdot.net>

	* cont.c, vm.h: fix to support sparc machine.
	  a patch from Yusuke ENDOH <mame AT tsg.ne.jp>

Mon Dec 24 03:35:19 2007  Koichi Sasada  <ko1@atdot.net>

	* common.mk: remove additional "-".

Mon Dec 24 02:59:32 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* io.c (rb_io_check_readable): should not fill fptr->enc always.
	  read-write IO (e.g. socket) does not work.  [ruby-dev:32685]

	* io.c (io_read_encoding): retrieve reading encoding.

	* io.c (prepare_getline_args): convert RS to external encoding. 

	* string.c (str_new_shared): was setting embedding flag of wrong
	  string object.  [ruby-dev:32685]

	* io.c (io_enc_str): should preserve default_external encoding.

	* io.c (appendline): should do multibyte aware RS search.

Mon Dec 24 02:06:35 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* io.c (rb_f_open): documentation update.

	* io.c (rb_io_s_pipe): ditto.

	* io.c (io_fwrite): wrong encoding destination.

	* io.c (rb_io_external_encoding): should return the encoding of
	  the file reading.

	* io.c (rb_io_internal_encoding): should return the encoding of
	  read string.

Mon Dec 24 01:46:43 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* io.c (rb_io_s_pipe): allow specifying read-side encoding.

	* io.c (io_enc_str): wrong encoding destination.

Mon Dec 24 01:03:17 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* string.c (rb_str_comparable): comparison including broken
	  coderange strings do not consider encoding.

Mon Dec 24 00:57:15 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* io.c (open_key_args): IO direct methods (foreach, readlines,
	  read) now takes keyword argument: encoding, mode, open_args.

Mon Dec 24 00:52:15 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* io.c (rb_io_s_read): encoding argument reverted.

	* io.c (mode_enc): independent function to share code.

	* io.c (rb_io_internal_encoding): new method.

Mon Dec 24 00:47:05 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* test/ruby/test_beginendblock.rb (TestBeginEndBlock::test_endblockwarn): 
	  rename endblockwarn.rb to endblockwarn_rb to avoid unnecessary
	  warning in make test.

Sun Dec 23 23:03:13 2007  Tanaka Akira  <akr@fsij.org>

	* encoding.c (rb_enc_codepoint): implemented to raise invalid
	  encoding.

	* include/ruby/encoding.h (rb_enc_codepoint): macro is replaced as a
	  declaration.

Sun Dec 23 19:45:22 2007  Tanaka Akira  <akr@fsij.org>

	* lib/time.rb (Time.httpdate): fix 2 digits year for 20xx.
	  reported by Tadayoshi Funaba.  [ruby-dev:32687]

Sun Dec 23 19:33:42 2007  Eric Hodel  <drbrain@segment7.net>

	* lib/open-uri.rb:  Fix method redefined warning.  [ruby-core:14304]

Sun Dec 23 18:31:49 2007  NARUSE, Yui <naruse@ruby-lang.org>

	* ext/nkf/nkf.c (rb_nkf_enc_get): use rb_define_dummy_encoding.

	* ext/nkf/nkf.c (Init_nkf): use rb_nkf_enc_get("ASCII").

	* ext/nkf/nkf-utf8/nkf.c: Update 1.161.

	* ext/nkf/nkf-utf9/config.h: default output encoding is now UTF-8.

	* ext/nkf/lib/kconv.rb (Kconv.kconv): replace Encoding#name by
	  Encoding#to_s.

Sun Dec 23 18:02:52 2007  Eric Hodel  <drbrain@segment7.net>

	* lib/rubygems/gem_open_uri.rb:  Fix version check.

Sun Dec 23 17:24:48 2007  Tanaka Akira  <akr@fsij.org>

	* encoding.c (rb_enc_init): add eucJP as an alias of EUC-JP.

Sun Dec 23 17:00:23 2007  Tanaka Akira  <akr@fsij.org>

	* lib/time.rb (Time.httpdate): use Time.utc for
	  "day-of-week, dd-mon-yy HH::MM:SS GMT" format.

Sun Dec 23 16:12:40 2007  Eric Hodel  <drbrain@segment7.net>

	* lib/rdoc:  Fix 1.9 warnings.

Sun Dec 23 15:28:37 2007  Eric Hodel  <drbrain@segment7.net>

	* lib/rubygems, test/rubygems:  Fix new 1.9 warnings.

Sun Dec 23 14:43:10 2007  Eric Hodel  <drbrain@segment7.net>

	* gem_prelude.rb:  Use require to load rubygems.rb so the correct path
	is in $LOADED_FEATURES on RubyGems upgrade.

Sun Dec 23 11:26:43 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* string.c (sym_call): use exact argument array interface.
	  [ruby-core:14279]

Sun Dec 23 11:01:35 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* io.c (rb_io_binmode_m): removed C99ism.

Sun Dec 23 10:23:23 2007  Martin Duerst  <duerst@it.aoyama.ac.jp>

	* transcode_data_one_byte.c: Better (and more honest) optimization.

	* transcode_data_japanese.c: First optimization step.

Sun Dec 23 09:07:02 2007  Tanaka Akira  <akr@fsij.org>

	* include/ruby/encoding.h, encoding.c, re.c, io.c, parse.y, numeric.c,
	  ruby.c, transcode.c, ext/nkf/nkf.c: rename rb_ascii_encoding. to
	  rb_ascii8bit_encoding.  rb_ascii_encoding is ambiguous with
	  ASCII-8BIT and US-ASCII.

Sun Dec 23 03:35:52 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* version.h: use patchlevel if revision is not set.

	* {bcc32,win{32,ce}}/setup.mak (-version-): skip including revision.h.

	* common.mk (srcs): new target to generated sources.

	* common.mk (encs, ext/ripper/ripper.c): MAKEFLAGS needs -.

	* enc/depend, enc/make_encmake.rb: use erb.

Sun Dec 23 01:56:18 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* io.c (rb_io_mode_enc): do not set encoding unless explicitly
	  specified.

	* io.c (rb_io_check_readable): fill fptr->enc by default_external
	  if it's empty.

	* io.c (io_enc_str): fptr->enc is always set for reading IO (by
	  rb_io_check_readable(fptr)).

Sun Dec 23 01:18:06 2007  David Flanagan  <david@davidflanagan.com>

	* io.c, io.h: temporary patch to partially implement
	  transcode-on-read and transcode-on-write

Sun Dec 23 00:48:05 2007  Shugo Maeda  <shugo@ruby-lang.org>

	* test/net/imap/test_imap.rb: added tests for SSL.

Sat Dec 22 21:10:53 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* ext/syck/rubyext.c (syck_genericresolver_node_import): should
	  not set instance variable "@kind" before initializing it.
	  [ruby-dev:32677]

Sat Dec 22 19:52:23 2007  Koichi Sasada  <ko1@atdot.net>

	* bootstraptest/test_objectspace.rb: fix condition.

Sat Dec 22 19:17:10 2007  Koichi Sasada  <ko1@atdot.net>

	* ext/probeprofiler/: removed.

Sat Dec 22 19:14:38 2007  Koichi Sasada  <ko1@atdot.net>

	* process.c (rb_f_fork): Unsupport Kernel.fork() on NetBSD.

Sat Dec 22 15:54:54 2007  Martin Duerst  <duerst@it.aoyama.ac.jp>

	* test/ruby/test_transcode.rb: Added simple tests for
	  EUC-JP and Shift_JIS and tests for ASCII-only range

Sat Dec 22 18:20:13 2007  NAKAMURA Usaku  <usa@ruby-lang.org>

	* common.mk (version.o): add dependency. [ruby-dev:32680]

Sat Dec 22 17:45:11 2007  NARUSE, Yui <naruse@ruby-lang.org>

	* ext/nkf/nkf.c (Init_nkf): use rb_ascii_encoding() for
	  rb_nkf_enc_get("US-ASCII").
	  * if use rb_nkf_enc_get("US-ASCII"), ruby will crash - this is bug?

Sat Dec 22 17:39:03 2007  NAKAMURA Usaku  <usa@ruby-lang.org>

	* lib/mkmf.rb ($extmk): fixed broken condition.

Sat Dec 22 17:35:59 2007  NARUSE, Yui <naruse@ruby-lang.org>

	* ext/nkf/nkf-utf8.c: Update nkf.c rev:1.157.

	* ext/nkf/nkf.c (rb_nkf_enc_get): replicate proper based encoding.

	* ext/nkf/kconv.c (Kconv#kconv, to*): use self.encoding as from_enc
	  when from_enc isn't given.

Sat Dec 22 17:06:50 2007  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* ext/openssl/lib/net/ssl.rb (OpenSSL::SSL::SSLContext.build): removed.

	* ext/openssl/lib/net/ssl.rb (OpenSSL::SSL::SSLContext#set_params):
	  new method to set suitable SSL parameters.

	* lib/net/pop.rb, lib/net/http.rb, lib/net/imap.rb, 
	  test/openssl/test_ssl.rb: follow above change.

	* test/net/http/test_https.rb: refine error case.

Sat Dec 22 16:58:49 2007  Shugo Maeda  <shugo@ruby-lang.org>

	* lib/net/imap.rb (encode_utf7): accept UTF-8 strings.

	* lib/net/imap.rb (decode_utf7): return UTF-8 strings.

Sat Dec 22 15:56:36 2007  NAKAMURA Usaku  <usa@ruby-lang.org>

	* transcode_data_japanese: typo.

Sat Dec 22 15:54:54 2007  Martin Duerst  <duerst@it.aoyama.ac.jp>

	* ChangeLog: Information for last patch got lost, fixed

Sat Dec 22 15:45:45 2007  Martin Duerst  <duerst@it.aoyama.ac.jp>

	* transcode_data_one_byte: slightly optimized

	* transcode_data_japanese: new data file for EUC-JP and SHIFT_JIS
	  (not yet optimized; tests to follow; data from
	  http://nkf.sourceforge.jp/ucm/{SJIS|eucJP}-nkf.ucm)

	* common.mk, transcode.c: Adjusted for transcode_data_japanese

Sat Dec 22 15:30:13 2007  NAKAMURA Usaku  <usa@ruby-lang.org>

	* */Makefile.sub (MFLAGS): define unless defined.

Sat Dec 22 15:17:40 2007  NAKAMURA Usaku  <usa@ruby-lang.org>

	* lib/mkmf.rb ($extmk): set true only when under ext/ or tool/.

Sat Dec 22 15:14:48 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* common.mk (encs, ext/ripper/ripper.c): needs MFLAGS.

	* configure.in (STRINGIZE): stringizing macro.

	* include/ruby/defines.h (STRINGIZE): fallback.

	* tool/make-snapshot: new file.

	* version.c (ruby_description, ruby_copyright): string constants for
	  -v option.

Sat Dec 22 15:03:37 2007  Shugo Maeda  <shugo@ruby-lang.org>

	* lib/net/imap.rb (initialize): fixed documentation.

Sat Dec 22 15:01:16 2007  Shugo Maeda  <shugo@ruby-lang.org>

	* lib/net/pop.rb (enable_ssl): use OpenSSL::SSL::SSLContext.build
	  instead of SSLContext.new (default verify mode is now
	  OpenSSL::SSL::VERIFY_PEER).

Sat Dec 22 14:45:21 2007  Tadayoshi Funaba  <tadf@dotrb.org>

	* lib/date.rb: shouldn't freeze nil. [ruby-dev:32677]

Sat Dec 22 14:27:27 2007  Tanaka Akira  <akr@fsij.org>

	* regenc.c (onigenc_ascii_is_code_ctype): moved from enc/ascii.c.

	* regenc.h (onigenc_ascii_is_code_ctype): declared.

	* enc/ascii.c: use onigenc_ascii_is_code_ctype.

	* enc/us_ascii.c: new file for US-ASCII.

Sat Dec 22 14:30:34 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* parse.y (reg_named_capture_assign_iter): allows non-ascii names and
	  get rid of reserved word IDs.

Sat Dec 22 14:18:45 2007  Koichi Sasada  <ko1@atdot.net>

	* test/ruby/test_float.rb, test_sprintf.rb: fix test place.

Sat Dec 22 14:17:02 2007  Koichi Sasada  <ko1@atdot.net>

	* bootstraptest/test_objectspace.rb: skip flozen string.

Sat Dec 22 14:02:58 2007  Koichi Sasada  <ko1@atdot.net>

	* array.c (rb_ary_permutation): add volatile to avoid GC problem.

Sat Dec 22 11:47:42 2007  Koichi Sasada  <ko1@atdot.net>

	* eval.c (rb_obj_instance_eval): use class of immediate objects.

	* test/ruby/test_eval.rb: fix a test.

Sat Dec 22 11:37:06 2007  NAKAMURA Usaku  <usa@ruby-lang.org>

	* encoding.c (rb_locale_charmap): win32 support.

Sat Dec 22 11:31:14 2007  Eric Hodel  <drbrain@segment7.net>

	* gem_prelude.rb:  Place bin dir before lib dir so gem bin stubs work.

Sat Dec 22 11:05:44 2007  Jim Weirich  <jim@tardis.local>

	* lib/rake.rb (Rake): Added Rake and related libraries to the
	source code base.

Sat Dec 22 10:30:45 2007  Koichi Sasada  <ko1@atdot.net>

	* tool/insns2vm.rb: moved from lib/vm/instruction.rb.

Sat Dec 22 10:25:44 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* parse.y (reg_named_capture_assign_iter): captured name should
	  not be reserved word.  a patch from Keita Yamaguchi
	  <keita.yamaguchi AT gmail.com> in [ruby-dev:32675].

	* parse.y (reg_named_capture_assign_iter): just ignore the
	  captures that do not have valid local variable name.

Sat Dec 22 10:19:08 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (rb_f_method_name): now __method__ and __callee__ are
	  aliases.  [ruby-core:14244]

Sat Dec 22 08:29:56 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* string.c (rb_str_buf_append): improvement for non-broken coded
	  strings.

Sat Dec 22 06:30:04 2007  Koichi Sasada  <ko1@atdot.net>

	* bootstraptest/test_fork.rb: skip if fork is not unsupported.

	* bootstraptest/test_io.rb: skip if require failed.

Sat Dec 22 06:09:12 2007  David Flanagan  <david@davidflanagan.com>

	* io.c: fix typo in rdoc comment

Sat Dec 22 05:09:43 2007  NAKAMURA Usaku  <usa@ruby-lang.org>

	* parse.y (parser_str_new, rb_intern3): rb_default_encoding() renamed.

	* ext/nkf/nkf.c (rb_nkf_putchar): ditto.

Sat Dec 22 03:54:18 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* encoding.c (rb_ascii_encoding): renamed from previous
	  rb_default_encoding().

Sat Dec 22 02:49:02 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* parse.y (command): block from cmd_brace_block was ignored.
	  [ruby-dev:32644]

	* re.c (rb_reg_prepare_re): stop ENCODING_NONE warning if the
	  encoding of the str is ASCII-8BIT.

Sat Dec 22 01:52:11 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* io.c (io_ungetc): avoid buffer relocation, which might cause
	  serious problem under concurrent situation.

Sat Dec 22 01:35:41 2007  Tanaka Akira  <akr@fsij.org>

	* re.c (ARG_ENCODING_NONE): defined for /.../n option.
	  (REG_ENCODING_NONE): ditto.
	  (rb_char_to_option_kcode): return ARG_ENCODING_NONE for n.
	  (rb_reg_prepare_re): warn /ascii/n =~ "non-ascii".
	  (rb_reg_initialize): set REG_ENCODING_NONE from ARG_ENCODING_NONE.

Sat Dec 22 01:23:10 2007  Shugo Maeda  <shugo@ruby-lang.org>

	* test/json/test_json_addition.rb (test_core): do not use Time.now
	  because JSON can't hold nsec.

Sat Dec 22 01:10:30 2007  NAKAMURA Usaku  <usa@ruby-lang.org>

	* ext/tk/sample/tkextlib/vu/canvSticker2.rb,
	  ext/tk/sample/demos-{en,jp}/bind.rb: fix typo. [ruby-dev:32668]

Sat Dec 22 00:56:43 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* sample/test.rb (valid_syntax): force_encoding input script.

Fri Dec 21 23:48:38 2007  NAKAMURA Usaku  <usa@ruby-lang.org>

	* lib/mkmf.rb (depend_rules): suffixes list broken. fixed.

Fri Dec 21 20:18:15 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* bignum.c (rb_big_mul0): remove unused variable.

	* bignum.c (bigdivrem): ditto.

Fri Dec 21 20:13:51 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* include/ruby/ruby.h (rb_catch_obj, rb_throw_obj): prototyped.

	* include/ruby/intern.h (rb_fiber_alive_p): prototyped.

Fri Dec 21 20:09:18 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* string.c (rb_str_succ): retry increasing until valid char is found.

Fri Dec 21 20:00:02 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* encoding.c (rb_enc_replicate): now creates first class encoding.

	* encoding.c (rb_define_dummy_encoding): always based on the default
	  encoding.

	* encoding.c (rb_enc_dummy_p): check if dummy.

	* encoding.c (enc_inspect): shows if dummy.

	* encoding.c (Init_Encoding): added dummy? method

	* include/ruby/encoding.h (ENCODING_INLINE_MAX): increased.

Fri Dec 21 18:40:54 2007  Koichi Sasada  <ko1@atdot.net>

	* io.c: write() should be in blocking region.

	* bootstraptest/test_io.rb, test_knownbug.rb: move a fixed test.

Fri Dec 21 17:56:30 2007    <nagai@orca16.orcabay.ddo.jp>

	* ext/tk/tcltklib.c: provisional support on Ruby-VM.

	* ext/tk/MANUAL_tcltklib.eng, ext/tk/MANUAL_tcltklib.eucj: 
	  modify document about new functions.

	* ext/tk/lib/tk.rb, ext/tk/lib/tk/labelframe.rb,
	  ext/tk/lib/tk/frame.rb, ext/tk/lib/tk/toplevel.rb,
	  ext/tk/lib/tk/scrollbar.rb, ext/tk/lib/tk/message.rb,
	  ext/tk/lib/tk/listbox.rb, ext/tk/lib/tk/text.rb,
	  ext/tk/lib/tk/scale.rb, ext/tk/lib/tk/entry.rb, 
	  ext/tk/lib/tk/ttk_selector.rb, ext/tk/lib/tk/menu.rb,
	  ext/tk/lib/tk/label.rb, ext/tk/lib/tk/spinbox.rb,
	  ext/tk/lib/tk/textmark.rb, ext/tk/lib/tk/winpkg.rb,
	  ext/tk/lib/tk/checkbutton.rb, ext/tk/lib/tk/panedwindow.rb,
	  ext/tk/lib/tk/texttag.rb, ext/tk/lib/tk/root.rb,
	  ext/tk/lib/tk/textimage.rb, ext/tk/lib/tk/radiobutton.rb,
	  ext/tk/lib/tk/package.rb, ext/tk/lib/tk/macpkg.rb,
	  ext/tk/lib/tk/composite.rb, ext/tk/lib/tk/autoload.rb,
	  ext/tk/lib/tk/canvas.rb, ext/tk/lib/tk/button.rb,
	  ext/tk/lib/tk/textwindow.rb,
	  ext/tk/lib/tkextlib/iwidgets/scrolledtext.rb,
	  ext/tk/lib/tkextlib/tile/style.rb,
	  ext/tk/lib/tkextlib/tile/tscrollbar.rb,
	  ext/tk/lib/tkextlib/tile/tpaned.rb, ext/tk/lib/tkextlib/tile.rb,
	  ext/tk/extconf.rb: support Tcl/Tk8.5 (partial, not complete).

	* ext/tk/sample/demos-jp/widget,
	  ext/tk/sample/demos-jp/pendulum.rb,
	  ext/tk/sample/demos-jp/bind.rb,
	  ext/tk/sample/tkextlib/vu/canvSticker2.rb, 
	  ext/tk/sample/demos-en/pendulum.rb, 
	  ext/tk/sample/demos-en/bind.rb: remove $KCODE and minor bug fix.

Fri Dec 21 17:49:06 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* transcode.c (rb_str_transcode_bang): returns self if no conversion.
	  [ruby-dev:32662]

Fri Dec 21 17:44:47 2007  Eric Hodel  <drbrain@segment7.net>

	* lib/rubygems*:  Update to RubyGems 1.0.1, r1581

Fri Dec 21 17:32:49 2007  Koichi Sasada  <ko1@atdot.net>

	* bootstraptest/pending.rb: renamed from featurebug.rb.
	  This file contains bugs which is known but will not be
	  fixed in days.

Fri Dec 21 17:31:22 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* debug.c (dummy_gdb_enums.various): added ENCODING and CODERANGE
	  constants.

	* .gdbinit: use enum constants.

Fri Dec 21 17:28:17 2007  Koichi Sasada  <ko1@atdot.net>

	* bootstraptest/featurebug.rb: added.

	* bootstraptest/test_knownbug.rb: move a feature bug.

Fri Dec 21 17:25:22 2007  Koichi Sasada  <ko1@atdot.net>

	* thread.c (rb_thread_atfork): fix to mark thread object.
	  [ruby-dev:32404]

	* bootstraptest/test_knownbug.rb, test_fork.rb: move a fixed test.

Fri Dec 21 17:07:13 2007  Koichi Sasada  <ko1@atdot.net>

	* gc.h: extern variable should not be initialized.

	* thread_pthread.c: add a parameter.

Fri Dec 21 16:50:43 2007  Tanaka Akira  <akr@fsij.org>

	* encoding.c (Init_Encoding): use enc_name as to_s.
	  (enc_inspect): renamed from enc_to_s.  add "#" at beginning.

Fri Dec 21 16:37:43 2007  NARUSE, Yui <naruse@ruby-lang.org>

	* ext/nkf/nkf-utf8/config.h (MIME_DECODE_DEFAULT, X0201_DEFAULT):
	 defined as FALSE.  nkf and kconv don't decode MIME encoded string
	 and don't convert JIS X 0201 Katakana.
	
	* test/nkf/test_kconv.rb: fix tests.

Fri Dec 21 16:33:28 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* enumerator.c (enumerator_iter_i): adjusted for rb_block_call_func.

	* include/ruby/ruby.h (rb_block_call_func): function to be called back
	  as block.

Fri Dec 21 16:25:25 2007  Martin Duerst  <duerst@it.aoyama.ac.jp>

	* common.mk, transcode_data_iso_8859.c: renamed to
	  transcode_data_one_byte.c.

Fri Dec 21 16:10:30 2007  Shigeo Kobayashi  <shigeo@tinyforest.jp>

	* ext/bigdecimal/bigdecimal.c (VpMidRound): Round method bug
	  pointed by Ryan Platte fixed(Patch to the patch from "NATORI
	  Shin").  [ruby-talk:273360]

Fri Dec 21 16:06:13 2007  Tanaka Akira  <akr@fsij.org>

	* re.c (append_utf8): use rb_utf8_encoding() instead of
	  rb_enc_find("utf-8").

Fri Dec 21 15:59:46 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* encoding.c (rb_enc_init): use enc_register_at() directly.

	* encoding.c (rb_utf8_encoding): returns utf-8 encoding.

	* include/ruby/encoding.h (rb_utf8_encoding): prototyped.

	* parse.y (UTF8_ENC): uses rb_utf8_encoding().

Fri Dec 21 15:31:59 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* io.c (rb_io_s_read): allow specifying encoding explicitly.

	* io.c (rb_io_binmode): specifies encoding to ASCII-8BIT (binary).

	* io.c (rb_io_s_read): IO should be in binary mode when offset is
	  specified.

	* encoding.c (rb_to_encoding): returns default encoding if no
	  corresponding encoding found.

Fri Dec 21 15:24:22 2007  Shugo Maeda  <shugo@ruby-lang.org>

	* lib/net/imap.rb (initialize): accept service name.  changed
	  the defalut value of the old style +verify+ argument to true.

Fri Dec 21 15:15:44 2007  Tanaka Akira  <akr@fsij.org>

	* gc.c (rb_garbage_collect): new function for debugging.

Fri Dec 21 15:16:00 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* encoding.c (rb_to_encoding_index): should return error instead of
	  exception even if type is incorrect.

Fri Dec 21 14:58:27 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* enumerator.c (enumerator_init_copy): prohibit cloning of
	  generators since Fibers cannot be copied.

	* enumerator.c (enumerator_init_copy): typo fixed.

Fri Dec 21 14:46:07 2007  Tanaka Akira  <akr@fsij.org>

	* io.c (Init_IO): define IO::BINARY even if O_BINARY is not exist.

Fri Dec 21 14:01:14 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* test/ruby/test_system.rb (TestSystem::valid_syntax): apply
	  ASCII-8BIT encoding explicitly.

	* re.c (rb_reg_prepare_re): add encoding name in the message.

Fri Dec 21 13:54:05 2007  Tanaka Akira  <akr@fsij.org>

	* re.c: change "character encodings differ" error messages.

Fri Dec 21 13:46:58 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* encoding.c (rb_enc_register): set encoding constant.

	* encoding.c (rb_enc_find_index): replace non-alphanumeric chars with
	  underscores, so that initialize function can be called.

	* encoding.c (rb_enc_find_index): extension libraries have lower case
	  names conventionally.

	* ruby.c (proc_options, process_options): finds encoding after
	  load_path is initialized.

Fri Dec 21 13:10:57 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* io.c (rb_io_external_encoding): new method.

	* encoding.c (rb_enc_from_encoding): returns Qnil for NULL
	  encoding.

	* io.c (rb_io_external_encoding): should fill delayed
	  initialization for STDIN.

Fri Dec 21 13:09:11 2007  Tanaka Akira  <akr@fsij.org>

	* encoding.c (rb_locale_charmap): return nil if no locale information.

Fri Dec 21 12:55:39 2007  Tanaka Akira  <akr@fsij.org>

	* lib/runit, lib/rubyunit.rb, test/testunit/runit: removed.

Fri Dec 21 12:45:49 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* string.c (rb_str_chomp_bang): avoid unnecessary loop using
	  ONIGENC_LEFT_ADJUST_CHAR_HEAD().

Fri Dec 21 12:32:08 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* file.c (Init_File): File.exists? revived.

	* dir.c (Init_Dir): Dir.exists? again.

Fri Dec 21 12:26:36 2007  Koichi Sasada  <ko1@atdot.net>

	* compile.c: remove "illegal".

Fri Dec 21 12:22:20 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* keywords, parse.y (__ENCODING__): represent script encoding.

Fri Dec 21 12:16:50 2007  Tanaka Akira  <akr@fsij.org>

	* string.c (rb_str_is_ascii_only_p): new method ascii_only?.

Fri Dec 21 12:11:57 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* io.c (rb_io_mode_enc): set default external encoding if no
	  encoding specified explicitly.

Fri Dec 21 12:00:34 2007  Tanaka Akira  <akr@fsij.org>

	* configure.in: check langinfo.h and locale.h.

	* encoding.c: use langinfo.h only if available.

	* main.c: use locale.h only if available.

Fri Dec 21 11:47:56 2007  Tanaka Akira  <akr@fsij.org>

	* encoding.c: include locale.h
	  (rb_locale_charmap): new method Encoding.locale_charmap for
	  nl_langinfo(CODESET).

	* include/ruby/encoding.h (rb_locale_charmap): declared.

	* main.c (main): call setlocale with LC_CTYPE.

	* ruby.c (locale_encoding): use rb_locale_charmap.

Fri Dec 21 11:35:10 2007  Koichi Sasada  <ko1@atdot.net>

	* vm.c, vm_dump.c: fix typo.  Reported by Yuki Mitsui.

Fri Dec 21 11:28:00 2007  Tanaka Akira  <akr@fsij.org>

	* regerror.c, string.c, io.c, lib/getoptlong.rb, lib/net/imap.rb,
	  compile.c, sprintf.c, parse.y, ext/win32ole/win32ole.c,
	  ext/tk/sample/demos-en/entry3.rb, ext/tk/lib/tcltk.rb,
	  ext/openssl/ossl_bn.c, numeric.c, vm.c,
	  benchmark/bm_so_meteor_contest.rb, bignum.c, ruby.c: don't "illegal"
	  for non law violation context.

Fri Dec 21 11:23:24 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* common.mk (enc.mk): depends on $(RBCONFIG) instead of rbconfig.rb.

	* encoding.c (Init_Encoding): ISO-8859-1 is no longer a replica.

	* regenc.h (OnigEncodingDefine): names of extension and encoding can
	  differ.

	* enc/Makefile.in: always shared.

	* enc/depend (deffile): should not upcase.

	* enc/{ascii,euc_jp,sjis,utf8,iso_8859_{1..16}}.c: fix for Init.

Fri Dec 21 09:26:48 2007  Tanaka Akira  <akr@fsij.org>

	* tool/compile_prelude.rb: use erb.

Fri Dec 21 08:07:35 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* enumerator.c (enumerator_next): should call next_init() if fiber
	  is dead already. [ruby-dev:32459]

Fri Dec 21 01:21:49 2007  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* ext/openssl/lib/openssl/ssl.rb (OpenSSL::SSL::SSLContext.build):
	  enable CRL checking by default.

Fri Dec 21 01:20:56 2007  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* lib/net/http.rb (Net::HTTP#connect): use
	  OpenSSL::SSL::SSLContext.build instead of SSLContext.new (default
	  verify mode is now OpenSSL::SSL::VERIFY_PEER).

	* lib/net/https.rb: SSL parameters are defined by attr_accessor.

	* test/net/http/test_https.rb: add test for HTTPS features.

Fri Dec 21 01:11:37 2007  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* io.c (select_internal): should return original value.

Fri Dec 21 00:26:39 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* string.c (tr_trans): wrong encoding check for tree strings.

	* test/ruby/test_m17n.rb (TestM17N::test_tr_s): "invalid mbstring
	  sequence" is not an error to be tested.

	* test/ruby/test_m17n.rb (TestM17N::test_tr): ditto.

Thu Dec 20 19:29:07 2007  Shugo Maeda  <shugo@ruby-lang.org>

	* lib/net/imap.rb (initialize): the second argument is an option
	  hash now.  use SSLContext.build to specify SSL parameters.

Thu Dec 20 19:11:56 2007  Koichi Sasada  <ko1@atdot.net>

	* thread_pthread.c (native_thread_apply_priority): check
	  _POSIX_PRIORITY_SCHEDULING for OpenBSD.

Thu Dec 20 18:33:54 2007  Koichi Sasada  <ko1@atdot.net>

	* configure.in: add libthr for FreeBSD.

Thu Dec 20 18:17:14 2007  Koichi Sasada  <ko1@atdot.net>

	* common.mk, *.ci: renamed to *.c.

	* eval_laod.c: renamed to load.c.

Thu Dec 20 17:36:01 2007  Eric Hodel  <drbrain@segment7.net>

	* lib/rubygems*:  Import RubyGems 1.0.0, r1575.

Thu Dec 20 17:18:38 2007  Koichi Sasada  <ko1@atdot.net>

	* proc.c: support Proc#binding.

	* sample/test.rb: add a test.

Thu Dec 20 17:15:15 2007  Martin Duerst  <duerst@it.aoyama.ac.jp>

	* pack.c: Slight change to documentation ('character' ->
	  'byte (C char)'). [ruby-core:13126], see also [ruby-core:13998].

Thu Dec 20 17:07:54 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* common.mk (enc.mk): depends on rbconfig.rb.

	* regenc.h (OnigEncodingDefine): external encoding definition macro.

	* enc/Makefile.in: fix for linking.

	* enc/depend, enc/make_encmake.rb: fix for Windows.

	* enc/{ascii,euc_jp,sjis,utf8,iso_8859_{1..16}}.c: renamed.

Thu Dec 20 16:42:55 2007  Koichi Sasada  <ko1@atdot.net>

	* iseq.c (find_line_no): return 0 if not found.

Thu Dec 20 16:04:17 2007  Koichi Sasada  <ko1@atdot.net>

	* insnhelper.ci, vm.c, vm_core.h: change interface of
	  vm_invoke_block() to specify block ptr.  [ruby-talk:266422]

	* cont.c, eval_jump.ci, insns.def, proc.c, signal.c, thread.c:
	  apply above change.

	* bootstraptest/test_knownbug.rb: move fixed bug.

	* bootstraptest/test_block.rb: ditto. and add a test.

Thu Dec 20 15:47:13 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* enc/iso_8859_{1..16}.c: renamed.

Thu Dec 20 09:59:27 2007  Koichi Sasada  <ko1@atdot.net>

	* insnhelper.ci (vm_expandarray): fix sp increase place.
	  a patch from Yusuke ENDOH <mame AT tsg.ne.jp> in [ruby-dev:32581].

	* bootstraptest/test_massign.rb: add a test for above.

	* bootstraptest/test_syntax.rb: fix last committed test.

Thu Dec 20 09:47:58 2007  Koichi Sasada  <ko1@atdot.net>

	* bootstraptest/test_syntax.rb: add a test.

Thu Dec 20 09:40:51 2007  Koichi Sasada  <ko1@atdot.net>

	* compile.c (iseq_compile_each/NODE_RETURN): fix stack consistency.

Thu Dec 20 09:42:11 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* bignum.c (big2str_orig): access beyond memory region cause crash
	  on interrupt.  a patch from Yusuke ENDOH <mame AT tsg.ne.jp> in 
	  [ruby-dev:32651].  [ruby-dev:32641]

Thu Dec 20 09:06:54 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* string.c (rb_str_index): wrong starting position.

Thu Dec 20 06:34:27 2007  Koichi Sasada  <ko1@atdot.net>

	* compile.c (iseq_compile_each): add pop after throw as return.

	* bootstraptest/test_knownbug.rb, test_syntax.rb: move resolved test.

	* vm_core.h, iseq.c, compile.h: add debug output code.

Thu Dec 20 04:57:18 2007  Koichi Sasada  <ko1@atdot.net>

	* compile.c (iseq_compile_each): remove unused retry entry.

Thu Dec 20 04:15:41 2007  NAKAMURA Usaku  <usa@ruby-lang.org>

	* */Makefile.sub (DEFS, RM): output to config.status.

Thu Dec 20 02:59:05 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* common.mk (encs): create encoding directory.

Thu Dec 20 02:50:28 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* enc/iso8859_{1..16}.c: adjust for ruby.

Thu Dec 20 02:28:29 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* enc/iso8859_{1..16}.c: imported from Onigiruma 5.9.0.

Thu Dec 20 02:23:22 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* enc/Makefile.in (RM): added.

	* enc/depend (encs): sort in alpha-numeric order.

	* enc/depend (clean, distclean): added.

Thu Dec 20 01:10:52 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* compile.c (iseq_compile_each): should handle upper level eval iseq
	  from break/next, and COMPILE_ERROR() breaks only one block.
	  [ruby-dev:31372]

Thu Dec 20 00:07:36 2007  Masatoshi SEKI  <m_seki@mva.biglobe.ne.jp>

	* test/drb/drbtest.rb (test_07_public_private_protected_missing):
	  followed current Ruby specification.

Wed Dec 19 23:57:37 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* dir.c (dir_inspect, dir_path, dir_tell): check for frozen and closed
	  is not needed.  [ruby-dev:32640]

Wed Dec 19 22:59:52 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* string.c (str_sublen): adjust position if position is not at the
	  head of a character.

	* string.c (rb_str_chomp_bang): check if match start at the head
	  of a character.

	* string.c (rb_str_chomp_bang): wrong adjust condition.

	* string.c (rb_str_rindex): comparison length should be based on
	  bytes, not characters.

	* string.c (rb_str_rindex_m): too much adjustment.

	* re.c (reg_match_pos): pos adjustment should be based on
	  characters.

	* test/ruby/test_m17n.rb (TestM17N::test_str_insert): test updated
	  to check negative offset behavior.

	* string.c (rb_str_each_line): should consider rslen.

	* string.c (rb_str_buf_append): should propagate encoding.

	* string.c (rb_str_each_line): ditto.

	* test/ruby/test_m17n.rb (TestM17N::test_str_each_line): should
	  check encoding as well.

	* test/ruby/test_m17n.rb (TestM17N::test_str_each_line): empty
	  array can not propagate encoding;  should not check.

Wed Dec 19 21:42:18 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* re.c (rb_reg_regsub): should set checked encoding.

	* string.c (rb_str_sub_bang): applied r14212 too.

Wed Dec 19 20:40:01 2007  NAKAMURA Usaku  <usa@ruby-lang.org>

	* bignum.c (bigmul1): C99ism.

	* bignum.c (bigdivrem1): need dummy return value.

Wed Dec 19 19:18:06 2007  NARUSE, Yui <naruse@ruby-lang.org>

	* ext/nkf/nkf-utf8/nkf.c: Updated.

	* ext/nkf/nkf.c (rb_nkf_enc_get): added.
	  (find encoding or replicate default encoding)

	* ext/nkf/nkf.c (NKF::<ENCODING>): redefine encoding constant.

	* ext/nkf/lib/kconv.rb (Kconv::<ENCODING>): redefined as Encoding.

	* ext/nkf/lib/kconv.rb: refactoring.

Wed Dec 19 19:11:08 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* bignum.c (rb_big_mul0): blocking check for bigger numbers.
	  a patch from Yusuke ENDOH <mame AT tsg.ne.jp> in [ruby-dev:32632].

	* bignum.c (bigdivrem): ditto.

Wed Dec 19 17:34:50 2007  Koichi Sasada  <ko1@atdot.net>

	* compile.c (iseq_compile_each): remove "retry" in block.
	  ("iter{retry}" cause syntax error)
	  Currently, "begin; ...; rescue; iter{retry}; end" cause
	  syntax error too.

	* bootstraptest/test_jump.rb: ditto.

	* lib/drb/invokemethod.rb: ditto.

	* sample/drb/darrayc.rb: ditto.

	* sample/test.rb: ditto.

	* test/drb/drbtest.rb: ditto.

	* test/ruby/test_iterator.rb: ditto.

	* sample/test.rb: add a 'test' directory on the SYSTEM test.

Wed Dec 19 17:12:59 2007  Koichi Sasada  <ko1@atdot.net>

	* bootstraptest/test_knownbug.rb, test_block.rb: 
	  move fixed bug.

	* bootstraptest/test_m17n.rb: added.

Wed Dec 19 16:59:55 2007  Koichi Sasada  <ko1@atdot.net>

	* eval.c (errinfo_place): skip if error is Fixnum.  [ruby-dev:32608]

	* bootstraptest/test_exception.rb, test_known_bug.rb: move fixed bug.

Wed Dec 19 16:31:58 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* parse.y (reg_named_capture_assign_iter): remove C99 dependency.

	* parse.y (reg_named_capture_assign_iter): get rid of creating
	  unnecessary ID.

	* parse.y (rb_enc_symname2_p): check for non-nul-terminated string.

Wed Dec 19 15:37:06 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* insnhelper.ci (vm_yield_with_cfunc): call cfunc with
	   (argv[0], data, argc, argv) to pass all arguments.

	* enumerator.c (enumerator_each_i): adapted to new calling
	  convention.

Wed Dec 19 15:13:20 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* string.c (rb_str_justify): should propagate encoding from pad
	  string too.

Wed Dec 19 13:57:43 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* configure.in (TIMEZONE_VOID): check whether timezone requires zero
	  arguments.  [ruby-dev:32631]

Wed Dec 19 13:22:14 2007  NARUSE, Yui <naruse@ruby-lang.org>

	* ext/nkf/nkf.c (NKF::_ENCODING): removed.

	* ext/nkf/nkf.c (rb_nkf_kconv): renamed to rb_nkf_convert.

	* ext/nkf/nkf.c (rb_nkf_convert): set encoding.

	* ext/nkf/nkf.c (rb_nkf_guess1): removed.

	* ext/nkf/nkf.c (rb_nkf_guess2): renamed to rb_nkf_guess.

	* ext/nkf/nkf.c (rb_nkf_guess):
	  guess method now returns encoding object.

	* ext/nkf/nkf-utf8/nkf.c: Update to nkf 2.0.8 2007-12-19.

Wed Dec 19 10:52:29 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* bignum.c (rb_cstr_to_inum): an underscore succeeding after octal
	  prefix is allowed.  [ruby-core:14139]

Wed Dec 19 00:09:19 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* bignum.c (rb_cstr_to_inum): wrong radix check.  a patch from
	  Yusuke ENDOH <mame AT tsg.ne.jp> in [ruby-dev:32628].

	* bignum.c (big2str_find_n1): ditto.

Tue Dec 18 23:53:53 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* compile.c (iseq_compile_each): fix for segfault.  [ruby-dev:31372]

Tue Dec 18 23:44:32 2007  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* test/net/http/utils.rb: split TestNetHTTPUtils module from
	  test/net/http/test_http.rb. and start HTTP server in each test case.

Tue Dec 18 23:27:51 2007  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* lib/webrick/server.rb (WEBrick::GenericServer#accept_client): 
	  should rescue Errno::EINVAL from TCPServer#accept. this exception
	  might occur if the server socket is not in ready to listen.

	* lib/webrick/server.rb (WEBrick::GenericServer#accept_client):
	  don't call TCPServer#close if the :ShutdownSocketWithoutClose is set.

	* lib/webrick/config.rb (WEBrick::Config::General): add new parameter
	  :ShutdownSocketWithoutClose.

Tue Dec 18 22:51:47 2007  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* ext/openssl/lib/openssl/ssl.rb (OpenSSL::SSL::SSLServer#shutdown): 
	  new method which calls TCPSocket#shutdown of the underlying socket.

Tue Dec 18 22:11:50 2007  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* lib/rss/parser.rb, lib/rss/atom.rb, lib/rss/rss.rb,
	  test/rss/rss-assertions.rb, test/rss/test_atom.rb: use
	  pack/unpack("m") instead of base64 library.

	* lib/webrick/httpproxy.rb: use delete("\n") instead of chomp/chop
	  because the result of pack("m") might be multi-line.

Tue Dec 18 22:12:35 2007  Koichi Sasada  <ko1@atdot.net>

	* insnhelper.ci, vm.c: rewrite sp manipulation around method/block
	  invocation.  [ruby-dev:32547]

Tue Dec 18 22:11:23 2007  NAKAMURA Usaku  <usa@ruby-lang.org>

	* ext/dl/win32/lib/win32/sspi.rb: use pack/unpack("m") instead of
	  base64 library which was already removed.

Tue Dec 18 21:09:23 2007  Koichi Sasada  <ko1@atdot.net>

	* vm.c (invoke_block): merge 2 stack overflow checks.

Tue Dec 18 20:58:35 2007  Koichi Sasada  <ko1@atdot.net>

	* compile.c, insnhelper.ci, insns.def, object.c, vm.c, vm.h:
	  optimize !@, != method invocation.

	* id.c, id.h: ditto.

	* bootstraptest/test_syntax.rb: add tests for above.

Tue Dec 18 18:10:05 2007  Koichi Sasada  <ko1@atdot.net>

	* bootstraptest/test_knownbug.rb: add issues.

Tue Dec 18 20:22:44 2007  Tanaka Akira  <akr@fsij.org>

	* parse.y (arg tMATCH arg): call reg_named_capture_assign_gen if regexp
	  literal is used.
	  (reg_named_capture_assign_gen): assign the result of named capture
	  into local variables.
	  [ruby-dev:32588]

	* re.c: document the assignment by named captures.

Tue Dec 18 18:09:15 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* string.c (rb_str_splice): propagate encoding.

	* string.c (rb_str_subpat_set): ditto.

Tue Dec 18 17:27:12 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* object.c (rb_obj_freeze): preserve frozen state of immediate
	  values in internal hash table, a la generic_ivar.

	* object.c (rb_obj_frozen_p): check immediate values too.

	* variable.c (generic_ivar_set): add frozen check fro immediate
	  values. 

Tue Dec 18 17:04:25 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* transcode.c (rb_str_transcode_bang, rb_str_transcode): set new
	  encoding even if no conversion is done because of 7bit only.
	  [ruby-dev:32591]

Tue Dec 18 15:43:59 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* common.mk (encs, ext/ripper/ripper.c): other options must come
	  before MAKEFLAGS in GNU make.

Tue Dec 18 15:19:55 2007  Eric Hodel  <drbrain@segment7.net>

	* lib/rdoc/parsers/parse_rb.rb: Don't call private fail anymore.

Tue Dec 18 15:17:26 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* common.mk (encs, ext/ripper/ripper.c): pass MAKEFLAGS.

Tue Dec 18 14:45:25 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* parse.y (op_tbl): remove duplication to avoid symbol aliases.

Tue Dec 18 14:39:05 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* string.c (str_nth): need not to raise out-of-range exception.

	* test/ruby/test_m17n.rb (TestM17N::test_str_aref_len): removed
	  debug print.

Tue Dec 18 14:05:23 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* enc/depend: get rid of target expanded as empty for nmake.

Tue Dec 18 07:56:57 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* proc.c (rb_obj_public_method): Object#public_method to retrieve
	  public method object.

	* proc.c (rb_mod_public_instance_method): Module#public_instance_method 
	  to retrieve public instance method from class / module.
	
	* proc.c (mnew): visibility check added.

	* eval_error.ci (rb_print_undef): add rb_ prefix.

	* eval_error.ci (rb_print_undef): add visibility in the error
	  message. 

Tue Dec 18 05:54:26 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* lib/Env.rb, lib/base64.rb, lib/importenv.rb, lib/eregex.rb: removed.

	* lib/ping.rb, lib/readbytes.rb: removed

Tue Dec 18 02:30:56 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* configure.in (BUILTIN_ENCS): removed.

	* common.mk (enc.mk): pass BUILTIN_ENCS from command line.

	* enc/depend: ditto.

	* enc/make_encmake.rb: ditto.

Tue Dec 18 01:46:48 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* sprintf.c (rb_str_format): need to clear output buffer to avoid
	  broken encoding compatibility check.

Tue Dec 18 01:40:20 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* lib/mkmf.rb (depend_rules): inserts ruby to only headers.

Tue Dec 18 01:21:19 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* parse.y (parser_encode_length): chomp eol style modifiers.

	* parse.y (parser_magic_comment): ditto.

	* parse.y (set_file_encoding): ditto.

Tue Dec 18 01:15:44 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* common.mk (encs): added dependencies.

	* enc/Makefile.in, enc/depend, enc/make_encmake.rb: moved serb code.

	* lib/mkmf.rb (depend_rules): now takes content string, not file name.

	* win32/enc-setup.mak: overrides default target.

Tue Dec 18 00:26:12 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* re.c (rb_reg_initialize): raise error if non-Unicode fixed
	  encoding option is specified for regexp literals with \u{}
	  escapes.

	* string.c (rb_str_squeeze_bang): should squeeze multibyte
	  characters as well.

Mon Dec 17 21:41:25 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* win32/enc-setup.mak: extracts BUILTIN_ENCOBJS.

	* tool/compile_prelude.rb: needs srcdir.

Mon Dec 17 21:24:04 2007  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* common.mk (miniprelude.c): add -I$(srcdir).

Mon Dec 17 20:53:27 2007  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* ext/openssl/ossl_ssl.c (ossl_sslctx_set_ssl_version):
	  new method OpenSSL::SSL::SSLContext#ssl_version to wrap
	  SSL_CTX_set_ssl_version.

	* ext/openssl/ossl_ssl.c (ossl_ssl_get_verify_result):
	  new method OpenSSL::SSL::SSLSocket#verify_result to wrap
	  SSL_get_verrify_result.

	* ext/openssl/lib/openssl/ssl.rb (OpenSSL::SSL::SSLContext.build):
	  new method to build OpenSSL::SSL::SSLContext with Hash parameters.
	  this method provides safety default parameters than SSLContext.new.

	* ext/openssl/lib/openssl/ssl.rb (OpenSSL::SSL.verify_cetificate_identity):
	  new module function: pull out identity verification process
	  from OpenSSL::SSL::SSLSocket#post_connection_check.

Mon Dec 17 18:42:23 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* string.c (scan_once): need no encoding compatibility check.
	  it's done inside of re_reg_search().

	* string.c (rb_str_split_m): ditto.

	* re.c (rb_reg_regsub): ditto.

Mon Dec 17 17:50:30 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* string.c (rb_str_index): check if substring is broken.

	* string.c (rb_str_rindex): ditto.

	* string.c (rb_str_succ): should carry over.

Mon Dec 17 17:47:26 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* common.mk (encs): new target to compile external encodings.

	* enc/Makefile.in: became a serb template.

	* enc/make_encmake.rb: creates enc.mk from enc/Makefile.in using serb.

	* lib/mkmf.rb (relative_from): moved from ext/extmk.rb.

	* lib/mkmf.rb ($extmk): true if under to top source directory, not
	  only ext.

	* lib/mkmf.rb (depend_rules): extracted from create_makefile.

	* tool/serb.rb (serb): splitted from tool/compile_prelude.rb.

Mon Dec 17 17:32:55 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* configure.in (MAKEFILES): removed enc/Makefile.

	* configure.in (EXTERNAL_ENCOBJS, ENCSOS): removed.

	* enc/Makefile.in (BUILTIN_ENCS): includes .c suffix.

	* enc/depend: splitted from Makefile.in.

	* {bcc32,win32,wince}/setup.mak (-encs-): extracts BUILTIN_ENCOBJS.

Mon Dec 17 17:07:53 2007  Tanaka Akira  <akr@fsij.org>

	* string.c (rb_enc_str_asciionly_p): use rb_enc_str_coderange.

Mon Dec 17 16:39:25 2007  Tanaka Akira  <akr@fsij.org>

	* string.c (rb_enc_str_coderange): set ENC_CODERANGE_BROKEN using
	  rb_enc_precise_mbclen.
	  (rb_str_valid_encoding_p): just check coderange is
	  ENC_CODERANGE_BROKEN or not.

Mon Dec 17 16:04:16 2007  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* ext/openssl/lib/openssl/buffering.rb (Buffering#gets): added second
	  optional argument to specify maximum length limit.

Mon Dec 17 16:02:30 2007  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* lib/webrick/httprequest.rb, lib/webrick/cgi.rb: Request-Line or
	  header fields shold be read with maximum length. [ruby-talk:231745]

Mon Dec 17 14:03:39 2007  Tanaka Akira  <akr@fsij.org>

	* include/ruby/encoding.h (ENC_CODERANGE_VALID): rename from
	  ENC_CODERANGE_8BIT.

	* string.c (rb_enc_str_coderange): follow the renaming.

Mon Dec 17 13:56:53 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* string.c (tr_find): wrong condition fixed.

	* sprintf.c (rb_str_format): check encoding based on result, not
	  the format string.

	* string.c (rb_str_upto): add encoding check.

Mon Dec 17 12:21:25 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* Makefile.in (RUNRUBY): added RUNRUBYOPT.

Mon Dec 17 11:38:59 2007  Tanaka Akira  <akr@fsij.org>

	* thread_win32.ci (native_thread_create): initialize
	  th->machine_stack_maxsize as rb_gc_stack_maxsize.

Sun Dec 16 17:07:35 2007  Martin Duerst  <duerst@it.aoyama.ac.jp>

	* transcode.c (transcode_loop): removed special case (-1)
	  for undefined conversions.

	* transcode_data_iso_8859.c: Changed from character constants
	  ('\xC2') to integer contants (0xC2) for shorter files and
	  better readability; eliminated duplicated tables; changed
	  from -1 offset to actual UNDEF entry (not yet distinguishing
	  UNDEF and ILLEGAL correctly).

	* test/ruby/test_transcode.rb: added a test for UNDEF conversion.

Sun Dec 16 14:51:59 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* configure.in (MAKEFILES): should be enc/Makefile, not GNUmakefile.
	  [ruby-dev:32609]

	* configure.in (BUILTIN_ENCS): removed escapes for OpenBSD.

Sat Dec 15 23:58:46 2007  Tanaka Akira  <akr@fsij.org>

	* test/openssl/test_pair.rb (SSLPair#ssl_pair): join the thread, even
	  on an error.

Sat Dec 15 23:50:31 2007  Tanaka Akira  <akr@fsij.org>

	* test/xmlrpc/webrick_testing.rb: join webrick server thread.

Sat Dec 15 22:27:39 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* configure.in (BUILTIN_ENCS): splitted command line instead of
	  semicolons for Solaris.

Sat Dec 15 21:38:24 2007  Tanaka Akira  <akr@fsij.org>

	* lib/timeout.rb: join the background thread to make sure it is dead.

Sat Dec 15 20:20:48 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* configure.in (enc/Makefile): add external encoding objects list.

	* common.mk (BUILTIN_ENCOBJS): renamed from ENCOBJS.

	* configure.in (BUILTIN_ENCS): [] needs to be enclosed because of m4.

	* Makefile.in (BUILTIN_ENCOBJS): substitued by autoconf.

	* enc/Makefile.in: new file to compile external encoding sources.

	* encoding.c (rb_enc_find_index): auto-load external encoding objects
	  as "ext/ENCODING_NAME".  [ruby-dev:32606]

Sat Dec 15 13:04:30 2007  Tanaka Akira  <akr@fsij.org>

	* vm_core.h (rb_thread_t): new member machine_stack_maxsize and
	  machine_register_stack_maxsize.

	* gc.c (rb_gc_stack_maxsize): new global variable for the thread size
	  of the main thread.
	  (STACK_LEVEL_MAX): use machine_stack_maxsize of current thread.
	  (ruby_stack_check): check IA64 register stack.
	  (ruby_set_stack_size): set rb_gc_stack_maxsize.
	  (Init_stack): set rb_gc_stack_maxsize.

	* thread_pthread.ci (native_thread_create): initialize
	  th->machine_stack_maxsize and th->machine_register_stack_maxsize.

	* vm.c (Init_BareVM): initialize th->machine_stack_maxsize and
	  th->machine_register_stack_maxsize.

	* thread_win32.ci (native_thread_create): initialize
	  th->machine_stack_maxsize.  not tested.  just a guess at all.

	[ruby-dev:32604]

Sat Dec 15 12:58:00 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* encoding.c (rb_enc_register, rb_enc_replicate, rb_enc_alias): check
	  if already registered.

Sat Dec 15 01:57:06 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* lib/rdoc/options.rb (Options::parse): do not access $KCODE any
	  longer.  [ruby-core:14079]

	* lib/irb/init.rb (IRB::IRB.parse_opts): ditto.

	* lib/cgi.rb (CGI::CGI): ditto.

Fri Dec 14 18:18:31 2007  Tanaka Akira  <akr@fsij.org>

	* thread_pthread.ci (native_thread_create): twice the stack size.
	  512KB is not enough to complete test-all on Debian GNU/Linux on
	  IA64.
	  
Fri Dec 14 16:10:50 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* io.c (rb_f_p): RDoc update.  a patch from murphy <murphy AT rubychan.de>.
	  [ruby-core:14010]

Fri Dec 14 16:06:18 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* string.c (rb_str_cmp): encoding aware comparison.

	* string.c (rb_str_casecmp): ditto.

Fri Dec 14 15:25:30 2007  Martin Duerst  <duerst@it.aoyama.ac.jp>

	* transcode.c (encoding_equal): new function.

	* transcode.c (str_transcode, transcode_dispatch): added two-step
	  conversion logic via UTF-8.

	* trancode.c: some minor formatting fixes

	* transcode_data.h, transcode_data_iso_8859.c: Shortened
	  extremely frequently used macros to shorten file length.

	* test/ruby/test_transcode.rb: Fixed name of test class;
	  added setup method to ensure all necessary encodings exist;
	  split tests into more test methods; added tests; fixed ordering
	  of arguments in assert_equal to have expected result first.

Fri Dec 14 13:47:54 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* common.mk (ruby.imp): fix for circular dependency.  a patch from
	  Yutaka Kanemoto <kinpoco AT gmail.com> in [ruby-dev:32590].

	* regint.h, st.c, ext/json/ext/generator/generator.c: suppress
	  warnings on AIX.

Fri Dec 14 12:36:35 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* configure.in (RUBY_CHECK_VARTYPE): check if a variable is defined
	  and its type.

	* configure.in (timezone, altzone): check for recent cygwin.

	* missing/strftime.c (strftime): fix for timezone.  [ruby-dev:32536]

	* lib/mkmf.rb (try_var): should fail for functions.

	* ext/readline/extconf.rb: should use have_func for functions instead
	  of have_var.

Fri Dec 14 10:25:56 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* lib/e2mmap.rb (Exception2MessageMapper::E2MM.Raise): $! no
	  longer modifiable in 1.9. 

Fri Dec 14 08:17:24 2007  Tanaka Akira  <akr@fsij.org>

	* eval.c (rb_protect): restore root_jmpbuf even if proc exits by
	  break such as dbm.delete_if { break }.

Fri Dec 14 02:55:41 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* string.c (str_nth): direct jump if string is 7bit only.  great
	  performance boost for worst case.

	* string.c (str_strlen): direct size if string is 7bit only.

Fri Dec 14 02:29:32 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* encoding.c (rb_enc_compatible): 1st argument (typically the
	  receiver) would have higher priority in encoding detection.

Fri Dec 14 02:05:42 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* io.c (rb_io_synchronized): should check if initialized.
	  [ruby-dev:32585]

Fri Dec 14 00:54:40 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* re.c (rb_reg_initialize): embedded string may override encoding
	  of the regular expression.

	* re.c (rb_reg_initialize): fix encoding of regular expression if
	  embedded string has its own encoding specified.

Thu Dec 13 22:16:46 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* encoding.c (rb_enc_compatible): encoding should never fall back
	  to ASCII-8BIT unless both encodings are ASCII-8BIT.

Thu Dec 13 20:31:28 2007  Tanaka Akira  <akr@fsij.org>

	* string.c (rb_str_shared_replace): make str noembed after free.

Thu Dec 13 20:09:09 2007  Tanaka Akira  <akr@fsij.org>

	* eval.c (rb_protect): restore root_jmpbuf to avoid SEGV by
	  'IO.pipe; [].each.next' with gcc version 3.3.5 (Debian 1:3.3.5-13)
	  on IA64.

Thu Dec 13 17:51:54 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* string.c (rb_str_split_m): need not to check encoding if regexp
	  is empty.

	* string.c (rb_str_justify): associate encoding of original to the
	  result. 

	* string.c (rb_str_chomp_bang): need to check encoding of record
	  separator.

	* string.c (str_gsub): should copy encoding to the result.

	* sprintf.c (rb_str_format): ditto.

	* string.c (rb_str_succ): should not enter infinite loop for
	  non-ASCII, non-alphanumeric character at the bottom.

Thu Dec 13 17:03:29 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* encoding.c (rb_enc_compatible): should swap encoding indexes too.

Thu Dec 13 16:41:37 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* encoding.c (rb_enc_compatible): should not judge compatibility
	  based on rb_enc_asciicompat().

Thu Dec 13 13:09:03 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* include/ruby/io.h (MakeOpenFile): fptr->enc should be
	  intialized to zero.  [ruby-dev:32569]

Thu Dec 13 08:56:01 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* io.c (rb_io_getc): use default external encoding if fptr->enc is
	  not set.  [ruby-dev:32565]

	* lib/rubygems/package.rb (Gem::TarReader::Entry::rewind): typo fixed.
	  [ruby-dev:32565]

Thu Dec 13 08:24:16 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* io.c (read_all): should associate default external encoding.

	* io.c (io_read): should NOT associate default external encoding.

Wed Dec 12 23:22:58 2007  Tanaka Akira  <akr@fsij.org>

	* re.c, regerror.c, string.c, parse.y, ruby.c, file.c:
	  use capital letter for \xHH notation.  [ruby-dev:32511]

Wed Dec 12 22:21:34 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* io.c (rb_io_mode_enc): allow specifying external encoding in
	  open mode, e.g. open(path, "r:utf-8").

Wed Dec 12 21:26:03 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval_method.ci (rb_alias): no need to skip aliasing when new
	  equals to old.  [ruby-core:13990]

Wed Dec 12 16:34:53 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* io.c (rb_io_check_readable): set default external encoding to
	  STDIN.

	* io.c (io_enc_str): associate encoding to output string.

Wed Dec 12 12:44:39 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* parse.y (expr): 'not' and '!' should act as conditional
	  expression.   [ruby-dev:32548]

Wed Dec 12 12:11:42 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* re.c (rb_reg_regsub): should copy encoding.

	* string.c (rb_str_sub_bang, str_gsub): should check and copy encoding
	  to be replaced.

Tue Dec 11 23:04:17 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* pack.c (pack_pack): RDoc update.  a patch from Gary Wright
	  <radar2002 AT gmail.com>.  [ruby-core:13998]

	* pack.c (pack_unpack): ditto.

Tue Dec 11 16:37:47 2007  Tanaka Akira  <akr@fsij.org>

	* encoding.c (rb_enc_ascget): renamed from rb_enc_get_ascii.

	* include/ruby/encoding.h: follow the renaming.

	* re.c: ditto.

Tue Dec 11 16:19:26 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* Makefile.in, */Makefile.sub (CP, MV): added.

	* common.mk (.y.c): not discard the old target until successfully
	  created.

Tue Dec 11 15:20:39 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* object.c (Init_Object): singleton_method_{added,removed,undefined}
	  hooks should be defined for BasicObject.  [ruby-dev:32531]

	* eval.c (Init_eval): method_missing should be defined for all
	  objects; moved to BasicObject.

Tue Dec 11 14:27:50 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* transcode.c (transcode_loop): get rid of SEGV at sequence can not be
	  converted.

	* transcode.c (rb_str_transcode_bang): copy encoding.  [ruby-dev:32532]

	* test/ruby/test_transcode.rb: added tests from Martin Duerst <duerst
	  AT it.aoyama.ac.jp>.  [ruby-dev:32532]

Tue Dec 11 12:05:51 2007  Tanaka Akira  <akr@fsij.org>

	* encoding.c (rb_enc_get_ascii): add an argument to provide the
	  length of the returned character.

	* include/ruby/encoding.h (rb_enc_get_ascii): add the argument.

	* re.c (rb_reg_expr_str): modify rb_enc_get_ascii call.
	  (rb_reg_quote): ditto.
	  (rb_reg_regsub): ditto.

Tue Dec 11 09:40:21 2007  Tanaka Akira  <akr@fsij.org>

	* include/ruby/oniguruma.h (ONIGENC_CONSTRUCT_MBCLEN_NEEDMORE):
	  parenthesize an argument.

Tue Dec 11 02:23:32 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (rb_method_missing): RDoc update patch from Hugh Sasse
	  <hgs AT dmu.ac.uk>.  [ruby-core:12932]

Tue Dec 11 01:51:34 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* lib/net/http.rb (Net::HTTP::get): now supports gzip
	  content-encoding.  a patch from Hugh Sasse <hgs AT dmu.ac.uk>.
	  [ruby-core:13451]

Tue Dec 11 01:21:21 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* parse.y (shadowing_lvar_gen): no duplicate error for "_".

Mon Dec 10 22:08:47 2007  Akinori MUSHA  <knu@iDaemons.org>

	* array.c (rb_ary_slice_bang): If an invalid range is given, do
	  not raise an exception but return nil just like slice() does.

Mon Dec 10 21:47:53 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* transcode.c (str_transcode): allow non-registered encodings.
	  [ruby-dev:32520]

Mon Dec 10 21:00:30 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* array.c (rb_ary_slice_bang): should return nil if position out
	  of range.  a patch from Akinori MUSHA <knu AT iDaemons.org>.
	  [ruby-dev:32518]

Mon Dec 10 19:02:52 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* re.c (rb_reg_match): should calculate offset by converted
	  operand.  [ruby-cvs:21416]

Mon Dec 10 18:28:06 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* lib/uri/common.rb (URI::REGEXP::PATTERN): typo in REG_NAME
	  regular expression.  a patch from Ueda Satoshi
	  <s-ueda AT livedoor.jp>.  [ruby-dev:32514]

Mon Dec 10 17:46:04 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* string.c (rb_str_tmp_new): creates hidden temporary buffer.

	* transcode.c (transcoding): added a pointer to function to flush.

	* transcode.c (transcode_loop): do not use string internal.
	  [ruby-dev:32512]

	* transcode.c (str_transcode): allow Encoding objects.

	* transcode_data.h (BYTE_LOOKUP): use actual struct name.

Mon Dec 10 16:52:17 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* string.c (rb_str_insert): should not add length in bytes to index in
	  chars.

Mon Dec 10 14:33:50 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (rb_f_public_send): rename invoke_method to public_send.
	  it now invokes public method only no matter how it's called.

Mon Dec 10 14:00:43 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* transcode.c: new file to provide encoding conversion features.
	  code contributed by Martin Duerst.

Mon Dec 10 13:50:33 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* re.c (rb_reg_search): return byte offset.  [ruby-dev:32452]

	* re.c (rb_reg_match, rb_reg_match2, rb_reg_match_m): convert byte
	  offset to char index.

	* string.c (rb_str_index): return byte offset.  [ruby-dev:32472]

	* string.c (rb_str_split_m): calculate in byte offset.

Mon Dec 10 09:56:29 2007  Koichi Sasada  <ko1@atdot.net>

	* benchmark/bm_vm1_neq.rb, bm_vm1_not.rb: added.

Mon Dec 10 07:48:14 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* parse.y (parser_yylex): wrong token was generated.  [ruby-dev:32498]

	* object.c (rb_obj_not_match): wrong test.

Mon Dec 10 06:44:47 2007  Tanaka Akira  <akr@fsij.org>

	* re.c (rb_reg_expr_str): use \xHH instead of \OOO.

	* regerror.c (to_ascii): ditto.
	  (onig_snprintf_with_pattern): ditto.
	  (onig_snprintf_with_pattern): ditto.

	* string.c (rb_str_inspect): ditto.
	  (rb_str_dump): ditto.

	* parse.y (parser_yylex): ditto.

	* ruby.c (proc_options): ditto.

	* file.c (rb_f_test): ditto.

	[ruby-dev:32495]

Mon Dec 10 06:41:00 2007  Tanaka Akira  <akr@fsij.org>

	* re.c (rb_reg_names): new method Regexp#names.
	  (rb_reg_named_captures): new method Regexp#named_captures
	  (match_regexp): new method MatchData#regexp.
	  (match_names): new method MatchData#names.

	* lib/pp.rb (MatchData#pretty_print): show names of named captures.

	[ruby-dev:32493]

Mon Dec 10 01:35:06 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* parse.y (expr): redefinable not (!) operator.

	* parse.y (arg): ditto.

	* object.c (rb_obj_not): new method "!".

	* object.c (rb_obj_not_equal): new method "!=".

	* object.c (rb_obj_not_match): new method "!~".

Sun Dec  9 22:31:36 2007  Tanaka Akira  <akr@fsij.org>

	* re.c (rb_reg_s_last_match): accept named capture's name.

Sun Dec  9 15:57:53 2007  Tanaka Akira  <akr@fsij.org>

	* re.c (match_backref_number): new function for converting a backref
	  name/number to an integer.
	  (match_offset): use match_backref_number.
	  (match_begin): ditto.
	  (match_end): ditto.
	  (name_to_backref_number): raise IndexError instead of RuntimeError.
	  (match_inspect): show capture index.

Sun Dec  9 14:59:15 2007  Koichi Sasada  <ko1@atdot.net>

	* eval_intern.h (CHECK_STACK_OVERFLOW): reserve frame size.
	  [ruby-dev:32485]

Sun Dec  9 14:38:25 2007  Koichi Sasada  <ko1@atdot.net>

	* vm.c (rb_thread_mark): use rb_gc_mark_maybe() for
	  VM stack specified by mark_stack_len.  [ruby-dev:32462]

	* insnhelper.ci: clear vm stack extended by opt value.

Sun Dec  9 14:08:47 2007  Tanaka Akira  <akr@fsij.org>

	* include/ruby/ruby.h (FilePathStringValue): defined.  similar to
	  FilePathValue but no taint check.

	* file.c (rb_get_path_no_checksafe): implementation of
	  FilePathStringValue.
	  (rb_file_s_basename): use FilePathStringValue.
	  (rb_file_s_dirname): ditto.
	  (rb_file_s_extname): ditto.
	  (rb_file_s_split): ditto.
	  (rb_file_join): ditto.

	* dir.c (file_s_fnmatch): ditto.

Sun Dec  9 12:49:34 2007  Tanaka Akira  <akr@fsij.org>

	* re.c (append_utf8): check unicode range.

Sun Dec  9 12:39:01 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* lib/cgi.rb (read_multipart): exclude blanks from header values.
	  [ruby-list:44327]

Sun Dec  9 12:18:19 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* file.c (rb_get_path): use the original object if to_path method is
	  not defined.  [ruby-dev:32473]

	* io.c (rb_f_open): call to_open on non-string objects, instead of
	  to_str.  [ruby-dev:32473]

Sun Dec  9 12:12:23 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* string.c (tr_find): returns true if no characters to be removed is
	  specified.

Sun Dec  9 12:03:16 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* parse.y (parser_magic_comment): delimits with a semicolon.

Sun Dec  9 11:29:23 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* string.c (tr_trans): get rid of segfaults when has mulitbytes but
	  source sets have no mulitbytes.

Sun Dec  9 04:01:28 2007  Tanaka Akira  <akr@fsij.org>

	* encoding.c (rb_enc_mbclen): return 1 if underlying implementation
	  returns a length longer than e-p.
	  (rb_enc_precise_mbclen): return needmore if underlying
	  implementation returns a length longer than e-p.

Sat Dec  8 17:59:40 2007  Tanaka Akira  <akr@fsij.org>

	* signal.c (posix_signal): return value.

Sat Dec  8 17:22:16 2007  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* test/openssl/test_pkcs7.rb: Remove redundant module namespace.

Sat Dec  8 17:07:10 2007  Tanaka Akira  <akr@fsij.org>

	* ruby.c (proc_options): make rb_raise format as a string literal to
	  avoid warning.

Sat Dec  8 16:18:16 2007  Tanaka Akira  <akr@fsij.org>

	* re.c (rb_reg_check_preprocess): new function for validating regexp
	  fragment.

	* parse.y (regexp): invoke reg_fragment_check.
	  (reg_fragment_check): defined.
	  (reg_fragment_check_gen): defined.

Sat Dec  8 11:06:29 2007  Tanaka Akira  <akr@fsij.org>

	* encoding.c (rb_enc_mbclen): make it never fail.
	  (rb_enc_nth): don't check the return value of rb_enc_mbclen.
	  (rb_enc_strlen): ditto.
	  (rb_enc_precise_mbclen): return needmore(1) if e <= p.
	  (rb_enc_get_ascii): new function for extracting ASCII character.

	* include/ruby/encoding.h (rb_enc_get_ascii): declared.

	* include/ruby/regex.h (ismbchar): removed.

	* re.c (rb_reg_expr_str): use rb_enc_get_ascii.
	  (unescape_escaped_nonascii): use rb_enc_precise_mbclen to determine
	  the termination of escaped non-ASCII character.
	  (unescape_nonascii): use rb_enc_precise_mbclen.
	  (rb_reg_quote): use rb_enc_get_ascii.
	  (rb_reg_regsub): use rb_enc_get_ascii.

	* string.c (rb_str_reverse) don't check the return value of
	  rb_enc_mbclen.
	  (rb_str_split_m): don't call rb_enc_mbclen with e <= p.

	* parse.y (is_identchar): use ISASCII.
	  (parser_ismbchar): removed.
	  (parser_precise_mbclen): new macro.
	  (parser_isascii): new macro.
	  (parser_tokadd_mbchar): use parser_precise_mbclen to check invalid
	  character precisely.
	  (parser_tokadd_string): use parser_isascii.
	  (parser_yylex): ditto.
	  (is_special_global_name): don't call is_identchar with e <= p.
	  (rb_enc_symname_p): ditto.

	  [ruby-dev:32455]

	* ext/tk/sample/tkextlib/vu/canvSticker2.rb: remove coding cookie
	  because the encoding is not UTF-8.  [ruby-dev:32475]

Fri Dec  7 20:21:35 2007  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* ext/openssl/lib/net/ftptls.rb, ext/openssl/lib/net/telnets.rb:
	  half-finished libraries are discontinued.

Fri Dec  7 15:44:40 2007  Tanaka Akira  <akr@fsij.org>

	* lib/pp.rb: use Hash for recursion check as inspect.

Fri Dec  7 15:04:01 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* array.c (flatten): some performance improvements, based on a patch
	  from Yusuke ENDOH <mame AT tsg.ne.jp> in [ruby-core:13877].
	  [ruby-core:13851]

	* thread.c (rb_exec_recursive): use Hash instead of Array for
	  performance improvement.  [ruby-core:13898]

	* thread.c (recursive_pop): use object ID.

Thu Dec  6 19:52:50 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* parse.y (arg): typo fixed ("!" -> "|") in the ripper code.

Thu Dec  6 19:48:41 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* parse.y (arg): tUPLUS no longer works as identity operation any
	  more.  inspired by [ruby-talk:265532].

Thu Dec  6 18:22:11 2007  Tanaka Akira  <akr@fsij.org>

	* encoding.c (rb_enc_precise_mbclen): new function for mbclen with
	  validation.

	* include/ruby/encoding.h (rb_enc_precise_mbclen): declared.
	  (MBCLEN_CHARFOUND): new macro.
	  (MBCLEN_INVALID): new macro.
	  (MBCLEN_NEEDMORE): new macro.

	* include/ruby/oniguruma.h (OnigEncodingTypeST): replace mbc_enc_len
	  by precise_mbc_enc_len.
	  (ONIGENC_PRECISE_MBC_ENC_LEN): new macro.
	  (ONIGENC_CONSTRUCT_MBCLEN_CHARFOUND): new macro.
	  (ONIGENC_CONSTRUCT_MBCLEN_INVALID): new macro.
	  (ONIGENC_CONSTRUCT_MBCLEN_NEEDMORE): new macro.
	  (ONIGENC_MBCLEN_CHARFOUND): new macro.
	  (ONIGENC_MBCLEN_INVALID): new macro.
	  (ONIGENC_MBCLEN_NEEDMORE): new macro.
	  (ONIGENC_MBC_ENC_LEN): use ONIGENC_PRECISE_MBC_ENC_LEN.

	* enc/euc_jp.c: validation implemented.

	* enc/sjis.c: ditto.

	* enc/utf8.c: ditto.

	* string.c (rb_str_inspect): use rb_enc_precise_mbclen for invalid
	  encoding.
	  (rb_str_valid_encoding_p): new method String#valid_encoding?.

	* io.c (rb_io_getc): use rb_enc_precise_mbclen.

	[ruby-dev:32438]

Thu Dec  6 01:37:23 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* regparse.c (i_apply_case_fold): fix for negative character class.  a
	  patch from Yusuke ENDOH <mame AT tsg.ne.jp> in [ruby-core:13884].

Thu Dec  6 01:00:38 2007  NARUSE, Yui <naruse@ruby-lang.org>

	* ext/iconv/iconv.c (iconv_s_list): support NetBSD/Citrus iconv.

Wed Dec  5 16:18:50 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* proc.c (rb_proc_s_new): call initialize.  [ruby-core:13824]

	* proc.c (rb_proc_location): return file name and line number where
	  the proc is defined.

	* thread.c (thread_s_new): call initialize.  [ruby-core:13835]

	* thread.c (thread_initialize): split initialize method.

Wed Dec  5 15:25:55 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* parse.y (rb_intern3): fix to changing encoding to default, and
	  uncommented r13835, which is rare but not impossible.

Wed Dec  5 15:15:21 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* range.c (step_i, range_step): support non-fixnum steps.
	  [ruby-talk:282100]

Wed Dec  5 14:25:11 2007  Koichi Sasada  <ko1@atdot.net>

	* compile.c (iseq_compile_each): fix typo.

Wed Dec  5 13:41:25 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* parse.y (yycompile): get rid of tracing while parsing.
	  [ruby-dev:31351]

	* thread.c (ruby_suppress_tracing): added a new parameter, which
	  directs to call func always.

Tue Dec  4 19:56:42 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* ext/iconv/iconv.c (iconv_convert): should not set encoding unless
	  the target encoding is supported.  [ruby-dev:32451]

Tue Dec  4 17:34:17 2007  NARUSE, Yui  <naruse@ruby-lang.org>

	* ext/nkf/lib/kconv.rb (tojis, tosjis, toeuc, toutf8):
	  set encoding. [ruby-dev:32447]

Tue Dec  4 17:07:25 2007  NARUSE, Yui  <naruse@ruby-lang.org>

	* lib/json.rb, lib/json/*: moved to ext/json/lib.

Tue Dec  4 16:34:46 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* ext/iconv/iconv.c (iconv_create): achieve target encoding.

	* ext/iconv/iconv.c (iconv_convert, iconv_finish, iconv_iconv,
	  iconv_conv): set result string encoding.  [ruby-dev:32446]

	* ext/iconv/iconv.c (iconv_initialize, iconv_s_open): set encoding to
	  Iconv instance.

Tue Dec  4 14:34:35 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* ruby.c (process_options): reverted c flag.

Tue Dec  4 11:23:50 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* bignum.c (rb_cstr_to_inum): trailing spaces may exist at sqeezing
	  preceeding 0s.  [ruby-core:13873]

Mon Dec  3 11:51:53 2007  NAKAMURA Usaku  <usa@ruby-lang.org>

	* ext/Win32API/*: removed or moved to ext/dl/win32.

	* ext/dl/win32/*: new. [ruby-dev:32387]

Sun Dec  2 22:08:01 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* parse.y (parser_tokadd_mbchar): fix for ASCII chars.  [ruby-dev:32432]

	* parse.y (parser_parse_string, parser_here_document): prevent false
	  error messages.

Sun Dec  2 20:43:22 2007  Tanaka Akira  <akr@fsij.org>

	* re.c (unescape_escaped_nonascii): fix mbclen argument.

Sun Dec  2 15:47:57 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* parse.y (parser_tokadd_mbchar): check insufficient multibyte char.
	  [ruby-dev:32429]

Sun Dec  2 15:42:16 2007  Kouhei Sutou  <kou@cozmixng.org>

	* lib/rss/rss.rb, test/rss/test_version.rb: 0.2.1 -> 0.2.2.

	* lib/rss/maker/itunes.rb: fixed new_itunes_category.
	* lib/rss/maker/taxonomy.rb: new_taxo_topic -> new_topic because
	  of consistency.

	* test/rss/test_maker_itunes.rb, test/rss/test_itunes.rb: removed
	  needless UTF-8 characters.

Sun Dec  2 15:18:37 2007  Koichi Sasada  <ko1@atdot.net>

	* insnhelper.ci (vm_callee_setup_arg): fix error message.
	  [ruby-dev:32430]

Sun Dec  2 09:12:48 2007  Tanaka Akira  <akr@fsij.org>

	* parse.y (regexp): fix /#{}\xa1\xa2/e to be EUC-JP. 
	  (reg_fragment_setenc_gen): extracted from reg_compile_gen.

Sun Dec  2 01:39:51 2007  Tanaka Akira  <akr@fsij.org>

	* include/ruby/intern.h (rb_uv_to_utf8): declared.

	* re.c (rb_reg_preprocess): new function for dynamic regexp with
	  \u{} such as Regexp.new("\\u{6666}").
	  (rb_reg_prepare_re): preprocess regexp for recompiling.
	  (read_escaped_byte): new function.
	  (unescape_escaped_nonascii): new function.
	  (append_utf8): new function.
	  (unescape_unicode_list): new function.
	  (unescape_unicode_bmp): new function.
	  (unescape_nonascii): new function.
	  (rb_reg_initialize): preprocess regexp.

	* pack.c (rb_uv_to_utf8): renamed from uv_to_utf8.

	* parse.y (STR_NEW3): take func instead of has8 and hasmb.
	  (parser_str_new): use default coderange mechanism except for regexp.
	  (parser_tokadd_utf8): copy regexp source as-is.
	  (parser_read_escape): UTF-8 stuff removed.
	  (parser_tokadd_escape): has8bit and hasmb removed.
	  (parser_tokadd_string): fix 8-bit single byte character with \u.
	  (parser_parse_string): has8bit and hasmb removed.
	  (parser_here_document): has8bit and hasmb removed.
	  (parser_yylex): call parser_tokadd_utf8 instead of read_escape for
	  UTF-8 character.

Wed Dec  2 01:00:07 2007  James Edward Gray II  <jeg2@ruby-lang.org>

	* lib/xmlrpc/server.rb (XMLRPC::Server#server): Improve signal handling so
	  pressing control-c in the controlling terminal or sending SIGTERM stops
	  the XML-RPC server.

Sat Dec  1 23:04:42 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* encoding.c: rename primary_encoding -> default_external (encoding).

Sat Dec  1 19:52:57 2007  Tadayoshi Funaba  <tadf@dotrb.org>

	* lib/date.rb (Time#to_datetime): use nsec instead of usec.

	* lib/date.rb (DateTime#to_time): second minute as an argument to
	  Time::utc contains fractional part in rational; hence Time
	  object may keep resolution at most nanosecond.

Sat Dec  1 14:36:05 2007  Koichi Sasada  <ko1@atdot.net>

	* bootstraptest/test_knownbug.rb: move fixed bugs.

	* test/ruby/test_sprintf.rb: ditto.

	* test/yaml/test_yaml.rb: ditto.

Sat Dec  1 13:24:47 2007  Koichi Sasada  <ko1@atdot.net>

	* insnhelper.ci (vm_yield_with_cfunc): fix to passing argc on third
	  parameter of IFUNC.  [ruby-dev:32329]

	* enumerator.c: fix to pass exact number of argument.

	* eval.c (rb_yield_values2): added.

	* include/ruby/ruby.h: ditto.

	* bootstraptest/test_knownbug.rb: move a fixed test.

	* bootstraptest/test_block.rb: ditto.

Sat Dec  1 10:45:56 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* io.c (rb_f_open): use to_open for every non-string object.  path
	  object may use method_missing.

Sat Dec  1 09:44:32 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* insns.def (concatarray, splatarray): use to_a instead of
	  to_splat.

	* insnhelper.ci (caller_setup_args): ditto.

Sat Dec  1 03:34:32 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* parse.y (newline_node): always remove NODE_BEGIN.

Fri Nov 30 23:48:07 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* signal.c (ruby_signal): use SA_SIGINFO if available.
	  [ ruby-Patches-6418 ]

Fri Nov 30 22:52:54 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* signal.c (trap_signm): SIGVTALRM no longer used for green
	  thread.  [ruby-talk:281318]

	* signal.c (ruby_sig_finalize): do not install SIG_DFL handler if
	  previous handler is sighandler().

Fri Nov 30 21:02:15 2007  NARUSE, Yui  <naruse@ruby-lang.org>

	* lib/json.rb, lib/json/add/{core.rb, rails.rb},
	  test/json/test_json_rails.rb: additional files of JSON 1.1.2.
	  [ruby-dev:32405]

Fri Nov 30 19:33:38 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* ext/syck/rubyext.c (rb_syck_mktime): avoid segmentation fault.
	  [ruby-core:13735]

Fri Nov 30 19:05:55 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* enum.c (enum_count): precise argument number check.

	* enum.c (enum_count): return Enumerator if no block given.

Fri Nov 30 16:42:50 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* enum.c (enum_take_while): returns Enumerator if no block given.

	* enum.c (enum_drop_while): ditto.

Thu Nov 29 16:59:10 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* parse.y (stmt): remove unnecessary NODE_BEGIN.  [ruby-core:13814]

Thu Nov 29 06:45:48 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* hash.c (rb_hash_eql): recursive comparison should be based on
	  eql?  [ruby-core:13803]

Wed Nov 28 18:08:00 2007  NARUSE, Yui  <naruse@ruby-lang.org>

	* ext/json, lib/json, test/json: Update to JSON 1.1.2.
	  (RubyForge#15447)

	* math.c: fix typo.

Wed Nov 28 16:29:35 2007  Koichi Sasada  <ko1@atdot.net>

	* insnhelper.ci (vm_invoke_block): should splat args.
	  [ruby-dev:32392]

	* test/ruby/test_yield.rb: add tests for above.

Wed Nov 28 14:43:14 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* ext/extmk.rb (extract_makefile): use dldflags instead of DLDFLAGS to
	  get rid of mixing $LDFLAGS and $ARCH_FLAG.

	* lib/mkmf.rb (configuration): ditto.

	* lib/mkmf.rb (create_makefile): support for extensions which has no
	  shared object.

Wed Nov 28 02:42:10 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* bignum.c (big2str_find_n1): removed extraneous element.
	  [ruby-dev:32351], [ruby-dev:32365]

	* bignum.c (big2str_find_n1): returns necessary digits now.

	* sprintf.c (remove_sign_bits): extends sign bit first.

Tue Nov 27 15:53:43 2007  Koichi Sasada  <ko1@atdot.net>

	* compile.c (iseq_compile_each): "when *[],1" dumps core.
	  a patch from Yusuke ENDOH <mame AT tsg.ne.jp>.  [ruby-dev:32350]

	* bootstraptest/test_syntax.rb: add a test for above.

Tue Nov 27 15:40:05 2007  Koichi Sasada  <ko1@atdot.net>

	* compile.c (iseq_compile_each): "a[*b] += 1" dumps core.
	  a patch from Yusuke ENDOH <mame AT tsg.ne.jp>.  [ruby-dev:32354]

	* bootstraptest/test_syntax.rb: add a test for above.

Tue Nov 27 12:47:23 2007  Koichi Sasada  <ko1@atdot.net>

	* compile.c, insns.def: change return value of "defined?"
	  for $&, $1, ... .  If such variables are defined,
	  return "global-variable".

	* test/ruby/test_defined.rb: add tests.

	* bootstraptest/test_syntax.rb: fix a test.

Tue Nov 27 11:54:46 2007  Koichi Sasada  <ko1@atdot.net>

	* insns.def: fix typo.

Tue Nov 27 11:23:20 2007  Koichi Sasada  <ko1@atdot.net>

	* test_beginendblock.rb: add loop to wait signal.
	  [ruby-dev:32332] 

Tue Nov 27 11:14:57 2007  Tanaka Akira  <akr@fsij.org>

	* include/ruby/encoding.h, encoding.c, re.c, string.c, parse.y: 
	  rename ENC_CODERANGE_SINGLE to ENC_CODERANGE_7BIT.
	  rename ENC_CODERANGE_MULTI to ENC_CODERANGE_8BIT.
	  Because single byte 8bit character, such as Shift_JIS 1byte katakana,
	  is represented by ENC_CODERANGE_MULTI even if it is not multi byte.

Tue Nov 27 10:45:45 2007  Koichi Sasada  <ko1@atdot.net>

	* eval.c (rb_method_missing): fix stack trace.

	* bootstraptest/test_knownbug.rb: move solved tests.

	* bootstraptest/test_method.rb, test/ruby/test_regexp.rb: ditto.

Tue Nov 27 09:57:42 2007  Koichi Sasada  <ko1@atdot.net>

	* insns.def, compile.c: fix to allow dsym for alias/undef.
	  [ruby-dev:32355]

	* bootstraptest/test_method.rb: add tests for above.

Mon Nov 26 23:18:46 2007  Masatoshi SEKI  <m_seki@mva.biglobe.ne.jp>

	* lib/drb/extserv.rb (initialize, stop_service): synchronize with
	  ExtServManager.

	* test/drb/test_drb.rb (TestDRbEval): ignored.

Mon Nov 26 17:32:16 2007  Tanaka Akira  <akr@fsij.org>

	* re.c (Init_Regexp): new method Regexp#fixed_encoding?
	  [ruby-dev:32361]

Mon Nov 26 13:28:14 2007  Keiju Ishitsuka  <keiju@ruby-lang.org>

	* lib/complex.rb: be able to create Complex(0, -0.0). [ruby-list:44268]

Mon Nov 26 11:24:04 2007  Tanaka Akira  <akr@fsij.org>

	* re.c (rb_reg_fixed_encoding_p): extracted from rb_reg_prepare_re and
	  rb_reg_s_union.
	  (rb_reg_s_union): refactored.

Mon Nov 26 10:44:20 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* io.c (rb_read_internal, rb_sysopen_internal): remove C99 dependency.

Sun Nov 25 22:21:35 2007  Tanaka Akira  <akr@fsij.org>

	* include/ruby/encoding.h (rb_enc_str_asciionly_p): declared.
	  (rb_enc_str_asciicompat_p): defined.

	* re.c (rb_reg_initialize_str): use rb_enc_str_asciionly_p.
	  (rb_reg_quote): return ascii-8bit string if the argument is
	  ascii-only to generate encoding generic regexp if possible.
	  (rb_reg_s_union): fix encoding handling.  [ruby-dev:32094]

	* string.c (rb_enc_str_asciionly_p): defined.

Sun Nov 25 12:12:03 2007  Eric Hodel  <drbrain@segment7.net>

	* gem_prelude.rb: Import fast-loading gem_prelude.rb from RubyGems.

	* lib/rubygems*: Import RubyGems r1516.

Sat Nov 24 23:25:52 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* test/ruby/test_eval.rb (TestEval::test_instance_eval_cvar):
	  updated not to modify class variable of Object class.

Fri Nov 23 17:34:24 2007  Koichi Sasada  <ko1@atdot.net>

	* io.c: add rb_read_internal() as blocking function.

Fri Nov 23 17:33:39 2007  Koichi Sasada  <ko1@atdot.net>

	* vm.c: fix comment.

Fri Nov 23 17:26:11 2007  Koichi Sasada  <ko1@atdot.net>

	* bootstraptest/test_knownbug.rb: move solved tests.

	* bootstraptest/test_io.rb, test_marshal.rb, test_objectspace.rb:
	  ditto.

	* test/ruby/test_integer.rb, test_regexp.rb: ditto.

Fri Nov 23 15:59:04 2007  Tanaka Akira  <akr@fsij.org>

	* struct.c (rb_struct_alloc_noinit): new function.
	  (rb_struct_define_without_accessor): add allocator to the arguments.

	* range.c (range_alloc): re-introduced using rb_struct_alloc_noinit.

Fri Nov 23 15:27:43 2007  Tanaka Akira  <akr@fsij.org>

	* re.c (REG_CASESTATE): unused macro removed.
	  (rb_reg_prepare_re): check encoding difference.
	  (rb_reg_initialize): check 8bit byte.

	* parse.y (parser_tokadd_escape): fix has8bit.

	  [ruby-dev:32113]

Fri Nov 23 15:16:48 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* variable.c (rb_f_global_variables): variable names should not
	  duplicate.  [ruby-dev:32344]

Fri Nov 23 13:34:08 2007  Tanaka Akira  <akr@fsij.org>

	* struct.c (rb_struct_define_without_accessor): new function.

	* range.c (range_alloc): removed.
	  (Init_Range): use rb_struct_define_without_accessor.

	  based on [ruby-dev:32327].

Fri Nov 23 11:01:54 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* re.c (match_begin): should return offset by character.
	  [ruby-dev:32331]

	* re.c (match_end): ditto.

	* re.c (rb_reg_search): ditto.

Fri Nov 23 10:44:24 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* compile.c (defined_expr): defined(method(x)) dumped core.  a
	  patch from Yusuke ENDOH <mame AT tsg.ne.jp>.  [ruby-dev:32335]

Wed Nov 21 18:03:49 2007  Koichi Sasada  <ko1@atdot.net>

	* vm.c: fix to recycle thread data (VM stack).

	* thread.c: ditto.

	* benchmark/bm_vm3_thread_create_join.rb: add loop count.

Wed Nov 21 18:02:10 2007  Koichi Sasada  <ko1@atdot.net>

	* benchmark/driver.rb: add path to trunk/lib if driver runner is
	  in build directory.

Wed Nov 21 16:39:21 2007  Tanaka Akira  <akr@fsij.org>

	* test/fileutils/fileasserts.rb (assert_equal_timestamp): new assert
	  to test tv_sec only for filestamp resolution portability.
	  (assert_same_entry): use assert_same_entry for mtime comparison.

Wed Nov 21 14:55:13 2007  Koichi Sasada  <ko1@atdot.net>

	* array.c (rb_ary_permutation): add gc guard codes.

Wed Nov 21 11:16:37 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* insnhelper.ci (vm_search_normal_superclass): rename function.

	* insnhelper.ci (vm_search_superclass): ditto.

	* proc.c (struct METHOD): rename rklass -> rclass.

Wed Nov 21 03:12:50 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* process.c (rb_f_system): returns nil on execution failure.
	  [ruby-core:13715]

Wed Nov 21 01:04:12 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* object.c (nil_plus): remove unused function.  [ruby-core:13737]

Tue Nov 20 21:46:46 2007  Tanaka Akira  <akr@fsij.org>

	* time.c (time_mload): ignore invalid digits in submicro.

Tue Nov 20 20:33:32 2007  Koichi Sasada  <ko1@atdot.net>

	* include/ruby/ruby.h: rename RFloat#double_value -> float_value.

	* numeric.c, parse.y: ditto.

Tue Nov 20 19:36:21 2007  Koichi Sasada  <ko1@atdot.net>

	* gc.h, vm_core.h: decl of rb_gc_save_machine_context()
	  should be at vm_core.h.

	* include/ruby/ruby.h, intern.h: remove type rb_thread_t.

	* include/ruby/intern.h: change rb_unblock_function_t,
	  rb_unblock_function_t.

	* file.c, process.c: apply above changes.

	* thread.c, thread_pthread.ci, thread_win32.ci: ditto.

	* io.c: support blocking open (2). [ruby-core:13614]

Tue Nov 20 17:10:11 2007  Tanaka Akira  <akr@fsij.org>

	* io.c (rb_io_close_on_exec_p): new method IO#close_on_exec?.
	  (rb_io_set_close_on_exec): new method IO#close_on_exec=.
	  [ruby-dev:32323]

Tue Nov 20 16:24:31 2007  Tanaka Akira  <akr@fsij.org>

	* gc.c (gc_mark_children): obj->as.file.fptr may be 0 for T_FILE.

Tue Nov 20 15:09:00 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* parse.y (parser_read_escape): has8bit flag may be set with control
	  escape.  [ruby-core:13722]

	* parse.y (parser_prepare): set begging after BOM if exists.
	  [ruby-core:13718]

Tue Nov 20 14:55:37 2007  Eric Hodel  <drbrain@segment7.net>

	* lib/rubygems*: Update to RubyGems 0.9.5.

Tue Nov 20 13:00:44 2007  NAKAMURA Usaku  <usa@ruby-lang.org>

	* include/ruby/win32.h win32/win32.c (rb_w32_pipe_exec): use dual fd
	  instead of socketpair when mode is RDWR.

	* io.c (pipe_open): pass &write_fd to rb_w32_pipe_exec().

	* io.c (popen_redirect): define only when HAVE_FORK.

Tue Nov 20 12:12:04 2007  Tanaka Akira  <akr@fsij.org>

	* include/ruby/io.h (rb_io_t): add tied_io_for_writing member.
	  
	* io.c: use tied_io_for_writing for duplex popen.

	* gc.c: mark tied_io_for_writing.

	* common.mk: gc.o depends io.h.

	  [ruby-dev:32205]

Tue Nov 20 11:59:33 2007  Tanaka Akira  <akr@fsij.org>

	* test/drb/test_drb.rb: rename TestRubyYield to TestDRbRubyYield to
	  avoid name crash with test/ruby/test_yield.rb.
	  TestRuby18Yield is renamed to TestDRbRuby18Yield too.

Tue Nov 20 03:24:42 2007  Masatoshi SEKI  <m_seki@mva.biglobe.ne.jp>

	* lib/drb/extservm.rb: merged from ruby_1_8 branch.

	* lib/drb/acl.rb: ditto.

	* lib/drb/ssl.rb: ditto.

	* lib/drb/unix.rb: ditto.

	* lib/drb/drb.rb: ditto.

	* lib/drb/observer.rb: ditto.

	* lib/drb/invokemethod.rb: ditto.

	* test/drb/test_drbssl.rb: ditto.

	* test/drb/test_drb.rb: ditto.

	* test/drb/drbtest.rb: ditto.

	* test/drb/test_drbunix.rb: ditto.

Tue Nov 20 00:52:46 2007  Tanaka Akira  <akr@fsij.org>

	* test/fileutils/fileasserts.rb (assert_equal_time): show nsec if
	  assertion fails but time.to_s equals.
	  (assert_same_entry): use assert_equal_time.

	* test/fileutils/test_fileutils.rb (test_install): use
	  assert_equal_time.

Mon Nov 19 18:46:49 2007  Tanaka Akira  <akr@fsij.org>

	* file.c (utime_internal): fallback utimensat to utimes.

Mon Nov 19 17:51:27 2007  Tanaka Akira  <akr@fsij.org>

	* configure.in: check struct timespec, clock_gettime, utimensat,
	  struct stat.st_atim,
	  struct stat.st_atimespec,
	  struct stat.st_atimensec,
	  struct stat.st_mtim,
	  struct stat.st_mtimespec,
	  struct stat.st_mtimensec,
	  struct stat.st_ctim,
	  struct stat.st_ctimespec,
	  struct stat.st_ctimensec.

	* include/ruby/missing.h: provide struct timespec if not available.

	* time.c: support nanosecond-resolution using struct timespec.
	  (time_nsec): new method: Time#nsec and Time#tv_nsec.

	* include/ruby/intern.h: provide rb_time_nano_new.

	* file.c (utime_internal): use utimensat if available.
	  (rb_file_s_utime): refactored.
	  (rb_f_test): use stat_atime, stat_mtime, stat_ctime.
	  (rb_stat_cmp): check tv_nsec.
	  (stat_atimespec): new function.
	  (stat_atime): ditto.
	  (stat_mtimespec): ditto.
	  (stat_mtime): ditto.
	  (stat_ctimespec): ditto.
	  (stat_ctime): ditto.
	  (rb_stat_atime): use stat_atime.
	  (rb_file_s_atime): ditto.
	  (rb_file_atime): ditto.
	  (rb_stat_mtime): use stat_mtime.
	  (rb_file_s_mtime): ditto.
	  (rb_file_mtime): ditto.
	  (rb_file_ctime): use stat_ctime.
	  (rb_file_s_ctime): ditto.
	  (rb_stat_ctime): ditto.

	* variable.c (rb_copy_generic_ivar): clear clone's instance variables
	  if obj has no instance variable.

	* marshal.c (w_object): dump instance variables of generated string
	  for TYPE_USERDEF, even if original object has instance variables.

	* lib/time.rb (Time#xmlschema): use nsec instead of usec.

	[ruby-dev:32306]

Mon Nov 19 17:48:30 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* object.c (rb_class_superclass): should not raise exception for
	  BasicObject.  [ruby-Bugs-15668]

Mon Nov 19 16:04:08 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* array.c (rb_ary_permutation): gives all permutations of elements
	  if no argument given.  a patch from Yusuke ENDOH <mame AT tsg.ne.jp>.
	  [ruby-dev:32309]

Mon Nov 19 02:44:07 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* compile.c (iseq_compile_each): alias and undef accept dsyms as well
	  as literals.  [ruby-dev:32308]

Mon Nov 19 02:31:36 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* eval_method.ci (rb_add_method): no redefinition warning for undef.

Mon Nov 19 01:53:11 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* parse.y (parser_read_escape): disallow control and meta modifiers
	  for non-ASCII characters.  [ruby-core:13685]

Sun Nov 18 20:47:41 2007  Tanaka Akira  <akr@fsij.org>

	* marshal.c (mark_dump_arg): it may be called after dump_ensure.

Sun Nov 18 18:27:47 2007  Tanaka Akira  <akr@fsij.org>

	* time.c (time_minus): fix Time.at(2**60+1) - Time.at(2**60).

Sun Nov 18 17:28:49 2007  Tanaka Akira  <akr@fsij.org>

	* time.c (time_arg): show actual year in 2-3 digits year warning.
	  (time_mdump): show actual year in "year too big to marshal" error.

Sun Nov 18 14:03:44 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* eval_method.ci (rb_alias): do not call hook functions until
	  initialization finishes.  [ruby-talk:279538]

Sun Nov 18 09:09:48 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* lib/mkmf.rb (String#tr_cpp): make preprocessor identifiers.

Sun Nov 18 05:19:46 2007  Tanaka Akira  <akr@fsij.org>

	* lib/mkmf.rb (have_struct_member): define HAVE_type_member.

Sat Nov 17 23:51:29 2007  Masaki Suketa  <masaki.suketa@nifty.ne.jp>

	* ext/win32ole/win32ole.c (ole_invoke): bug fix. [ruby-talk:279100]

Sat Nov 17 23:21:15 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* parse.y (parser_yylex): should clear parser->tokp as well.
	  [ruby-dev:32250]

	* parse.y: remove NEED_ASSOC that break test_parser_events.

	* parse.y (parser_yylex): should not decrement line numbers at the
	  end of file.

	* file.c (rb_find_file_ext): search .rb files first through in the
	  loadpath.

Fri Nov 16 23:31:18 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* bignum.c (rb_big_odd_p): new method added.  a patch from Tadashi
	  Saito <shiba AT mail2.accsnet.ne.jp>.  [ruby-dev:32305]

	* bignum.c (rb_big_even_p): ditto.

Fri Nov 16 17:41:34 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* ext/iconv/iconv.c (Document-class): moved the simplest example to
	  the top.

	* ext/iconv/iconv.c (iconv_s_iconv): Document-method: needs class
	  prefix for class method.  [ruby-core:13542]

	* ext/iconv/iconv.c (iconv_iconv): also instance method needs to be
	  qualified.

Fri Nov 16 16:26:57 2007  Shugo Maeda  <shugo@ruby-lang.org>

	* include/ruby/ruby.h: added some declarations for event hooks.

	* lib/profile.rb: set VM::InstructionSequence.compile_option.

Fri Nov 16 11:16:41 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* lib/yaml/rubytypes.rb (String#is_binary_data?): use Integer#fdiv.

Fri Nov 16 03:36:01 2007  why the lucky stiff  <why@ruby-lang.org>

	* ext/syck/rubyext.c: Node#value defined twice.

	* lib/yaml/: several method redefinitions causing warnings.

Fri Nov 16 03:01:00 2007  why the lucky stiff  <why@ruby-lang.org>

	* lib/yaml/types.rb: Likewise, pass self to YAML::quick_emit.

Fri Nov 16 02:51:59 2007  why the lucky stiff  <why@ruby-lang.org>

	* lib/yaml.rb (quick_emit): use combination of object_id and hash to
	  identify repeated object references, since GC will reuse memory of
		objects during output of YAML. [ruby-Bugs-8548] [ruby-Bugs-3698]

Thu Nov 15 19:49:03 2007  NAKAMURA Usaku  <usa@ruby-lang.org>

	* ext/curses/extconf.rb: check macro if cannot find func.
	  [ruby-list:44224]

Thu Nov 15 18:04:06 2007  Tanaka Akira  <akr@fsij.org>

	* tool/compile_prelude.rb: fix TMP_RUBY_PREFIX for relative load path
	  environment.

Thu Nov 15 17:28:21 2007  Tanaka Akira  <akr@fsij.org>

	* tool/compile_prelude.rb: absolute path may not start with a slash.
	  pointed by usa.

Thu Nov 15 17:07:54 2007  Tanaka Akira  <akr@fsij.org>

	* tool/compile_prelude.rb: fix first substitution.
	  use constant for prefix.
	  pointed by Richard Kilmer.

Thu Nov 15 14:29:56 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* common.mk (prereq): added auto generated sources.  [ruby-dev:32280]

Thu Nov 15 12:31:13 2007  Tanaka Akira  <akr@fsij.org>

	* tool/compile_prelude.rb: use constant for prefix.

Thu Nov 15 12:24:39 2007  Tanaka Akira  <akr@fsij.org>

	* tool/compile_prelude.rb: use simple template system for source
	  code generation.

Thu Nov 15 12:19:14 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* lib/cgi/session.rb (CGI::Session::FileStore::restore): use
	  lockfile for exclusive locks.  a patch from <tommy AT tmtm.org>.
	  [ruby-dev:32296]

Thu Nov 15 12:14:53 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* tool/compile_prelude.rb (c_esc): need to escape closing brace.

Thu Nov 15 11:52:16 2007  Tanaka Akira  <akr@fsij.org>

	* tool/compile_prelude.rb: adjust RbConfig::CONFIG paths relative
	  to the installation path.

Thu Nov 15 11:25:20 2007  Tanaka Akira  <akr@fsij.org>

	* ruby.c (usage): fix typo on --disable-gems option.
	  pointed by Richard Kilmer.

Wed Nov 14 16:16:17 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* test/net/http/test_https_proxy.rb
	  (HTTPSProxyTest::test_https_proxy_authentication): initialize
	  local variable 't' first.  [ruby-dev:32253]

Wed Nov 14 15:39:24 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* test/socket/test_socket.rb: update not to use 1.8 assignment to
	  external local variable in the block parameters.  [ruby-dev:32251]

	* test/strscan/test_stringscanner.rb: avoid $KCODE, and use
	  String#force_encoding().  [ruby-dev:32251]

Wed Nov 14 14:04:42 2007  Tanaka Akira  <akr@fsij.org>

	* common.mk, Makefile.in: rename prelude.c to miniprelude.c.
	  rename ext_prelude.c to prelude.c

	* win32/Makefile.sub: ditto.

	* bcc32/Makefile.sub: ditto.

Wed Nov 14 07:09:48 2007  Koichi Sasada  <ko1@atdot.net>

	* blockinlining.c, compile.c, compile.h, debug.c, debug.h,
	  id.c, insnhelper.h, insns.def, thread.c, thread_pthread.ci,
	  thread_pthread.h, thread_win32.ci, thread_win32.h, vm.h,
	  vm_dump.c, vm_evalbody.ci, vm_opts.h: fix comments and
	  copyright year.

Wed Nov 14 07:07:51 2007  Koichi Sasada  <ko1@atdot.net>

	* tool/makedocs.rb, template/insnstbl.html: removed.

Wed Nov 14 02:50:43 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* common.mk (parse.c): dependency also needs vpath.

	* common.mk (node_name.inc, prelude.c): VPATH in nmake does not
	  work for targets of explicit rules.

Wed Nov 14 02:11:38 2007  Tanaka Akira  <akr@fsij.org>

	* missing/isinf.c (isinf): don't define if the macro is defined.

	* configure.in: no need to set ac_cv_func_isinf=yes on non-gcc
	  solaris.

Wed Nov 14 01:34:42 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* numeric.c (round): fallback definition.

	* numeric.c (flo_divmod, flo_round): use round() always.
	  [ruby-dev:32269]

Wed Nov 14 00:33:49 2007  Koichi Sasada  <ko1@atdot.net>

	* include/ruby/ruby.h: introduce 2 macros:
	  RFLOAT_VALUE(v), DOUBLE2NUM(dbl).
	  Rename RFloat#value -> RFloat#double_value.
	  Do not touch RFloat#double_value directly.

	* bignum.c, insns.def, marshal.c, math.c, numeric.c, object.c,
	  pack.c, parse.y, process.c, random.c, sprintf.c, string.c,
	  time.c: apply above changes.

	* ext/dl/mkcallback.rb, ext/json/ext/generator/generator.c: 
	  ditto.

Wed Nov 14 00:15:37 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* tool/ytab.sed: get rid of GNU sed feature.  a patch from Laurent
	  Sansonetti <laurent.sansonetti AT gmail.com> in [ruby-core:13470].

Tue Nov 13 21:41:39 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* common.mk (parse.c), ext/ripper/depend (ripper.c): process after
	  bison with sed.  [ruby-dev:32204]

	* ruby.c (proc_options): use yydebug in cmdline_options.

	* ruby.c (process_options): set yydebug flag of parser.

	* parse.y (yydebug): moved into struct parser_params.

	* parse.y (rb_parser_get_yydebug, rb_parser_set_yydebug): parser
	  generic methods.

	* */Makefile.sub (parse.c): moved to common.mk.

	* tool/ytab.sed: comment out yydebug definition, and substitute
	  yyerror with parser_yyerror.

Tue Nov 13 16:33:07 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* numeric.c (flodivmod): work around for infinity.

	* numeric.c (flo_divmod): work around for platforms have no round().
	  [ruby-dev:32247]

Tue Nov 13 15:26:33 2007  Tanaka Akira  <akr@fsij.org>

	* lex.c.blt: moved from lex.c.

	* lex.c.src: copied from keywords.  This is the source of lex.c.blt.

	* Makefile.in (lex.c): use lex.c.blt if keywords is same as lex.c.src.

	* win32/Makefile.sub (lex.c): re-introduce copy rule.

	* bcc32/Makefile.sub (lex.c): ditto.

	* wince/Makefile.sub (lex.c): ditto.

Tue Nov 13 15:21:52 2007  Koichi Sasada  <ko1@atdot.net>

	* compile.c (iseq_specialized_instruction): check argc.

Tue Nov 13 14:44:32 2007  why the lucky stiff  <why@ruby-lang.org>

	* test/yaml/test_yaml.rb: fixed the failing YAML Struct test
	  at ko1's request.

Tue Nov 13 02:57:04 2007  URABE Shyouhei  <shyouhei@ice.uec.ac.jp>

	* numeric.c (flo_divmod): round to the nearest integer.
	  [ ruby-Bugs-14540 ]

Tue Nov 13 00:36:16 2007  Shugo Maeda  <shugo@ruby-lang.org>

	* test/ruby/test_settracefunc.rb: fixed tests for set_trace_func.

Mon Nov 12 19:47:29 2007  NAKAMURA Usaku  <usa@ruby-lang.org>

	* thread.c (call_trace_proc): should return value.

Mon Nov 12 19:45:18 2007  NAKAMURA Usaku  <usa@ruby-lang.org>

	* {bcc,win}32/Makefile.sub (miniruby): use $(COMMONOBJS) and $(DMYEXT)
	  instead of $(LIBRUBY_A).

Mon Nov 12 18:32:53 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* {bcc,win}32/Makefile.sub (MINIOBJS): added prelude.$(OBJEXT).

Mon Nov 12 17:13:23 2007  Tanaka Akira  <akr@fsij.org>

	* Makefile.in, common.mk: add prelude.o to MINIOBJS.

Mon Nov 12 16:52:29 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* lib/mkmf.rb (create_makefile): rdoc about srcprefix.  a patch from
	  Daniel Berger <djberg96 AT gmail.com> in [ruby-core:13378].

Mon Nov 12 16:48:09 2007  Tanaka Akira  <akr@fsij.org>

	* Makefile.in, common.mk: add ext_prelude.o to OBJS.

Mon Nov 12 13:57:39 2007  Tanaka Akira  <akr@fsij.org>

	* configure.in (MINIDLNOBJS): removed.
	  (MINIOBJS): set to dln.o if dmydln.o is not used.

	* Makefile.in (miniruby): use MINIOBJS instead of MINIDLNOBJS.

Mon Nov 12 13:53:06 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* misc/ruby-mode.el (ruby-parse-partial): handle stringified
	  symbols properly using ruby-forward-string.

Mon Nov 12 12:17:59 2007  Tanaka Akira  <akr@fsij.org>

	* configure.in (MINIDLNOBJS): defined.

	* Makefile.in (miniruby): use MINIDLNOBJS and COMMONOBJS instead of
	  MINIOBJS and OBJS to avoid linking both dmydln.o and dln.o.

Sun Nov 11 20:32:45 2007  Tanaka Akira  <akr@fsij.org>

	* {win32,wince,bcc32}/Makefile.sub: delete lex.c rule.

Sun Nov 11 19:40:52 2007  Tanaka Akira  <akr@fsij.org>

	* Makefile.in (lex.c): simplified.

Sun Nov 11 18:31:48 2007  Tanaka Akira  <akr@fsij.org>

	* Makefile.in (lex.c): touch lex.c if gperf failed but lex.c exists.
	  Although this may cause non-updated lex.c,
	  svn co may generate keywords newer than lex.c especially on
	  a file system which can record fractional mtime such as XFS.

Sun Nov 11 17:32:46 2007  Shugo Maeda  <shugo@ruby-lang.org>

	* insnhelper.ci (vm_call_method): pass mn->nd_clss to
	  vm_call_cfunc() instead of klass.

	* vm.c (rb_thread_method_id_and_klass): traverse parent_iseq.
	
	* thread.c (call_trace_proc): use rb_thread_method_id_and_klass().

Sun Nov 11 16:54:25 2007  Tanaka Akira  <akr@fsij.org>

	* lex.c: renamed from lex.c.blt.

	* Makefile.in (lex.c): use find command to check mtime.

Sun Nov 11 05:34:13 2007  Eric Hodel  <drbrain@segment7.net>

	* bin/gem: Add forgotten gem command.

Sat Nov 10 23:50:31 2007  Tanaka Akira  <akr@fsij.org>

	* string.c (tr_trans): cast to unsigned char after dereference
	  a pointer to a char to avoid SEGV with "\377".tr("a", "b").
	  on FreeBSD/amd64.

Sat Nov 10 23:08:53 2007  Tanaka Akira  <akr@fsij.org>

	* configure.in, common.mk, Makefile.in: don't generate
	  libminiruby-static.a.

Sat Nov 10 19:46:54 2007  Tanaka Akira  <akr@fsij.org>

	* configure.in, common.mk, Makefile.in: generate libminiruby-static.a 
	  which contains prelude.o for miniruby.

Sat Nov 10 18:10:07 2007  Tanaka Akira  <akr@fsij.org>

	* gem_prelude.rb: new file for gem libraries.  currently empty.

	* common.mk: generate ext_prelude.c by prelude.rb and gem_prelude.rb.
	  ruby (not miniruby) is linked with ext_prelude.o instead of
	  prelude.o. 

	* inits.c (rb_call_inits): don't call Init_prelude.

	* ruby.c: support --disable-gems option.
	  (ruby_init_gems): new function to define Gem::Enable and
	  invoke Init_prelude.
	  (process_options): call ruby_init_gems just after
	  ruby_init_loadpath.

	* tool/compile_prelude.rb: support multiple files.

Sat Nov 10 17:27:55 2007  Shugo Maeda  <shugo@ruby-lang.org>

	* thread.c (call_trace_proc): don't call ID2SYM() for ID_ALLOCATOR
	  to avoid SEGV.

Sat Nov 10 16:37:07 2007  Eric Hodel  <drbrain@segment7.net>

	* lib/rubygems: Import RubyGems revision 1493.

	* lib/rubygems.rb: ditto.

	* lib/ubygems.rb: ditto.

	* lib/rbconfig/datadir.rb: ditto.

	* test/rubygems: ditto.

Sat Nov 10 16:34:21 2007  Eric Hodel  <drbrain@segment7.net>

	* lib/soap/property.rb: Don't override Enumerable#inject for 1.9.

Sat Nov 10 14:43:30 2007  David Flanagan  <davidflanagan@ruby-lang.org>

	* parse.y: use ASCII encoding for string literals that are
		7-bit clean, fixing regression from my previous patch

Sat Nov 10 13:18:54 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* {bcc32,win32}/Makefile.sub: vendor_ruby support.

Fri Nov  9 23:33:16 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* parse.y (parser_nextc): added single line read forward buffer.

	* parse.y (parser_yylex): adjust line number for fluent interface.

Fri Nov  9 22:04:21 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* vm.h (FRAME_MAGIC_MASK_BITS): bits of FRAME_MAGIC_MASK.

	* insnhelper.ci (vm_call_cfunc, vm_cfunc_flags): use shift operations.

Fri Nov  9 21:46:28 2007  Koichi Sasada  <ko1@atdot.net>

	* eval.c (eval): should be volatile value for GC.

Fri Nov  9 17:48:22 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* ruby.c (locale_encoding): guesstimate encoding from environment
	  variables.  [ruby-core:13315]

	* ruby.c (process_options): set primary encoding from environment.

Fri Nov  9 16:51:42 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* io.c (rb_io_each_byte): should update rbuf_off and rbuf_len for
	  each iteration.  [ruby-dev:31659][ruby-dev:32192]

	* variable.c (rb_cvar_set): cvar assignment obey same rule to cvar
	  reference.  [ruby-dev:32192]

Fri Nov  9 15:52:00 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* encoding.c (enc_check_encoding, rb_set_primary_encoding): ENCODING
	  is no longer in FL_USERS flags.

Fri Nov  9 15:20:13 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* string.c (rb_str_squeeze_bang): initialize squeezing table if no
	  arguments given.

Fri Nov  9 13:57:50 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* enum.c (each_with_index_i): use rb_yield_values() for
	  compatibility with Enumerator#with_index().  a patch from Yusuke
	  ENDOH <mame AT tsg.ne.jp>.  [ruby-dev:32195]

Fri Nov  9 13:45:05 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* test/ruby/test_iterator.rb (TestIterator::IterTest::each):
	  #each_pair is now alias to #each.  [ruby-dev:32192]

	* test/ruby/test_iterator.rb (TestIterator::test_assoc_yield):
	  ditto 

Fri Nov  9 12:56:36 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* eval_load.c (loaded_feature_path): check with type of given feature.

Fri Nov  9 12:43:02 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* test/ruby/test_basicinstructions.rb: updated for new class
	  behavior.  [ruby-dev:32192]

	* encoding.c (enc_name): Encoding should not rely on ENCODING in
	  the FL_USERS flags.

	* encoding.c (rb_enc_from_encoding): do not call rb_enc_associate
	  for encoding itself.

	* encoding.c (enc_register_at): ditto.

	* marshal.c (r_ivar): do not set real instance variable for
	  encoding data associated.

Fri Nov  9 10:43:55 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* eval.c (send_internal): use self in the previous frame to check for
	  protected methods.  [ruby-core:13254]

	* insnhelper.ci (vm_call_method): send! method has gone.

Fri Nov  9 10:38:13 2007  Koichi Sasada  <ko1@atdot.net>

	* marshal.c (w_object): should be SPECIAL_CONST_P() instead of
	  IMMEDIATE_P().

Fri Nov  9 10:29:21 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* eval.c (rb_invoke_method): check if invoked in function style.
	  [ruby-core:13245]

	* insnhelper.ci (vm_call_cfunc, vm_cfunc_flags): stores and returns VM
	  calling flags.

	* vm.c (rb_vm_cfunc_funcall_p): returns if the current method is
	  invoked in function style.

Fri Nov  9 10:10:21 2007  Koichi Sasada  <ko1@atdot.net>

	* cont.c: add rb_context_t#type.

Fri Nov  9 10:05:54 2007  Koichi Sasada  <ko1@atdot.net>

	* ruby.c (set_arg0): fix breaking environ bugs.

Fri Nov  9 07:26:04 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* random.c: update MT URL.[ruby-core:13305].

Thu Nov  8 17:09:55 2007  David Flanagan  <davidflanagan@ruby-lang.org>

	* object.c: improve docs for Object.tap

	* ChangeLog: fix bogus dates on my previous entries

Thu Nov  8 15:13:56 2007 David Flanagan <davidflanagan@ruby-lang.org>

	* parse.y: fix segfault with \x escapes in regexps
	  delete unused #if 0 code regions from previous patch
	
Thu Nov  8 12:12:10 2007  NAKAMURA Usaku  <usa@ruby-lang.org>

	* parse.y (parser_read_escape): remove C99/gcc-ism.

Thu Nov  8 07:54:22 2007 David Flanagan <davidflanagan@ruby-lang.org>

	* parse.y: patch, based on Nobu's, work to support \u escapes
	           also modifications for better coderange detection

	* test/ruby/test_unicode_escapes.rb: test cases

	* test/ruby/test_mixed_unicode_escapes.rb: mixed encoding test cases
	
Thu Nov  8 07:14:37 2007 David Flanagan <davidflanagan@ruby-lang.org>

	* parse.y (rb_intern3): commented out broken code that prevented
	  correct interning of multi-byte symbols.  Without this patch
	  :x==:x is false when x is a multi-byte character. 
	
Thu Nov  8 07:04:31 2007 David Flanagan <davidflanagan@ruby-lang.org>

	* string.c (tr_setup_table, tr_trans): fix test failures
	  in test/ruby/test_string.rb
	
Wed Nov  7 15:07:51 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* enum.c (enum_each_with_index): make different arrays at each
	  iteration.  [ruby-dev:32181]

Wed Nov  7 05:17:24 2007  David Flanagan <davidflanagan@ruby-lang.org>

	* eval.c: fix typo in invoke_method documentation

Wed Nov  7 03:52:26 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* array.c (rb_ary_product): core dumped with non array arguments.
	  a patch from Yusuke ENDOH <mame AT tsg.ne.jp>.  [ruby-dev:32180]

Wed Nov  7 03:32:38 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* lib/rexml/encodings/SHIFT-JIS.rb (REXML::Encoding): place -x for
	  nkf conversion.  a patch from <moonwolf AT moonwolf.com>.
	  [ruby-dev:32183]

Wed Nov  7 02:59:49 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* array.c (rb_ary_each_index): should return meaningful value.

Tue Nov  6 16:37:47 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* eval_load.c (loaded_feature_path): need to expand relative paths.

	* eval_load.c (rb_feature_p): check if the feature is loading with
	  load path.  [ruby-dev:31932]

	* eval_load.c (load_lock): check the result of barrier waiting.

	* thread.c (rb_barrier_wait): check if owned by the current thread.

	* thread.c (rb_barrier_release): ditto.

Mon Nov  5 08:01:22 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (Init_eval): move #send to Kernel module from BasicObject.

Mon Nov  5 05:17:04 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* lib/optparse.rb (OptionParser::Switch::summarize): fix for long form
	  option with very long argument.  a patch from Kobayashi Noritada
	  <nori1 AT dolphin.c.u-tokyo.ac.jp> in [ruby-list:44179].

Mon Nov  5 01:20:33 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* parse.y (call_args): remove "parenthesize argument(s) for future
	  version" warning.  when I added this warning, I had a plan to
	  reimplement the parser that is simpler than the current one.
	  since we abandoned the plan, warning no longer required.

Mon Nov  5 01:02:56 2007  Minero Aoki  <aamine@loveruby.net>

	* lib/net/http.rb (HTTPHeader#initialize): provide default
	  User-Agent to fix 500 error on some corrupted HTTP servers.
	  [ruby-core:13135]

Mon Nov  5 00:32:32 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (rb_f_send): allow send/__send__ to call methods of all
	  visibility again.  we no longer provide __send, __send!.

	* eval.c (rb_invoke_method): new method to honor private
	  visibility.  if it's invoked in a function call style, it calls
	  private methods as well (previous 1.9 send behavior).

Mon Nov  5 00:24:24 2007  NAKAMURA Usaku  <usa@ruby-lang.org>

	* win32/Makefile.sub: vendor_ruby support.

	* configure.in (RUBY_LIB): duplicated.

Mon Nov  5 00:01:33 2007  Tanaka Akira  <akr@fsij.org>

	* re.c (rb_reg_quote): quote \v as well.

Sun Nov  4 23:51:59 2007  Tanaka Akira  <akr@fsij.org>

	* re.c (rb_reg_initialize_m): use StringValuePtr instead of
	  StringValueCStr because \0 exists when Regexp.new("\0").

Sun Nov  4 08:11:19 2007  Tanaka Akira  <akr@fsij.org>

	* gc.c (count_objects): count TOTAL.

Sun Nov  4 03:58:32 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* string.c (tr_setup_table): use C array for characters that fit
	  in a byte to gain performance.

	* string.c (rb_str_delete_bang): ditto.

	* string.c (rb_str_squeeze_bang): ditto.

	* string.c (rb_str_count): ditto.

	* string.c (tr_trans): ditto.

Sun Nov  4 00:06:40 2007  Tanaka Akira  <akr@fsij.org>

	* gc.c (count_objects): ObjectSpace.count_objects implemented.
	  [ruby-core:12301]

Sat Nov  3 22:49:37 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* hash.c (rb_hash_each_pair): make Hash#each to be alias to
	  Hash#each_pair for compatibility and clarity.

	* hash.c (env_each_pair): ditto.

Sat Nov  3 22:41:05 2007  Tanaka Akira  <akr@fsij.org>

	* configure.in: --with-vendor-hdrdir implemented.

	* lib/mkmf.rb: check --vendor argument.

	* README.EXT: explain --vendor option for extconf.rb

	* README.EXT.ja: ditto.

Sat Nov  3 20:30:48 2007  Tanaka Akira  <akr@fsij.org>

	* configure.in: --with-vendordir implemented.

	* mkconfig.rb: add config to vendorlibdir and vendorarchdir.

	* instruby.rb: make vendor library directories.

	* ruby.c: insert vendor library directories into load path.

Fri Nov  2 20:55:49 2007  Kouhei Sutou  <kou@cozmixng.org>

	* lib/rss/content.rb, lib/rss/content/, lib/rss/maker/content.rb,
	  test/rss/test_content.rb, test/rss/test_maker_content.rb,
	  test/rss/rss-testcase.rb (RSS::TestCase): supported
	  content:encoded with RSS 2.0.
	  Suggested by Sam Lown. Thanks.

Fri Nov  2 20:47:04 2007  Kouhei Sutou  <kou@cozmixng.org>

	* lib/rss/rss.rb, test/rss/test_version.rb: 0.2.0 -> 0.2.1.

Thu Nov  1 21:56:45 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* error.c (Init_Exception): make NameError to be subclass of
	  StandardError again.

	* error.c (Init_Exception): make SecurityError to be subclass of
	  Exception, since it's too important to be handled implicitly.

Thu Nov  1 14:51:39 2007 David Flanagan <davidflanagan@ruby-lang.org>
	* enum.c (take_while_i, drop_while_i) add RTEST to handle nil return
	
Thu Nov  1 02:12:50 2007  NAKAMURA Usaku  <usa@ruby-lang.org>

	* common.mk (prereq): update the path of prelude.c.

	* common.mk (prelude.c): rollback a part of r13675, because it is not
	  documented and causes build error.

Thu Nov  1 01:52:23 2007  NAKAMURA Usaku  <usa@ruby-lang.org>

	* enum.c (enum_drop): fix typo.

Thu Nov  1 01:51:01 2007  NAKAMURA Usaku  <usa@ruby-lang.org>

	* vm_core.h (ruby_current_thread): RUBY_EXTERN'ed for probeprofiler.

Thu Nov  1 00:46:30 2007  NAKAMURA Usaku  <usa@ruby-lang.org>

	* win32/configure.bat, setup.mak: now can recognize OS even if
	  the ``--target'' option of configure is omitted.

	* win32/README.win32: update the descriptions about compiler.

Wed Oct 31 03:13:41 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* enum.c (enum_take_while): separate with-block form.

	* enum.c (drop_while_i): ditto.

	* enum.c (enum_butfirst): abandon butfirst method.  reverted.

Tue Oct 30 10:03:43 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* enum.c (enum_butfirst): add a new method to iterates over
	  elements but first n.  RDoc need to be updated.

	* enumerator.c (Init_Enumerator): remove unnecessary symbol
	  initialization.

Mon Oct 29 18:42:17 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* parse.y (bvar): block-local variable can shadow outer variable.
	  [ruby-core:13036]

Mon Oct 29 17:58:16 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* string.c (rb_str_substr): performance improvement.  [ruby-dev:31806]

Mon Oct 29 17:20:13 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* encoding.c (rb_enc_replicate): new function to replicate encoding.

	* encoding.c (enc_based_encoding): Encoding#base_encoding returns
	  based encoding of replica.

Mon Oct 29 17:18:36 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* encoding.c (rb_enc_compatible): ASCII encoding is compatible with
	  ASCII-compatible encoding, even for non-string objects.

Sun Oct 28 21:50:02 2007  Tanaka Akira  <akr@fsij.org>

	* lib/open-uri.rb: :redirect option implemented to disable redirects.
	  (OpenURI::HTTPRedirect): new exception class for redirection.

Fri Oct 26 17:38:13 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* numeric.c (int_chr): take an optional encoding parameter.
	  [ruby-core:12816]

Fri Oct 26 17:14:14 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* numeric.c (fix_pow): returns 1.0 for 0**0.0.

	* numeric.c (fix_pow): returns infinity for 0**-1.  [ruby-dev:32084]

Fri Oct 26 15:00:52 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* misc/ruby-style.el (ruby-style-{case,label}-indent): adjust for
	  labels inside switch block.

Fri Oct 26 05:48:57 2007  David Flanagan <davidflanagan@ruby-lang.org>
	* array.c: raise IndexError for negative length in rb_ary_fill
	
Wed Oct 25 07:12:03 2007  James Edward Gray II  <jeg2@ruby-lang.org>

	* lib/net/telnet.rb (Net::Telnet#login): Allowing "passphrase" in
	  addition to "password" for Telnet login prompts. [ruby-Bugs-10746]

Wed Oct 25 06:34:11 2007  James Edward Gray II  <jeg2@ruby-lang.org>

	* lib/net/telnet.rb (Net::Telnet#login): Making the password prompt
	  pattern case insensitive. [ruby-Bugs-10746]

Fri Oct 26 04:21:36 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* lib/net/pop.rb (Net::POP3::do_start): type fixed.  a patch from
	  Dan Zwell <dzwell AT zwell.net> in [ruby-core:12941].

Fri Oct 26 01:48:28 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* array.c (rb_ary_assoc): check and convert inner arrays (assocs)
	  using #to_ary.

	* hash.c (rb_hash_s_create): check and convert argument hash
	  using #to_hash.

	* hash.c (rb_hash_s_create): Hash#[] now takes assocs as source of
	  hash conversion.

Thu Oct 25 16:46:05 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* parse.y (parser_yylex): dot at the head of the line denote line
	  continuation from previous one to support fluent interface.
	  [experimental]

	* misc/ruby-mode.el (ruby-calculate-indent): support fluent dot.

Thu Oct 25 14:19:33 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* io.c (rb_io_tell, rb_io_seek): check errno too.  [ruby-dev:32093]

Thu Oct 25 13:59:53 2007 David Flanagan <davidflanagan@ruby-lang.org>

	* parse.y (parser_tokspace): increment tokidx
	  fixes test failure at [test/ruby/test_stringchar.rb:72]
	
Thu Oct 25 09:49:49 2007  akira yamada  <akira@ruby-lang.org>

	* lib/uri.rb, lib/uri/ldaps.rb: added LDAPS
	  scheme. [ruby-dev:31896]

Wed Oct 25 06:23:14 2007  James Edward Gray II  <jeg2@ruby-lang.org>

	* lib/xmlrpc/parser.rb (XMLRPC::Convert::dateTime): Fixing a bug that
	  caused time zone conversion to fail for some ISO 8601 date formats.
	  [ruby-Bugs-12677]

Wed Oct 25 04:59:28 2007  James Edward Gray II  <jeg2@ruby-lang.org>

	* lib/xmlrpc/client.rb (XMLRPC::Client#do_rpc): Explicitly start
	  the HTTP connection to support keepalive requests. [ruby-Bugs-9353]

Wed Oct 25 04:46:53 2007  James Edward Gray II  <jeg2@ruby-lang.org>

	* lib/xmlrpc/client.rb (XMLRPC::Client#do_rpc): Improving the error
	  message for Content-Type check failures. [ruby-core:12163]

Wed Oct 25 03:45:08 2007  James Edward Gray II  <jeg2@ruby-lang.org>

	* lib/xmlrpc/utils.rb (XMLRPC::ParseContentType#parse_content_type):
	  Making Content-Type checks case insensitive. [ruby-Bugs-3367]

Wed Oct 24 17:09:39 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* parse.y (parser_tokspace): make space in token buffer.

	* parse.y (parser_yylex): fix encoding of single character literal.

Tue Oct 23 13:44:14 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* parse.y (call_args2): nd_head of NODE_BLOCK_PASS should be a list.
	  [ruby-core:12850]

Tue Oct 23 10:42:51 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* ruby.c (process_options): encoding set by command line option takes
	  priority over the encoding in the source, as the primary encoding.

Mon Oct 22 19:24:33 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* ruby.c (proc_options): allow space after -E (encoding) option.

Mon Oct 22 11:03:09 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* encoding.c (enc_check_encoding): returns index now.

	* encoding.c (rb_enc_compatible): check if two objects have compatible
	  encodings.

	* encoding.c (enc_compatible_p): added Encoding.compatible?.

	* include/ruby/encoding.h (rb_enc_compatible): prototype.

Sun Oct 21 18:29:17 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* encoding.c (rb_enc_default, rb_enc_primary): return pointers to
	  rb_encoding of default and primary respectively.  [ruby-core:12795]

	* encoding.c (set_primary_encoding): removed primary_encoding setter.

Sat Oct 20 13:17:01 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* enum.c (enum_cycle): hide temporary array from ObjectSpace.
	  [ruby-core:12762]

Sat Oct 20 11:49:20 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* file.c (rb_get_path): returns frozen string.

	* file.c (rb_file_s_chown, rb_file_s_lchown): use uid_t and gid_t.

Fri Oct 19 20:08:14 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* encoding.c (rb_id_encoding): returns ID "encoding".

	* marshal.c (w_encoding): dump encoding name.

	* marshal.c (r_ivar): load encoding.

Fri Oct 19 16:41:00 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* parse.y (parser_regx_options, reg_compile_gen): relaxened encoding
	  matching rule.

	* re.c (rb_reg_initialize): always set encoding of Regexp.

	* re.c (rb_reg_initialize_str): fix encoding for non 7bit-clean
	  strings.

	* re.c (rb_reg_initialize_m): use ascii encoding for 'n' option.

Fri Oct 19 11:09:56 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* ruby.c (process_options): set primary encoding from the parser
	  always.  [ruby-core:12758]

	* ruby.c (load_file): should not discard the parser parameter.

Fri Oct 19 10:55:42 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* range.c (range_last): removed unused variables.

Thu Oct 18 17:08:57 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* enum.c (enum_find_index): update RDoc.  a patch from David Flanagan
	  <david AT davidflanagan.com> in [ruby-core:12710].

	* enum.c (enum_take, enum_drop): ditto.

	* enum.c (enum_cycle): should not cause infinite loop for empty
	  arrays.  [ruby-core:12710]

	* range.c (Init_Range): typo fixed.

Thu Oct 18 16:39:34 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* lib/rexml/source.rb (REXML::SourceFactory::SourceFactory): more
	  duck typed.  better performance on JRuby.
	  http://headius.blogspot.com/2007/10/another-performance-discovery-rexml.html

Thu Oct 18 09:33:25 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* range.c (range_first): takes first n element if argument is
	  given.  [ruby-core:12697]

	* range.c (range_last): returns last n elements if argument is
	  given.

	* array.c (rb_ary_subseq, rb_ary_last): export.

Wed Oct 17 17:39:31 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* ruby.c (proc_options): fixed reversed condition.  [ruby-core:12722]

Wed Oct 17 13:54:28 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* re.c (rb_reg_s_union): the last check was not complete.

Wed Oct 17 11:30:55 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* encoding.c (rb_enc_from_encoding, rb_enc_register): associate index
	  to self.

	* encoding.c (enc_capable): Encoding objects are encoding capable.

	* re.c (rb_reg_s_union): check if encoding matching by exact encoding
	  objects.

Wed Oct 17 06:18:06 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* encoding.c (rb_enc_alias, rb_enc_find_index): changed
	  enc_table_alias to a name-to-index hash.

	* encoding.c (rb_enc_init): use upper case names for aliases to use as
	  constant names.

	* encoding.c (enc_find): allow symbols.

	* encoding.c (Init_Encoding): define encoding constants.

	* st.c (strcasehash): fix wrong code range condition.

Wed Oct 17 05:07:18 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* encoding.c (rb_primary_encoding): added Encoding.primary_encoding.

	* parse.y (rb_parser_encoding): added.

	* ruby.c (proc_options): added -E and --encoding options.

	* ruby.c (process_options): set primary encoding from command line
	  option if set, or source encoding.

	* include/ruby/encoding.h (rb_enc_from_encoding,
	  rb_get_primary_encoding, rb_set_primary_encoding): prototypes.

	* include/ruby/node.h (rb_parser_encoding): prototype.

Wed Oct 17 03:37:07 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* re.c (rb_reg_desc): set encoding.

	* re.c (rb_reg_s_union): check encodings.

	* enc/utf8.c (utf8_code_to_mbclen): 0xfe and 0xff are valid Unicode to
	  be encoded to 2bytes in UTF-8.  [ruby-core:12700]

Wed Oct 17 02:50:49 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* string.c (rb_str_ord): use encoding.

Wed Oct 17 01:57:06 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* re.c (rb_reg_initialize_m): allow binary encoding option.
	  [ruby-dev:32083]

Tue Oct 16 19:48:01 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* re.c (rb_reg_s_union): check for encoding of original object.

Tue Oct 16 18:28:51 2007  Tanaka Akira  <akr@fsij.org>

	* debug.c: use enum for constants for gdb if possible.

Tue Oct 16 18:20:10 2007  Tanaka Akira  <akr@fsij.org>

	* ruby.c, debug.c: move debug enum and constants to debug.c.

Tue Oct 16 18:16:15 2007  Tanaka Akira  <akr@fsij.org>

	* ruby.c (RUBY_ENCODING_SHIFT): added as enum.

	* .gdbinit (rp): show encoding and coderange for strings.

Tue Oct 16 14:48:38 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* parse.y (parser_regx_options): check if regexp encoding option
	  matches to current encoding.

	* re.c (char_to_option, rb_char_to_option_kcode): 'n' is not kcode
	  option now.

	* re.c (rb_reg_to_s, rb_reg_error_desc): copy encoding rather than
	  append as an option.

	* re.c (make_regexp, rb_reg_prepare_re): use encoding of Regexp and
	  String instead of kcode.

	* re.c (rb_reg_initialize): set fixed option if none is set.

	* re.c (rb_reg_regcomp): ditto.

	* re.c (rb_reg_equal): check if encodings are equal.

	* re.c (rb_reg_initialize_m): encoding option is obsolete.

	* re.c (rb_kcode, rb_get_kcode, rb_set_kcode): removed.

	* re.c (Init_Regexp): removed Regexp#kcode method.

	* ruby.c (proc_options): allow long encoding name.

Tue Oct 16 14:03:09 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* re.c (rb_reg_s_union): encoding of all regexp objects should
	  match.  [ruby-dev:32076]

Tue Oct 16 13:49:41 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* encoding.c (enc_to_s): rename function.

Tue Oct 16 13:25:46 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* string.c (rb_str_new4): should copy encoding.  a patch from NARUSE,
	  Yui <naruse AT airemix.com>.  [ruby-dev:32076]

Tue Oct 16 01:31:23 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* enum.c (enum_inject): RDoc update.  a patch from David Flanagan
	  <david AT davidflanagan.com> in [ruby-core:12710].

Tue Oct 16 01:25:40 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* encoding.c (Init_Encoding): define #to_s to show encoding name
	  in to_s representation as well as #inspect.

Mon Oct 15 13:24:08 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* numeric.c (flo_round): should be number but not rounding factor.
	  [ruby-dev:32060]

Mon Oct 15 11:45:12 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* marshal.c (r_bytes0): refined length check.  [ruby-dev:32059]

Mon Oct 15 10:24:19 2007  Tanaka Akira  <akr@fsij.org>

	* process.c (pst_to_s): returns a string such as "pid 10220 exit 1"
	  instead of "256".  [ruby-dev:32053]
	  (pst_inspect): change format
	  "#<Process::Status: pid=10220,exited(1)>" to
	  "#<Process::Status: pid 10220 exit 1>".

Mon Oct 15 09:58:07 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* marshal.c (r_bytes0): check if source has enough data.
	  [ruby-dev:32054]

Mon Oct 15 01:15:09 2007  Tanaka Akira  <akr@fsij.org>

	* ext/socket/socket.c (s_accept_nonblock): make accepted fd
	  nonblocking.  [ruby-talk:274079]

Sun Oct 14 17:31:48 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* encoding.c (rb_obj_encoding): rdoc update.  a patch from David
	  Flanagan <david AT davidflanagan.com>.  [ruby-core:12664]

	* encoding.c (enc_dump, enc_load): marshaling feature.  a patch from
	  David Flanagan.  [ruby-core:12665]

	* encoding.c (Init_Encoding): undefine allocator of Encoding.
	  [ruby-core:12665], [ruby-core:12666]

	* test/ruby/test_encoding.rb: tests for Encoding from David Flanagan
	  [ruby-core:12665]

Sun Oct 14 11:09:09 2007  Tanaka Akira  <akr@fsij.org>

	* lib/pp.rb (PP::PPMethods#pp_hash): don't sort keys because hash is
	  ordered.
	  (ENV.pretty_print): call pp_hash with sorted hash.

Sun Oct 14 04:08:34 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* configure.in (AC_SYS_LARGEFILE): keep results also in command
	  options, to vail out of mismatch.  [ruby-list:44114]

	* mkconfig.rb, lib/mkmf.rb (configuration): add DEFS.

Sun Oct 14 03:55:52 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* win32/mkexports.rb: deal with __fastcall name decorations.
	  [ruby-list:44111]

Sun Oct 14 02:20:40 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* encoding.c (rb_cEncoding): new Encoding class.

	* encoding.c (rb_to_encoding, rb_to_encoding_index): helper functions.

	* encoding.c (rb_obj_encoding): return Encoding object now.

	* gc.c (garbage_collect): mark Encoding objects.

	* inits.c (rb_call_inits): call Init_Encoding.

	* string.c (rb_str_force_encoding): accept Encoding object as well as
	  encoding name.

	* include/ruby/encoding.h (rb_to_encoding_index, rb_to_encoding):
	  prototypes.

Sun Oct 14 01:03:30 2007  Tanaka Akira  <akr@fsij.org>

	* lib/open-uri.rb (OpenURI.open_http): fix :ssl_ca_cert option.

Sat Oct 13 21:23:21 2007  Masaki Suketa  <masaki.suketa@nifty.ne.jp>

	* ext/win32ole/win32ole.c (foletype_s_ole_classes, 
	  foletype_s_typelibs): refactoring.
	
	* test/win32ole/test_win32ole_type.rb: add some test. 

	* ext/win32ole/win32ole.c (Init_win32ole): change method name
	  WIN32OLE_TYPELIB.ole_types from WIN32OLE_TYPELIB.ole_classes.

	* test/win32ole/test_win32ole_typelib.rb: ditto.

	* test/win32ole/test_folderitem2_invokeverb.rb: check create
	  shortcut string more strictly (This test is invoked in Japanese
	  Windows environment).

Sat Oct 13 09:11:58 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* parse.y (set_file_encoding): case-insensitive search, a patch from
	  David Flanagan <david AT davidflanagan.com> [ruby-core:12629]

Sat Oct 13 09:02:16 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* {bcc,win}32/mkexports.rb: explicit data.  [ruby-list:44108]

Sat Oct 13 00:17:49 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* lib/rexml/document.rb (REXML::Document::write): leaky
	  modification trans -> transitive.  [ruby-dev:32040]

Sat Oct 13 00:00:33 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* parse.y: encoding specifier should work if the line matches
	  /coding[:=] ?/, a la Python PEP-263, so that VIM comments like
	  "# vim: set fileencoding=<encoding name>" should be recognized.

Fri Oct 12 15:04:54 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* trunk/parse.y (magic_comments): add "encoding" as same as "coding".

	* trunk/parse.y (set_file_encoding): special file encoding handling.

	* trunk/parse.y (parser_yylex): ditto.

Fri Oct 12 12:44:11 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* array.c (rb_ary_combination): fixed memory corruption due to too
	  small memory allocation

	* array.c (rb_ary_product): accessing out of memory bounds.
	  condition fixed.

Fri Oct 12 11:22:15 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* re.c (match_values_at): make #select to be alias to #values_at
	  to adapt RDoc description.  [ruby-core:12588]  

Thu Oct 11 21:10:17 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* include/ruby/node.h (NOEX_LOCAL): remove unused local visibility.

	* class.c (ins_methods_push): ditto.

	* class.c (rb_class_local_methods): method removed.

Thu Oct 11 14:29:31 2007  NAKAMURA Usaku  <usa@ruby-lang.org>

	* */Makefile.sub (COMMON_MACROS): workaround for old SDK's bug.
	  [ruby-core:12584]

Thu Oct 11 06:35:43 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* Makefile.in, */Makefile.sub (VPATH): add enc directory.

	* common.mk (ENCOBJS): encoding objects.

	* enc: directory for encodings.

Thu Oct 11 00:04:37 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* include/ruby/oniguruma.h (OnigEncodingTypeST): add OnigEncoding
	  parameter to every function members.

	* include/ruby/oniguruma.h (OnigEncodingTypeST): add auxiliary
	  data member to provide user defined data for an encoding.

Wed Oct 10 23:32:15 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* re.c (rb_reg_s_quote): no longer takes optional second argument
	  that has never been documented.

Wed Oct 10 15:39:04 2007  Tanaka Akira  <akr@fsij.org>

	* encoding.c (rb_enc_init): don't alias iso-8859-1 to ascii.

	* ascii.c (OnigEncodingASCII): change the name US-ASCII to ASCII-8BIT.

Wed Oct 10 14:31:05 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* string.c (rb_enc_str_coderange): fixed checkfor non-ascii.

Tue Oct  9 21:35:28 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* array.c (rb_ary_permutation, rb_ary_combination): missing type
	  names.

	* array.c (rb_ary_permutation): used buffer should be t1.

	* array.c (rb_ary_permutation): use frozen shared hidden array.
	  [ruby-dev:31985]

Tue Oct  9 16:58:10 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* array.c: remove to_a completely.

	* array.c (tmpbuf): keep DRY to clear klass of temporary objects.

Tue Oct  9 16:33:32 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* array.c (rb_ary_permutation, rb_ary_combination, rb_ary_product):
	  hide internal buffer objects.  [ruby-dev:31982]

Tue Oct  9 16:00:32 2007  NAKAMURA Usaku  <usa@ruby-lang.org>

	* parse.y (parser_read_escape, parser_tokadd_escape): check code range.
	  [ruby-dev:31980]

Tue Oct  9 15:40:24 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* parse.y (STR_NEW3): check for if single byte sequence.

Mon Oct  8 20:06:29 2007  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* lib/net/imap.rb, lib/net/smtp.rb, lib/net/pop.rb: hostname should
	  be verified against server's identity as presented in the server's
	  certificate. [ruby-dev:31960]

	* ext/openssl/lib/net/telnets.rb, ext/openssl/lib/net/ftptls.rb: ditto.

Sun Oct  7 22:37:47 2007  Kouhei Sutou  <kou@cozmixng.org>

	* test/rss/test_taxonomy.rb, test/rss/test_parser_1.0.rb,
	  test/rss/test_image.rb, test/rss/rss-testcase.rb: ensured
	  declaring XML namespaces.

Sun Oct  7 22:00:01 2007  Tanaka Akira  <akr@fsij.org>

	* include/ruby/node.h: make node flags as VALUE type.
	  enum ruby_node_flags removed.

	* ruby.c: define RUBY_NODE_* as const for gdb.

Sun Oct  7 18:57:12 2007  Tanaka Akira  <akr@fsij.org>

	* include/ruby/ruby.h: enum ruby_value_flags removed.  [ruby-dev:31959]

	* ruby.c: define RUBY_FL_* as const VALUE for gdb.

Sun Oct  7 17:50:14 2007  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* lib/net/http.rb: remove enable_post_connection_check flag.

	* lib/open-uri.rb: ditto.

Sun Oct 07 15:48:40 2007  Koichi Sasada  <ko1@atdot.net>

	* insns.def (opt_eq): fix to use rb_str_equal().

Sat Oct  6 23:14:54 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* string.c (rb_str_to_i): update RDoc since base can be any value
	  between 2 and 36.  [ruby-talk:272879]

Sat Oct  6 16:24:02 2007  Koichi Sasada  <ko1@atdot.net>

	* cont.c (cont_free): check Fiber or Continuation.

	* bootstraptest/test_knownbug.rb: remove a fixed test.

Sat Oct  6 14:56:02 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* encoding.c (rb_enc_register): returns new index or -1 if failed.

	* encoding.c (rb_enc_alias): check if original name is registered.

	* encoding.c (rb_enc_init): register in same order as kcode options in
	  re.c.  added new aliases.

	* string.c (rb_str_force_encoding): check if valid encoding name.

Sat Oct  6 14:32:30 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* insns.def (opt_eq): get rid of gcc bug.

Sat Oct  6 02:34:18 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* include/ruby/defines.h: no longer provide DEFAULT_KCODE. 

Fri Oct  5 21:24:59 2007  Tanaka Akira  <akr@fsij.org>

	* re.c (rb_reg_s_union_m): Regexp.union accepts single argument which
	  is an array of patterns.  [ruby-list:44084]

Fri Oct  5 16:42:27 2007  Tanaka Akira  <akr@fsij.org>

	* bootstraptest/runner.rb (assert_not_match): new method.

Fri Oct  5 16:15:52 2007  Akinori MUSHA  <knu@iDaemons.org>

	* configure.in: Turn on --enable-pthread by default for FreeBSD
	  5.2.1-RELEASE and later, and remove pthread support for older
	  versions which has never worked perfectly.

Fri Oct  5 16:11:50 2007  Akinori MUSHA  <knu@iDaemons.org>

	* time.c (time_to_s): Fix documentation.  Time format changed.

Fri Oct  5 04:02:39 2007  Akinori MUSHA  <knu@iDaemons.org>

	* lib/ipaddr.rb (in_addr, in6_addr, addr_mask): Make some minor
	  code optimization.

Fri Oct  5 03:25:51 2007  Akinori MUSHA  <knu@iDaemons.org>

	* lib/ipaddr.rb (<=>): Implement IPAddr#<=> and make IPAddr
	  comparable.

	* lib/ipaddr.rb (succ): Implement IPAddr#succ.  You can now create
	  a range between two IPAddr's, which (Range) object is
	  enumerable.

	* lib/ipaddr.rb (to_range): A new method to create a Range object
	  for the (network) address.

Fri Oct  5 03:14:45 2007  Akinori MUSHA  <knu@iDaemons.org>

	* lib/ipaddr.rb (coerce_other): Support type coercion and make &,
	  |, == and include? accept a string or an integer instead of an
	  IPAddr object as the argument.

	* lib/ipaddr.rb (initialize): Give better error messages.

	* lib/ipaddr.rb: Improve documentation.

Thu Oct  4 20:45:53 2007  NAKAMURA Usaku  <usa@ruby-lang.org>

	* process.c (Init_process): win32 has our own WNOHANG definition, so
	  remove unnecessary #ifdef guard.

Thu Oct  4 20:17:19 2007  NAKAMURA Usaku  <usa@ruby-lang.org>

	* array.c (rb_ary_permutation, rb_ary_product): support non C99
	  compilers.

Thu Oct  4 17:33:18 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* re.c (kcode_setter): Perl-ish global variable `$=' no longer
	  effective.

	* io.c (Init_IO): remove obsolete variables: $defout, $deferr.

	* re.c (Init_Regexp): remove obsolete const alias: MatchingData.

	* time.c (Init_Time): remove obsolete Time::times.

	* re.c (ignorecase_setter): change warning message.

	* re.c (ignorecase_getter): now gives warning.

	* string.c (rb_str_cmp_m): update RDoc document.

	* re.c (kcode_setter): restore erroneously removed setter.

Thu Oct  4 16:28:33 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* encoding.c (rb_obj_encoding): returns encoding of the given object.

	* parse.y (reg_compile_gen): copy encoding from source string if
	  non-empty.

	* re.c (Init_Regexp): new method Regexp#encoding.

	* string.c (str_encoding): moved to encoding.c

Thu Oct  4 15:49:33 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* array.c (rb_ary_permutation): remove C99 dependency.
	  [ruby-dev:31934]

	* array.c (rb_ary_product): ditto.

Wed Oct  3 23:37:17 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* ext/nkf/nkf.c, bin/ri, bin/irb: fixed typos in doc and comments.
	  a patch from Eugene Ossintsev  <eugoss AT gmail.com>.
	  [ruby-core:12375]

Wed Oct  3 17:56:22 2007  Koichi Sasada  <ko1@atdot.net>

	* benchmark/driver.rb: enable specify label to executable.
	  (-e "ruby1::/path/to/ruby1; ruby2::/path/to/ruby2; ...")

Wed Oct  3 16:58:48 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* parse.y (parser_str_new, parser_yylex, rb_intern3): set code-range
	  bits.

	* parse.y (parser_tokadd_string): check code-range.

	* parse.y (parser_parse_string, parser_here_document): ditto.

	* parse.y (parser_set_encode): check if valid encoding.

Wed Oct  3 15:43:15 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* variable.c (rb_cvar_set): check whether class variable is
	  defined in superclasses.  root classes have higher priority.
	  removes lower class variable entry from IV_TBL (if it's defined
	  in classes, not modules).

	* variable.c (rb_cvar_get): ditto.

Wed Oct  3 10:06:53 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* ruby.c (ruby_process_options): push frame with program name.
	  [ruby-core:12351]

Tue Oct  2 20:16:55 2007  NAKAMURA Usaku  <usa@ruby-lang.org>

	* win32/win32.c (init_env): refactoring. remove unused code.

Tue Oct  2 12:30:40 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* array.c (rb_ary_product): generalized product, now takes
	  arbitrary number of arrays.  a patch from David Flanagan
	  <david AT davidflanagan.com>.  [ruby-core:12346]

Tue Oct  2 08:25:50 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* array.c (rb_ary_permutation): implementation contributed from
	  David Flanagan.  [ruby-core:12344]

	* array.c (rb_ary_combination): RDoc update to clarify.  a patch
	  from David Flanagan.  [ruby-core:12344]

	* array.c (rb_ary_permutation): small dirty hack by Matz to avoid
	  arrays on stack.

Tue Oct  2 07:01:05 2007  Koichi Sasada  <ko1@atdot.net>

	* proc.c (proc_dup): proc->block.proc should be self.

	* bootstraptest/test_knownbug.rb, test_method.rb:
	  move a fixed test.

Mon Oct  1 16:17:44 2007  Tanaka Akira  <akr@fsij.org>

	* bootstraptest/test_method.rb: use assert_normal_exit to test
	  [ruby-dev:31818].

Mon Oct  1 15:57:49 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* gc.c (id2ref): skip ICLASS.

Mon Oct  1 15:29:35 2007  Tanaka Akira  <akr@fsij.org>

	* bootstraptest/runner.rb (assert_normal_exit): use `` instead of
	  system.

Mon Oct  1 15:17:48 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* gc.c (id2ref): T_VALUES is less than T_BLOCK.  [ruby-dev:31911]

Mon Oct  1 10:58:42 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* ruby.c (require_libraries): use require method instead of calling
	  rb_require directly.  [ruby-dev:31322]

Mon Oct  1 10:52:30 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* eval.c (ruby_options), ruby.c (proc_options, process_options): not
	  call exit(2) directly.  [ruby-dev:31912]

	* eval.c (ruby_run_node): deal with direct exit code.

Sun Sep 30 17:12:53 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* string.c (rb_str_append): always set encoding, and coderange
	  cache bits.

	* include/ruby/encoding.h (ENC_CODERANGE_SET): fixed a bug not to
	  set cache bits.

Sun Sep 30 11:52:11 2007  Tanaka Akira  <akr@fsij.org>

	* bootstraptest/runner.rb (pretty): don't show beginning empty line.

Sun Sep 30 11:32:34 2007  Tanaka Akira  <akr@fsij.org>

	* numeric.c: use #ifdef for test LONG_LONG_VALUE.

Sun Sep 30 04:30:55 2007  Tanaka Akira  <akr@fsij.org>

	* bignum.c: use SIZEOF_LONG instead of SIZEOF_ULONG which is not
	  defined.

Sun Sep 30 04:03:43 2007  Tanaka Akira  <akr@fsij.org>

	* re.c (Init_Regexp): test DEFAULT_KCODE in C code because
	  KCODE_EUC, etc. are enum.

Sun Sep 30 00:55:40 2007  NAKAMURA Usaku  <usa@ruby-lang.org>

	* variable.c (obj_ivar_each): get rid of warning.

Sat Sep 29 17:45:22 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* main.c (main): use platform-independent per-process initialization.
	  [ruby-dev:31900]

	* ruby.c (ruby_sysinit): new function for per-process initialization.

	* include/ruby/ruby.h (RUBY_GLOBAL_SETUP): toplevel setup declaration.

	* include/ruby/win32.h, win32/mkexports.rb: alias NtInitialize
	  ruby_sysinit.

	* win32/win32.c (rb_w32_sysinit): renamed from NtInitialize.

Sat Sep 29 17:31:04 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* array.c (rb_ary_combination): new method to give all combination
	  of elements from an array.  [ruby-list:42671]

	* array.c (rb_ary_product): a new method to get all combinations
	  of elements from two arrays.  can be extended to combinations of
	  n-arrays, e.g. a.product(b,c,d).  anyone volunteer?

	* array.c (rb_ary_permutation): empty function body to calculate
	  permutations of array elements.  need volunteer.

Sat Sep 29 17:14:44 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* marshal.c (r_leave): move proc invocation from r_entry() to
	  avoid potential crash.

Sat Sep 29 12:28:08 2007  Tanaka Akira  <akr@fsij.org>

	* bootstraptest/runner.rb (assert_normal_exit): new method.

	* bootstraptest/test_knownbug.rb: add test for Marshal.load.

Sat Sep 29 10:12:20 2007  Tanaka Akira  <akr@fsij.org>

	* variable.c (rb_ivar_set): fix class instance variable.

	* object.c (rb_class_real): cl argument may be 0.

Sat Sep 29 09:12:02 2007  Tanaka Akira  <akr@fsij.org>

	* object.c (rb_class_real): use BUILTIN_TYPE instead of TYPE.
	  access flags directly instead of FL_TEST.
	  they are enough because cl argument is a class.

Sat Sep 29 08:57:15 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* include/ruby/win32.h (strcasecmp): needed for type_strcasehash.

Sat Sep 29 06:47:29 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* ruby.c (struct cmdline_options): static variables packed.

Sat Sep 29 05:29:30 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* io.c (rb_io_fdopen): create IO object from fd.

	* parse.y (yycompile): use encoding of the source as default.

	* ruby.c (proc_options, load_file): ditto.

Sat Sep 29 04:27:08 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* encoding.c (rb_enc_alias): allow encodings multiple aliases.

	* encoding.c (rb_enc_find_index): search the encoding which has the
	  given name and return its index if found, or -1.

	* st.c (type_strcasehash): case-insensitive string hash type.

	* string.c (rb_str_force_encoding): force encoding of self.  this name
	  comes from [ruby-dev:31894] by Martin Duerst.  [ruby-dev:31744]

	* include/ruby/encoding.h (rb_enc_find_index, rb_enc_associate_index):
	  prototyped.

	* include/ruby/encoding.h (rb_enc_isctype): direct interface to ctype.

	* include/ruby/st.h (st_init_strcasetable): prototyped.

Sat Sep 29 03:53:26 2007  Koichi Sasada  <ko1@atdot.net>

	* cont.c: Thread local storage should be fiber local.

	* bootstraptest/test_knownbug.rb, test/ruby/test_fiber.rb: 
	  move a fixed test.

Fri Sep 28 23:15:31 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* insnhelper.ci (vm_call_method): allow send! to call protected
	  methods as well.  [ruby-core:12280]

Fri Sep 28 22:33:47 2007  Koichi Sasada  <ko1@atdot.net>

	* benchmark/bm_so_fasta.rb: added.

	* benchmark/bm_so_k_nucleotide.rb: added.

	* benchmark/bm_so_reverse_complement.rb: added.

	* benchmark/make_fasta_output.rb: added.

	* benchmark/prepare_so_k_nucleotide.rb: added.

	* benchmark/prepare_so_reverse_complement.rb: added.

Fri Sep 28 19:14:51 2007  Koichi Sasada  <ko1@atdot.net>

	* benchmark/driver.rb: fix notations.

	* benchmark/bm_loop_whileloop.rb: ditto.

	* benchmark/bm_loop_whileloop2.rb: ditto.

	* benchmark/bm_app_uri.rb: added.

	* benchmark/bm_vm1_ivar_set.rb: ditto.

	* benchmark/bm_so_binary_trees.rb: added from Computer Language
	  Benchmarks Game (http://shootout.alioth.debian.org/).

	* benchmark/bm_so_fannkuch.rb: ditto.

	* benchmark/bm_so_mandelbrot.rb: ditto.

	* benchmark/bm_so_meteor_contest.rb: ditto.

	* benchmark/bm_so_nbody.rb: ditto.

	* benchmark/bm_so_nsieve.rb: ditto.

	* benchmark/bm_so_nsieve_bits.rb: ditto.

	* benchmark/bm_so_partial_sums.rb: ditto.

	* benchmark/bm_so_pidigits.rb: ditto.

	* benchmark/bm_so_spectralnorm.rb: ditto.

Fri Sep 28 16:22:52 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* vm_core.h (rb_vm_struct): fix typo: bufferd -> buffered.

Fri Sep 28 15:47:48 2007  Koichi Sasada  <ko1@atdot.net>

	* benchmark/driver.rb: fix to output benchmark results
	  to file "bmlog-#{Time.now.strftime('%Y%m%d-%H%M%S')}.#{$$}".

	* benchmark/bm_io_file_create.rb: remove useless codes.

	* benchmark/bm_vm2_eval.rb: added.

Fri Sep 28 15:05:24 2007  Tanaka Akira  <akr@fsij.org>

	* include/ruby/intern.h: export rb_ivar_foreach.

	* include/ruby/ruby.h: modify struct RObject and RClass for optimizing
	  T_OBJECT space.  [ruby-dev:31853]
	  (ROBJECT_LEN, ROBJECT_PTR)
	  (RCLASS_IV_TBL, RCLASS_M_TBL, RCLASS_SUPER, RCLASS_IV_INDEX_TBL)
	  (RMODULE_IV_TBL, RMODULE_M_TBL, RMODULE_SUPER): abstract accessor
	  defined.

	* variable.c: support the modified RObject and RClass.

	* object.c: ditto.

	* class.c: ditto.

	* gc.c: ditto.

	* marshal.c: ditto.

	* eval_method.ci: use the abstract accessor.

	* insns.def: ditto.

	* proc.c: ditto.

	* struct.c: ditto.

	* eval.c: ditto.

	* error.c: ditto.

	* vm.c: ditto.

	* insnhelper.ci: ditto.

	* ext/digest/digest.c: ditto.

Fri Sep 28 13:20:10 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* io.c (rb_io_getline_fast, rb_io_getline_1): set encoding to the
	  result string, as well as getc.

Fri Sep 28 12:51:42 2007  Koichi Sasada  <ko1@atdot.net>

	* benchmark/bm_app_erb.rb: added.

	* benchmark/bm_io_file_(create|read|write).rb: added.

Fri Sep 28 12:49:05 2007  Koichi Sasada  <ko1@atdot.net>

	* benchmark/driver.rb: fix file selection algorithm.

Fri Sep 28 02:05:42 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* string.c (rb_str_comparable): need not to check asciicompat here.

	* encoding.c (rb_enc_check): ditto.

	* string.c (rb_enc_str_coderange): tuned a bit; no broken check.

	* encoding.c (rb_enc_check): new encoding comparison criteria.

Thu Sep 27 17:36:28 2007  NAKAMURA Usaku  <usa@ruby-lang.org>

	* win32/REAMDE.win32: follow recent changes.

Thu Sep 27 16:01:53 2007  Koichi Sasada  <ko1@atdot.net>

	* benchmark/driver.rb: fix to output some helpful messages.

Thu Sep 27 15:44:51 2007  Koichi Sasada  <ko1@atdot.net>

	* benchmark/driver.rb: added.

	* common.mk: fix to use above driver.

	* benchmark/prepare_so_count_words.rb: added.

	* benchmark/bm_so_count_words.rb: fix benchmark process.

Thu Sep 27 15:42:34 2007  Koichi Sasada  <ko1@atdot.net>

	* ext/fiber/fiber.c: modify prototype declaration.
	  [ruby-core:12247]

Thu Sep 27 09:42:50 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* parse.y (strings, xstring, regexp, dsym): empty strings have
	  US-ASCII encoding.

Thu Sep 27 07:39:13 2007  Tanaka Akira  <akr@fsij.org>

	* bootstraptest/runner.rb (assert_finish): new method.

	* bootstraptest/test_knownbug.rb: add test for [ruby-dev:31866] using
	  assert_finish.

Thu Sep 27 04:46:31 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* encoding.c (rb_enc_associate_index): deal with ASCII compatible
	  flags.

	* encoding.c (rb_enc_check): allow ASCII compatible strings.

	* parse.y (rb_intern_str): use ASCII encoding for ASCII string.

	* string.c (rb_enc_str_coderange): check for code-range.

	* string.c (rb_str_modify): clear code-range flags.

	* string.c (rb_str_hash, rb_str_eql): ASCII compatible strings are
	  comparable.

	* include/ruby/encoding.h: added code-range flags.

Thu Sep 27 04:40:47 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* gc.c (rb_mark_set): new function to mark keys.

	* marshal.c (struct dump_arg, struct load_arg): added wrappers to mark
	  data and compat_tbl entries.  [ruby-dev:31870]

Thu Sep 27 03:17:41 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* process.c (rb_waitpid): no needs to poll.  [ruby-dev:31871]

Wed Sep 26 20:11:46 2007  Koichi Sasada  <ko1@atdot.net>

	* bootstraptest/test_knownbug.rb: remove a fixed test.

Wed Sep 26 20:00:12 2007  Koichi Sasada  <ko1@atdot.net>

	* bootstraptest/test_knownbug.rb: move fixed tests.

	* bootstraptest/test_method.rb: ditto.

	* test/ruby/test_io.rb: ditto.

Wed Sep 26 19:36:26 2007  Koichi Sasada  <ko1@atdot.net>

	* eval.c (eval): fix to check stack overflow.
	  [ruby-dev:31850]

	* eval_intern.h, vm.h: move CHECK_STACK_OVERFLOW() macro.

Wed Sep 26 19:27:11 2007  Koichi Sasada  <ko1@atdot.net>

	* insnhelper.ci (vm_throw): fix to move increment point.
	  [ruby-dev:31840]

Wed Sep 26 19:23:56 2007  Koichi Sasada  <ko1@atdot.net>

	* cont.c: Fiber as SemiCoroutine on default. [ruby-core:12146]

	* ext/fiber/fiber.c: enable Fiber#transfer.

Wed Sep 26 18:38:41 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* encoding.c (rb_enc_check): check for ASCII-compatibilities.

	* parse.y (parser_tokadd_string, parser_parse_string,
	  parser_here_document, parser_yylex): set encoding to US-ASCII.

	* parse.y (rb_enc_symname_p): check if valid with encoding.

	* parse.y (rb_intern3): let symbols have encoding.

	* string.c (rb_str_hash): add encoding index.

	* string.c (rb_str_comparable, rb_str_equal, rb_str_eql): check if
	  compatible encoding.

	* string.c (sym_inspect): made encoding aware.

	* insns.def (opt_eq): compare with encoding.

	* include/ruby/encoding.h (rb_enc_asciicompat): check if ASCII
	  compatible.

	* include/ruby/encoding.h (rb_enc_get_index): added prototype.

	* include/ruby/intern.h (rb_str_comparable, rb_str_equal): ditto.

Wed Sep 26 15:01:16 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* eval_method.ci (rb_get_alloc_func): cast to suppress a warning.

	* eval_method.ci (remove_method): local variable to be initialized.

Wed Sep 26 08:36:31 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* Makefile.in (ext/extinit.o): use $(OUTFLAG) as well as other
	  objects.  [ruby-Bugs-14228]

Wed Sep 26 05:12:17 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* parse.y (parser_yyerror): limit error message length.
	  [ruby-dev:31848]

Tue Sep 25 15:11:32 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* io.c (io_ungetc): reallocate internal buffer if pushing data
	  excess capacity.  [ruby-dev:31650]

Tue Sep 25 13:43:03 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval_method.ci (remove_method): should not remove undef place
	  holder.  [ruby-dev:31816], [ruby-dev:31817]

Tue Sep 25 09:51:31 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (rb_longjmp): source file information may be NULL.
	  [ruby-dev:31849]

	* eval.c (ruby_finalize_0): clear trace_func before finalization.

Mon Sep 24 22:36:13 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* array.c (rb_ary_equal): should handle recursive array.

	* hash.c (hash_equal): should handle recursive hash.

Mon Sep 24 22:14:13 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* lib/weakref.rb (WeakRef): remove debug print.  [ruby-dev:31799]

	* hash.c (hash_i): avoid too frequent hash conflict where key and
	  value are same.  a patch from Yusuke ENDOH <mame AT tsg.ne.jp>.
	  [ruby-dev:31802]

Mon Sep 24 17:56:21 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* ext/strscan/strscan.c (strscan_initialize, strscan_getch): use the
	  encoding of the target string instead of setting to StringScanner
	  instance.  [ruby-dev:31831]

Mon Sep 24 16:52:11 2007  Urabe Shyouhei  <shyouhei@ruby-lang.org>

	* lib/net/http.rb: fix typo.

Mon Sep 24 06:49:15 2007  GOTOU Yuuzou  <gotoyuzo@notwork.org>  

	* lib/net/http.rb: an SSL verification (the server hostname should
	  be matched with its certificate's commonName) is added.
	  this verification can be skipped by
	  "Net::HTTP#enable_post_connection_check=(false)".
	  suggested by Chris Clark <cclark at isecpartners.com>

	* lib/net/open-uri.rb: use Net::HTTP#enable_post_connection_check to
	  perform SSL post connection check.

	* ext/openssl/lib/openssl/ssl.c
	(OpenSSL::SSL::SSLSocket#post_connection_check): refine error message.  

Sun Sep 23 09:05:05 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* gc.c (os_obj_of, os_each_obj): hide objects to be finalized.
	  [ruby-dev:31810]

Sun Sep 23 08:58:01 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* eval_method.ci (rb_attr): should not use alloca for unknown size
	  input.  [ruby-dev:31818]

	* parse.y (rb_intern_str): prevent str from optimization.

Sun Sep 23 06:16:04 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* eval_method.ci (remove_method): check for undefined method.
	  [ruby-dev:31816]

Sun Sep 23 05:42:35 2007  URABE Shyouhei  <shyouhei@ruby-lang.org>

	* lib/rdoc/options.rb (Options::check_diagram): dot -V output
	  changed. [ ruby-Bugs-11978 ], Thanks Florian Frank.

Sat Sep 22 06:02:11 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* lib/optparse.rb (OptionParser::List::summarize): use each_line if
	  defined rather than each.  [ruby-Patches-14096]

Sat Sep 22 05:19:49 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* ext/stringio/stringio.c (strio_init): separate from strio_initialize
	  to share with strio_reopen properly.  [ruby-Bugs-13919]

Fri Sep 21 14:51:40 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* gc.c (gc_mark_rest): copy just used part.

	* gc.c (gc_mark_children): mark u1 and u2 of NODE_ARGSCAT.

	* gc.c (os_obj_of): hide T_VALUES too.  [ruby-dev:31804]

	* gc.c (run_final): freeze temporary argument array.

Fri Sep 21 04:58:39 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* misc/ruby-style.el (ruby-style-label-indent): fix for function top
	  level labels.

Fri Sep 21 02:11:22 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* re.c (rb_reg_match_m): evaluate a block if match.  it would make
	  condition statement much shorter, if no else clause is needed.

	* string.c (rb_str_match_m): ditto.

Fri Sep 21 02:02:34 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* hash.c (hash_equal): should call rb_eql when argument eql is set.

Thu Sep 20 17:28:00 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* io.c (popen_exec), process.c (rb_spawn): stop other threads before
	  exec.  [ruby-core:08262]

Tue Sep 18 22:08:42 2007  Keiju Ishitsuka  <keiju@ruby-lang.org>

	* lib/matrix.rb: fix a coerce bug of Vector. [ruby-core: 12190]

Mon Sep 17 21:06:03 2007  Minero Aoki  <aamine@loveruby.net>

	* lib/net/http.rb (HTTP::GenericRequest#initialize): check path is
	  not nil. [ruby-dev:31149]

Mon Sep 17 21:00:51 2007  Minero Aoki  <aamine@loveruby.net>

	* parse.y (ripper): rename event: arglist_* -> args_*.

	* parse.y (ripper): rename event: restparam -> rest_param.

	* parse.y (ripper): rename event: constpath_* -> const_path_*.

	* parse.y (ripper): rename event: topconst_* -> top_const_*.

	* parse.y (ripper): rename event: iter_block -> method_add_block.

	* parse.y (ripper): support block local parameter declaration.

	* parse.y (ripper): introduce new macro params_new.

	* ext/ripper/lib/ripper/sexp.rb: should not dispose event
	  arguments whose name ends with "_new" but arity != 0.

Sat Sep 15 23:36:31 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* parse.y (struct parser_params): common members in the parser and
	  ripper must be placed at each same location.

Sat Sep 15 18:25:15 2007  Kouhei Sutou  <kou@cozmixng.org>

	* string.c (rb_str_rstrip_bang): fixed too much rstrip. [ruby-dev:31786]

Sat Sep 15 17:32:10 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* parse.y (parser_initialize): set default encoding.  [ruby-dev:31787]

	* ruby.c (load_file): make new parse instance after processing shebang
	  line options.

Sat Sep 15 17:04:08 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* encoding.c (rb_enc_associate_index, rb_enc_get_index): check if
	  object is encoding capable.  [ruby-dev:31780]

	* string.c (rb_str_subpat_set): check for if the argument is a String.

Sat Sep 15 13:31:21 2007  Kouhei Sutou  <kou@cozmixng.org>

	* lib/rss.rb, lib/rss/, test/rss/:
	  - 0.1.9 -> 0.2.0.
	  - supported Slash module.

Fri Sep 14 22:20:01 2007  Masaki Suketa  <masaki.suketa@nifty.ne.jp>

	* ext/win32ole/win32ole.c (fev_unadvise): no needs to reset
	  event handlers.

Fri Sep 14 17:28:32 2007  Koichi Sasada  <ko1@atdot.net>

	* test/ruby/test_io.rb: tests which cause SEGV should not be
	  added.

	* bootstraptest/test_knownbug.rb: add above test to known bug.

Fri Sep 14 16:24:04 2007  Koichi Sasada  <ko1@atdot.net>

	* insnhelper.ci (vm_expandarray): assignment should be placed
	  after creating new array.

Fri Sep 14 16:17:30 2007  Koichi Sasada  <ko1@atdot.net>

	* bootstraptest/runner.rb: add a stress test (-s).

Fri Sep 14 16:14:28 2007  Koichi Sasada  <ko1@atdot.net>

	* vm.h, eval_intern.h: move some macros to eval_intern.h.

	* eval_jump.ci (rb_f_throw): fix to use NEW_THROW_OBJECT().

	* eval.c (rb_f_loop): remove additional macro.

Fri Sep 14 16:12:10 2007  Koichi Sasada  <ko1@atdot.net>

	* insnhelper.ci (vm_expandarray): should be volatile value for GC.

Thu Sep 13 15:42:03 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* compile.c (iseq_compile_each): inline cache entries are overwritten
	  in iseq_build_body().

Thu Sep 13 14:00:15 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* parse.y (brace_block): should use compstmt.  patch submitted by
	  Kirill A. Shutemov <k.shutemov AT gmail.com>  [ruby-core:12154].

Thu Sep 13 13:47:08 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* parse.y (rb_id2str): fixed typo.

Wed Sep 12 23:12:22 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* ruby.c (proc_options): -W should be allowed in RUBYOPT
	  environment variable.  [ruby-core:12118]

Wed Sep 12 15:19:04 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* io.c (rb_io_s_sysopen): should not use alloca for unknown size
	  input.  [ruby-dev:31775]

	* parse.y (rb_id2str): ditto.

	* marshal.c (w_float): use snprintf instead of sprintf.

Tue Sep 11 17:28:00 2007  Akinori MUSHA  <knu@iDaemons.org>

	* lib/tempfile.rb (Tempfile::make_tmpname): Allow to specify a
	  suffix for a temporary file name.

	* lib/tempfile.rb (Tempfile::make_tmpname): Make temporary file
	  names less predictable by including a random string.
	  [inspired by: akr]

Tue Sep 11 17:25:59 2007  Akinori MUSHA  <knu@iDaemons.org>

	* lib/shellwords.rb: Add shellescape() and shelljoin().

	* lib/shellwords.rb: Rename shellwords() to shellsplit() and make
	  the former an alias to the latter.

	* lib/shellwords.rb: Add escape(), split(), join() as class
	  methods, which are aliases to their respective long names
	  prefixed with `shell'.

	* lib/shellwords.rb: Add String#shellescape(), String#shellsplit()
	  and Array#shelljoin() for convenience.

Mon Sep 10 15:48:31 2007  Tanaka Akira  <akr@fsij.org>

	* range.c: represent initialized state using EXCL instead of FL_USER3.

	* range.c (range_dumper): make uninitialized range dumpable.
	  (range_loader): make uninitialized range loadable.

Mon Sep 10 13:44:37 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* array.c (rb_ary_cycle): avoid infinite loop for empty array.
	  based on a patch from David Flanagan.  [ruby-core:12085]

Mon Sep 10 01:21:23 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* marshal.c (r_object0): struct allocation first to check if a
	  class is a struct.  compatibility check should come next.

Mon Sep 10 01:05:25 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* range.c (range_step): fixed integer overflow.  [ruby-dev:31763]

Sun Sep  9 08:57:27 2007  Tadayoshi Funaba  <tadf@dotrb.org>

	* lib/date/format.rb (_strptime): now also attaches an element
	  which denotes leftover substring if exists.

Sun Sep  9 01:59:08 2007  Tanaka Akira  <akr@fsij.org>

	* marshal.c (r_object0): check T_STRUCT type for structs.

Sun Sep  9 01:17:05 2007  Tanaka Akira  <akr@fsij.org>

	* marshal.c (r_object0): don't call user-defined initialize for
	  T_STRUCT objects.

	* include/ruby/intern.h (rb_struct_initialize): declared.

	* struct.c (rb_struct_initialize): export.

Sat Sep  8 23:55:56 2007  Tanaka Akira  <akr@fsij.org>

	* eval_method.ci (rb_get_alloc_func): new function to get allocation
	  function.

	* include/ruby/intern.h (rb_alloc_func_t): declared.
	  (rb_define_alloc_func): declared.
	  (rb_marshal_define_compat): declared.

	* range.c: use T_STRUCT for Range.

	* inits.c: move Init_marshal() prior to Init_Range() because
	  Init_Range calls rb_marshal_define_compat which needs
	  marshal's compat_allocator_tbl initialized.

	* marshal.c: support marshal format compatibility layer designed for
	  marshaling T_STRUCT Range using T_OBJECT format.
	  (rb_marshal_define_compat): defined.
	
	[ruby-dev:31710]

Sat Sep  8 10:05:14 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* struct.c (rb_struct_s_members): check if __members__ is an
	  array to prevent segmentation fault.  [ruby-dev:31759]

Sat Sep  8 09:33:09 2007  Tadayoshi Funaba  <tadf@dotrb.org>

	* lib/date/format.rb (str[fp]time): now check specifications more
	  strictly.

Sat Sep  8 02:56:31 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* test/ruby/test_fiber.rb (TestFiber::test_throw): uncaught throw
	  now raise ArgumentError exception.

Sat Sep  8 02:45:33 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* struct.c (rb_struct_s_members): should raise TypeError instead
	  of call rb_bug().  [ruby-dev:31709]

	* marshal.c (r_object0): no nil check require any more.

Sat Sep  8 01:46:36 2007  NAKAMURA Usaku  <usa@ruby-lang.org>

	* regenc.c, regenc.h (onigenc_single_byte_mbc_enc_len): should take
	  two arguments. [ruby-dev:31754]

Fri Sep  7 00:58:16 2007  Koichi Sasada  <ko1@atdot.net>

	* common.mk: fix typo.

Fri Sep  7 00:28:25 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* io.c (rb_io_getc): forgot to commit rb_enc_mbclen() fix.

	* ext/stringio/stringio.c (strio_getc): rb_enc_mbclen() fix.

	* ext/stringio/stringio.c (strio_ungetc): ditto.

Thu Sep  6 22:57:01 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* lib/fileutils.rb (FileUtils::Entry_::copy): prevent self copy of
	  directories.

	* lib/fileutils.rb (FileUtils::fu_each_src_dest0): use try_convert.

	* lib/fileutils.rb (FileUtils::fu_update_option): ditto.

Thu Sep  6 21:36:33 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* include/ruby/oniguruma.h (OnigEncodingTypeST): add end parameter
	  to mbc_enc_len.

	* euc_jp.c (mbc_enc_len), sjis.c (mbc_enc_len),
	  utf8.c (utf8_mbc_enc_len): ditto.

	* encoding.c (rb_enc_mbclen): add end parameter.

Thu Sep  6 21:31:49 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* array.c (rb_ary_cycle): typo in rdoc.  a patch from Yugui
	  <yugui@yugui.sakura.ne.jp>.  [ruby-dev:31748]

Thu Sep  6 12:42:10 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* string.c (rb_str_succ, rb_str_chop_bang, rb_str_chop): m17n support.
	  [ruby-dev:31734]

Wed Sep  5 22:02:27 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* array.c (rb_ary_subseq): need integer overflow check.
	  [ruby-dev:31736]

	* array.c (rb_ary_splice): ditto.  [ruby-dev:31737]

	* array.c (rb_ary_fill): ditto.  [ruby-dev:31738]

	* string.c (rb_str_splice): integer overflow for length.
	  [ruby-dev:31739]

Tue Sep  4 20:43:44 2007  Masaki Suketa  <masaki.suketa@nifty.ne.jp>

	* ext/win32ole/win32ole.c: add WIN32OLE_EVENT#unadvise.

	* test/win32ole/test_win32ole_event.rb: ditto.

Mon Sep  3 15:37:09 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* common.mk (vm.o): depends on st.h too.

Sun Sep  2 23:38:29 2007  Tanaka Akira  <akr@fsij.org>

	* include/ruby/st.h (struct st_table): make num_entries bitfield
	  instead of num_bins for speed.  num_entries has less access.

Sun Sep  2 00:37:57 2007  Tadayoshi Funaba  <tadf@dotrb.org>

	* lib/date/format.rb (_parse): improved parsing of ordinal dates.

	* lib/date/format.rb (_parse): use named character classes in some
	  regular expressions.

Sat Sep  1 23:44:26 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval_jump.ci (rb_f_throw): wrap tag and TAG_THROW in a NODE_MEMO
	  node to make throw instruction to work well.

Sat Sep  1 20:56:07 2007  Tanaka Akira  <akr@fsij.org>

	* include/ruby/ruby.h (struct RBignum): embed digits in RBignum for
	  small bignums.

	* bignum.c: RBignum embedded digits implemented.

	* include/ruby/intern.h: declare rb_big_resize.

	* gc.c: don't free embedded digits.

	* numeric.c: replace direct bignum field accessor by abstract field
	  accessor such as RBIGNUM(val)->sign to RBIGNUM_SIGN(val).

	* sprintf.c: ditto.

	* compar.c: ditto.

	* marshal.c: ditto.

	* random.c: ditto.

	* .gdbinit: support embedded small bignums.

	[ruby-dev:31689]

Sat Sep  1 19:59:43 2007  Masaki Suketa  <masaki.suketa@nifty.ne.jp>

	* ext/win32ole/win32ole.c (ole_event_free): IConnectionPoint should be
	  released.

	* ext/win32ole/win32ole.c (EVENTSINK_Destructor): ITypeInfo should be
	  released.

	* ext/win32ole/win32ole.c (fev_initialize): refactoring.

Sat Sep  1 16:26:09 2007  NAKAMURA Usaku  <usa@ruby-lang.org>

	* test/socket/test_tcp.rb (test_recvfrom): same as mswin32 on mswin64.

Sat Sep  1 14:24:23 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* st.c (st_numcmp, st_numhash): use st_data_t instead of long, because
	  the former may be larger than the latter.

	* include/ruby/st.h (CHAR_BIT): get rid of magic number.

	* include/ruby/st.h (rb_index_t): use st_data_t for the platforms it
	  is larger than int.

Sat Sep  1 10:43:30 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval_jump.ci (rb_f_catch): generate new tag object if no argument is
	  given.  backported from MatzRuby.  [ruby-dev:31609]

	* eval_jump.ci (rb_catch): call #catch without arguments if tag
	  string is NULL.

	* eval_jump.ci (rb_f_throw): allow throwing non-symbol object.

	* eval_jump.ci (rb_catch_obj): new function to wait throw with arbitrary
	  object. 

	* eval_jump.ci (rb_throw_obj): new function to throw arbitrary object.

	* variable.c (check_autoload_table): prevent multiple calls from
	  RSTRING_PTR().

Fri Aug 31 07:12:24 2007  NAKAMURA Usaku  <usa@ruby-lang.org>

	* numeric.c (SQRT_LONG_MAX): use SIZEOF_LONG instead of SIZEOF_VALUE
	  because SIZEOF_VALUE > SIZEOF_LONG on some platforms.

Fri Aug 31 04:18:03 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* parse.y (f_norm_arg, f_arg_item): not croak already erred names.
	  [ruby-dev:31687]

	* parse.y (assignable_gen): ignore already erred names.

	* parse.y (shadowing_lvar_gen): always make new block local variable
	  when shadowing outer local variable.  [ruby-dev:31507]

Thu Aug 30 19:40:33 2007  NAKAMURA Usaku  <usa@ruby-lang.org>

	* regenc.h: check RUBY_EXTERN before including config.h and defines.h

	* common.mk: update header dependency.

Thu Aug 30 14:06:50 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* proc.c (rb_obj_define_method): reverted.  [ruby-talk:266637]

Thu Aug 30 13:49:25 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* lib/mkmf.rb: initialize $top_srcdir always.  [ruby-dev:31682]

	* lib/mkmf.rb (try_const, have_const): check for a const is defined.
	  [ruby-core:04422]

Thu Aug 30 08:00:12 2007  Tanaka Akira  <akr@fsij.org>

	* include/ruby/intern.h: declare rb_hash_tbl.

	* include/ruby/ruby.h (RHash): delay st_table allocation.
	  rename tbl field to ntbl to detect direct reference to the st_table
	  as a compile error.
	  (RHASH_TBL): abstract accessor defined.
	  (RHASH_ITER_LEV): ditto.
	  (RHASH_IFNONE): ditto.
	  (RHASH_SIZE): ditto.
	  (RHASH_EMPTY_P): ditto.
	  (hash_alloc0, hash_alloc): unified because hash_alloc doesn't
	  allocate st_table now.

	* hash.c: delay st_table allocation.

	* gc.c: replace tbl by ntbl.

	* array.c: replace direct field accessor by abstract field accessor
	  such as RHASH(hash)->tbl to RHASH_TBL(hash).

	* marshal.c: ditto.

	* insns.def: ditto.

	* ext/iconv/iconv.c: ditto.

	* ext/json/ext/generator/generator.c: ditto.

	* ext/json/ext/parser/parser.c: ditto.

	* ext/json/ext/parser/parser.rl: ditto.

	* ext/syck/rubyext.c: ditto.

	* ext/tk/tkutil/tkutil.c: ditto.

	[ruby-dev:31678]

Wed Aug 29 18:36:06 2007  Tanaka Akira  <akr@fsij.org>

	* lib/open-uri.rb: add :ftp_active_mode option.  [ruby-dev:31677]

Wed Aug 29 14:55:28 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* string.c (str_gsub): should not use mbclen2() which has broken API.

	* re.c: remove rb_reg_mbclen2().

Wed Aug 29 12:48:17 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* parse.y (aref_args): args may not be a list.  [ruby-dev:31592]

Wed Aug 29 11:30:10 2007  Tanaka Akira  <akr@fsij.org>

	* include/ruby/st.h (struct st_table): add entries_packed 1-bit
	  bitfield.  decrease num_bins 1-bit.

	* st.c: pack numhash which have 5 or less entries in bins.
	  (st_init_table_with_size): setup entries_packed flag.
	  (st_clear): support packed mode.
	  (st_lookup): ditto.
	  (st_insert): ditto.
	  (st_add_direct): ditto.
	  (st_copy): ditto.
	  (st_delete): ditto.
	  (st_foreach): ditto.
	  (st_reverse_foreach): ditto.
	  (unpack_entries): new function for converting to unpacked mode.

	[ruby-list:43954]
	  
Wed Aug 29 10:46:37 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* include/ruby/defines.h (flush_register_windows): call "ta 0x03"
	  even on Linux/Sparc.  [ruby-dev:31674]

Tue Aug 28 19:16:00 2007  Masaki Suketa  <masaki.suketa@nifty.ne.jp>

	* ext/win32ole/win32ole.c (ole_type_progid): progid getted by
	  ProgIDFromCLSID should be freed by CoTaskMemFree. Thanks, arton.

	* test/win32ole/test_win32ole.rb (test_raise_message): set negative
	  compareMode value to raise WIN32OLERuntimeError.

	* test/win32ole/test_win32ole_type.rb (test_implemented_ole_types):
	  support some environment which returns IShellDispatch5 instead 
	  of IShellDispatch.

Tue Aug 28 15:42:09 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* string.c (rb_str_subseq): retrieve substring based on byte offset.

	* string.c (rb_str_rindex_m): was confusing character offset and
	  byte offset.

Tue Aug 28 14:23:31 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* string.c (rb_str_splice_0): should check to modify.  [ruby-dev:31665]

Tue Aug 28 14:21:46 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* parse.y (parser_prepare): set parser encode too when BOM exists.

Tue Aug 28 00:51:22 2007  Koichi Sasada  <ko1@atdot.net>

	* thread.c: fix Mutex to be interruptable lock.

	* thread_win32.ci, thread_win32.h, thread_pthread.ci, thread_pthread.h:
	  prepare native_cond_*() which are based on pthread_cond_*() spec.

	* prelude.rb: fix Mutex#synchronize method.

	* vm_core.h, include/ruby/intern.h: change unblock function interface
	  (to pass some user data).

	* file.c, process.c: ditto.

	* benchmark/bm_vm2_mutex.rb: add a benchmark for mutex.

	* benchmark/bm_vm3_thread_mutex.rb: add a benchmark for mutex
	  with contention.

	* benchmark/run.rb: fix to remove ENV['RUBYLIB'] for matzruby.

	* test/ruby/test_thread.rb: add a test.

	* common.mk: fix benchmark options.

Mon Aug 27 23:14:02 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* string.c (rb_str_rstrip_bang): wrong strip point.  [ruby-dev:31652]

	* string.c (rb_str_each_line): should swallow sequence of newlines
	  if rs (optional argument) is an empty string.  [ruby-dev:31652]

Mon Aug 27 22:39:08 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* encoding.c (rb_enc_codelen): raises invalid sequence exception
	  if ONIGENC_CODE_TO_MBCLEN() returns zero.  [ruby-dev:31661]

	* encoding.c (rb_enc_mbclen): check invalid sequence.

Mon Aug 27 20:27:59 2007  Masaki Suketa  <masaki.suketa@nifty.ne.jp>

	* ext/win32ole/win32ole.c (ole_type_progid): fix the bug.
	  [ruby-dev:31576]

	* test/win32ole/test_win32ole_type.rb (test_initialize):
	  remove duplicate assertions.

Mon Aug 27 19:10:50 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* ext/etc/etc.c (etc_getlogin): update documentation to note
	  security issue.  [ruby-Bugs-11821]

Mon Aug 27 15:56:48 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* string.c (sym_encoding): return the encoding of a Symbol.

Mon Aug 27 15:33:10 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* util.c (IEEE_BIG_ENDIAN): use configured value.  [ruby-dev:31623]

	* util.c (Llong): set to LONG_LONG if available.

Mon Aug 27 13:11:56 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* string.c (tr_trans): wrong condition for mbmaxlen==1 strings.
	  [ruby-dev:31652]

Mon Aug 27 00:41:13 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* io.c (rb_io_each_byte): caused infinite loop.  [ruby-dev:31652]

	* io.c (rb_io_getc): should return nil at EOF, not EOFError.

	* lib/delegate.rb (SimpleDelegator::__setobj__): use raise
	  argument to specify backtrace.

	* test/ruby/test_fnmatch.rb (TestFnmatch::bracket_test):
	  String#include? no longer works for Fixnum.  use #chr.
	  [ruby-dev:31652]

Sun Aug 26 12:27:14 2007  Koichi Sasada  <ko1@atdot.net>

	* cont.c: fix to remove Fiber.new until fiber.so is not loaded.

	* test/ruby/test_continuation.rb: fix to use resume.

Sun Aug 26 06:51:46 2007  Masaki Suketa  <masaki.suketa@nifty.ne.jp>

	* ext/win32ole/win32ole.c (ole_wc2mb, reg_enum_key): allocate 
	  buffer should be NULL terminated.

Sun Aug 26 06:04:13 2007  Koichi Sasada  <ko1@atdot.net>

	* insnhelper.ci (vm_setup_method): reorder code for branch prediction.

Sun Aug 26 05:54:49 2007  Koichi Sasada  <ko1@atdot.net>

	* insnhelper.ci (vm_call_method): fix to relaxant safe level check
	  ($SAFE > 2).  [ruby-core:11998]

	* bootstraptest/test_method.rb: add tests for above.

Sun Aug 26 05:52:08 2007  Koichi Sasada  <ko1@atdot.net>

	* test/ruby/test_fiber.rb: fix to require 'continuation'.

Sat Aug 25 23:52:14 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* enumerator.c (enumerator_next): message changed.

Sat Aug 25 23:22:14 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* include/ruby/encoding.h: remove unused rb_enc_ismbchar().

Sat Aug 25 22:50:14 2007  Masaki Suketa  <masaki.suketa@nifty.ne.jp>

	* ext/win32ole/win32ole.c (ole_event_free, EVENTSINK_Destructor,
	  fev_initialize): remove the connection ole_event_free and 
	  EVENTSINK_Destructor.

Sat Aug 25 17:52:06 2007  Koichi Sasada  <ko1@atdot.net>

	* string.c, include/ruby/intern.h: export rb_str_length().

	* insns.def: use rb_str_length() in opt_length.

Sat Aug 25 17:48:51 2007  Koichi Sasada  <ko1@atdot.net>

	* cont.c: rename FIBER_STACK_SIZE to FIBER_VM_STACK_SIZE.

Sat Aug 25 17:05:05 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* io.c (swallow): removed condition using an unset variable.

	* parse.y, re.c: re-applied revision 13092.

	* string.c (rb_str_splice): return from void function.

	* include/ruby/encoding.h (rb_enc_str_new): prototype added.

Sat Aug 25 11:45:37 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* encoding.c: provide basic features for M17N.

	* parse.y: encoding aware parsing.

	* parse.y (pragma_encoding): encoding specification pragma.

	* parse.y (rb_intern3): encoding specified symbols.

	* string.c (rb_str_length): length based on characters.  
	  for older behavior, bytesize method added.

	* string.c (rb_str_index_m): index based on characters.  rindex as
	  well.

	* string.c (succ_char): encoding aware succeeding string.

	* string.c (rb_str_reverse): reverse based on characters.

	* string.c (rb_str_inspect): encoding aware string description.

	* string.c (rb_str_upcase_bang): encoding aware case conversion.
	  downcase, capitalize, swapcase as well.

	* string.c (rb_str_tr_bang): tr based on characters.  delete,
	  squeeze, tr_s, count as well.

	* string.c (rb_str_split_m): split based on characters.

	* string.c (rb_str_each_line): encoding aware each_line.

	* string.c (rb_str_each_char): added.  iteration based on
	  characters.

	* string.c (rb_str_strip_bang): encoding aware whitespace
	  stripping.  lstrip, rstrip as well.

	* string.c (rb_str_justify): encoding aware justifying (ljust,
	  rjust, center).

	* string.c (str_encoding): get encoding attribute from a string. 

	* re.c (rb_reg_initialize): encoding aware regular expression

	* sprintf.c (rb_str_format): formatting (i.e. length count) based
	  on characters.

	* io.c (rb_io_getc): getc to return one-character string.
	  for older behavior, getbyte method added.

	* ext/stringio/stringio.c (strio_getc): ditto.

	* io.c (rb_io_ungetc): allow pushing arbitrary string at the
	  current reading point.

	* ext/stringio/stringio.c (strio_ungetc): ditto.

	* ext/strscan/strscan.c: encoding support.

Sat Aug 25 10:59:19 2007  Koichi Sasada  <ko1@atdot.net>

	* cont.c: separate Continuation and Fiber from core.

	* ext/continuation/*, ext/fiber/*: ditto.

	* include/ruby/ruby.h: remove rb_cFiber.

	* include/ruby/intern.h: add the rb_fiber_new() declaration.

	* enumerator.c (next_init): fix to use rb_fiber_new().

	* test/ruby/test_enumerator.rb: remove next? tests.

	* test/ruby/test_continuation.rb: add a require 'continuation'.

	* test/ruby/test_fiber.rb: add a require 'fiber'.

Sat Aug 25 10:20:28 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* common.mk (prelude.o): depends on vm_core.h now.

	* common.mk (prelude.c): depends on tool/compile_prelude.rb too.

	* common.mk (prereq): updates all auto-generated sources.

	* tool/compile_prelude.rb: separated dynamic and static portions.

Sat Aug 25 10:05:17 2007  Koichi Sasada  <ko1@atdot.net>

	* prelude.rb: add Thread.exclusive.  This class method
	  is different from 1.8's.  Thread.exclusive only does
	  synchronize with VM global mutex.

Sat Aug 25 09:39:50 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* array.c (rb_ary_s_try_convert): more document description.

	* re.c (rb_reg_s_try_convert): typo fixed.

Sat Aug 25 08:54:12 2007  Koichi Sasada  <ko1@atdot.net>

	* id.h, id.c: remove idFuncall.

	* compile.c (iseq_specialized_instruction): ditto.

Sat Aug 25 08:47:28 2007  Koichi Sasada  <ko1@atdot.net>

	* tool/compile_prelude.rb: fix to include "vm_core.h".

Sat Aug 25 03:49:14 2007  Tanaka Akira  <akr@fsij.org>

	* test/ruby/sentence.rb (Sentence): include Enumerable.
	  (Sentence#each): defined.

	* test/ruby/test_assignment.rb: use Sentence#expand.

Sat Aug 25 03:08:57 2007  Koichi Sasada  <ko1@atdot.net>

	* prelude.rb: fix Mutex#synchronize definition.

Sat Aug 25 02:08:45 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* array.c (rb_ary_s_try_convert): a new class method to convert
	  object or nil if it's not target-type.  this mechanism is used
	  to convert types in the C implemented methods.

	* hash.c (rb_hash_s_try_convert): ditto.

	* io.c (rb_io_s_try_convert): ditto.

	* re.c (rb_reg_s_try_convert): ditto.

	* string.c (rb_str_s_try_convert): ditto.

Sat Aug 25 00:49:44 2007  Koichi Sasada  <ko1@atdot.net>

	* benchmark/bm_loop_generator.rb: added.

Sat Aug 25 00:22:31 2007  Koichi Sasada  <ko1@atdot.net>

	* prelude.rb: added.  run this script on startup.

	* tool/compile_prelude.rb: compile prelude.rb to C string.
	  (prelude.rb -> prelude.c)

	* common.mk: fix to build with prelude.c.

	* inits.c (rb_call_inits): ditto.

	* thread.c (Init_Thread): move definition of Mutex#synchronize
	  to prelude.rb.

Sat Aug 25 00:08:43 2007  Koichi Sasada  <ko1@atdot.net>

	* compile.c (compile_massign_opt): fix to skip massign optimization
	  with global variables.

	* bootstraptest/test_massign.rb: add some tests for above.

Fri Aug 24 18:42:03 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* test/ruby/test_dir.rb (TestDir::setup): ?c now makes a string.

	* lib/test/unit/autorunner.rb (Test::Unit::AutoRunner::initialize):
	  initialize @workdir to stop warning.

Fri Aug 24 18:30:50 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* lib/drb/drb.rb (DRb::DRbServer::InvokeMethod::perform_without_block): 
	  replace funcall by send!.  other files in the distribution as well.

Fri Aug 24 17:06:56 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (rb_f_send_bang): abandon the name funcall for private
	  aware method call.

Fri Aug 24 15:27:12 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* enumerator.c (enumerator_next): stop pre-fetching.

	* enumerator.c (Init_Enumerator): remove next? method.

Fri Aug 24 15:14:57 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (rb_f_loop): now handles StopIteration exception.

Thu Aug 23 20:31:31 2007  Koichi Sasada  <ko1@atdot.net>

	* compile.c: optimize simple massign.

Thu Aug 23 20:02:25 2007  Masaki Suketa  <masaki.suketa@nifty.ne.jp>

	* ext/win32ole/win32ole.c (reg_get_value): use RegQueryValueEx instead
	  of RegQueryValueEx.

	* ext/win32ole/win32ole.c (typelib_file_from_clsid): fix the bug
	  that the function always returns Qnil.

	* test/win32ole/test_win32ole_type.rb (test_initialize): add some test.

Thu Aug 23 17:25:05 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* configure.in (group_member): check if presents.

	* configure.in (XCFLAGS): add _GNU_SOURCE on linux.

	* file.c (group_member): use system routine if available.

	* process.c: moved _GNU_SOURCE macro to Makefile.

Thu Aug 23 16:59:40 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* compile.c (compile_massign), insnhelper.ci (vm_throw): not use C99
	  comment.

	* cont.c (rb_cont_call, fiber_switch, rb_fiber_resume, rb_fiber_yield):
	  suppress warnings.

	* cont.c (rb_fiber_start): change on non-volatile variable between
	  setjmp and longjmp may not has an effect.

	* enumerator.c (sym_call): initialize first.

	* enumerator.c (enum_iter): typedefed.

	* enumerator.c (next_i): suppress a warning.

Thu Aug 23 16:04:11 2007  Koichi Sasada  <ko1@atdot.net>

	* compile.c, insns.def, parse.y: fix massign order.  This change
	  causes performance problem.  Try vm1_swap benchmark.
	  [ruby-dev:31522]

	* insns.def, insnhelper.ci: move process body of expandarray insn to
	  vm_expandarray().

	* bootstraptest/test_knownbug.rb, bootstraptest/test_massign.rb: 
	  move a solved test.

Thu Aug 23 15:51:19 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* parse.y (f_norm_arg): ripper has no shadowing check.

	* parse.y (f_block_arg): dispatch blkarg_mark.

Thu Aug 23 15:48:26 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* compile.c (make_masgn_lhs, iseq_compile_each): fixed indent.

	* compile.c (iseq_translate_threaded_code),
	  vm_evalbody.ci (get_insns_address_table),
	  template/vmtc.inc.tmpl (insns_address_table): constified.

	* vm_evalbody.ci (vm_eval),
	  template/insns_info.inc.tmpl (insn_stack_increase, insn_ret_num):
	  suppress warnings.

Thu Aug 23 13:19:43 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* parse.y (f_norm_arg): check also nested arguments.  [ruby-dev:31502]

Thu Aug 23 00:06:48 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* util.c: updated for ANSI C only.  applied a patch from
	  <snakagawa AT infoteria.co.jp>.  [ruby-dev:31591]

Thu Aug 23 00:04:45 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* missing/strtod.c: removed.  [ruby-dev:31588]

	* LEGAL: updated.

Wed Aug 22 15:59:44 2007  Koichi Sasada  <ko1@atdot.net>

	* bootstraptest/test_knownbug.rb:
	  fix typo of filename (test_knwonbug.rb).

Wed Aug 22 14:04:53 2007  Koichi Sasada  <ko1@atdot.net>

	* bootstraptest/test_knwonbug.rb: added.  This file will contain
	  test cases which point out known bug.  If bug is fixed, tests
	  should move to the suitable place.

	* bootstraptest/test_massign.rb: move a test which show known bug
	  to test_knownbug.rb.

Wed Aug 22 13:02:26 2007  Tanaka Akira  <akr@fsij.org>

	* bootstraptest/runner.rb (in_temporary_working_directory):
	  don't remove the directory specified by --dir.

Wed Aug 22 05:51:23 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* util.c (ruby_strtod): replaced by the implementation by David
	  M. Gay inspired by William D. Clinger's paper "How to Read Floating
	  Point Numbers Accurately" [Proc. ACM SIGPLAN '90, pp. 92-101].
	  a patch from Satoshi Nakagawa <snakagawa AT infoteria.co.jp>.
	  [ruby-dev:31582]

	* test/ruby/test_float.rb (TestFloat::test_float): add test for
	  precision.

Wed Aug 22 03:51:07 2007  Koichi Sasada  <ko1@atdot.net>

	* cont.c: add Fiber#resume and Fiber.yield.
	  and Fiber::Core class to realize Coroutine.

	* include/ruby/intern.h: declare rb_fiber_yield(), rb_fiber_resume().

	* enumerator.c: use above api.

	* test/ruby/test_fiber.rb: fix and add tests for above changes.

Tue Aug 21 21:09:48 2007  Tanaka Akira  <akr@fsij.org>

	* lib/tmpdir.rb (Dir.mktmpdir): make directory suffix specifiable.
	  suggested by knu.  [ruby-dev:31568]

Tue Aug 21 15:00:23 2007  Koichi Sasada  <ko1@atdot.net>

	* st.c (st_clear): reset num_entries too.

Tue Aug 21 13:57:04 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* hash.c (st_foreach_func, rb_foreach_func): typedefed.

	* hash.c (rb_hash_clear): use st_clear() unless iterating.

	* st.c (struct st_table_entry): add new members, fore and back, to
	  iterate in inserted order.

	* include/ruby/st.h (struct st_table): ditto.

Tue Aug 21 04:09:06 2007  Koichi Sasada  <ko1@atdot.net>

	* benchmark/bm_vm2_case.rb: add a new benchmark.
	  YARV optimize case/when syntax.  If every conditions
	  are literal (such as Symbol, Fixnum, String), dispatch
	  calc order will be O(1).

Tue Aug 21 04:08:07 2007  Koichi Sasada  <ko1@atdot.net>

	* test/ruby/test_enumerator.rb: fix last commit.

Tue Aug 21 03:59:32 2007  Koichi Sasada  <ko1@atdot.net>

	* test_enumerator.rb (enum_test): fix to return sorted
	  array (for Hash test).

Tue Aug 21 03:55:20 2007  Koichi Sasada  <ko1@atdot.net>

	* enumerator.c (next_i): fix to return with Fiber#yield at
	  the end of each block.  [ruby-dev:31470]

	* enumerator.c (enumerator_next_p): call init_next if not
	  initialized.  [ruby-dev:31514]

	* test/ruby/test_enumerator.rb: add tests for Enumerator.

Mon Aug 20 23:28:39 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* string.c (Init_String): remove Symbol.intern and Symbol#dump.
	  [ruby-dev:31525]

	* dir.c (dir_foreach): return Enumerator if no block given.
	  [ruby-dev:31525]

	* io.c (rb_io_s_foreach): argument count check before making
	  Enumerator.  [ruby-dev:31525]

Mon Aug 20 23:17:14 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* vm_core.h (struct rb_thread_struct): removed first_func_arg and
	  reuse first_args instead.

Sun Aug 19 13:31:40 2007  Tanaka Akira  <akr@fsij.org>

	* gc.c: use VALGRIND_MAKE_MEM_UNDEFINED to detect use of collected
	  objects if valgrind is available.  It cannot detect first 2 words
	  because they are used as the free list.

Sun Aug 19 13:13:52 2007  Koichi Sasada  <ko1@atdot.net>

	* compile.c (iseq_compile_each/NODE_RESBODY): fix to add
	  additional nop to prevent tailcall optimization.

	* vm_opts.h: clean up comments.

Sun Aug 19 12:58:39 2007  Koichi Sasada  <ko1@atdot.net>

	* insnhelper.ci (vm_call_bmethod): fix to propagate information
	  that this proc is "from Method".  [ruby-dev:31490]

	* proc.c (method_proc, rb_mod_define_method): ditto.

	* vm.c (vm_invoke_proc_core): removed.

	* vm_core.h: ditto.

Sun Aug 19 12:36:11 2007  Tanaka Akira  <akr@fsij.org>

	* test/ruby/sentence.rb: new method Sentence().

Sun Aug 19 12:32:39 2007  Koichi Sasada  <ko1@atdot.net>

	* insnhelper.ci (vm_callee_setup_arg): fix to mark enough VM stack.
	  [ruby-dev:31492]

Sat Aug 18 19:02:34 2007  Tanaka Akira  <akr@fsij.org>

	* test/ruby/test_yield.rb (TestYieldGen): relax array size check
	  in nested parameters.
	  [ruby-dev:31485]

Sat Aug 18 17:44:42 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* ext/tk/tcltklib.c (Init_tcltklib): use rb_set_end_proc().

Sat Aug 18 17:40:11 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* thread.c (is_ruby_native_thread): check properly.  [ruby-dev:31166]

Sat Aug 18 16:44:15 2007  Koichi Sasada  <ko1@atdot.net>

	* insnhelper.ci (vm_call_bmethod), 
	  vm.c (vm_invoke_proc_core): fix to do not restore
	  $SAFE when proc invoked by bmethod.

	* vm_core.h: ditto.

Sat Aug 18 16:44:49 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* eval_error.ci (ruby_error_print): call error_print.

	* eval_jump.ci, process.c (rb_exit, rb_f_exit, rb_f_abort): moved.

Sat Aug 18 15:59:52 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* process.c (detach_process_watcher): should not pass the pointer
	  to an auto variable to the thread to be created.  pointed and
	  fix by KUBO Takehiro <kubo at jiubao.org>  [ruby-dev:30618]

Sat Aug 18 15:52:50 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* insnhelper.ci (vm_send_optimize): use MEMMOVE to shift values inside
	  an array.

Sat Aug 18 15:45:34 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* insnhelper.ci (vm_yield_setup_args): rsize and psize should not be
	  negative.

Sat Aug 18 14:35:00 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* insnhelper.ci (vm_callee_setup_arg, vm_send_optimize,
	  vm_yield_setup_args): bulk copy for arguments.

Sat Aug 18 13:55:58 2007  Koichi Sasada  <ko1@atdot.net>

	* compile.c (iseq_compile_each): fix to allow self.x=
	  if x= is private.

	* bootstraptest/test_method.rb: add a test for above.

Sat Aug 18 14:05:34 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* parse.y (reg_compile_gen): obtain error info from errinfo.

	* re.c (rb_reg_error_desc): make RegexpError for initialization error.

	* re.c (rb_reg_compile): return nil and set errinfo if error.

Sat Aug 18 13:23:01 2007  Koichi Sasada  <ko1@atdot.net>

	* eval.c: $! should not be writable.

	* eval.c (rb_rubylevel_errinfo): added.  rb_errinfo() returns
	  rb_thread_t#errinfo.  rb_rubylevel_errinfo() returns $! value.

Sat Aug 18 13:14:40 2007  Koichi Sasada  <ko1@atdot.net>

	* insnhelper.ci (vm_callee_setup_arg): fix to check arguments
	  correctly. [ruby-dev:31472]

Sat Aug 18 13:13:06 2007  Koichi Sasada  <ko1@atdot.net>

	* bootstraptest/test_exception.rb: add escape character ("\") for
	  editors.

Sat Aug 18 12:42:50 2007  Tanaka Akira  <akr@fsij.org>

	* test/ruby/test_yield.rb (TestYieldGen): add test for yielding to
	  lambda using lambda parameter passing emulator.

Sat Aug 18 12:24:30 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* sample/test.rb, test/ruby/test_system.rb(valid_syntax?): keep
	  comment lines first.

Sat Aug 18 11:44:59 2007  Koichi Sasada  <ko1@atdot.net>

	* compile.c (iseq_set_arguments), insnhelper.ci
	  (vm_callee_setup_arg, vm_yield_setup_args): 
	  fix to cause raise on "lambda{|a|}.call(1, 2)".
	  [ruby-dev:31464]

	* bootstraptest/test_block.rb: add tests for above.

Sat Aug 18 01:12:01 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* eval.c (frame_func_id): return proper method ID.

Fri Aug 17 22:43:11 2007  Koichi Sasada  <ko1@atdot.net>

	* compile.c (iseq_compile_each): massign should return rvalue(s).

Fri Aug 17 22:10:19 2007  Koichi Sasada  <ko1@atdot.net>

	* test/ruby/test_basicinstructions.rb: fix old tests.
	  class variables should be inherited.

Fri Aug 17 21:20:44 2007  Koichi Sasada  <ko1@atdot.net>

	* eval.c (rb_call), eval_method.ci (rb_add_method, rb_alias),
	  insnhelper.ci (vm_call_method): fix to save safelevel for
	  method node.

	* include/ruby/node.h: ditto.

	* bootstraptest/test_method.rb: add a test for above.

Fri Aug 17 16:02:50 2007  Koichi Sasada  <ko1@atdot.net>

	* thread.c (rb_thread_terminate_all): fix to ignore
	  exceptions.

	* thread.c (thread_start_func_2): fix
	  abort_on_exception process.  [ruby-dev:31394]

Fri Aug 17 14:38:36 2007  Tanaka Akira  <akr@fsij.org>

	* bootstraptest/runner.rb (in_temporary_working_directory): use
	  Dir.mktmpdir to create and remove temporary directory.
	  (Dir.mktmpdir): define if not available.
	  [ruby-dev:31431]

Fri Aug 17 03:07:37 2007  Koichi Sasada  <ko1@atdot.net>

	* compile.c (iseq_compile_each): fix throw insn option of next.

Fri Aug 17 01:25:23 2007  Koichi Sasada  <ko1@atdot.net>

	* compile.c (iseq_set_arguments), insnhelper.ci
	  (vm_callee_setup_arg, vm_yield_setup_args): fix 
	  block parameter problems. [ruby-dev:31437], [ruby-dev:31440]

	* bootstraptest/test_block.rb: add a test of [ruby-dev:31440].

Fri Aug 17 01:24:12 2007  Koichi Sasada  <ko1@atdot.net>

	* iseq.c (ruby_iseq_disasm): fix to show arg_simple value.

Fri Aug 17 01:21:29 2007  Koichi Sasada  <ko1@atdot.net>

	* insns.def (throw): insert a RUBY_VM_CHECK_INTS(). [ruby-dev:31361]

Thu Aug 16 20:40:50 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* bignum.c (bigtrunc): RBIGNUM(x)->len may be zero.  out of bound
	  access.  [ruby-dev:31404]

	* sprintf.c (rb_str_format): small float should not call
	  rb_dbl2big(). 

Thu Aug 16 22:10:06 2007  Koichi Sasada  <ko1@atdot.net>

	* compile.c (iseq_compile_each): fix next/redo stack consistency.
	  [ruby-dev:31373]

	* bootstraptest/test_syntax.rb: add tests for above.

	* sample/test.rb: fix to use __FILE__ instead of $0 to know basedir.

Thu Aug 16 21:14:06 2007  WATANABE Hirofumi  <eban@ruby-lang.org>

	* configure.in (BASERUBY): need AC_SUBST.  [ruby-dev:31438]

Thu Aug 16 19:18:26 2007  Tanaka Akira  <akr@fsij.org>

	* test/ruby/sentence.rb: Sentence class implemented
	  based on sentgen.rb

	* test/ruby/sentgen.rb: removed.

	* test/ruby/test_assignment.rb: use sentence.rb.

	* test/ruby/test_yield.rb: block parameter passing emulator
	  implemented.

Thu Aug 16 16:48:47 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* configure.in (BASERUBY): check if base ruby is runnable first.
	  [ruby-core:11900]

Thu Aug 16 16:46:07 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* configure.in (aix): enable shared by default.

	* configure.in (aix): for 64bit-mode AIX.  [ruby-dev:31401]
	  + use CC for LDSHARED if non-gcc,
	  + moved -G option from *LDFLAGS to LDSHARED,
	  + set -brtl only in XLDFLAGS.

Thu Aug 16 13:06:08 2007  Tanaka Akira  <akr@fsij.org>

	* bignum.c (big_lshift): make shift offset long type.
	  (big_rshift): ditto.
	  (rb_big_lshift): ditto.
	  (big_rshift): ditto.
	  [ruby-dev:31434]

Thu Aug 16 06:29:08 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* io.c (argf_readpartial): argf_forward needs argc and argv.

Thu Aug 16 02:47:39 2007  Koichi Sasada  <ko1@atdot.net>

	* cont.c (rb_fiber_m_yield): added.  use this function
	  for Fiber#yield instead of rb_fiber_yield.

Thu Aug 16 00:36:52 2007  Tanaka Akira  <akr@fsij.org>

	* lib/tmpdir.rb (Dir.mktmpdir): new method.  [ruby-dev:31416]

Wed Aug 15 18:57:30 2007  Koichi Sasada  <ko1@atdot.net>

	* gc.c (os_live_obj): fix to skip T_VALUES.

	* sample/test.rb: add an ObjectSpace test.

Wed Aug 15 16:49:04 2007  Koichi Sasada  <ko1@atdot.net>

	* inits.c (rb_call_inits): change initializing order.
	  [ruby-dev:31420]

Wed Aug 15 16:44:15 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* io.c (ARGF_FORWARD): wrongly compares with current_file with
	  rb_stdout.  should be rb_stdin.  [ruby-cvs:20177]

Wed Aug 15 14:59:21 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* io.c (rb_io_initialize, argf_each_line, argf_each_byte): suppress
	  warnings.

Wed Aug 15 14:22:05 2007  Koichi Sasada  <ko1@atdot.net>

	* parse.y: remove "//" type comment.

Wed Aug 15 13:42:15 2007  Koichi Sasada  <ko1@atdot.net>

	* parse.y: fix rules around f_margs.  "make test" passes all tests.

	* bootstraptest/test_block.rb: add some tests for above.

Wed Aug 15 13:50:10 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* hash.c (rb_hash_delete_key): delete the entry without calling block.

	* hash.c (rb_hash_shift): should consider iter_lev too.

	* hash.c (delete_if_i): use rb_hash_delete_key() so that the block
	  isn't called twice.  [ruby-core:11556]

Wed Aug 15 13:39:25 2007  Koichi Sasada  <ko1@atdot.net>

	* process.c (proc_geteuid): fix strange conversion.  [ruby-dev:31417]

Wed Aug 15 01:05:55 2007  Tanaka Akira  <akr@fsij.org>

	* bootstraptest/runner.rb (assert_check): don't call newtest.
	  (assert_equal): call newtest.
	  (assert_match): ditto.

Tue Aug 14 21:43:39 2007  Tanaka Akira  <akr@fsij.org>

	* bootstraptest/runner.rb (assert_check): new method.
	  (assert_match): new method.
	  (assert_equal): use assert_check.
	  (pretty): give failure description as an argument.

	* bootstraptest/test_exception.rb: use assert_match to describe the
	  test for [ruby-dev:31407].  [ruby-dev:31412]

Tue Aug 14 19:53:15 2007  Koichi Sasada  <ko1@atdot.net>

	* proc.c (Init_Proc), eval.c (Init_eval), eval_intern.h: move
	  init place of exception_error.

	* inits.c: ditto.

	* eval.c (Init_eval): set exception_error#throwed_state as TAG_FATAL.
	  [ruby-dev:31407]

	* bootstraptest/test_exception.rb: add a test for above.

Tue Aug 14 19:51:20 2007  Koichi Sasada  <ko1@atdot.net>

	* common.mk: change test order (test -> btest).

Tue Aug 14 00:04:27 2007  Kouhei Sutou  <kou@cozmixng.org>

	* lib/rss/rss.rb: 0.1.8 -> 0.1.9.

	* test/rss/test_version.rb: followed the above change.

	* lib/rss/parser.rb: fixed a bug that handles unintended elements.
	  Thanks to Takuo Yonezawa. [ruby-list:43841]

Mon Aug 13 17:23:10 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* eval.c (rb_clear_trace_func, rb_thread_stop_timer_thread):
	  declarations for forward references.

	* eval.c (rb_longjmp, eval): use local variable.

	* eval.c (rb_longjmp): string object not to be optimized.

Mon Aug 13 13:21:58 2007  Tanaka Akira  <akr@fsij.org>

	* lib/open-uri.rb: make ftp passive mode to avoid NAT problem.
	  [ruby-dev:31377]

Mon Aug 13 09:18:05 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* ext/stringio/stringio.c (strio_getc): should returns
	  one-character string.

	* ext/stringio/stringio.c: remove unnecessary prototypes.

	* ext/stringio/stringio.c (strio_getbyte): new method.

	* ext/stringio/stringio.c (strio_readbyte): new method.

	* ext/stringio/stringio.c (strio_ungetc): should take a string as
	  an input.

Mon Aug 13 08:19:43 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* io.c (argf_close): always close via method.

	* io.c (Init_IO): remove obsolete Kernel#getc.

Mon Aug 13 05:03:53 2007  Koichi Sasada  <ko1@atdot.net>

	* thread.c (rb_thread_raise): check if target thread is
	  thrown by another thread or not.  [ruby-dev:31371]

	* bootstraptest/test_thread.rb: add a test for above.

Mon Aug 13 04:35:30 2007  Koichi Sasada  <ko1@atdot.net>

	* compile.c (iseq_peephole_optimize): fix peephole optimization
	  bug. [ruby-dev:31360]

	* bootstraptest/test_syntax.rb: add a test for above.

Mon Aug 13 04:02:29 2007  Koichi Sasada  <ko1@atdot.net>

	* vm_dump.c (debug_print_pre): fix to show control frame count.

	* insns.def (opt_call_c_function): fix operand type.

	* lib/vm/instruction.rb: ditto.

	* insnhelper.ci (vm_push_frame, vm_pop_frame): fix to show
	  control stack status on if VMDEBUG == 2.

	* vm.h: add a comment about VMDEBUG.

	* iseq.c (find_prev_line_no): fix to skip bug report if
	  line is not found.

	* lib/vm/instruction.rb: fix to use build_string() on
	  source code generators.

Mon Aug 13 03:57:32 2007  Koichi Sasada  <ko1@atdot.net>

	* template/yasmdata.rb.tmpl: fix type and name.

Sat Aug 11 23:27:37 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* io.c (argf_each_line): should use #each_line, not #each.

	* io.c (argf_each_line): simplified.

	* io.c (argf_getline): should handle non T_FILE object in ARGV.

	* io.c (argf_each_byte): each_byte should yield bytes not
	  one-character strings.  [ruby-dev:31374]

Sat Aug 11 07:24:55 2007  Tadayoshi Funaba  <tadf@dotrb.org>

	* lib/date/format.rb: reverted some wrongly erased "o" options
	  (pointed out by nobu).

Sat Aug 11 00:01:12 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* thread.c (thread_start_func_2): not re-raise to main thread if it is
	  joining the current thread.

Fri Aug 10 23:54:46 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* thread.c (thread_create_core): inherit the priority of creating
	  thread.  submitted at [ruby-core:11873] by David Flanagan <david AT
	  davidflanagan.com>.  [ruby-core:11876]

Fri Aug 10 05:12:19 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* thread.c (thread_start_func_2): let abort_on_exception work.
	  [ruby-core:11873]

Fri Aug 10 04:47:09 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* parse.y (internal_id_gen): internal ID must be bigger than
	  tLAST_TOKEN.

Thu Aug  9 16:04:55 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* parse.y (stmt): check if rhs has value before assignment instead
	  inside node_assign_gen().  [ruby-dev:31293]

	* parse.y (call_bin_op_gen, call_uni_op_gen): split call_op_gen.

Thu Aug  9 14:01:36 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* parse.y (f_marg_list): renamed from f_marg_head.

	* parse.y (f_margs): allow multiple mandatory arguments after a splat.
	  [ruby-dev:31153]

Thu Aug  9 02:02:02 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* enum.c (enum_cycle): typo fixed.  a patch from Kazuhiro
	  NISHIYAMA <zn AT mbf.nifty.com>.  [ruby-dev:31362]

Wed Aug  8 19:17:40 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* ext/dl/cptr.c (rb_dlptr_s_to_ptr): no longer check
	  HAVE_RB_IO_STDIO_FILE. 

Wed Aug  8 15:52:01 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* enumerator.c (enumerator_next_p): should check correctly even when
	  e.next has not been called before.

	* enumerator.c (enumerator_next): raise StopIteration (name taken
	  from Python) instead of IndexError.

	* enum.c (enum_zip): catch StopIteration exception.

	* enumerator.c (enumerator_with_index): return Enumerator if no
	  block is given.

	* test/ruby/test_iterator.rb (TestIterator::test_enumerator): add
	  test for enumerators.

Wed Aug  8 11:48:37 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* bignum.c (rb_big2str0): should not use RTEST for non-VALUE.

Wed Aug  8 11:25:25 2007  NAKAMURA Usaku  <usa@ruby-lang.org>

	* bignum.c (rb_big2str0): should preserve sign mark.

Wed Aug  8 11:02:43 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* common.mk (btest-miniruby, test-sample): split the test target
	  so that -k option works.

Tue Aug  7 14:58:39 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* ext/pty/pty.c (establishShell): handshaking before close slave
	  device.  [ruby-talk:263410]

	* ext/pty/pty.c (MasterDevice, SlaveDevice, deviceNo): constified.

	* ext/pty/pty.c (SlaveName): removed static buffer.

	* ext/pty/expect_sample.rb: support for autologin.

Tue Aug  7 13:58:03 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* include/ruby/ruby.h (ruby_special_consts): added RUBY_SPECIAL_SHIFT.

	* .gdbinit: some improvements.

Tue Aug  7 13:28:32 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* common.mk (node_name.inc): use $? instead of $< for nmake.
	  [ruby-dev:31356]

Tue Aug  7 12:45:13 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* configure.in (ac_cv_func_isinf): set yes also on OpenSolaris.
	  [ruby-Bugs-12859]

Tue Aug  7 12:31:51 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* io.c (pipe_open): fix for win32 platforms.

Tue Aug  7 02:58:33 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* bignum.c (rb_big2str0): make Bignum#to_s even faster.  a patch
	  from Kenta Murata <muraken AT gmail.com>.  [ruby-dev:31354]

Tue Aug  7 01:42:05 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* enum.c (enum_zip): zip no longer converts arguments into
	  arrays, uses enumerators. 

Tue Aug  7 01:27:47 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* cont.c (rb_fiber_yield): change argument ordering.  export.

	* cont.c (rb_fiber_current): export

	* include/ruby/intern.h: export several functions from cont.c.

	* enumerator.c (enumerator_next): new method to implement external
	  iterator (generator) using fiber.

	* enumerator.c (enumerator_next_p): new method to check whether
	  any element is left in the generator sequence.

	* enumerator.c (enumerator_rewind): a new method to rewind the
	  generator sequence.

Tue Aug  7 01:15:24 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* enum.c (enum_cycle): new method to cycle enumerable forever.

Tue Aug  7 00:05:38 2007  Keiju Ishitsuka  <keiju@ruby-lang.org>

	* irb/ruby-lex.rb: support for '\c'. [ruby-talk:263508]

Mon Aug  6 20:29:22 2007  Koichi Sasada  <ko1@atdot.net>

	* insnhelper.ci, insns.def: move some statements to functions.

	* vm.c, vm.h, vm_evalbody.ci: fix include/typedef places.

Mon Aug  6 18:41:12 2007  Koichi Sasada  <ko1@atdot.net>

	* lib/vm/instruction.rb (make_header_analysys): fix last commit.

Mon Aug  6 18:33:22 2007  Koichi Sasada  <ko1@atdot.net>

	* lib/vm/instruction.rb (make_header_analysys): add to separate
	  header addition process.

Mon Aug  6 17:36:29 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* lib/rexml/encodings/{ISO-8859-15,CP-1252}.rb: fixed invalid syntax.

Mon Aug  6 16:57:08 2007  Koichi Sasada  <ko1@atdot.net>

	* sample/test.rb: fix to output file name if it contains
	  invalid syntax.

Mon Aug  6 16:41:22 2007  Koichi Sasada  <ko1@atdot.net>

	* parse.y (value_expr_gen): fix to cause "void value expression"
	  when jump expression such as "next" are shown on value_expr().
	  [ruby-dev:31119]

	* bootstraptest/test_syntax.rb: fix to above change.

Mon Aug  6 14:36:30 2007  Koichi Sasada  <ko1@atdot.net>

	* parse.y: fix a f_marg rule. [ruby-dev:31160]

Mon Aug  6 14:29:30 2007  Koichi Sasada  <ko1@atdot.net>

	* bootstraptest/runner.rb (assert_equal): add additional
	  message parameter.

Mon Aug  6 13:34:09 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* common.mk (INSNS): not chdir to srcdir.

	* common.mk (node_name.inc): auto-generate node name list.

	* iseq.c (ruby_node_name): ditto.

	* iseq.c (iseq_s_compile_option_get, Init_ISeq): added a new
	  method VM::InstructionSequence::compile_option.

	* lib/vm/instruction.rb (RubyVM::SourceCodeGenerator): --destdir
	  option.

	* tool/node_name.rb: to auto-generate node name list.

Sun Aug  5 11:51:39 2007  Kouhei Sutou  <kou@cozmixng.org>

	* lib/rss, sample/rss, test/rss:
	- 0.1.7 -> 0.1.8.
	- supported <itunes:XXX>.
	- reverted backward incompatibility API changes introduced 0.1.7.

Sun Aug  5 04:56:25 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* io.c (pipe_open_v, pipe_open_s): separate array and string
	  cases.  [ruby-dev:31344]

Fri Aug  3 11:05:54 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* ext/extmk.rb (extmake): save all CONFIG values.

	* ext/extmk.rb (extmake): remove mkmf.log at clean, and extconf.h at
	  distclean, respectively.

	* ext/extmk.rb: remove rdoc at clean, and installed list file at
	  distclean, respectively.

Fri Aug  3 07:09:05 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* lib/mkmf.rb: more verbose message.  [ruby-Bugs-12766]

	* lib/mkmf.rb (have_type): suppress a warning with -Wall.

	* lib/mkmf.rb (find_type): new method.

Fri Aug  3 00:00:20 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* bignum.c (big2str_table): base cannot be 0 or 1.

Thu Aug  2 23:42:57 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* parse.y (reg_compile_gen): set error if failed to compile regexp
	  literal.  [ruby-dev:31336]

	* re.c (option_to_str, arg_kcode, opt_kcode): options conversion
	  between int and string.

	* re.c (rb_reg_compile): should not use regexp which could not get
	  initialized.  [ruby-dev:31333]
	  return error message to let the parser know it.

	* re.c (rb_reg_compile): append regexp options to error message.
	  [ruby-dev:31334]

Thu Aug  2 22:05:32 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* bignum.c (rb_big2str0): faster Bignum#to_s using Karatsuba
	  algorithm.  a patch from Yusuke ENDOH <mame AT tsg.ne.jp>
	  in [ruby-dev:31312], slightly modified by Kenta Murata
	  <muraken AT gmail.com> in [ruby-dev:31339].

Thu Aug  2 13:46:39 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* sprintf.c (rb_f_sprintf): should not check positional number as
	  width.  [ruby-core:11838]

Wed Aug  1 12:40:05 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* generic.rb (URI::Generic::merge_path): behave as RFC 3986.
	  [ruby-talk:252052]

Tue Jul 31 23:38:09 2007  Tadayoshi Funaba  <tadf@dotrb.org>

	* lib/date/format.rb (_parse): now interprets slashed numerical
	  dates as a big endian (except dd/mm/yyyy). [experimental]

Mon Jul 30 11:16:40 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* bignum.c (rb_big_aref): check for Bignum index range.
	  [ruby-dev:31271]

Sat Jul 28 09:35:41 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* ext/digest/lib/digest.rb (Digest::self.const_missing): avoid
	  infinite recursive const_missing call.  [ruby-talk:262193]

Thu Jul 26 20:40:25 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* range.c (range_eqq): call_super() in === does not work well
	  since Enumerable#=== has different behavior.  [ruby-dev:31296]

Thu Jul 26 13:57:45 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* dln.c (load_1, dln_find_1): constified.

	* dln.c (conv_to_posix_path): removed.

	* ruby.c (usage): constified.

	* ruby.c (rubylib_mangled_path, rubylib_mangled_path2): return
	  VALUE instead of a pointer to static buffer.

	* ruby.c (push_include_cygwin): fixed buffer overflow.
	  [ruby-dev:31297]

	* ruby.c (ruby_init_loadpath): not convert built-in paths.

Tue Jul 24 10:37:04 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* io.c (rb_f_p): return nil if no argument.  [ruby-dev:31285]

Tue Jul 24 01:05:07 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* regint.h (USE_MATCH_RANGE_IS_COMPLETE_RANGE): undef to achieve old
	  rindex behavior.  [ruby-dev:31265]

Mon Jul 23 18:37:14 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* include/ruby/oniguruma.h: upgrade to Oniguruma 5.9.0.  fixes
	  some memory violation.  [ruby-dev:31070]

Sun Jul 22 20:09:49 2007  Tadayoshi Funaba  <tadf@dotrb.org>

	* lib/date/format.rb (Date._parse): now accepts some new
	  hints. [experimental]

	* lib/parsedate.rb: followed the changes on
	  lib/date/format.rb. [experimental]

Sun Jul 22 16:06:56 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* thread.c (is_ruby_native_thread): made an int function as
	  well as version 1.8.

	* include/ruby/ruby.h (is_ruby_native_thread): moved prototype
	  from intern.h as well as version 1.8.

Sun Jul 22 14:33:46 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* file.c (rb_file_s_rename): deleted code to get rid of a bug of
	  old Cygwin.

	* file.c (rb_file_truncate): added prototype of GetLastError()
	  on cygwin.  [ruby-dev:31239]

	* include/ruby/intern.h (is_ruby_native_thread): prototype.

	* missing/strftime.c (strftime): fix printf format and actual
	  arguments.

	* ext/Win32API/Win32API.c (Win32API_initialize): ditto.

	* ext/tk/tcltklib.c (ip_finalize): ditto.

	* ext/win32ole/win32ole.c (lcid_installed): ditto.

	* ext/socket/getnameinfo.c: include stdio.h always.

Sat Jul 21 21:39:12 2007  Tadayoshi Funaba  <tadf@dotrb.org>

	* lib/date.rb, lib/date/format.rb (Date._parse): now can take some
	  hints (its aim must be mainly determination of endianness of
	  date). [experimental]

	* lib/date.rb, lib/date/format.rb (Date._parse): now completes
	  truncated year as default action. [experimental]

	* lib/date.rb, lib/date/format.rb: added ::iso8601, ::rfc3339,
	  ::xmlschema, ::rfc2822, ::httpdate, ::jisx0301, #xmlschema,
	  #httpdate. [experimental]

Sat Jul 21 17:48:26 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* common.mk: inverted rules order.

	* thread_win32.ci (w32_create_thread): bcc does not have
	  _beginthreadex().

	* lib/mkmf.rb (create_makefile): make OBJS depend on RUBY_EXTCONF_H
	  only if extconf.h is created.

	* bcc32/Makefile.sub: headers have moved.

	* bcc32/{Makefile.sub,configure.bat,setup.mak: configure_args
	  support.

	* bcc32/setup.mak: check runtime version.

	* win32/win32.c (rb_w32_open_osfhandle): prototype has changed
	  in bcc 5.82.

	* {win32,wince,bcc32}/setup.mak (-version-): no RUBY_EXTERN magic.

	* win32/resource.rb: include patchlevel number.

Sat Jul 21 12:06:48 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* lib/mkmf.rb (init_mkmf): should remove mkmf.log too.

Sat Jul 21 01:45:03 2007  Tadayoshi Funaba  <tadf@dotrb.org>

	* lib/date/format.rb (Date._parse): completes calendar week based year.

	* lib/date/format.rb (Date._parse): detects year of ordinal date in
	  extended format.

Fri Jul 20 16:30:31 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* compile.c (iseq_set_sequence): raise SyntaxError instead of rb_bug
	  since this function can be called from VM::InstructionSequence.load.

	* compile.c (insn_set_sc_state, iseq_set_sequence_stackcaching): ditto.

Fri Jul 20 16:11:33 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* compile.c, compile.h (DECL_ANCHOR, INIT_ANCHOR): split not to
	  initialize aggregations with dynamic values.  [ruby-talk:259306]

	* eval.c (rb_protect): not to initialize aggregations with dynamic
	  values.  [ruby-talk:259306]

	* gc.c (mark_current_machine_context): ditto.

	* thread.c (thgroup_list, call_trace_func): ditto.

	* vm.c (vm_init_redefined_flag): ditto.

Fri Jul 20 15:22:51 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* ext/openssl/ossl_config.c (ossl_config_set_section): do not
	  initialize aggregations with dynamic values.  [ruby-talk:259306]

Fri Jul 20 10:39:28 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* parse.y (stmt, mlhs_node, lhs, arg, var_ref): return dummy
	  NODE_BEGIN after errors.  [ruby-dev:31100], [ruby-dev:31118]

	* parse.y (remove_begin): keep empty NODE_BEGIN, instead of null.
	  [ruby-dev:31252], [ruby-dev:31263]

Fri Jul 20 09:50:40 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* bootstraptest/runner.rb (get_result_string): check $?.coredump?
	  first.

	* bootstraptest/runner.rb (cleanup_coredump, check_coredump): see
	  stackdump file too.

Thu Jul 19 20:39:30 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* parse.y (value_expr_gen): warn for empty expression ().
	  [ruby-dev:31252]

Thu Jul 19 19:24:14 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* eval_error.ci (get_backtrace): check the result more.
	  [ruby-dev:31261] [ruby-bugs-12398]

Thu Jul 19 14:38:45 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* bignum.c (rb_big_lshift, rb_big_rshift): separated functions
	  to get rid of infinite recursion.  fixed calculation in edge
	  cases.  [ruby-dev:31244]

	* numeric.c (rb_fix_lshift, rb_fix_rshift): ditto.

Wed Jul 18 16:57:41 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* bignum.c (rb_big_pow): refine overflow check.  [ruby-dev:31242]

Wed Jul 18 09:19:07 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* parse.y (rb_parser_append_print, rb_parser_while_loop): moved check
	  for node to the head.

	* ruby.c (proc_options): do nothing for -p/-n options if tree is null.
	  submitted by Yusuke ENDOH <mame AT tsg.ne.jp> at [ruby-dev:31243].

Wed Jul 18 08:47:09 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* time.c (time_succ): Time#succ should return a time object in the
	  same timezone mode to the original.  [ruby-talk:260256]

Mon Jul 16 23:07:51 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* lib/base64.rb (Base64::b64encode): should not specify /o option
	  for regular expression.  [ruby-dev:31221]

Mon Jul 16 22:57:53 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* sprintf.c (rb_str_format): make %u behave like %d for negative
	  values, since decimal format does not work with preceding dots.
	  [ruby-core:11575]

Mon Jul 16 18:29:33 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* string.c (rb_str_rindex_m): accept string-like object convertible
	  with #to_str method, as well as rb_str_index_m.  [ruby-core:11692]

Mon Jul 16 07:17:28 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* insns.def (getspecial): lfp_svar_get() requires int for special
	  global variables.

Mon Jul 16 05:45:53 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* sprintf.c (rb_f_sprintf): more checks for format argument.
	  [ruby-core:11569], [ruby-core:11570], [ruby-core:11571],
	  [ruby-core:11573]

Mon Jul 16 00:26:10 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* bignum.c (rb_big_pow): removed invariant variable.  [ruby-dev:31236]

Sun Jul 15 22:24:37 2007  pegacorn  <subscriber.jp AT gmail.com>

	* ext/dl/cfunc.c (rb_dlcfunc_call): adjust format.  [ruby-dev:31222]

	* ext/digest/digest.c (rb_digest_instance_update,
	  rb_digest_instance_finish, rb_digest_instance_reset,
	  rb_digest_instance_block_length): %s in rb_raise() expects char*.
	  [ruby-dev:31222]

	* ext/openssl/ossl.h: include ossl_pkcs5.h.  [ruby-dev:31231]

	* ext/openssl/ossl_pkcs5.h: new file for PKCS5.  [ruby-dev:31231]

	* ext/openssl/ossl_x509name.c (ossl_x509name_to_s): use ossl_raise()
	  instead of rb_raise().  [ruby-dev:31222]

	* ext/sdbm/_sdbm.c: DOSISH platforms need io.h.  [ruby-dev:31232]

	* ext/syck/syck.h: include stdlib.h for malloc() and free().
	  [ruby-dev:31232]

	* ext/syck/syck.h (syck_parser_set_input_type): prototype added.
	  [ruby-dev:31231]

	* win32/win32.c: include mbstring.h for _mbspbrk().  [ruby-dev:31232]

	* include/ruby/win32.h (rb_w32_getcwd): prototype added.
	  [ruby-dev:31232]

Sun Jul 15 21:07:43 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* bignum.c (bigtrunc): do not empty Bignum.  [ruby-dev:31229]

Sun Jul 15 19:05:28 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* bignum.c (rb_cstr_to_inum): check leading non-digits.
	  [ruby-core:11691]

Sun Jul 15 04:42:20 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* bignum.c (get2comp): do nothing for empty Bignum.  [ruby-dev:31225]

Sat Jul 14 22:49:30 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* numeric.c (fix_pow): integer power calculation: 0**n => 0,
	  1**n => 1, -1**n => 1 (n: even) / -1 (n: odd).

	* test/ruby/test_fixnum.rb (TestFixnum::test_pow): update test
	  suite.  pow(-3, 2^64) gives NaN when pow(3, 2^64) gives Inf.

Sat Jul 14 18:46:35 2007  Tanaka Akira  <akr@fsij.org>

	* configure.in: add --with-valgrind.

	* gc.h (SET_MACHINE_STACK_END): new macro to replace
	  rb_gc_set_stack_end.  it find out accurate stack boundary by
	  asm using gcc on x86.

	* thread.c (rb_gc_set_stack_end): don't define if asm-version
	  SET_MACHINE_STACK_END is available.

	* gc.c (mark_current_machine_context): extracted from garbage_collect.
	  it use SET_MACHINE_STACK_END to not scan out of stack area.
	  it notify conservative GC information to valgrind if
	  --with-valgrind.

Sat Jul 14 14:04:06 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* enum.c (sort_by_cmp): check if reentered.  [ruby-dev:24291]

Sat Jul 14 11:08:28 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* ext/json/ext/generator/generator.c (check_max_nesting): wrong
	  format specifier.  a patch from pegacorn <subscriber.jp AT gmail.com>.
	  [ruby-dev:31217]

Sat Jul 14 02:27:43 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* numeric.c (int_pow): overflow detection using FIT_SQRT_LONG().
	  [ruby-dev:31215]

Sat Jul 14 02:05:53 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* insns.def (opt_div): LONG2FIX() may not work for corner cases,
	  use LONG2NUM() instead.  [ruby-dev:31210]

Sat Jul 14 00:34:01 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* numeric.c (int_round): should not return false, but self.
	  [ruby-dev:31212]

Fri Jul 13 18:31:27 2007  Koichi Sasada  <ko1@atdot.net>

	* include/ruby/intern.h: remove unused function declarations.

	* include/ruby/ruby.h: ditto.

Fri Jul 13 17:32:37 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* vm.c (vm_free): clear free'ed living_threads field.
	  [ruby-dev:31163]

	* insns.def (opt_succ): use cast to shut a warning up.

Fri Jul 13 16:10:00 2007  Tanaka Akira  <akr@fsij.org>

	* lib/open-uri.rb (URI::Generic#find_proxy): use ENV.to_hash to access
	  http_proxy environment variable to avoid case insensitive
	  environment search.

Fri Jul 13 15:02:15 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* win32/win32.c (CreateChild): enclose command line except for
	  command.com which can not handle quotes.  [ruby-talk:258939]

Fri Jul 13 11:33:09 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* range.c (range_max, range_min): return nil for empty set as well as
	  1.8 and Enumerable.  [ruby-dev:31198]

Fri Jul 13 11:28:37 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* parse.y (bvar): semicolon was lost for ripper description.
	  [ruby-dev:31140]

Fri Jul 13 11:25:10 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* parse.y (program, stmt, primary): reduced duplicated code.

	* parse.y (dsym): convert also literals containing NUL to
	  symbol.

	* parse.y (debug_lines): use rb_hash_lookup() to get rid of
	  call of Hash#default.

	* parse.y (ripper_warningS): unused in ripper right now.

Fri Jul 13 10:33:29 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* array.c (rb_ary_flatten_bang): check argument if valid
	  integer.  [ruby-dev:31197]

Fri Jul 13 10:10:46 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* lib/mkmf.rb (link_command, cc_command, cpp_command): do not expand
	  ::CONFIG which is an alias of MAKEFILE_CONFIG.

Thu Jul 12 21:38:02 2007  NAKAMURA Usaku  <usa@ruby-lang.org>

	* insns.def (opt_succ): use LONG_MAX as maximum Fixnum VALUE.
	  [ruby-dev:31199]

Thu Jul 12 18:42:18 2007  Tanaka Akira  <akr@fsij.org>

	* range.c (range_max): use FIX2LONG instead of FIX2INT to avoid
	  RangeError by ((-0x80000001)...(-0x80000001)).max on LP64.

	* insns.def (opt_plus): use FIX2LONG instead of FIX2INT to avoid
	  RangeError by 0x3fffffffffffffff+1 on LP64.

	* insns.def (opt_succ): don't use 0x80000000 which assumes 32bit VALUE.
	  use FIX2LONG instead of FIX2INT.
	  [ruby-dev:31190]

Thu Jul 12 17:03:15 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* struct.c (rb_struct_init_copy): disallow changing the size.
	  [ruby-dev:31168]

Thu Jul 12 12:58:21 2007  Koichi Sasada  <ko1@atdot.net>

	* blockinlining.c: remove "yarv" prefix.

	* array.c, numeric.c: ditto.

	* insnhelper.ci, insns.def, vm_evalbody.ci: ditto.

	* yarvcore.c: removed.

	* yarvcore.h: renamed to core.h.

	* cont.c, debug.c, error.c, process.c, signal.c : ditto.

	* ext/probeprofiler/probeprofiler.c: ditto.

	* id.c, id.h: added.

	* inits.c: ditto.

	* compile.c: rename internal functions.

	* compile.h: fix debug flag.

	* eval.c, object.c, vm.c: remove ruby_top_self.
	  use rb_vm_top_self() instead.

	* eval_intern.h, eval_load: ditto.

	* gc.c: rename yarv_machine_stack_mark() to
	  rb_gc_mark_machine_stack().

	* insnhelper.h: remove unused macros.

	* iseq.c: add iseq_compile() to create iseq object
	  from source string.

	* proc.c: rename a internal function.

	* template/insns.inc.tmpl: remove YARV prefix.

	* thread.c: use rb_iseq_eval() and rb_str_new2().

	* vm.c (rb_iseq_eval): added.

	* vm.c: move some functions from yarvcore.c.

	* vm_dump.c: fix to remove compiler warning.

Thu Jul 12 12:24:29 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* insns.def (opt_succ): fixed typo.  [ruby-dev:31189]

Thu Jul 12 10:30:46 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* thread.c (thread_start_func_2): moved prototye from thread_*.ci.

	* thread_pthread.ci (thread_start_func_2): not use a directive
	  inside a macro argument.  [ruby-talk:258763]

	* thread.c (thread_join): pthread_t may not be pointer.

	* thread_pthread.ci (ubf_select_each): ditto.

Thu Jul 12 05:32:28 2007  NAKAMURA Usaku  <usa@ruby-lang.org>

	* include/ruby/ruby.h (FIX2ULONG): drop sign bit for LLP64 platform.

Tue Jul 10 19:34:45 2007  Koichi Sasada  <ko1@atdot.net>

	* hash.c (rb_hash_lookup): added.  this function is similar to
	  rb_hash_aref(), but doesn't call Hash#default when no entry
	  exists.

	* include/ruby/intern.h: ditto.

	* insnhelper.ci (lfp_svar_get): use rb_hash_lookup().

Tue Jul 10 19:16:28 2007  Koichi Sasada  <ko1@atdot.net>

	* eval.c, insnhelper.ci, vm.c: change cref index (-1 -> 2).

Tue Jul 10 18:49:56 2007  Koichi Sasada  <ko1@atdot.net>

	* eval.c (exec_under): add proper casts.

Tue Jul 10 16:58:16 2007  Koichi Sasada  <ko1@atdot.net>

	* vm.c, insnhelper.ci: fix svar interface.

	* compile.c (iseq_compile_each), yarvcore.h: fix to use new
	  svar interface for flip flop.

	* eval.c: ditto.

	* insns.def: ditto.

	* include/ruby/intern.h: remove "rb_svar()" declaration.

Tue Jul 10 16:52:01 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* compile.c (rb_iseq_compile): formatted if/else to switch statement.

Tue Jul 10 15:57:53 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* bootstraptest/test_flip.rb: new test for flip-flop operator.

Tue Jul 10 14:50:01 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* bcc32/{Makefile.sub,setup.mak}: remove surplus slash from srcdir.

Mon Jul  9 02:17:36 2007  NAKAMURA Usaku  <usa@ruby-lang.org>

	* cont.c (cont_restore_1): workaround for x64-mswin64's SEH.

Sun Jul  8 02:08:53 2007  NARUSE, Yui  <naruse@ruby-lang.org>

	* lib/json.rb, lib/json/, ext/json/: import JSON 1.1.1

Sat Jul  7 21:59:29 2007  Tanaka Akira  <akr@fsij.org>

	* lib/pp.rb (PP::PPMethods#pp_hash): sort condition changed:
	  all keys have a same class which is kind of Comparable.

Sat Jul  7 17:12:37 2007  Koichi Sasada  <ko1@atdot.net>

	* compile.c: use rb_bug() instead of rb_compile_error().

Sat Jul  7 16:12:48 2007  Koichi Sasada  <ko1@atdot.net>

	* parse.y: fix node construction (around f_margs).
	  [ruby-dev:31143]

	* bootstraptest/test_block.rb: add a test for above.

	* insnhelper.ci: fix indent.

Sat Jul  7 15:36:50 2007  Tanaka Akira  <akr@fsij.org>

	* lib/pp.rb (PP::PPMethods#pp_hash): sort if
	  all keys are strings, symbols or integers.

Sat Jul  7 15:30:05 2007  Koichi Sasada  <ko1@atdot.net>

	* insnhelper.ci (vm_yield_setup_args), vm.c, insns.def:
	  fix to pass nil as block parameter to yielded block.
	  [ruby-dev:31147]

	* bootstraptest/test_block.rb: add a test for above.

Fri Jul  6 19:55:10 2007  Keiju Ishitsuka  <keiju@ruby-lang.org>

	* lib/irb.rb: typo. Thanks, Giles Bowkett.

	* lib/irb/completion.rb: support Ruby1.9 changing return value
	  String to Symbol for Object#methods, etc. [ruby-dev:31148].

Fri Jul  6 18:20:50 2007  Koichi Sasada  <ko1@atdot.net>

	* bootstraptest/runner.rb: fix load path.

	* common.mk: fix "test" rule to run with "btest".

	* rubytest.rb, sample/test.rb: fix to show tests progress.

Fri Jul  6 15:37:48 2007  Koichi Sasada  <ko1@atdot.net>

	* test/ruby/test_iterator.rb: fix test to 1.9 spec.

Fri Jul  6 15:21:25 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* eval.c (rb_interrupt): suppress a gcc's officious warning.

Fri Jul  6 14:57:12 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* parse.y (keyword_to_name): constified.

	* ext/ripper/eventids2.c (token_to_eventid): ditto.

Fri Jul  6 14:50:40 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* bootstraptest/runner.rb: added --quiet option.

Fri Jul  6 14:35:25 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* parse.y (f_marg): wrap f_norm_arg assignment node with NODE_LIST.
	  [ruby-dev:31141]

Fri Jul  6 12:15:01 2007  Tanaka Akira  <akr@fsij.org>

	* test/ruby/sentgen.rb: new file.

	* test/ruby/test_assignment.rb: tests implemented using assignment
	  generator and emulator.

Fri Jul  6 03:06:58 2007  Koichi Sasada  <ko1@atdot.net>

	* insns.def: remove unused code.

	* compile.c (compile_massign): fix to invoke to_splat on
	  splat rhs (example: *a = *nil). [ruby-dev:31136]

	* bootstraptest/test_massign.rb: add tests for above.

	* compile.c (iseq_compile_each): disable excess optimization.
	  [ruby-dev:31126]

Fri Jul  6 02:08:25 2007  Koichi Sasada  <ko1@atdot.net>

	* insns.def: fix to invoke nil.to_splat on NODE_ARGSCAT.
	  [ruby-dev:31138].

	* bootstraptest/test_literal.rb: add tests for above.

Thu Jul  5 19:45:55 2007  Koichi Sasada  <ko1@atdot.net>

	* yarvcore.h: rename rb_control_frame_t#magic to flag.

	* vm.h: add VM_FRAME_TYPE() and VM_FRAME_FLAG().

	* cont.c, insnhelper.ci, insns.def, vm.c, vm_dump.c,
	  vm_evalbody.ci, yarvcore.c: apply above changes.

Thu Jul  5 19:16:14 2007  Koichi Sasada  <ko1@atdot.net>

	* test/ruby/test_basicinstructions.rb: remove an assertion using
	  unsupported hash literal (such as {1, 2}).

	* test/ruby/test_hash.rb: ditto.

Thu Jul  5 19:12:22 2007  NAKAMURA Usaku  <usa@ruby-lang.org>

	* ruby.c: Qfalse is VALUE, not pointer.

Thu Jul  5 18:42:01 2007  Koichi Sasada  <ko1@atdot.net>

	* compile.c (iseq_compile_each): add break catch point.

	* insns.def (throw): support correct "break" and "return".
	  this commit achieve that "make test" passes all tests.

	* vm.c: ditto.

Thu Jul  5 18:44:12 2007  Tanaka Akira  <akr@fsij.org>

	* parse.y (mlhs_basic): use mlhs_post after tSTAR.
	  [ruby-dev:31109]

Thu Jul  5 18:27:58 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* include/ruby/{intern,ruby}.h, compile.[ch], error.c, eval.c,
	  eval_load.c, gc.c, iseq.c, main.c, parse.y, re.c, ruby.c,
	  yarvcore.[ch] (ruby_eval_tree, ruby_sourcefile, ruby_sourceline,
	  ruby_nerrs): purge global variables.

	* ruby.c (proc_options): moved do_print and do_loop options
	  handling from ruby_process_options().

Thu Jul  5 16:37:34 2007  NAKAMURA Usaku  <usa@ruby-lang.org>

	* numeric.c (int_pow): fix previous nubu's commit.

	* test/ruby/test_fixnum.rb: new test.

Thu Jul  5 15:56:06 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* numeric.c (int_pow): even number multiplication never be negative.

Thu Jul  5 10:42:07 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* include/ruby/{node,ruby}.h, ruby.c: added enum constants for gdb
	  support.  [ruby-dev:31066]

	* .gdbinit: some improvements.

Thu Jul  5 10:13:08 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* parse.y (global_symbols.last_id): reduce unused ID numbers.

	* include/ruby/st.h, st.c (st_init_table, st_init_table_with_size):
	  constified.

Wed Jul  4 23:36:27 2007  NAKAMURA, Hiroshi  <nahi@ruby-lang.org>

	* lib/webrick/httpauth/authenticator.rb
	  (WEBrick::HTTPAuth::Authenticator#check_scheme): auth-scheme must be
	  treated as a case-insensitive token according to RFC 2617 section 1.2.

Wed Jul  4 18:30:04 2007  Tanaka Akira  <akr@fsij.org>

	* parse.y (mlhs_inner): new rule.  [ruby-dev:31132]

Wed Jul  4 05:11:57 2007  Koichi Sasada  <ko1@atdot.net>

	* iseq.c (set_relation): added.

Wed Jul  4 04:58:30 2007  Koichi Sasada  <ko1@atdot.net>

	* insnhelper.ci (caller_setup_args): fix to show correct class
	  on an error message (ex: m(&1)). [ruby-dev:31101]

Wed Jul  4 04:30:32 2007  Koichi Sasada  <ko1@atdot.net>

	* compile.c (compile_array, iseq_compile_each): fix about array
	  generation in void context. [ruby-dev:31102]

	* bootstraptest/test_literal.rb: add a test for above.

Wed Jul  4 04:07:00 2007  Koichi Sasada  <ko1@atdot.net>

	* compile.c (compile_array): ignore NODE_ZARRAY.
	  [ruby-dev:31110]

	* bootstraptest/test_method.rb: add a test for above.

Wed Jul  4 04:04:02 2007  Koichi Sasada  <ko1@atdot.net>

	* compile.h: fix debug print level.

Wed Jul  4 03:52:55 2007  Koichi Sasada  <ko1@atdot.net>

	* compile.c (iseq_compile_each): support v[&b]= type method call.
	  [ruby-dev:31094]

	* bootstraptest/test_method.rb: add a test for above.

Wed Jul  4 03:43:29 2007  Koichi Sasada  <ko1@atdot.net>

	* compile.c (compile_massign): fix massign compilation
	  (example: a, *v, (*x) = ...).  [ruby-dev:31107]

	* bootstraptest/test_massign.rb: add tests for above.

Tue Jul  3 23:12:29 2007  NAKAMURA Usaku  <usa@ruby-lang.org>

	* include/ruby/onigiruma.h (ONIG_EXTERN): use RUBY_EXTERN if defined.

	* regenc.h: include ruby/defines.h.

	* regint.h: x64-mswin64 support.

Tue Jul  3 13:47:44 2007  Koichi Sasada  <ko1@atdot.net>

	* cont.c (cont_save_machine_stack): clear saved_thread.machine_stack*.

Mon Jul  2 21:45:53 2007  Koichi Sasada  <ko1@atdot.net>

	* compile.c: rename iseq_translate_direct_threaded_code()
	  to iseq_translate_threaded_code().

	* eval_intern.h, yarvcore.h: mv EXEC_EVENT_HOOK() and
	  exec_event_hooks() to yarvcore.h.

	* insnhelper.ci, vm.c: mv yarv_finish_insn_seq to vm.c.

	* insns.def (opt_call_c_function): fix to use RESTORE_REGS().

	* iseq.c (rb_iseq_build_for_ruby2cext): fix to allocate iseq.

Mon Jul  2 11:59:34 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* insns.def (defineclass): suppress a warning.

	* insns.def (opt_call_c_function): should raise the thrown exception
	  instead of returning it.

Mon Jul  2 08:53:47 2007  Koichi Sasada  <ko1@atdot.net>

	* eval_intern.h, yarvcore.h: move declaration of sysstack_error
	  to yarvcore.h.

	* iseq.c: fix symbol name (:toplevel -> :top).

	* lib/vm/instruction.rb, template/vm.inc.tmpl: replacable
	  current file name.

Mon Jul  2 05:29:07 2007  Koichi Sasada  <ko1@atdot.net>

	* compile.c, iseq.c: fix iseq some of load/store process.

Mon Jul  2 03:09:36 2007  Koichi Sasada  <ko1@atdot.net>

	* yarvcore.h, compile.c, insnhelper.ci, iseq.c, vm.c:
	  rename structure names and field names.

	* insnhelper.h, insns.def: add GET_CONST_INLINE_CACHE().

	* iseq.c: add rb_iseq_build_for_ruby2cext().

	* yarvcore.h, vm.h: move declaration of rb_insn_func_t
	  to yarvcore.h.

Sun Jul  1 03:25:53 2007  Koichi Sasada  <ko1@atdot.net>

	* insnhelper.h, vm.h: some refactoring.
	  remove useless comments, etc.

Sun Jul  1 03:02:29 2007  Koichi Sasada  <ko1@atdot.net>

	* yarvcore.h: some refactoring on rb_iseq_t.
	  rename some variable names, add comments, etc.

	* compile.c, iseq.c, proc.c, vm.c: ditto.

Sun Jul  1 02:57:57 2007  Koichi Sasada  <ko1@atdot.net>

	* vm.h: rename insn_func_type to rb_insn_func_type.

	* vm_evalbody.ci: ditto.

	* insns.def: add opt_call_native_compiled instruction
	  instead of opt_call_native_compiled.

Sat Jun 30 00:17:00 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* parse.y (parser_yylex): return non-valid token for an invalid
	  instance/class variable name.  a patch from Yusuke ENDOH
	  <mame AT tsg.ne.jp>.  [ruby-dev:31095]

Fri Jun 29 23:38:06 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* parse.y (stmts): fix for ripper.

Fri Jun 29 21:55:48 2007  Koichi Sasada  <ko1@atdot.net>

	* parse.y: fix to show line number of blank block.
	  [ruby-dev:31093]

Fri Jun 29 20:51:04 2007  Tanaka Akira  <akr@fsij.org>

	* lib/cgi/session.rb (create_new_id): don't cut off md5.hexdigest to
	  follow Ruby 1.8.

Fri Jun 29 17:10:14 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* debug.h: constified.

	* debug.c (ruby_set_debug_option): separated from main.c.

	* gc.c (ruby_gc_stress), signal.c (ruby_enable_coredump): prefixed.

Fri Jun 29 16:39:06 2007  Koichi Sasada  <ko1@atdot.net>

	* proc.c (proc_new): fix to return a proc object
	  which block is contained ([ruby-dev:31056]).

Fri Jun 29 15:43:59 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* numeric.c (fix_pow): get rid of division by zero.  reported by
	  Yusuke ENDOH <mame AT tsg.ne.jp> [ruby-dev:31040]

	* numeric.c (int_round): do nothing when rounding by zeroth digit.
	  check underflow.  [ruby-dev:31043]

Fri Jun 29 15:32:00 2007  Koichi Sasada  <ko1@atdot.net>

	* configure.in: add fastcall attribute check.

Fri Jun 29 14:51:24 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* parse.y (assoc_list): remove expanded hash literal (no splat).

	* lib/webrick/httpstatus.rb (WEBrick::HTTPStatus::EOFError): adapt
	  to new syntax.

Fri Jun 29 14:48:18 2007  Koichi Sasada  <ko1@atdot.net>

	* tool/insns2vm.rb, lib/vm/instruction.rb: move process body
	  to lib/vm/instruction.rb.

	* common.mk: fix aotc rule.
	  experimental. bin/ruby2cext is not added yet.

Fri Jun 29 11:23:09 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* parse.y (dsym): return non-null NODE even if yyerror().  based on a
	  patch from Yusuke ENDOH <mame AT tsg.ne.jp>.  [ruby-dev:31085]

Thu Jun 28 23:29:30 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* parse.y (assoc_list): odd number check only for NODE_ARRAY.
	  [ruby-dev:31082]

Thu Jun 28 22:24:33 2007  Koichi Sasada  <ko1@atdot.net>

	* win32/Makefile.sub: define FUNC_FASTCALL macro.

	* vm.h: fix to use FUNC_FASTCALL macro.
	  TODO: add FUNC_FASTCALL macro by configure.

Thu Jun 28 19:38:53 2007  Koichi Sasada  <ko1@atdot.net>

	* compile.c: fix to remove -Wall warnings on gcc.

	* compile.c (make_name_with_str): removed. use rb_sprintf() instead.

Thu Jun 28 18:53:01 2007  Tanaka Akira  <akr@fsij.org>

	* bignum.c (rb_big_hash): fix hash area.

Thu Jun 28 15:00:06 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* ext/stringio/stringio.c (strio_getline): local variable to be
	  initialized.  [ruby-dev:31077]

Thu Jun 28 11:30:39 2007  NAKAMURA Usaku  <usa@ruby-lang.org>

	* gc.c (rb_obj_id): use SIGNED_VALUE instead of long.

Thu Jun 28 05:01:56 2007  Koichi Sasada  <ko1@atdot.net>

	* common.mk (run.gdb): fix to load $(srcdir)/.gdbinit

	* vm.c (rb_vm_set_finish_env): add a cast.

	* vm.h: support __fastcall for MSVC.

Thu Jun 28 02:12:08 2007  Koichi Sasada  <ko1@atdot.net>

	* bootstraptest/runner.rb: fix to untouch $:.

Thu Jun 28 02:03:07 2007  Koichi Sasada  <ko1@atdot.net>

	* compile.c (setup_args): change parameter type.

Thu Jun 28 02:03:39 2007  NAKAMURA Usaku  <usa@ruby-lang.org>

	* parse.y (rb_intern2): unconstify cast.

Thu Jun 28 01:44:31 2007  Tanaka Akira  <akr@fsij.org>

	* parse.y (rb_intern2): don't allocate a string object at first.
	  [ruby-dev:31064]

Thu Jun 28 01:24:02 2007  Koichi Sasada  <ko1@atdot.net>

	* bootstraptest/runner.rb: fix to show file name.

	* bootstraptest/test_*.rb: add bootstrap tests.

Thu Jun 28 01:22:15 2007  Koichi Sasada  <ko1@atdot.net>

	* include/ruby/node.h, parse.y, gc.c, iseq.c: remove NODE_CREF.

Thu Jun 28 01:19:43 2007  Koichi Sasada  <ko1@atdot.net>

	* compile.c (iseq_compile_each): fix popped backref and others.
	  ([ruby-dev:31068]).

	* compile.c (iseq_compile_each): remove needless statements.

Wed Jun 27 23:51:33 2007  NAKAMURA Usaku  <usa@ruby-lang.org>

	* win32/win32.c: remove unused functions.

Wed Jun 27 20:46:05 2007  NAKAMURA Usaku  <usa@ruby-lang.org>

	* include/ruby/win32.h, win32/Makefile.sub, win32/configure.bat,
	  win32/mkexports.rb, win32/setup.mak, win32/win32.c: import
	  x64-mswin64 port.

Wed Jun 27 20:31:07 2007  Koichi Sasada  <ko1@atdot.net>

	* compile.c (iseq_translate_direct_threaded_code): fix prototype
	  function name.

	* vm.h: add correct cast.

Wed Jun 27 17:08:42 2007  Koichi Sasada  <ko1@atdot.net>

	* vm_evalbody.ci: support OPT_CALL_THREADED_CODE.

	* insns.def, vm.c, vm.h: ditto.

	* vm.h: add VM_CFP_CNT() and VM_SP_CNT().

Wed Jun 27 04:23:47 2007  Koichi Sasada  <ko1@atdot.net>

	* compile.c (iseq_compile_each): fix type error.

Wed Jun 27 03:26:15 2007  Koichi Sasada  <ko1@atdot.net>

	* compile.c (compile_massign), insns.def (expandarray): support
	  postarg with massign (a, *b, c = ...).

	* bootstraptest/test_massign.rb: add tests for above.

	* compile.h: fix debug macro names.

Wed Jun 27 00:18:41 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* string.c (rb_str_clear): need to check STR_EMBED_P() before
	  free()ing memory.  a patch from Yusuke ENDOH <mame AT tsg.ne.jp>.
	  [ruby-dev:31062]

Tue Jun 26 16:39:01 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* process.c (proc_getgroups): use GIDT2NUM for rb_gid_t.

Tue Jun 26 16:28:24 2007  Koichi Sasada  <ko1@atdot.net>

	* thread.c (rb_thread_wait_fd_rw): terminate fdset.

Tue Jun 26 16:26:58 2007  NAKAMURA Usaku  <usa@ruby-lang.org>

	* regint.h: IL32LLP64 support.

Tue Jun 26 16:22:45 2007  Koichi Sasada  <ko1@atdot.net>

	* iseq.c (ruby_node_name): update node names.

Tue Jun 26 15:21:20 2007  NAKAMURA Usaku  <usa@ruby-lang.org>

	* include/ruby/ruby.h: IL32LLP64 support.

	* bignum.c (bigfixize, rb_cstr_to_inum): ditto.

	* insns.def (opt_plus, opt_minus, opt_mult): ditto.

Tue Jun 26 15:04:06 2007  Koichi Sasada  <ko1@atdot.net>

	* cont.c (rb_fiber_s_new): revert initializing VM stack.

	* yarvcore.c (th_init2): ditto.

	* vm.c, vm.h: fix to stop using Qundef on VM stack.  According to
	  this change, VM stack should not include Qundef value.

	* insns.def (putundef): removed.

	* compile.c (iseq_compile_each): ditto.

	* eval.c (eval): fix spacing.

Tue Jun 26 04:03:50 2007  Koichi Sasada  <ko1@atdot.net>

	* insnhelper.ci (vm_yield_with_cfunc), proc.c: fix Method#to_proc
	  to return lambda Proc ([ruby-dev:31021], [ruby-dev:31037]).

Tue Jun 26 03:46:08 2007  Koichi Sasada  <ko1@atdot.net>

	* cont.c (rb_fiber_s_new): fix to clear rb_thread_t#tag.
	  [ruby-dev:30995]

Tue Jun 26 03:38:31 2007  Koichi Sasada  <ko1@atdot.net>

	* cont.c (rb_fiber_s_new), yarvcore.c (th_init2): fix to clear
	  VM stack ([ruby-dev:31046]).

Tue Jun 26 03:15:27 2007  Koichi Sasada  <ko1@atdot.net>

	* compile.c: rename setup_arg() to setup_args().
	  fix to use setup_args() at processing NODE_YIELD.

Tue Jun 26 02:50:24 2007  Koichi Sasada  <ko1@atdot.net>

	* compile.c (setup_arg): support kind of "m(*ary, x)" method call.
	  ([ruby-dev:31048]).

Tue Jun 26 00:28:44 2007  Koichi Sasada  <ko1@atdot.net>

	* insnhelper.ci, vm.c: complete block parameter support.
	  post arguments, optional arguments, block argument.

	* compile.c, parse.y: fix {|a|} parameter.

	* insnshelper.ci, insns.def: revert caller_setup_args() option
	  (need_block_check) parameter.

Mon Jun 25 20:18:44 2007  NAKAMURA Usaku  <usa@ruby-lang.org>

	* gc.c (RVALUE): in RVALUE and RBasic, flags must be the same type.

Mon Jun 25 18:02:55 2007  NAKAMURA Usaku  <usa@ruby-lang.org>

	* ext/pty/extconf.rb: skip wince and win64.

Mon Jun 25 17:59:32 2007  NAKAMURA Usaku  <usa@ruby-lang.org>

	* include/ruby/node.h (NODE_LMASK, nd_line): shouldn't use int and/or
	  long carelessly.

Mon Jun 25 11:36:35 2007  Koichi Sasada  <ko1@atdot.net>

	* gc.h: add RUBY_ prefix to debug macros.

	* cont.c, proc.c, yarvcore.c,

	* gc.c: define ruby_gc_debug_indent variable to debug mark/free.

	* vm.c, insnhelper.ci: rename some functions to vm_* or rb_vm_*.
	  move some functions, definitions, declarations to suitable files.

	* eval.c, yarvcore.h, eval_error.ci, insnhelper.ci: ditto.

Mon Jun 25 09:45:46 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* eval_error.ci, eval_jump.ci, eval_method.ci, eval_safe.ci: c-mode.

Mon Jun 25 05:27:54 2007  Koichi Sasada  <ko1@atdot.net>

	* eval.c: remove ruby_current_node and change eval() prototype.
	  fix to use rb_sourcefile/line() instead of ruby_sourcefile/line.

	* error.c, eval_error.ci, eval_load.c, eval_safe.ci, gc.c,
	  include/ruby/intern.h, parse.y, process.c, ruby.c: ditto.

	* vm.c: fix spaces.

Mon Jun 25 04:20:14 2007  Koichi Sasada  <ko1@atdot.net>

	* eval_*.h: rename to eval_*.ci.

	* common.mk: ditto.

	* eval_error.ci: remove ruby_set_current_source().

	* error.c, eval.c, ruby.c: ditto.

	* eval_safe.c, proc.c: remove unused macros.

Mon Jun 25 03:37:20 2007  Koichi Sasada  <ko1@atdot.net>

	* insnhelper.ci (caller_setup_args): add need_block_check option.

	* insns.def: ditto.

	* yarvcore.h: add GetCoreDataFromValue().

Mon Jun 25 02:14:30 2007  Koichi Sasada  <ko1@atdot.net>

	* call_cfunc.ci: removed.

	* insnhelper.ci: added. this function includes all functions that
	  vm insns need.

	* common.mk: ditto.

	* insnhelper.h, vm.h, vm.c: move some declaration.

	* gc.h: remove GC_CHECK() macro because GC.stress is more useful.

	* compile.c, iseq.c, vm_dump: ditto.

	* gc.h, thread.c: move a prototype declaration.

	* debug.c, debug.h: rename some functions.

	* compile.h: ditto.

Mon Jun 25 00:45:02 2007  Koichi Sasada  <ko1@atdot.net>

	* insns.def (invokesuper): fix error message.

Mon Jun 25 00:14:13 2007  Koichi Sasada  <ko1@atdot.net>

	* vm.c: some refactoring.
	  * rename th_* to vm_*.
	  * remove unused variables functions.
	  * add prototypes.

	* blockinlining.c, compile.c, cont.c, eval.c, eval_intern.h,
	  eval_jump.h, eval_load.c, inits.c, insns.def, iseq.c, parse.y,
	  proc.c, process.c, signal.c, thread.c, vm.c, vm_dump.c,
	  vm_evalbody.ci, yarvcore.c, yarvcore.h: ditto.

Sun Jun 24 22:32:00 2007  Koichi Sasada  <ko1@atdot.net>

	* eval_method.h (rb_add_method): fix to check 0.

Sun Jun 24 22:00:17 2007  Koichi Sasada  <ko1@atdot.net>

	* insn_send.ci: removed.

	* common.mk: ditto.

	* vm.c (vm_call_bmethod), isnsn.def: added.  fix to use this
	  function instead of using goto.

	* vm.c (vm_call_bmethod): renamed from th_invoke_bmethod().

	* vm.c (vm_method_missing): renamed from eval_method_missing().

	* vm_evalbody.ci: remove tmp_* variables.

	* insnhelper.h: add some macros.

	* insns.def: forbid zsuper from method defined by define_method().

	* test/ruby/test_super.rb: ditto.

Sun Jun 24 20:01:08 2007  Koichi Sasada  <ko1@atdot.net>

	* vm_macro.def: removed.

	* insn_send.ci: added.  this file includes send instruction body.

	* common.mk: ditto.

	* insns.def: ditto.

	* tool/insns2vm.rb: ditto.

	* vm.c: ditto.

Sun Jun 24 19:30:37 2007  Koichi Sasada  <ko1@atdot.net>

	* insnhelper.h (RESTORE_REGS): add do/while(0) around macro.

	* vm.c, vm_macro.def: remove macro_eval_invoke_func() and
	  add vm_setup_method().  use it instead.

Sun Jun 24 19:02:33 2007  Koichi Sasada  <ko1@atdot.net>

	* vm.c, vm_macro.def : remove macro_eval_invoke_cfunc() and
	  add vm_call_cfunc().

Sun Jun 24 17:54:13 2007  Koichi Sasada  <ko1@atdot.net>

	* insns.def, vm.c: add/fix stack overflow check.

Sun Jun 24 17:28:52 2007  Koichi Sasada  <ko1@atdot.net>

	* insnhelper.h: change CHECK_STACK_OVERFLOW() to throw exception.

	* vm.c (caller_setup_arg), vm_macro.def: remove
	  macro_eval_setup_send_arguments and add caller_setup_arg().

	* insns.def: ditto.

	* bootstraptest/test_method.rb: add splat arg tests.

Sun Jun 24 16:35:46 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* proc.c (proc_to_s): used a variable before initialized.

Sun Jun 24 16:05:45 2007  Koichi Sasada  <ko1@atdot.net>

	* vm.c (callee_setup_arg): added.  support correct post arg.

	* vm_macro.def (macro_eval_invoke_func): fix to use
	  callee_setup_arg.

	* compile.c (set_arguments): adjust for above changes.

	* compile.c (iseq_compile_each): ditto.

	* iseq.c (ruby_iseq_disasm): ditto.

	* yarvcore.h: add rb_iseq_t#post_arg_start and arg_size.

	* bootstraptest/test_method.rb: add post arg tests.

Sun Jun 24 16:10:43 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* proc.c (proc_to_s): suppress warning, and reduced duplicated code.

Sun Jun 24 15:33:47 2007  Koichi Sasada  <ko1@atdot.net>

	* bootstraptest/runner.rb: set default directory to
	  '/tmp/bootstraptest.tmpwd' and add --dir option.
	  fix to output driver and target information.

	* common.mk: fix to run btest on BASERUBY and
	  add OPTS to pass option ("make btest OPTS=...").

Sun Jun 24 03:05:00 2007  Tanaka Akira  <akr@fsij.org>

	* enum.c (enum_minmax): fix SEGV by [].minmax.

Sat Jun 23 17:18:19 2007  Tanaka Akira  <akr@fsij.org>

	* re.c (match_inspect): MatchData#inspect implemented.

Sat Jun 23 15:00:16 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* enum.c (enum_minmax): new method to get the minimum and maximum
	  values from the enumerable at once.

	* enum.c (enum_minmax_by): ditto.

Sat Jun 23 01:25:40 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* hash.c (rb_hash_assoc): new method.

	* hash.c (rb_hash_rassoc): ditto.

	* hash.c (rb_hash_flatten): ditto.

Fri Jun 22 23:55:59 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* string.c (rb_str_upto): add optional argument to specify
	  exclusiveness.

	* range.c (range_step): use String#upto with optional argument.

	* range.c (range_each): ditto.

Fri Jun 22 19:55:51 2007  Tanaka Akira  <akr@fsij.org>

	* proc.c (proc_to_s): revert the change from %p to %lx at YARV
	  merge time.

Fri Jun 22 19:33:49 2007  Tanaka Akira  <akr@fsij.org>

	* proc.c (proc_to_s): show is_lambda.

Thu Jun 21 20:36:12 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* hash.c (rb_hash_sort): remove hash specific implementation.

Thu Jun 21 20:28:05 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* hash.c (rb_hash_select): returns new hash, not assoc array.
	  [ruby-core:11504]

	* hash.c (env_select): ditto.

Thu Jun 21 23:08:19 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* parse.y (rb_intern2): ID_JUNK test based on len, not by NUL.

Thu Jun 21 19:42:07 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* yarvcore.c (rb_thread_mark): mark also thrown_errinfo.

Thu Jun 21 17:13:44 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* parse.y (rb_intern2): name may not be NUL-terminated.

Wed Jun 20 08:27:57 2007  Tanaka Akira  <akr@fsij.org>

	* eval_error.h (error_print): show full stacktrace on
	  non-SystemStackError.

Wed Jun 20 04:45:39 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* parse.y (rb_intern2): use rb_intern2 to intern without trailing
	  equal sign.

	* parse.y (rb_intern2, ripper_id2sym): fixed indent.

Tue Jun 19 10:55:05 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* eval_load.c (load_ext, rb_require_safe): pass VALUE instead of
	  pointer.  [ruby-Bugs-11659]

Mon Jun 18 08:47:54 2007  Technorama Ltd.  <oss-ruby@technorama.net>

	* ext/openssl/{extconf.rb,ossl_ssl_session.c}:
	  Fix ruby-Bugs-11513.

	* ext/openssl/ossl_pkey_ec.c
	  New methods EC::Point.[eql,make_affine!,invert!,on_curve?,infinity?]
	  By default output the same key form as the openssl command.

	* ext/openssl/ossl_rand.c
	  New method Random.status?

	* test/openssl/test_ec.rb
	  New tests.

Mon Jun 18 17:04:07 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* eval_load.c (rb_require_safe, ruby_init_ext): load with ruby level
	  cfp.  [ruby-core:10779]

	* eval_intern.h, vm.c (rb_vm_call_cfunc): new function to call a
	  function with ruby level cfp.

Mon Jun 18 16:57:24 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* parse.y (yycompile): disable trace while creating ruby_debug_lines.
	  [ruby-talk:253586]

	* thread.c (ruby_suppress_tracing): new function to call a function
	  with suppressing trace.

	* lib/debug.rb, lib/tracer.rb: for YARV.

Mon Jun 18 13:54:36 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* eval.c (ruby_cleanup): return EXIT_FAILURE if any exceptions occurred
	  in at_exit blocks.  [ruby-core:11263]

Mon Jun 18 02:49:16 2007  Koichi Sasada  <ko1@atdot.net>

	* vm.c (env_mark): fix to mark block.proc.

	* vm.c (th_make_proc_from_block): set created proc to block->proc.

Mon Jun 18 02:48:12 2007  Koichi Sasada  <ko1@atdot.net>

	* vm_dump.c (vm_stack_dump_raw): hide VM stack trace.

Mon Jun 18 02:43:53 2007  Koichi Sasada  <ko1@atdot.net>

	* signal.c (sigsegv): clear gc_stress flag on SEGV.

Mon Jun 18 01:14:10 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* variable.c (rb_path2class): get rid of dangling pointer caused by
	  optimized out value.

	* variable.c (rb_global_entry, rb_f_untrace_var, rb_alias_variable,
	  rb_generic_ivar_table, generic_ivar_get, generic_ivar_set,
	  generic_ivar_defined, generic_ivar_remove, rb_mark_generic_ivar,
	  rb_free_generic_ivar, rb_copy_generic_ivar,
	  rb_obj_instance_variables): suppress warnings.

Sun Jun 17 11:11:07 2007  Tanaka Akira  <akr@fsij.org>

	* eval.c (rb_method_missing): avoid a warning "too many arguments
	  for format string" on "./ruby -ve 'def m() super end; m'".

Sat Jun 16 22:24:17 2007  Tanaka Akira  <akr@fsij.org>

	* gc.c (garbage_collect): re-introduce ruby_current_node marking code.
	  [ruby-dev:31005]

Sat Jun 16 21:37:43 2007  Tanaka Akira  <akr@fsij.org>

	* gc.c (gc_sweep): re-introduce heap extension strategy change.
	  [ruby-dev:31005]

Fri Jun 15 22:59:37 2007  Tanaka Akira  <akr@fsij.org>

	* .gdbinit: new file to ease debugging using gdb.

Fri Jun 15 22:33:55 2007  Tanaka Akira  <akr@fsij.org>

	* signal.c (default_handler): func argument removed.
	  (trap_handler): support SYSTEM_DEFAULT.  call default_handler
	  internally.
	  (sig_trap): don't call default_handler.
	  [ruby-dev:30999]

Fri Jun 15 22:33:29 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* common.mk (realclean): separate local and ext.

	* ext/extmk.rb: not remove unrelated directories.

Fri Jun 15 20:50:02 2007  Tanaka Akira  <akr@fsij.org>

	* keywords: enclose C code in declaration section by %{ and %} to
	  avoid extra semicolon after #ifdef RIPPER.
	  pointed by eban.

Fri Jun 15 18:56:52 2007  Tanaka Akira  <akr@fsij.org>

	* signal.c (trap_handler): trap("SIGSEGV", "DEFAULT") may cause wrong
	  trap error because SIG_DFL may be zero.

Fri Jun 15 15:55:55 2007  Koichi Sasada  <ko1@atdot.net>

	* insns.def (setconstant, toregexp): fix to mark object correctly.

Fri Jun 15 13:24:18 2007  Koichi Sasada  <ko1@atdot.net>

	* hash.c: exchange semantics of Hash#each and Hash#each_pair.
	  pointed out by [ruby-dev:30997].

	* test/ruby/test_iterator.rb: ditto.

	* test/ruby/test_yield.rb: ditto.

Fri Jun 15 12:38:29 2007  Koichi Sasada  <ko1@atdot.net>

	* test/ruby/test_iterator.rb: remove debug code (GC.stress=true).

Fri Jun 15 12:25:33 2007  Koichi Sasada  <ko1@atdot.net>

	* vm.c (th_yield_setup_args): |v| should work as |v,|.
	  ex) def m;yield 1, 2; end; m{|v| p v} #=> 1

	* parse.y: apply above change for "for" statement.

	* test/ruby/test_assignment.rb: ditto

	* test/ruby/test_basicinstructions.rb: ditto.

	* test/ruby/test_iterator.rb: ditto.

	* test/ruby/test_yield.rb: ditto.

	* compile.c (iseq_compile_each): fix debug.

Fri Jun 15 12:22:10 2007  Koichi Sasada  <ko1@atdot.net>

	* eval.c (ruby_finalize_1): rb_thread_t#errinfo should be clear with
	  Qnil.

Fri Jun 15 12:20:11 2007  Koichi Sasada  <ko1@atdot.net>

	* cont.c (rb_cont_call): forbid cross fiber continuation call.

	* test/ruby/test_fiber.rb: ditto.

Fri Jun 15 12:14:07 2007  Koichi Sasada  <ko1@atdot.net>

	* sample/test.rb: fix to show line information whether test succeeds.

Thu Jun 14 17:16:05 2007  Tanaka Akira  <akr@fsij.org>

	* eval_load.c (Init_load): delay allocating an array for rb_load_path
	  to avoid GC problem in very early stage.
	  (RUBY_GC_STRESS causes GC in such stage.)

	* variable.c (rb_gc_mark_global_tbl): rb_global_tbl may be 0 in
	  very early stage.

	* thread.c (thread_cleanup_func) [IA64]: clear register stack position.
	  (thread_start_func_2) [IA64]: record the beginning of register
	  stack using extra argument.
	  (rb_gc_save_machine_context) [IA64]: record the end of register
	  stack.

	* gc.c [IA64] (SET_STACK_END): record the end of register stack.
	  (garbage_collect) [IA64]: use recorded register stack area for
	  GC marking.
	  (yarv_machine_stack_mark) [IA64]: GC mark from the register stack
	  area.

	* yarvcore.c [IA64] (rb_gc_register_stack_start): defined.
	  (Init_VM): store th->self on stack to fix GC problem.
	  (Init_yarv) [IA64]: initialize the beginning of register stack.

	* yarvcore.h (struct rb_thread_struct) [IA64]: new members for
	  register stack area.

	* thread_pthread.ci (thread_start_func_1) [IA64]: call
	  thread_start_func_2 with the end of register stack.

	* cont.c (struct rb_context_struct) [IA64]: new members for register
	  stack area.
	  (cont_mark) [IA64]: GC mark from register stack area.
	  (cont_free) [IA64]: free saved register stack.
	  (cont_save_machine_stack) [IA64]: record the position and contents
	  of the register stack.
	  (cont_capture): store cont->self on stack to fix GC problem.
	  (cont_restore_1) [IA64]: restore the register stack.
	  [IA64] (register_stack_extend): new function.
	  (cont_restore_0) [IA64]: call register_stack_extend instead of
	  cont_restore_1.

	[ruby-dev:30982]

Thu Jun 14 17:09:48 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* lib/rdoc/parsers/parse_c.rb (RDoc::C_Parser): handle more
	  extensions.  [ruby-dev:30972]

Thu Jun 14 14:40:42 2007  Tanaka Akira  <akr@fsij.org>

	* lib/securerandom.rb: document updated.
	  suggested by NaHi.  [ruby-dev:30966]

Wed Jun 13 22:42:06 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* gc.c (garbage_collect): update IA64 register stack code.
	  [ruby-dev:30971]

Wed Jun 13 06:05:12 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* configure.in (darwin): prohibit loading extension libraries to
	  miniruby.

Tue Jun 12 21:50:51 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* parse.y (call_args): no allow splat after assocs.  takes
	  consistency over compatibility.

	* parse.y (call_args2): ditto

Tue Jun 12 14:53:51 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* lib/mkmf.rb (Logging.quiet, Logging.message): added quiet flag and
	  use it.  [ruby-core:10909]

	* lib/mkmf.rb (find_header): use header names in the message.

Sun Jun 10 18:37:13 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* ext/probeprofiler/probeprofiler.c: clean warnings.

Sun Jun 10 18:32:24 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* missing/isinf.c, missing/dup2.c, missing/strtod.c, missing/x68.c,
	  missing/alloca.c: use "ruby/config.h".

Sun Jun 10 17:49:20 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* instruby.rb (install_recursive): should check parent directories of
	  the destination.  [ruby-dev:30947]

Sun Jun 10 16:59:39 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* parse.y (do_block, brace_block): fix line numbers.  [ruby-dev:30831]

Sun Jun 10 16:57:20 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* instruby.rb (install_recursive): add :glob option rather than
	  using FNM_DOTMACH.

	* instruby.rb (ext-comm): make header directory first.

Sun Jun 10 16:10:58 2007  NAKAMURA Usaku  <usa@ruby-lang.org>

	* test/ruby/test_beginendblock.rb: typo.

Sun Jun 10 16:07:10 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* instruby.rb (install_recursive): skip .svn directories.

Sun Jun 10 15:44:43 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* win32/Makefile.sub (config.status): rubyhdrdir was missing.

Sun Jun 10 15:26:36 2007  Tanaka Akira  <akr@fsij.org>

	* Makefile.in: use --output-file for gperf to not leave lex.c.tmp.

Sun Jun 10 15:11:07 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* Makefile.in, win32/Makefile.sub (XCFLAGS): -I. is needed for *.inc.

	* ext/extmk.rb: prepend also topdir to mflags at last.

Sun Jun 10 13:47:36 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* test/ruby/test_beginendblock.rb (test_should_propagate_signaled):
	  get rid of invoking shell.  [ruby-dev:30942]

Sun Jun 10 12:56:46 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* include/ruby: moved public headers.

	* instruby.rb (install_recursive): skip backup files.

	* instruby.rb (ext-comm): install only current platform headers.

Sun Jun 10 10:42:04 2007  Tanaka Akira  <akr@fsij.org>

	* lib/securerandom.rb: renamed from lib/secrand.rb.
	  suggested by NaHi.  [ruby-dev:30934]

Sat Jun  9 06:40:05 2007  Tanaka Akira  <akr@fsij.org>

	* lib/secrand.rb: rename SecRand() to SecRand.random_number.
	  suggested by NaHi.  [ruby-dev:30934]

Fri Jun  8 16:34:20 2007  Tanaka Akira  <akr@fsij.org>

	* ext/zlib/zlib.c (gzfile_s_open): use FilePathValue to support
	  to_path.

Fri Jun  8 16:11:00 2007  Koichi Sasada  <ko1@atdot.net>

	* eval_jump.h: th->errinfo should clear with nil.

Fri Jun  8 14:53:28 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* parse.y (call_args): allow splat argument after unpacked
	  assocs like 1.8 does.

	* parse.y (call_args): ditto.

Fri Jun  8 14:26:18 2007  Tanaka Akira  <akr@fsij.org>

	* lib/secrand.rb: new file for secure random interface.

	* lib/cgi/session.rb: use secrand for generating cookies.

Fri Jun  8 12:44:37 2007  NAKAMURA Usaku  <usa@ruby-lang.org>

	* {win32,wince}/Makefile.sub: add lex.c rule.

Fri Jun  8 11:54:18 2007  Tanaka Akira  <akr@fsij.org>

	* lex.c.blt: moved from lex.c.

	* Makefile.in: use lex.c.blt if gperf is not available.
	  [ruby-list:8212], [ruby-list:8214], [ruby-list:24667],
	  [ruby-talk:120857], [ruby-dev:28102]

Thu Jun  7 21:38:39 2007  Koichi Sasada  <ko1@atdot.net>

	* thread.c (rb_thread_execute_interrupts): invoke ensure when
	  main thread exits.

Thu Jun  7 19:02:48 2007  Tanaka Akira  <akr@fsij.org>

	* lib/pp.rb: call original "method" method instead of redefined one.

Thu Jun  7 17:20:57 2007  Koichi Sasada  <ko1@atdot.net>

	* iseq.c (prepare_iseq_build): freeze filename and name string.

	* variable.c: freeze class name string.

Thu Jun  7 12:48:33 2007  Koichi Sasada  <ko1@atdot.net>

	* cont.c (cont_restore_1): fix to check root fiber [ruby-dev:30911].

	* test/ruby/test_fiber.rb: add a test.

Thu Jun 07 07:24:36 2007  NARUSE, Yui  <naruse@ruby-lang.org>

	* lib/json/common.rb: Ponder offering parse! method.

	* lib/json/editor.rb: be a bit more robust while loading data.

	* ext/json/ext/{generator,parser}/extconf.rb:
	  add a have_header directive for st.h

	* test/json: fix some tests.

Thu Jun  7 03:29:18 2007  Koichi Sasada  <ko1@atdot.net>

	* test_fiber.rb: add a test (Continuation and Fiber).

Thu Jun  7 03:17:24 2007  Koichi Sasada  <ko1@atdot.net>

	* cont.c (cont_new): add debug message.

	* cont.c (cont_restore_1): copy stack information from fiber.

	* cont.c (rb_fiber_s_new): fix to mark created fiber.

	* test/ruby/test_fiber.rb: add some tests around Thread and Fiber.

	* yarvcore.c (thread_free): fix to skip freeing stack if root fiber
	  is available.

Thu Jun  7 01:03:20 2007  Koichi Sasada  <ko1@atdot.net>

	* eval_intern.h, eval.c (ruby_init): remove POP_TAG_INIT().

	* cont.c (rb_fiber_start): remove zero-clearing tag.

Wed Jun  6 20:23:46 2007  Koichi Sasada  <ko1@atdot.net>

	* insns.def (invokeblock): fix of splat argument.
	  (splat same as normal method dispatch)

Wed Jun  6 16:27:25 2007  NAKAMURA Usaku  <usa@ruby-lang.org>

	* insns.def: fixed indentation.

Wed Jun  6 10:58:23 2007  Koichi Sasada  <ko1@atdot.net>

	* eval.c (rb_yield): fix to check Qundef.

Wed Jun  6 10:57:45 2007  Koichi Sasada  <ko1@atdot.net>

	* test/ruby/test_continuation.rb: add a test for last commit.

Wed Jun  6 10:55:42 2007  Koichi Sasada  <ko1@atdot.net>

	* cont.c (rb_cont_call): forbid calling dead fiber with
	  Continuation#call.

Wed Jun  6 10:50:01 2007  Koichi Sasada  <ko1@atdot.net>

	* compile.c (iseq_compile_each): fix around yield arguments
	  (with NODE_ARGSCAT).

Wed Jun  6 02:50:53 2007  Koichi Sasada  <ko1@atdot.net>

	* cont.c (rb_fiber_start): clear th->tag and check error to fix
	  [ruby-dev:30888] and [ruby-dev:30889].

	* eval_intern.h: fix rb_fiber_start() prototype.

	* test/ruby/test_fiber.rb: add tests for above.

Wed Jun  6 02:40:20 2007  NAKAMURA Usaku  <usa@ruby-lang.org>

	* insnhelper.h, insns.def (DEC_SP): shouldn't use unary minus operator
	  in pointer operation. some compilers (such as VC++8 x64) cannot deal
	  it with expected way.

Wed Jun  6 02:19:48 2007  Koichi Sasada  <ko1@atdot.net>

	* parse.y (new_yield), compile.c (iseq_compile_each): fix
	  passing parameter.

	* eval.c, eval_jump.h: simplify rb_yield*.

	* proc.c (proc_mark): fix to mark proc->block.proc.

	* proc.c (Init_Proc): add Proc#lambda?

	* test/ruby/test_lambda.rb: add some tests.

	* vm.c (invoke_block): fix to check lambda block or not.

	* vm.c (th_yield_setup_args): fix to check arguments size
	  when lambda block.

Tue Jun  5 16:30:38 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* io.c (rb_f_p): returns arguments to intervene.  [ruby-dev:29736]

Tue Jun  5 14:07:55 2007  Koichi Sasada  <ko1@atdot.net>

	* insns.def (invokeblock): check block is created by lambda
	  or Proc.new.

	* vm.c (block_proc_is_lambda): added.

Tue Jun  5 14:47:52 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* lib/pp.rb (PP::PPMethods::seplist): revert last change to work
	  around wrapper bug.  [ruby-dev:30840]

Tue Jun  5 14:11:15 2007  NARUSE, Yui  <naruse@ruby-lang.org>

	* ext/nkf/nkf-utf8/nkf.c (kanji_convert): Fix guess fallback.

Tue Jun  5 13:32:04 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* compile.c, dir.c, eval.c, eval_jump.h, eval_method.h, numeric.c,
	  pack.c, parse.y, re.c, thread.c, vm.c, vm_dump.c, call_cfunc.ci,
	  thread_pthread.ci, thread_win32.ci: fixed indentation.

	* call_cfunc.ci: protoized.

	* thread_win32.ci: fixed typo.

Tue Jun  5 13:17:11 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* call_cfunc.ci, compile.c, dir.c, eval.c, eval_jump.h, numeric.c,
	  pack.c, re.c, thread.c, thread_win32.ci, vm.c, vm_dump.c: fixed
	  indentation.

Mon Jun  4 21:15:45 2007  NARUSE, Yui  <naruse@ruby-lang.org>

	* lib/json.rb, lib/json, ext/json, test/json:
	  import JSON library.

	* ext/nkf: import nkf.c rev:1.124
	  Support CP10001.

Mon Jun  4 20:52:58 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* numeric.c (int_round): should not just truncate.

Sat Jun  2 16:48:55 2007  Koichi Sasada  <ko1@atdot.net>

	* cont.c (Fiber#pass): rename to Fiber#yield.  Block parameter
	  of fiber body receive first yield values.
	  e.g.: Fiber.new{|x| p x}.yield(:ok) #=> :ok

	* cont.c: rename rb_context_t#retval to rb_context_t#value.

	* test/ruby/test_fiber.rb: ditto.

Sat Jun  2 16:45:21 2007  Koichi Sasada  <ko1@atdot.net>

	* proc.c (Init_Proc): remove a line break.

Sat Jun  2 01:27:27 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* numeric.c (int_round): small optimization to handle bignums.

Fri Jun  1 13:02:35 2007  NAKAMURA Usaku  <usa@ruby-lang.org>

	* insnhelper.h (INC_SP): shouldn't cast ``x'' to unsigned type because
	  it might be a negative value.

	* insnhelper.h, insns.def: shouldn't use unary minus operator in index
	  operator. some compilers (such as VC++8 x64) cannot deal it with
	  expected way.

Fri Jun  1 11:33:40 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* numeric.c (num_round): should convert self to Float.
	  [ruby-dev:30860]

Fri Jun  1 02:01:13 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* numeric.c (flo_round): now takes optional argument to specify
	  number of digits, like round() in Python/PHP.

	* numeric.c (num_round): ditto.

Fri Jun  1 01:58:33 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* enum.c (each_with_index_i): should work well with continuation.
	  a patch from sheepman <sheepman AT sheepman.sakura.ne.jp>.
	  [ruby-dev:30846]

Thu May 31 17:27:53 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* lib/benchmark.rb (Benchmark::Job::item): avoid modifying the
	  argument unintentionally.  [ruby-talk:253676]

Wed May 30 14:43:00 2007  Koichi Sasada  <ko1@atdot.net>

	* cont.c (cont_capture): store all local variables in heap
	  ([ruby-dev:30832]).

	* vm.c (th_stack_to_heap): added.

	* test/ruby/test_continuation.rb: add a test for above.

	* eval_intern.h (th_get_ruby_level_cfp): fix to clean code.

Wed May 30 13:32:34 2007  Shugo Maeda  <shugo@ruby-lang.org>

	* lib/net/imap.rb (ResponseParser#next_token): fixed
	  error message.

	* lib/net/imap.rb (ResponseParser#parse_error): fixed
	  the condition not to refer @token.symbol unexpectedly.
	  Thanks, Dick Monahan.

Wed May 30 13:24:33 2007  Shugo Maeda  <shugo@ruby-lang.org>

	* lib/net/ftp.rb (Net::FTP#transfercmd): skip 2XX
	  responses for some FTP servers.

Wed May 30 04:18:37 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* eval.c (rb_eval_cmd): just return if no exceptions.
	  [ruby-dev:30820]

Wed May 30 02:14:25 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* signal.c (interrupt_init): needs to pass nil for Interrupt.
	  [ruby-core:11038]

	* signal.c (trap): fixed segfaults.  [ruby-dev:30830]

Wed May 30 00:50:48 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* gc.c (rb_source_filename, obj_free): suppress warnings.

	* gc.c (garbage_collect, yarv_machine_stack_mark): fixed typo.
	  http://bugs.debian.org/426267

Wed May 30 00:24:09 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* parse.y (open_args, arg_ambiguous, parser_warning): should not use
	  rb_warning in the parser.

Tue May 29 12:31:33 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* win32/win32.c (rb_w32_opendir): removed duplicated code.

Tue May 29 10:55:24 2007  Koichi Sasada  <ko1@atdot.net>

	* cont.c: fix bug around Continuation and Fiber.

	* test/ruby/test_continuation.rb: add tests for Continuation.

Tue May 29 10:54:34 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* win32/win32.c (rb_w32_opendir, rb_w32_readdir): eliminate magic
	  numbers.

Mon May 28 10:27:14 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* cont.c: fixed a function name.

Mon May 28 03:56:44 2007  Koichi Sasada  <ko1@atdot.net>

	* cont.c: support Fiber.  Check test/ruby/test_fiber.rb for detail.
	  Fiber is known as "Micro Thread", "Coroutine", and other terms.
	  At this time, only Fiber#pass is supported to change context.
	  I want to know more suitable method name/API for Fiber (... do you
	  know more suitable class name instead of Fiber?) as "suspend/resume",
	  "call", "yield", "start/kick/stop/restart", ....

	* eval.c, eval_intern.h, thread.c, yarvcore.c, yarvcore.h: ditto.

Sat May 26 00:38:21 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* eval.c (ruby_exec_internal): do nothing if no code.

	* compile.c (rb_iseq_compile): check node if NULL before check
	  nd_type.  [ruby-talk:252956]

Sat May 26 00:05:22 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* test/ruby/test_beginendblock.rb (test_should_propagate_signaled):
	  skip tests for exitstatus and termsig on the platforms where
	  signals not supported.

Fri May 25 16:04:47 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* yarvcore.c (Init_VM): wrap already initialized structs to use
	  it directly.

Fri May 25 11:09:47 2007  NAKAMURA Usaku  <usa@ruby-lang.org>

	* regint.h (include): on some platform, defines.h redefines
	  SIZE_OF_LONG_LONG so shouldn't re-include config.h after included
	  defines.h.

	* regint.h (vsnprintf): ruby on windows already have vsnprintf macro.

Thu May 24 12:07:27 2007  Koichi Sasada  <ko1@atdot.net>

	* cont.c: check across trap violation.

	* eval.c, yarvcore.h: ditto.

Thu May 24 11:46:55 2007  Koichi Sasada  <ko1@atdot.net>

	* gc.c, yarvcore.c: fix to mark VM structure on startup.

	* yarvcore.h: disable USE_CACHED_VALUE.

Thu May 24 01:54:53 2007  Koichi Sasada  <ko1@atdot.net>

	* cont.c: support callcc which everyone love.
	  incomplete. please give me bug reports.

	* common.mk, inits.c, thread.c: ditto.

	* yarvcore.c: export thread_mark().

	* yarvcore.h: disable value cache option.

	* eval_intern.h: set th_get_ruby_level_cfp to inline.

Wed May 23 15:39:02 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* common.mk: add a rule for regsyntax.c.

Wed May 23 10:31:53 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* oniguruma.h: updated to Oniguruma 5.7.0.

	* regsyntax.c, unicode.c: new files along with Oniguruma 5.x.

Wed May 23 06:51:46 2007  URABE Shyouhei  <shyouhei@ruby-lang.org>

	* lib/cgi.rb (CGI#[]): get rid of exceptions being raised.
	  [ruby-dev:30740], Thanks Kentaro KAWAMOTO.

Wed May 23 05:49:49 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* ext/extmk.rb, ext/purelib.rb, lib/mkmf.rb, runruby.rb: clear default
	  load path to get rid of load pre-installed extensions/libraries.
	  [ruby-core:11017]

Tue May 22 16:37:36 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* ruby.c (set_arg0): support RSTRING_LEN on HP-UX.  a patch from
	  WATANABE Tetsuya <Tetsuya.WATANABE AT nifty.com>.  [ruby-dev:30806]

Mon May 21 13:40:00 2007  Koichi Sasada  <ko1@atdot.net>

	* compile.c, vm_macro.def: support tail call optimization
	  (on default, this feature is not enabled).

	* iseq.c, compile.c, vm_opts.h: add "tailcall_optimization"
	  option.

	* sample/test.rb (test_ok): fix to adjust tailcall stack layout.

	* insns.def, vm.c, compile.c, yarvcore.c, yarvcore.h:
	  add opt_gt, opt_le instructions.

Mon May 21 03:34:06 2007  Minero Aoki  <aamine@loveruby.net>

	* lib/net/smtp.rb: CRAM-MD5 authentication did not work.
	  [ruby-dev:30770]

Sat May 19 10:26:01 2007  Tadayoshi Funaba  <tadf@dotrb.org>

	* lib/date/format.rb (Date._parse): detects some OFX dates
	  (Of course not fully).

Sat May 19 03:08:05 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* enum.c (enum_inject): minor improvement.  [ruby-dev:30792]

	* enum.c (one_i): no needs to iterate once the result became false.

	* enum.c (enum_one): fix for an example.

	* enum.c (one_iter_i, none_iter_i): DRY.;

Sat May 19 01:07:42 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* enum.c (enum_inject): it is now can work without block.  you
	  have to specify two argument method name as the first argument.

	* enum.c (Init_Enumerable): reduce is new alias to inject.

Sat May 19 01:05:33 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* file.c (Init_File): method definition mismatch.

Fri May 18 16:44:04 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* file.c (Init_File): add to_path method to File objects.

Fri May 18 11:12:39 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* ruby.c (DllMain, ruby_init_loadpath): use DLL instance handle given
	  to DllMain instead of VirtualQuery so that loadpath becomes relative
	  from the DLL on WinCE too.

Thu May 17 17:03:11 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* misc/ruby-style.el (ruby-style-label-indent): for yacc rules.

Thu May 17 13:30:27 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* parse.y (f_arg): remove typo from ripper description.

Thu May 17 13:23:38 2007  Koichi Sasada  <ko1@atdot.net>

	* parse.y, compile.c (set_arguments): fix to support in-paren
	  parameter (ex: def foo((a, b))).

Thu May 17 13:01:52 2007  Koichi Sasada  <ko1@atdot.net>

	* iseq.c (ruby_iseq_disasm): fix to show post arg info.

Thu May 17 12:56:52 2007  Koichi Sasada  <ko1@atdot.net>

	* debug.c (ruby_debug_node): fix to show node line.

Wed May 16 21:48:44 2007  NAKAMURA, Hiroshi  <nahi@ruby-lang.org>

	* lib/logger.rb (Logger::Application): remove meaningless logdev
	  attribute and added logger attribute instead.  [ruby-core:11143]
	  also added Logger#formatter rdoc comment.

Tue May 15 16:40:07 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* test/ruby/test_beginendblock.rb (test_endblockwarn): now parser
	  warnings emit source names and line numbers.

Tue May 15 15:01:38 2007  NAKAMURA Usaku  <usa@ruby-lang.org>

	* win32/win32.c (init_stdhandle): stderr should be without buffering,
	  but mswin32 use buffering when stderr is not connected to tty.

Mon May 14 02:12:07 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* array.c (rb_ary_zip): a.zip(b,c) should return an array, not
	  enumerator.

	* array.c (rb_ary_zip): a.zip(b,c) should return array with size
	  truncated to the size of its shortest argument array.
	  [incompatible]

Mon May 14 01:54:15 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* array.c (rb_ary_choice): should return nil when the array is
	  empty.

Sat May 12 18:26:36 2007  Minero Aoki  <aamine@loveruby.net>

	* lib/net/http.rb (tokens): forgot to add strip. [ruby-core:11120]

	* test/net/http/test_http.rb: test Net::HTTP.post_form.

Fri May 11 15:27:09 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* iseq.c (iseq_data_to_ary): internal IDs must not be exposed.
	  [ruby-core:11073]

	* parse.y (internal_id_gen): now returns scope local ID instead of
	  global one.

Thu May 10 15:15:53 2007  NAKAMURA Usaku  <usa@ruby-lang.org>

	* test/ruby/test_super.rb: add tests.

Thu May 10 15:14:05 2007  NAKAMURA Usaku  <usa@ruby-lang.org>

	* ext/iconv/iconv.c (iconv_s_conv): rdoc fix.

Thu May 10 15:09:23 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* parse.y (POINTER_P): pointer may be larger than long.

	* parse.y (vtable_size, vtable_included, vtable_tblcpy,
	  vtable_to_tbl): constified.

Thu May 10 10:13:14 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* thread.c (rb_thread_priority): rdoc fix; the initial value is
	  inherited from the creating thread.  [ruby-core:10607]

Wed May  9 12:28:57 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* bignum.c (Init_Bignum), numeric.c (Init_Numeric): added fdiv as
	  aliases of quo.  [ruby-dev:30771]

Tue May  8 23:39:09 2007  Tadayoshi Funaba  <tadf@dotrb.org>

	* lib/date/format.rb (Date._parse): revised treatment of
	  hyphened/separatorless dates.

	* lib/date/format.rb: some trivial adjustments.

Tue May  8 20:23:07 2007  Tadayoshi Funaba  <tadf@dotrb.org>

	* lib/date/format.rb: reverted.

Tue May  8 19:32:18 2007  Keiju Ishitsuka  <keiju@ruby-lang.org>

	* lib/rational.rb: fix high-precision Rationals cannot be
	  converted to Floats. [ruby-Bugs:10502], [ruby-core:11069],
	  [ruby-dev:30743]

Mon May  7 10:59:55 2007  Kouhei Sutou  <kou@cozmixng.org>

	* lib/rss/image.rb, test/rss/test_image.rb: fixed Image module
	  namespace URI. reported by Dmitry Borodaenko. Thanks.

Sun May  6 18:44:11 2007  Minero Aoki  <aamine@loveruby.net>

	* lib/net/http.rb (Net::HTTP.post_form): allow an Array of String
	  for pairs argument. [ruby-Bugs:10340]

	* lib/net/http.rb (Net::HTTP#set_form_data): ditto.

Sun May  6 17:54:36 2007  Minero Aoki  <aamine@loveruby.net>

	* lib/net/http.rb: Connection header field might include both of
	  "keep-alive" token and "close" token. [ruby-core:10818]

Sat May  5 16:26:33 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* lib/date/format.rb (Format::Bag#method_missing): get rid of
	  modifying original argument.  [ruby-core:11090]

Thu May  3 22:20:08 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* configure.in, defines.h, eval_load.c (rb_feature_p, rb_provided,
	  search_required, rb_require_safe), ext/extmk.rb: Fix
	  a bug where a statically linked extension cannot be autoloaded.
	  [ruby-dev:30023] / [ruby-dev:30239]

	* thread.c: added an internal class, Barrier.

	* thread.c: copied rdocs from fastthread.

	* yarvcore.h (struct rb_vm_struct): moved loading_table from global.

Thu May  3 18:10:12 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* vm_evalbody.ci, insns.def, vm.c, tool/insns2vm.rb (rb_num_t):
	  renamed to get rid of name clash.  [ruby-dev:30504]

	* yarvcore.c (ruby_thread_init): ditto.

Wed May  2 18:52:58 2007  Koichi Sasada  <ko1@atdot.net>

	* vm.c, yarvcore.h, yarvcore.c, insns.def: fix to mark VM stack
	  in correct range.

Wed May  2 17:13:26 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* bignum.c (rb_big_quo): now calculate in integer.  [ruby-dev:30753]

Wed May  2 15:14:56 2007  Koichi Sasada  <ko1@atdot.net>

	* eval_method.h: add redefine checks ([ruby-dev:30751]).

Wed May  2 11:22:52 2007  Koichi Sasada  <ko1@atdot.net>

	* compile.c: use Qtrue instead of 2.

	* vm.c, insns.def: support "lambda" calling convention.

Wed May  2 06:46:43 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* error.c, parse.y, ruby.h (rb_compile_warn, rb_compile_warning): warn
	  for compilation.  the parser should no longer use rb_warn() and
	  rb_warning().  [ruby-dev:30121]

Wed May  2 05:45:21 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* parse.y (assoc): result of assoc_new needs to be an assoc.

Wed May  2 05:40:43 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* bignum.c (rb_big_pow): improvement by calculating from MSB and using
	  factorization.  <http://yowaken.dip.jp/tdiary/20070426.html#p01>

Tue May  1 18:45:45 2007  Koichi Sasada  <ko1@atdot.net>

	* sample/test.rb: import matzruby's sample/test.rb.

Tue May  1 17:46:05 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* array.c (rb_ary_choice): a new method to choose an element
	  randomly from an array.

	* array.c (rb_ary_choice): fixed mistake from RDoc.

Tue May  1 13:59:18 2007  Koichi Sasada  <ko1@atdot.net>

	* proc.c (proc_arity): fix an arity bug ([ruby-core:11060]).

Tue May  1 13:12:49 2007  Koichi Sasada  <ko1@atdot.net>

	* yarvcore.h, compile.c (set_arguments): support post arguments.

	* test/ruby/test_method.rb: add tests for above.

	* test/ruby/test_proc.rb: ditto.

	* proc.c: fix an arity bug ([ruby-core:11029]).

	* vm.c, vm.h, insns.def, vm_dump.h: fix bmethod process.

	* vm.c: support block argument on block parameter.

Fri Apr 27 17:05:41 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* numeric.c (int_pow): bugfix of overflow detection.

	* numeric.c (int_pow): rb_big_pow() may return other than Bignum.

Fri Apr 27 01:51:50 2007  Koichi Sasada  <ko1@atdot.net>

	* compile.c: support multiple splat (e.g, [a, *b, *c, e, *f]).

Fri Apr 27 00:03:48 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* bignum.c (rb_big_pow): truncate all zero BDIGITs. [ruby-dev:30733]

Thu Apr 26 17:31:00 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* bignum.c (rb_big_pow): reduce multiplying for even number.

	* numeric.c (int_pow): calculate power in Fixnum as possible.
	  [ruby-dev:30726]

Thu Apr 26 17:18:51 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* parse.y: fixes for ripper.

	* parse.y (primary): reduced duplicated code.

	* parse.y (f_arg_item): should not override by meaningless value.

	* parse.y (f_arg, assocs): should not use $$ before assigned.

	* parse.y (assoc_list): dispatch assoclist_from_args for assocs as
	  well as args.

	* parse.y (assoc): return assoc if dispatched result is $1.

Thu Apr 26 13:54:51 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* misc/ruby-style.el: new file.  C/C++ style for ruby source code.

Wed Apr 25 19:49:16 2007  Tanaka Akira  <akr@fsij.org>

	* ext/socket/socket.c (unix_send_io, unix_recv_io): use CMSG_DATA to
	  align file descriptor appropriately.

Wed Apr 25 15:23:29 2007  NAKAMURA Usaku  <usa@ruby-lang.org>

	* win32/win32.c (NtInitialize, exit_handler): add initializing and
	  cleanup of critical section object for select.

	* win32/win32.c (do_select): block reentrance.

	* win32/win32.c (rb_w32_select): 0 sec polling of socket. this is
	  workaround because winsock cannot do select at same socket at the
	  same time by two or more threads.

Wed Apr 25 14:10:47 2007  Koichi Sasada  <ko1@atdot.net>

	* ext/probeprofiler/probeprofiler.c: fix function name and
	  return value.

Wed Apr 25 12:42:40 2007  Koichi Sasada  <ko1@atdot.net>

	* yarvcore.h: remove rb_control_frame_t#callee_id.

	* vm_macro.def: ditto.

	* eval_intern.h (exec_event_hooks): fix to check event flags

	* eval_intern.h (EXEC_EVENT_HOOK): fix to re-check event flags.

	* ext/probeprofiler : added.  this profiler is sampling based
	  profiler.

	* vm.c: add rb_thread_current_status() API for probeprofiler.

	* thread.c (rb_thread_execute_interrupts): add comments.

Wed Apr 25 10:36:03 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* eval_intern.h (PUSH_TAG): no argument now.

	* eval.c, eval_error.h, eval_jump.h, eval_load.c, proc.c, thread.c:
	  ditto.

	* thread.c (alloc_event_hook, rb_thread_remove_event_hook): should
	  return value.

Tue Apr 24 09:33:57 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* dir.c (do_stat, do_lstat, do_opendir): should not warn ENOTDIR.
	  [ruby-talk:248288]

Mon Apr 23 22:14:42 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* ext/extmk.rb ($ruby): add extout directory to include path.
	  [ruby-core:11003]

	* lib/mkmf.rb (libpathflag): not to append RPATHFLAG to current
	  directory.

	* lib/mkmf.rb (init_mkmf): add current directory to default
	  library path with highest priority.  [ruby-core:10960]

	* lib/mkmf.rb (LINK_SO): LIBPATH to be placed before DLDFLAGS.

Fri Apr 20 16:05:22 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* configure.in (LIBPATHFLAG, RPATHFLAG): no needs to be quoted,
	  it is done by libpathflag in mkmf.rb.

Fri Apr 20 12:27:04 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* lib/optparse.rb: fix to override conv proc.

Fri Apr 20 12:21:28 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* eval.c (ruby_cleanup): fixed access to out of bound, and inverted
	  the order of errinfos.

Fri Apr 20 10:33:23 2007  Koichi Sasada  <ko1@atdot.net>

	* eval_intern.h: add prototypes of rb_sourceline() and
	  rb_sourcefile().

Fri Apr 20 02:37:48 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* eval.c (ruby_cleanup): re-send signal.  [ruby-dev:30516]

	* eval_error.h (error_handle): no message when exiting by signal.

	* intern.h (rb_thread_signal_raise, ruby_default_signal): prototypes.

	* signal.c (esignal_init): takes a signal number and an optional
	  signal name.

	* signal.c (interrupt_init): pass SIGINT always.

	* signal.c (ruby_default_signal): invoke system default signal
	  handler.

	* signal.c (rb_f_kill): use NUM2PIDT instead of NUM2INT.

	* signal.c (rb_signal_exec, trap): handle SIGTERM.  [ruby-dev:30505]

	* thread.c (rb_thread_signal_raise): now takes signal number instead
	  of signal name.

	* thread.c (rb_thread_signal_exit): since rb_make_exception() calls
	  #exception method, rb_class_new_instance() is not needed here.

	* yarvcore.h (struct rb_vm_struct), eval_jump.h (terminate_process):
	  exit_code is no longer stored in VM.

Thu Apr 19 18:37:49 2007  Koichi Sasada  <ko1@atdot.net>

	* eval.c, node.h, thread.c, yarvcore.[ch], eval_intern.h:
	  support set_trace_func (incomplete.  id and klass
	  don't be passed).  And support Thread#set_trace_func
	  which hook only specified thread and Thread#add_trace_func
	  which add new trace func instead of replace old one.
	  C level API was modified.  See thread.c (logic) and
	  yarvcore.h (data structures).

	* vm.c, vm_macro.def: add hook points.

	* compile.c, insns.def: fix "trace" instruction.

	* iseq.c, vm_macro.h: add compile option "trace_instruction".

	* test/ruby/test_settracefunc.rb: hook "c-return" of set_trace_func.

Thu Apr 19 20:57:50 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* parse.y (symbol): symbols should be followed by EXPR_ENDARG.

	* parse.y (dsym): ditto.

	* parse.y (parser_yylex): strings should be followed by
	  EXPR_ENDARG.

	* parse.y (parser_yylex): ditto for numbers.

	* parse.y (parser_yylex): EXPR_ENDARG after ']' and '}'.

Thu Apr 19 17:46:36 2007  Koichi Sasada  <ko1@atdot.net>

	* lib/optparse.rb: fix to override conv proc.

Wed Apr 18 10:41:21 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* util.c (ruby_strtod): exponent is radix 10.  [ruby-talk:248272]

Wed Apr 18 02:50:50 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* yarvcore.c (th_init2): push initial blockptr value for
	  rb_block_given_p() outside ruby_exec().  [ruby-core:10923]

Wed Apr 18 02:30:24 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* configure.in (LDFLAGS): prepend -L. instead appending it to
	  XLDFLAGS.  [ruby-core:10933]

	* configure.in (Makefile): remove $U for automake from MISSING.
	  [ruby-talk:248171]

Mon Apr 16 22:56:01 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* ext/pty/expect_sample.rb: avoid symbolic link representation for
	  expect.  a patch from Kazuhiro NISHIYAMA <zn at mbf.nifty.com>.
	  [ruby-dev:30714]

Mon Apr 16 22:51:11 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* sample: replace TRUE, FALSE with true, false respectively.
	  a patch from Kazuhiro NISHIYAMA <zn at mbf.nifty.com>.
	  [ruby-dev:30713]

Mon Apr 16 17:08:02 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* lib/optparse.rb (make_switch): do not clobber converter if pattern
	  has no convert method.  reported by sheepman in [ruby-dev:30709].

Mon Apr 16 16:49:32 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* ext/stringio/stringio.c (strio_seek): consistent behavior with
	  IO#seek.  patch by sheepman in [ruby-dev:30710].

Mon Apr 16 16:34:08 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* parse.y (parser_yylex): should set command_start after block
	  starting "do"s and braces.  [ruby-core:10916]

Mon Apr 16 10:51:37 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* enum.c (enum_each_with_index): each_with_index to forward
	  arguments to each.  [ruby-core:10921]

Mon Apr 16 10:43:10 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* time.c (time_arg): should allow to specify 24:00.
	  [ruby-core:10915]

Sun Apr 15 09:12:54 2007  Tadayoshi Funaba  <tadf@dotrb.org>

	* lib/date/format.rb: added some zone names.

	* lib/date/format.rb (_parse): now interprets doted numerical
	  dates as a big endian (except dd.mm.yyyy).

Thu Apr 12 17:13:22 2007  Koichi Sasada  <ko1@atdot.net>

	* thread.c (mutex_try_lock): check and set owner thread.

	* thread_pthread.ci: fix to show error code in error message.

Thu Apr 12 17:11:54 2007  Koichi Sasada  <ko1@atdot.net>

	* eval.c (rb_rescue2): restore cfp ([ruby-dev:30582]).

Thu Apr 12 16:06:48 2007  Koichi Sasada  <ko1@atdot.net>

	* eval.c (rb_protect): restore cfp ([ruby-dev:30671]).

Thu Apr 12 16:04:31 2007  Koichi Sasada  <ko1@atdot.net>

	* compile.c (iseq_compile_each): check node->nd_state == 1, not !0.

Wed Apr 11 16:35:16 2007  NAKAMURA Usaku  <usa@ruby-lang.org>

	* win32/win32.[ch] (rb_w32_enter_critical, rb_w32_leave_critical): no
	  need to reject reentrance. removed.

	* rubysig.h (RUBY_CRITICAL): follow above changes.

	* rubysig.h (TRAP_BEG, TRAP_END): no need to save errno.

Tue Apr 10 17:02:17 2007  NAKAMURA Usaku  <usa@ruby-lang.org>

	* win32/win32.c (rb_w32_fclose, rb_w32_close): need to save errno
	  before calling original fclose()/close().

Tue Apr 10 16:14:22 2007  NAKAMURA Usaku  <usa@ruby-lang.org>

	* thread_win32.ci (w32_wait_events): check whether interrupt_event is
	  valid handle or not.

	* thread_win32.ci (native_thread_destroy): clear interrupt_event when
	  close it.

Tue Apr 10 15:53:17 2007  NAKAMURA Usaku  <usa@ruby-lang.org>

	* thread_pthread.ci (native_thread_create): initialize sleep_cond.
	  fixed: [ruby-dev:30675]

Mon Apr  9 18:48:57 2007  NAKAMURA Usaku  <usa@ruby-lang.org>

	* thread.c (do_select): ubf_select() is not necessary. interrupt is
	  checked in the loop.

Mon Apr  9 18:27:26 2007  NAKAMURA Usaku  <usa@ruby-lang.org>

	* thread.c (do_select): use ubf_select() as UBF on windows.

	* win32/win32.c (do_select): shouldn't call catch_interrupt() here.
	  fixed: [ruby-dev:30674], reported by wanabe.

Mon Apr  9 09:24:32 2007  Shugo Maeda  <shugo@ruby-lang.org>

	* lib/net/imap.rb (disconnect): call shutdown for
	  SSLSocket. Thanks, Technorama Ltd.

Sun Apr  8 13:28:17 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* compile.c (defined_expr): test arguments of NODE_CALL and so
	  on as well as NODE_ATTRASGN.  [ruby-core:10886]

Fri Apr  6 10:56:29 2007  NAKAMURA Usaku  <usa@ruby-lang.org>

	* ext/openssl/ossl_pkey_ec.c (ossl_ec_key_get_group): get rid of
	  warning. we are aware of it.

Fri Apr  6 04:00:24 2007  Technorama Ltd.  <oss-ruby@technorama.net>

	* ext/openssl/ossl_{bn,x509{attr,cert,name,store}}.c:
	  Add documentation.

Thu Apr  5 17:59:19 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* compile.c (defined_expr): support for assignment.
	  [ruby-core:10867]

	* compile.h (ADD_CATCH_ENTRY): removed temporary variable.

Thu Apr  5 15:13:34 2007  NAKAMURA Usaku  <usa@ruby-lang.org>

	* ext/openssl/ossl_ssl_session.c (ossl_ssl_session_alloc): should
	  return value.

Thu Apr  5 14:58:49 2007  Technorama Ltd. <oss-ruby@technorama.net>

	* ext/openssl/ossl_pkcs5.c: New module.

	* ext/openssl/ossl_{cipher,digest,pkcs7,pkcs12}.c:
	  Remove redundant module namespace.

	* ext/openssl/lib/openssl/{cipher,digest}.rb
	  Add backwards compatible classes for rearranged classes.

	* ext/openssl/ossl_{pkcs7,pkcs12}.c: Add documentation.

Thu Apr  5 00:42:48 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* error.c (rb_notimplement), io.c (pipe_open): removed definite
	  articles and UNIX manual section from messages.  [ruby-dev:30690]

Wed Apr  4 17:09:17 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* io.c (pipe_open): refined the message of NotImplementedError.
	  [ruby-dev:30685]

Wed Apr  4 12:29:02 2007  NAKAMURA Usaku  <usa@ruby-lang.org>

	* error.c (rb_notimplement): should show the name of this func,
	  not callee.

Wed Apr  4 10:18:04 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* io.c (popen_exec): should not close close-on-exec FDs.
	  [ruby-dev:30679]

	* io.c (pipe_open): raise NotImplementedError for command "-" on
	  platforms where fork(2) is not available.  [ruby-dev:30681]

Tue Apr  4 04:17:18 2007  Technorama Ltd. <oss-ruby@technorama.net>

	* ext/openssl/ossl_ssl.c: Add documentation.

Tue Apr  3 16:22:24 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* ext/openssl/extconf.rb: check for functions added in 1.9.

	* ext/openssl/ruby_missing.h: check per features instead by
	  checking version code.  [ruby-core:10845]

Tue Apr  3 16:02:44 2007  Technorama Ltd. <oss-ruby@technorama.net>

	* ext/openssl/ossl_bn.c: More documentation.

	* ext/openssl/lib/ossl_{pkey,pkey_ec}.[ch]: Add elliptic curves.

Tue Apr  3 15:50:41 2007  NAKAMURA Usaku  <usa@ruby-lang.org>

	* ext/socket/socket.c (s_recv, s_recvfrom): some systems (such as
	  windows) doesn't set fromlen if the socket is connection-oriented.
	  reported by Bram Whillock in [ruby-core:10512] [ruby-Bugs#9061]

Tue Apr  3 09:36:55 2007  NAKAMURA Usaku  <usa@ruby-lang.org>

	* ext/openssl/ruby_missing.h: need to include version.h to check
	  RUBY_VERSION_CODE.

Mon Apr  3 07:10:12 2007  Technorama Ltd. <oss-ruby@technorama.net>

	* ext/openssl/ossl_{ssl.[ch],ssl_session.c},
	  ext/openssl/lib/openssl/lib/openssl/ssl.rb:
	  New SSL::Session class.  Add session cb's, getter/setters,
	  config, and statistics methods.

Mon Apr  3 04:00:23 2007  Technorama Ltd. <oss-ruby@technorama.net>

	* ext/openssl/{ossl.[ch],ossl_pkey.c} Add documentation.

	* ext/openssl/ossl_hmac.c Add reset method.

	* ext/openssl/ossl_cipher.c (Cipher#update) Take additional
	  buffer argument.

	* ext/openssl/{ossl_bio.c,ossl_ssl.c,ruby_missing.h}
	  compatibility with 1.8.

Mon Apr  2 21:55:12 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* insns.def (throw), thread.c, yarvcore.h (throwed_errinfo): fixed
	  typo.

Fri Mar 30 11:46:51 2007  NAKAMURA Usaku  <usa@ruby-lang.org>

	* win32/win32.c (rb_w32_cmdvector): fixed buffer size. reported by
	  wanabe [ruby-dev:30672]

	* win32/win32.c (init_env, insert, rb_w32_get_environ): use strdup
	  instead of malloc + strlcpy. suggested by nobu [ruby-dev:30673]

Fri Mar 30 02:29:04 2007  Technorama  <oss-ruby@technorama.net>

	* ext/openssl/ossl_{bn,cipher,digest,hmac,rand,pkey_{dh,dsa,rsa}}.c:
	  Add Documentation for various methods.

	* ext/openssl/lib/openssl/cipher.rb: Ditto

	* ext/openssl/ossl_bn.c: add lshift! and rshift! methods.

	* ext/openssl/ossl_digest.c: GetDigestPtr() also accept a string.

Fri Mar 23 11:28:24 2007  NAKAMURA Usaku  <usa@ruby-lang.org>

	* win32/win32.c (init_env, insert, cmdglob, rb_w32_cmdvector,
	  rb_w32_opendir, rb_w32_readdir, rb_w32_strerror, rb_w32_stati64,
	  rb_w32_get_environ): use strlcpy() and strlcat().

	* win32/win32.c (rb_w32_opendir): use realloc() instead of xrealloc().

	* win32/win32.c (rb_w32_closedir): check NULL before free pointers.

Fri Mar 23 00:24:52 2007  Keiju Ishitsuka <keiju@ruby-lang.org>

	* lib/shell: commit miss(support for ruby 1.9(YARV) thread model).

Thu Mar 22 13:32:17 2007  NAKAMURA Usaku  <usa@ruby-lang.org>

	* win32/Makefile.sub (LIBS): remove an unnecessary library.

Thu Mar 22 10:27:58 2007  NAKAMURA Usaku  <usa@ruby-lang.org>

	* test/ruby/test_bignum.rb (test_to_s): add tests for Bignum#to_s.

Wed Mar 21 20:38:06 2007  NAKAMURA Usaku  <usa@ruby-lang.org>

	* marshal.c (w_short, w_long, w_object): get rid of VC++ warnings.

Wed Mar 21 20:05:07 2007  Koichi Sasada  <ko1@atdot.net>

	* compile.c, parse.y, eval.c, intern.h, iseq.c, lex.c, node.h,
	  proc.c, vm.c, vm_macro.def, vm_macro.def, yarvcore.c, yarvcore.h,
	  debug.c, debug.h: merge half-baked-1.9 changes.  The biggest change
	  is to change node structure around NODE_SCOPE, NODE_ARGS.  Every
	  scope (method/class/block) has own NODE_SCOPE node and NODE_ARGS
	  represents more details of arguments information.  I'll write a
	  document about detail of node structure.

Wed Mar 21 17:04:30 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* bignum.c (rb_big2str0): round up for the most significant digit.
	  [ruby-core:10686]

Tue Mar 21 08:20:00 2007  Nathaniel Talbott  <ntalbott@ruby-lang.org>

	* test/testunit/collector/test_dir.rb: Fixed test/unit tests that
	  were breaking due to Module#public_instance_methods now
	  returning a Symbol instead of a String.

	* test/testunit/collector/test_objectspace.rb: Ditto.

Tue Mar 20 22:54:50 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* marshal.c (w_extended): erroneous check condition when dump
	  method is defined.  [ruby-core:10646]

Tue Mar 20 21:36:47 2007  Keiju Ishitsuka <keiju@ruby-lang.org>

	* lib/shell.rb, lib/shell: support for ruby 1.9(YARV) thread model.

Tue Mar 20 16:36:08 2007  URABE Shyouhei  <shyouhei@ruby-lang.org>

	* distruby.rb: Add zip generation.

Tue Mar 20 16:20:49 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (rb_f_callee_name): add __method__ and __callee__ again.
	  __callee__ need to rework to adopt YARV.  [ruby-core:10671]

Tue Mar 20 11:09:00 2007  Akinori MUSHA  <knu@iDaemons.org>

	* lib/set.rb: Revise rdoc.

	* lib/set.rb (Set#freeze, Set#taint, Set#untaint): Implement
	  Set#freeze, Set#taint, and Set#untaint; requested by: Dan
	  Hutchings <dan AT moltoagitato.com> in [ruby-bugs:PR#9359].

Tue Mar 20 09:13:10 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* process.c (rb_fork): flush stdouts always before fork(2).
	  fixed: [ruby-dev:30612]

Tue Mar 20 01:38:48 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* thread.c (thread_start_func_2): store the result of first_func
	  as well as first_proc.

	* thread.c (thread_create_core): block is not used if first_func
	  is given.

Mon Mar 19 16:58:52 2007  NAKAMURA Usaku  <usa@ruby-lang.org>

	* missing/{strlcat,strlcpy}.c, missing.h: new functions.

	* LEGAL: add copyright notice about above files.

	* configure.in: check whether strlcat and strlcpy are exist or not.

	* {bcc32,win32,wince}/Makefile.sub: use above files.

Mon Mar 19 14:12:25 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* lib/matrix.rb (Matrix::inverse_from): adding partial pivoting to
	  the Gauss-Jordan algorithm, making it stable.  a patch from
	  Peter Vanbroekhoven.  [ruby-core:10641]

Mon Mar 19 12:13:36 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* regparse.c, etc.: K&R to ANSI code cleanup patch from Stefan
	  Huehner <stefan at huehner.org>.  [ruby-core:10543]

Mon Mar 19 11:27:13 2007  Minero Aoki  <aamine@loveruby.net>

	* lib/net/protocol.rb (rbuf_read): extend buffer size for speed.

Sun Mar 18 08:31:51 2007  NAKAMURA Usaku  <usa@ruby-lang.org>

	* win32/dir.h, win32/win32.c (rb_w32_opendir, rb_w32_readdir,
	  rb_w32_closedir): get rid of possible buffer-overflows.

Sat Mar 17 19:10:39 2007  Kouhei Sutou  <kou@cozmixng.org>

	* lib/rss, test/rss:
	- supported Atom.
	- bumped version 0.1.6 to 0.1.7.
	* sample/rss/convert.rb: added new sample.

Fri Mar 16 22:32:20 2007  Minero Aoki  <aamine@loveruby.net>

	* lib/net/pop.rb: change default verification mode from
	  VERIFY_PEER to VERIFY_NONE because most POPS server does not have
	  true certification.

Fri Mar 16 22:19:24 2007  Masaki Suketa  <masaki.suketa@nifty.ne.jp>

	* ext/win32ole/win32ole.c: add WIN32OLE#ole_activex_initialize,
	  a little bit supporting ActiveX control. [ruby-talk:241188]

Fri Mar 16 22:16:58 2007  Minero Aoki  <aamine@loveruby.net>

	* lib/net/http.rb: merge Ruby-SSPI patch contributed by Justin
	  Bailey.

	* ext/Win32API/lib/win32/sspi.rb: new file.

Wed Mar 14 12:30:00 2007  Shigeo Kobayashi  <shigeo@tinyforest.jp>

	* ext/bigdecimal/bigdecimal.c: BigDecimal("-.31") is now
	  treated as ("-0.31") not as ("0.31").

Tue Mar 13 19:04:30 2007  Keiju Ishitsuka <keiju@ruby-lang.org>

	* lib/sync.rb: support for ruby 1.9(YARV) thread model.

Tue Mar 13 09:25:10 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* common.mk (clear-installed-list): separated from install-prereq.

Tue Mar 13 07:23:20 2007  Shugo Maeda  <shugo@ruby-lang.org>

	* lib/monitor.rb (mon_try_enter): call @mon_muetx.try_lock.
	  Thanks, Keiju ISHITSUKA. [ruby-dev:30507]

Tue Mar 13 02:42:58 2007  Akinori MUSHA  <knu@iDaemons.org>

	* lib/cgi.rb (CGI::header): IIS >= 5.0 does not need the nph
	  assumption any more; submitted by MIYASAKA Masaru <alkaid AT
	  coral.ocn.ne.jp> in [ruby-dev:30537].

Mon Mar 12 10:53:28 2007  Akinori MUSHA  <knu@iDaemons.org>

	* ext/openssl/ossl_asn1.c (Init_ossl_asn1): Let rdoc know about
	  externally defined modules; submitted by Technorama
	  Ltd. <oss-ruby AT technorama.net> in [ruby-bugs:PR#4704].

	* ext/openssl/ossl_bn.c (Init_ossl_bn): Ditto.

	* ext/openssl/ossl_cipher.c (Init_ossl_cipher): Ditto.

	* ext/openssl/ossl_digest.c (Init_ossl_digest): Ditto.

	* ext/openssl/ossl_hmac.c (Init_ossl_hmac): Ditto.

	* ext/openssl/ossl_pkey.c (Init_ossl_pkey): Ditto.

	* ext/openssl/ossl_pkey_dh.c (Init_ossl_dh): Ditto.

	* ext/openssl/ossl_pkey_dsa.c (Init_ossl_dsa): Ditto.

	* ext/openssl/ossl_pkey_rsa.c (Init_ossl_rsa): Ditto.

	* ext/openssl/ossl_rand.c (Init_ossl_rand): Ditto.

	* ext/openssl/ossl_ssl.c (Init_ossl_ssl): Ditto.

Sun Mar 11 18:42:01 2007  Akinori MUSHA  <knu@iDaemons.org>

	* misc/ruby-mode.el (ruby-block-end-re): Support for the
	  experimental ';;' terminator had been dropped.

Sun Mar 11 05:45:46 2007  Akinori MUSHA  <knu@iDaemons.org>

	* misc/README, misc/rdebug.el: Add rdebug.el, Emacs ruby-debug
	  interface based on rubydb3x.el; submitted by Martin Nordholts
	  <enselic AT gmail.com> in [ruby-bugs:PR#9023].

Sat Mar 10 07:20:28 2007  Masaki Suketa  <masaki.suketa@nifty.ne.jp>

	* ext/win32ole/win32ole.c: add WIN32OLE_TYPELIB#library_name,
	  WIN32OLE_TYPELIB#visible?.

	* test/win32ole/test_win32ole_typelib.rb: ditto.

Thu Mar  8 09:17:59 2007  Minero Aoki  <aamine@loveruby.net>

	* compile.c: iseq_compile -> rb_iseq_compile.

	* iseq.c: ditto.

	* intern.h: provide function prototype of Init_jump.

	* eval_jump.h (Init_jump): declare function type.

	* thread.c: platform-dependent functions should be surrounded by #ifdef.

	* iseq.c (iseq_data_to_ary): remove unused variable.

	* compile.c (set_arguments): ditto.

	* thread.c (set_unblock_function): ditto.

	* thread_pthread.ci: reduce printf warning.

	* vm_dump.c: ditto.

Tue Mar  6 16:35:04 2007  Keiju Ishitsuka  <keiju@ruby-lang.org>

	* lib/shell/process-controller.rb: fix thread synchronization problem for [ruby-dev:30477].

Tue Mar  6 11:53:25 2007  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/sample/irbtkw.rbw: fails to exit process.

Tue Mar  6 10:23:09 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* runruby.rb: added --pure (turned on by default) and --debugger
	  options.

Mon Mar  5 09:19:33 2007  Minero Aoki  <aamine@loveruby.net>

	* lib/timeout.rb (Timeout.timeout): should return the block value
	  always.

	* lib/timeout.rb (Timeout.timeout): should yield sec argument
	  always.

	* lib/timeout.rb (Timeout.timeout): fix document.

Mon Mar  5 09:16:40 2007  Minero Aoki  <aamine@loveruby.net>

	* lib/net/smtp.rb: support automatic STARTTLS.

	* lib/net/smtp.rb: check server advertisement.

	* lib/net/smtp.rb: introduce new class SMTP::Response.

	* lib/net/smtp.rb (getok): should not use sprintf.

	* lib/net/smtp.rb (get_response): ditto.

	* lib/net/protocol.rb: reduce syntax warning on 1.9.

Mon Mar  5 07:13:28 2007  Minero Aoki  <aamine@loveruby.net>

	* lib/net/smtp.rb: reconstruct SMTPS/STARTTLS interface.  New
	  interface is incompatible from current 1.9 interface at all.

	* lib/net/smtp.rb: All SSL-related class methods are removed; use
	  instance methods instead.

	* lib/net/smtp.rb: rename methods: *ssl -> *tls (with alias
	  "ssl").

	* lib/net/smtp.rb: rename methods: *tls -> *starttls.

Mon Mar  5 01:36:41 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* parse.y (parser_yylex), win32/win32.c (rb_w32_utime): fixed
	  indentation broken at YARV merger.

Sun Mar  4 23:41:14 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* file.c (rb_stat_uid, rb_stat_gid, eaccess): use rb_uid_t and
	  rb_gid_t instead of int.

	* file.c (rb_stat_s_utime): fixed a commit miss for the platforms
	  where utimes() does not exist.

	* lib/fileutils.rb (touch): ditto.

Sun Mar  4 14:46:56 2007  WATANABE Hirofumi  <eban@ruby-lang.org>

	* util.c (push_element): should return a int value.

Sun Mar  4 01:01:25 2007  Akinori MUSHA  <knu@iDaemons.org>

	* lib/set.rb (Set#^, Set#&): Correct documentation.  Those methods
	  return sets, not arrays; noted by Oliver Frank Wittich <nietz AT
	  mangabrain.de>.

Sat Mar  3 22:54:33 2007  Minero Aoki  <aamine@loveruby.net>

	* lib/fileutils.rb (touch): last #touch change causes error when
	  :mtime option was not given.

Sat Mar  3 22:51:29 2007  Minero Aoki  <aamine@loveruby.net>

	* lib/fileutils.rb (mv): could not move directory between
	  different file systems. [ruby-dev:30411]

Sat Mar  3 22:37:02 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* file.c (rb_file_s_utime): allow nil to set the current time.

	* lib/fileutils.rb (touch): ditto, and added :mtime and :nocreate
	  options.  fixed: [ruby-talk:219037]

Sat Mar  3 15:52:26 2007  Akinori MUSHA  <knu@iDaemons.org>

	* object.c (instance_variable_get): Restore rdoc markups lost in
	  the last commit.

Fri Mar  2 21:17:14 2007  Masaki Suketa  <masaki.suketa@nifty.ne.jp>

	* ext/win32ole/win32ole.c (get_ptr_of_variant, ole_set_safe_array,
	  ole_val2ptr_variant, ole_val2olevariantdata, ole_variant2val,
	  ): fix some bugs of WIN32OLE_VARIANT.new when variant type is
	  VT_ARRAY|VT_BSTR or VT_BYREF.

	* ext/win32ole/win32ole.c (folevariant_s_array, folevariant_initialize):
	  WIN32OLE_VARIANT#[], WIN32OLE_VARIANT#[]=, WIN32OLE_VARIANT#value=
	  is defined as instance method of WIN32OLE_VARIANT.

	* test/win32ole/test_win32ole_variant.rb: add some test for
	  VT_ARRAY, VT_BYREF variant type.

Fri Mar  2 07:58:24 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* object.c (rb_obj_ivar_set): RDoc updated according to a
	  suggestion from Brian Candler <B.Candler AT pobox.com>.
	  [ruby-core:10469]

Thu Mar  1 21:38:07 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* parse.y (stmt, arg): should not omit lhs of OP_ASGN1 even if
	  empty.  [ruby-dev:30455]

Thu Mar  1 02:55:25 2007  Akinori MUSHA  <knu@iDaemons.org>

	* ext/digest/digest.c (get_digest_base_metadata): Allow inheriting
	  Digest::Base subclasses, which was unintentionally made
	  impossible while restructuring Digest classes.

Thu Mar  1 02:05:17 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* mkconfig.rb (patchlevel): read from version.h.

Wed Feb 28 21:15:00 2007  WATANABE Hirofumi  <eban@ruby-lang.org>

	* configure.in (ac_cv_func_fcntl): fcntl support for MinGW.

	* missing/flock.c: workaround for MinGW.

Wed Feb 28 20:51:32 2007  URABE Shyouhei  <shyouhei@ruby-lang.org>

	* pack.c (pack_unpack): properly ignore non-base64 octets such as
	  UTF-8 encoded BOMs; submitted by SOUMA Yutaka <holon@radastery.jp>
	  to fix [ruby-core:10437]

Wed Feb 28 18:31:51 2007  NAKAMURA Usaku  <usa@ruby-lang.org>

	* ext/openssl/extconf.rb: no need to check unistd.h and sys/time.h.
	  they are already checked at configure.
	  reported by KOBAYASHI Yasuhiro [ruby-list:43225]

Wed Feb 28 18:23:43 2007  NAKAMURA Usaku  <usa@ruby-lang.org>

	* lib/mkmf.rb ($DEFLIBPATH): default library paths ($(topdir), etc)
	  should be the first elements of library paths list.
	  reported by KOBAYASHI Yasuhiro [ruby-list:43225]

Wed Feb 28 10:33:58 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* Makefile.in, configure.in, */Makefile.sub (THREAD_MODEL): system
	  specific thread model.

	* compile.h, regint.h, vm.h, array.c: removed unnecessary #include.

Wed Feb 28 04:03:03 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* enum.c (take_i): small cosmetic / documentation patch from
	  Tadashi Saito <shiba AT mail2.accsnet.ne.jp>. [ruby-dev:30446]

Wed Feb 28 01:20:18 2007  NAKAMURA Usaku  <usa@ruby-lang.org>

	* test/{dbm,gdbm}/test_{dbm,gdbm}.rb: shouldn't use host_os. use
	  target_os instead. reported by KOBAYASHI Yasuhiro [ruby-list:43225]

Wed Feb 28 00:08:11 2007  URABE Shyouhei  <shyouhei@ice.uec.ac.jp>

	* mkconfig.rb (RbConfig): add CONFIG['PATCHLEVEL']

	* common.mk: new target dist

	* distruby.rb: new file

Tue Feb 27 22:18:45 2007  WATANABE Hirofumi  <eban@ruby-lang.org>

	* configure.in (--enable-auto-image-base): avoid the neccessity to
	  rebase the shared libs as much as possible;
	  submitted by Corinna Vinschen <spam at vinschen.de> in
	  [ruby-talk:240964].

Tue Feb 27 21:36:47 2007  WATANABE Hirofumi  <eban@ruby-lang.org>

	* util.c (__crt0_glob_function): use ruby_glob() instead of rb_globi().

Tue Feb 27 21:33:04 2007  WATANABE Hirofumi  <eban@ruby-lang.org>

	* configure.in (ac_cv_func_setrlimit): workaround for djgpp.

Tue Feb 27 20:35:28 2007  NAKAMURA Usaku  <usa@ruby-lang.org>

	* common.mk (error.c, process.c): depend on yarvcore.h and rubysig.h.

Tue Feb 27 19:26:31 2007  Akinori MUSHA  <knu@iDaemons.org>

	* ext/nkf/nkf.c (rb_str_resize, rb_nkf_kconv, rb_nkf_guess1,
	  rb_nkf_guess2): Silence warnings regarding char * vs. unsigned
	  char * mismatch; submitted by Lyle Johnson
	  <lyle.johnson@gmail.com> in [ruby-core:10416].

Tue Feb 27 19:15:01 2007  Akinori MUSHA  <knu@iDaemons.org>

	* lib/base64.rb (Base64::b64encode): Fix documentation; submitted
	  by David Symonds <dsymonds@gmail.com> in [ruby-core:10432].

Tue Feb 27 18:59:42 2007  Akinori MUSHA  <knu@iDaemons.org>

	* ext/bigdecimal/bigdecimal.c (BigDecimal_load): Silence warnings
	  regarding char * vs. unsigned char * mismatch; submitted by Lyle
	  Johnson <lyle.johnson@gmail.com> in [ruby-core:10416].

	* ext/digest/sha1/sha1ossl.c (SHA1_Finish): Ditto.

	* ext/digest/rmd160/rmd160ossl.c (RMD160_Finish): Ditto.

	* ext/digest/digest.c (rb_digest_base_finish,
	  rb_digest_base_update): Ditto.

Tue Feb 27 18:12:05 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* enum.c (enum_take): new method.  [ruby-dev:30407]

	* enum.c (enum_drop): ditto.

Tue Feb 27 07:47:24 2007  Koichi Sasada  <ko1@atdot.net>

	* yarvcore.h, vm.h: rename th_invoke_yield() to th_yield().

	* blockinlining.c: ditto.

	* eval.c: ditto.

	* vm.c, insns.def: rename th_invoke_yield_cfunc()
	  to th_yield_with_cfunc().

	* yarvcore.h, yarvcore.c: rename theYarvVM to ruby_current_vm and
	  yarvCurrentThread to ruby_current_thread.  remove yarvVMArray.

Tue Feb 27 00:45:23 2007  Minero Aoki  <aamine@loveruby.net>

	* test/ruby/test_optimization.rb: restore method before calling
	  assert_equal.

Mon Feb 26 00:58:39 2007  Koichi Sasada  <ko1@atdot.net>

	* yarvcore.h: add rb_thread_t#top_wrapper, top_self.

	* eval_load.c (rb_load): support eval in wrapper module
	  (load(file, true)).

	* eval.c: ditto.

	* eval_jump.h: ditto.

	* iseq.c: ditto.

	* vm.c: ditto.

	* yarvcore.c: ditto.

	* insns.def: add a empty line.

Mon Feb 26 00:54:36 2007  Koichi Sasada  <ko1@atdot.net>

	* common.mk: change "gdb" rule.  You can debug miniruby with
	  $(srcdir)/test.rb on gdb by this rule (type "make gdb").
	  If you write break points to "breakpoints.gdb" on $srcdir,
	  gdb runs with this file.

Sun Feb 25 11:46:58 2007  Koichi Sasada  <ko1@atdot.net>

	* win32/Makefile.sub: enable -Zi (debug) option.

Sun Feb 25 11:38:40 2007  Koichi Sasada  <ko1@atdot.net>

	* ruby.h: define RUBY_VM macro and remove NATIVETHREAD* macros.

	* intern.h: ditto.

	* signal.c (posix_signal): remove unused function
	  posix_nativethread_signal().

Sun Feb 25 11:31:13 2007  Koichi Sasada  <ko1@atdot.net>

	* thread.c (rb_thread_run): fix to ANSI style.

Sun Feb 25 11:09:16 2007  Minero Aoki  <aamine@loveruby.net>

	* bootstraptest/runner.rb: show source code in error message.

Sun Feb 25 09:39:50 2007  Koichi Sasada  <ko1@atdot.net>

	* yarvcore.h:
	  rename:
	    rb_iseq_t#file_name -> filename
	    rb_iseq_t#local_tbl -> local_table
	  add:
	    rb_iseq_t#local_table_size

	* compile.c: separate local_table_size and local_size
	  (local variable size)

	* blockinlining.c: apply above rename.

	* compile.h: ditto.

	* eval.c: ditto.

	* iseq.c: ditto.

	* proc.c: ditto.

	* vm.c: ditto.

	* vm_dump.c: ditto.

Sun Feb 25 10:27:17 2007  Minero Aoki  <aamine@loveruby.net>

	* bootstraptest/runner.rb: add lib/ to load path.

Sat Feb 25 10:16:50 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* rubyio.h (HAVE_RB_IO_T): macro to tell if rb_io_t is defined.

Sat Feb 24 19:39:16 2007  Minero Aoki  <aamine@loveruby.net>

	* common.mk: new target "btest", to run bootstraptests.

Sat Feb 24 19:30:40 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* file.c, gc.c, io.c, ruby.h, rubyio.h, win32/win32.h (rb_io_t):
	  renamed from OpenFile.

	* ext/dl/cptr.c, ext/io/wait/wait.c, ext/openssl/ossl.h,
	  ext/openssl/ossl_bio.c, ext/openssl/ossl_ssl.c, ext/pty/pty.c,
	  ext/readline/readline.c, ext/socket/socket.c: ditto.

Sat Feb 24 19:28:23 2007  Minero Aoki  <aamine@loveruby.net>

	* bootstraptest/runner.rb: new option -v,--verbose.

Sat Feb 24 18:55:50 2007  Minero Aoki  <aamine@loveruby.net>

	* yarvtest/test_method.rb: removed (merged to bootstraptest).

	* yarvtest/test_class.rb: ditto.

Sat Feb 24 18:44:39 2007  Minero Aoki  <aamine@loveruby.net>

	* bootstraptest/test_class.rb: new file.

	* bootstraptest/test_method.rb: add tests.

Sat Feb 24 18:44:30 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* intern.h (rb_thread_blocking_region): add prototype.

	* file.c (rb_thread_flock, rb_file_flock): use UBF feature.

	* process.c (rb_waitpid_blocking, rb_waitpid): use UBF feature.

	* thread.c (rb_thread_debug): added runtime debugging flag.

	* thread.c (BLOCKING_REGION): restore previous UBF.

	* thread.c (rb_thread_blocking_region): default UBF to interrupt
	  in system dependent way by RB_UBF_DFL.
	  + ubf_select() on posix system
	  + ubf_handle() on Win32
	  + none on cygwin

	* thread_win32.ci (rb_w32_wait_events_blocking): blocking version.

	* win32/win32.c (waitpid): use rb_w32_wait_events_blocking().

Sat Feb 24 17:45:48 2007  Minero Aoki  <aamine@loveruby.net>

	* parse.y (f_arg, opt_f_block_arg): ripper should export VALUE.

Sat Feb 24 16:52:55 2007  Minero Aoki  <aamine@loveruby.net>

	* bootstraptest/runner.rb: fix syntax error.

Sat Feb 24 16:51:09 2007  Minero Aoki  <aamine@loveruby.net>

	* bootstraptest/runner.rb: new option --help.

Sat Feb 24 16:47:33 2007  Minero Aoki  <aamine@loveruby.net>

	* bootstraptest: new test suite.

	* bootstraptest/runner.rb: new file.

	* bootstraptest/test_literal.rb: new file.

	* bootstraptest/test_method.rb: new file.

Sat Feb 24 16:29:15 2007  NAKAMURA Usaku  <usa@ruby-lang.org>

	* win32/win32.c (StartSocket): remove unnecessary code.

Sat Feb 24 16:04:30 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* parse.y (struct local_vars): remove unused nofree member from
	  struct.

	* parse.y (parser_free): ditto.

Sat Feb 24 15:57:19 2007  Shugo Maeda  <shugo@ruby-lang.org>

	* lib/thread.rb (ConditionVariable#broadcast): use Mutex
	  instead of Thread.exclusive.

	* lib/monitor.rb (MonitorMixin#mon_exit): unset @mon_owner
	  before calling Mutex#unlock.

Sat Feb 24 15:51:45 2007  Minero Aoki  <aamine@loveruby.net>

	* parse.y (program): remove useless assignment to reduce warning.

Sat Feb 24 15:41:51 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* parse.y (lambda): remove unused clause from the rule to stop
	  warning.

Sat Feb 24 15:41:22 2007  Shugo Maeda  <shugo@ruby-lang.org>

	* lib/thread.rb: do not redefine Mutex#synchronize.

Sat Feb 24 15:14:02 2007  Shugo Maeda  <shugo@ruby-lang.org>

	* lib/monitor.rb: rewritten using Mutex/ConditionVariable.

Sat Feb 24 13:25:32 2007  Koichi Sasada  <ko1@atdot.net>

	* lib/soap/mapping/factory.rb: catch up with spec changes (return
	  Symbols instead of Strings).

	* lib/soap/mapping/mapping.rb: ditto.

Sat Feb 24 10:49:55 2007  Koichi Sasada  <ko1@atdot.net>

	* parse.y, node.h, compile.c: change node tree structure.  a purpose
	  of this change is to unify argument structure of method and block.
	  this change prohibits duplicate block parameter name.
	  new argument infromation:
	    NODE_ARGS	  [m: int, o: NODE_OPT_ARG, ->]
	    NODE_ARGS_AUX [r: ID, b: ID, ->]
	    NODE_ARGS_AUX [Pst: id, Plen: int, init: NODE*]
	  optarg information:
	    NODE_OPT_ARGS [idx, expr, ->]

	* vm_macro.def: ditto.

	* gc.c: ditto.

	* iseq.c: ditto.

	* compile.h: fix debug function name.

	* test/ripper/test_scanner_events.rb: |_,_,foo| -> |_1,_2,foo|

	* test/ruby/test_lambda.rb: disalbe test temporarily.

Sat Feb 24 10:46:28 2007  Koichi Sasada  <ko1@atdot.net>

	* test/testunit/test_testcase.rb: catch up with current instance
	  variable spec.

Sat Feb 24 10:32:59 2007  Koichi Sasada  <ko1@atdot.net>

	* common.mk: change vm_macro.def rule.

Sat Feb 24 10:38:05 2007  Minero Aoki  <aamine@loveruby.net>

	* ext/racc/cparse/cparse.c (cparse_params_mark): remove useless
	  rb_gc_mark.  Thanks Tomoyuki Chikanaga. [ruby-dev:30405]

Sat Feb 24 07:31:35 2007  Masaki Suketa  <masaki.suketa@nifty.ne.jp>

	* ext/win32ole/win32ole.c: add WIN32OLE_VARIANT.array,
	  WIN32OLE_VARIANT#value=, refactoring.

	* test/win32ole/test_win32ole_variant.rb: add some test for
	  WIN32OLE_VARIANT.array, WIN32OLE_VARIANT#value=.

Fri Feb 23 18:37:55 2007  Minero Aoki  <aamine@loveruby.net>

	* test/ruby/test_yield.rb: new test.

	* yarvtest/test_yield.rb: removed (moved to test_yield.rb).

Fri Feb 23 18:27:17 2007  NAKAMURA Usaku  <usa@ruby-lang.org>

	* thread.c (rb_thread_polling): check interrupts here.

	* thread_win32.ci (w32_wait_events): rename from w32_wait_event(), and
	  now receive multiple event handles.

	* win32/win32.c (wait_events, rb_w32_main_context): removed.

	* thread_win32.ci (rb_w32_wait_events): new function.

	* thread_win32.ci, win32/win32.c (rb_w32_sleep, rb_w32_Sleep): move
	  from win32/win32.c to thread_win32.ci, and use w32_wait_events().

Fri Feb 23 18:13:22 2007  Minero Aoki  <aamine@loveruby.net>

	* test/ruby/test_optimization.rb: new test (merges test_opts.rb).

	* yarvtest/test_opts.rb: removed.

Fri Feb 23 16:59:39 2007  Minero Aoki  <aamine@loveruby.net>

	* test/ruby/test_assignment.rb: merge yarvtest/test_massign.

	* yarvtest/test_massign.rb: removed (merged to
	  test_assignment.rb).

Fri Feb 23 15:58:20 2007  NAKAMURA Usaku  <usa@ruby-lang.org>

	* signal.c (sighandler): need to re-install sighandler on some
	  platforms.

Fri Feb 23 15:05:57 2007  NAKAMURA Usaku  <usa@ruby-lang.org>

	* win32/win32.c (set_pioinfo_extra): simplified.

Fri Feb 23 14:23:20 2007  Minero Aoki  <aamine@loveruby.net>

	* test/ruby/test_literal.rb: new test.

Fri Feb 23 12:40:12 2007  James Edward Gray II  <james@grayproductions.net>

	* lib/xmlrpc/client.rb (XMLRPC::Client::do_rpc): Make the
	  Content-Length parameter optional for responses in
	  xmlrpc/client.rb; suggested by Daniel Berger
	  <Daniel.Berger@qwest.com> and approved by the maintainer.

	* lib/xmlrpc/create.rb (XMLRPC::Create::conv2value): Add DateTime
	  support to xmlrpc; approved by the maintainer.

Fri Feb 23 12:24:46 2007  Minero Aoki  <aamine@loveruby.net>

	* parse.y (lambda): add ripper event.  This fixes bus error on
	  "make test-all".

	* ext/ripper/extconf.rb: do not stop build.

Fri Feb 23 12:16:05 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* parse.y: remove dyna_check_gen() prototype.

Fri Feb 23 11:41:21 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* parse.y, compile.c, gc.c, insns.def, intern.h, iseq.c, node.h,
	  object.c, string.c, variable.c, vm_macro.def: revert private
	  instance variable feature, which is postponed until next major
	  release.

	* marshal.c: TYPE_SYMBOL2 removed; MARSHAL_MINOR reverted back to
	  8th version.

Fri Feb 23 10:53:21 2007  Shugo Maeda  <shugo@ruby-lang.org>

	* thread_pthread.ci (native_mutex_lock): do not call
	  pthread_mutex_trylock().

Fri Feb 23 10:31:16 2007  Minero Aoki  <aamine@loveruby.net>

	* dln.c: use dlopen on Mac OS X 10.3 or later.

Fri Feb 23 10:03:49 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* string.c (rb_str_ord): need not to check string length;  ord
	  returns a codepoint for the first character in the string.

Wed Feb 21 22:29:45 2007  Akinori MUSHA  <knu@iDaemons.org>

	* numeric.c (fix_equal): A bit more optimization.

Wed Feb 21 17:40:37 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* numeric.c (fix_equal): remove FIX2LONG() to optimize.  suggested
	  in http://t-a-w.blogspot.com/2007/02/making-ruby-faster.html.
	  [ruby-talk:240223]

	* numeric.c (fix_cmp): ditto.

Wed Feb 21 09:14:04 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* eval_load.c (rb_require_safe): should restore safe level.

Tue Feb 20 21:19:29 2007  Masaki Suketa  <masaki.suketa@nifty.ne.jp>

	* ext/win32ole/win32ole.c (installed_code_page_proc,
	  ole_variant2val): small refactoring.

Tue Feb 20 15:11:42 2007  Koichi Sasada  <ko1@atdot.net>

	* eval.c, vm.c, yarvcore.h: move definition of rb_call_super() to
	  vm.c from eval.c.  change th_call_super() to static function.

Tue Feb 20 15:08:25 2007  Koichi Sasada  <ko1@atdot.net>

	* test/io/nonblock/test_flush.rb: YARV doesn't raise any errors if
	  another thread close IO object which current thread is blocking with.

Tue Feb 20 15:03:29 2007  Koichi Sasada  <ko1@atdot.net>

	* thread.c (do_select, rb_thread_wait_fd_rw): raise sys error if
	  errno is not 0 and EBADF.

Mon Feb 19 22:15:31 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* configure.in (RUBY_REPLACE_TYPE): cache convertible type info.

	* intern.h (rb_detach_process): use rb_pid_t instead of pid_t.

	* ruby.h (PIDT2NUM, NUM2PIDT, UIDT2NUM, NUM2UIDT, GIDT2NUM, NUM2GIDT):
	  defaulted to conversion using long.

Mon Feb 19 17:14:28 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* ext/socket/socket.c (unix_peeraddr): wrong syscall name in error
	  message for #peeraddr. a patch from Sam Roberts
	  <sroberts at uniserve.com>.  [ruby-core:10366]

Sun Feb 18 22:56:07 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* ext/etc/etc.c (etc_getgrgid): missed to replace a macro.

Sun Feb 18 19:33:00 2007  Tadayoshi Funaba  <tadf@dotrb.org>

	* lib/date/format.rb: updated based on date2 4.0.3.

Sun Feb 18 13:11:51 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* configure.in (pid_t, uid_t, gid_t): check if defined.

	* intern.h, process.c, rubyio.h, ext/etc/etc.c, ext/pty/pty.c: use
	  rb_{pid,uid,gid}_t instead of plain int.  [ruby-dev:30376]

	* ext/etc/extconf.rb (PIDT2NUM, NUM2PIDT, UIDT2NUM, NUM2UIDT, GIDT2NUM,
	  NUM2GIDT): moved to configure.in.

Fri Feb 16 21:34:33 2007  Koichi Sasada  <ko1@atdot.net>

	* object.c (rb_obj_ivar_set/get/defined): fix to check :@_v/C id.

	* test/testunit/test_testcase.rb: fix to use instance_variable_get()
	  to access @_result.

Fri Feb 16 20:59:10 2007  Koichi Sasada  <ko1@atdot.net>

	* intern.h: add a prototype of rb_sym_to_s().

Fri Feb 16 19:24:22 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* math.c (math_log): update document to mention second optional
	  argument for logarithm base.

Fri Feb 16 19:19:21 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* parse.y (mrhs): need to append by arg_append().
	  [ruby-talk:239385]

Fri Feb 16 11:18:21 2007  Eric Hodel  <drbrain@segment7.net>

	* lib/.document: Apply patch for irb, e2mmap and README by Hugh Sasse
	<hgs at dmu.ac.uk> from [ruby-core:10135]

	* lib/prettyprint.rb: Suppress RDoc for PrettyPrint test suite.

Thu Feb 15 20:48:36 2007  NAKAMURA Usaku  <usa@ruby-lang.org>

	* win32/win32.c (set_pioinfo_extra): new function for VC++8 SP1
	  workaround. [ruby-core:10259]

	* win32/win32.c (NtInitialize): call above function.

Thu Feb 15 16:25:54 2007  Akinori MUSHA  <knu@iDaemons.org>

	* lib/uri/generic.rb (URI::Generic::userinfo): Considering how
	  `scheme://user:@...', `scheme://:password@...' and
	  `scheme://:@...' are parsed, an empty user name or password
	  should be allowed and represented as it is.

Thu Feb 15 01:52:53 2007  Koichi Sasada  <ko1@atdot.net>

	* vm.(c|h), yarvcore.(c|h) (yarvGlobalStateVersion): rename to
	  ruby_vm_global_state_version.

Thu Feb 15 01:50:26 2007  Koichi Sasada  <ko1@atdot.net>

	* test/fileutils/test_fileutils.rb (check_singleton): fix to use
	  symbole instead of string.

	* test/io/nonblock/test_flush.rb: enable tests.

	* test/xmlrpc/test_webrick_server.rb: ditto.

Thu Feb 15 01:43:45 2007  Koichi Sasada  <ko1@atdot.net>

	* lib/delegate.rb: catch up with class local variable (@_v) spec.

	* lib/singleton.rb: ditto.

Wed Feb 14 22:52:43 2007  Masaki Suketa  <masaki.suketa@nifty.ne.jp>

	* ext/win32ole/win32ole.c (ole_variant2val): VC++6 does not
	  support VT_I8, VT_UI8.

Wed Feb 14 22:10:21 2007  Koichi Sasada  <ko1@atdot.net>

	* configure.in: change stack limit to 2MB from 32MB.

	* win32/Makefile.sub: ditto.

Wed Feb 14 21:39:36 2007  Akinori MUSHA  <knu@iDaemons.org>

	* ext/digest/lib/digest.rb (Digest::self.const_missing): Drop
	  autoloads for sha2 classes in favor of handling in
	  const_missing(), to work around a problem exposed on OS X.

Wed Feb 14 21:19:47 2007  Koichi Sasada  <ko1@atdot.net>

	* thread_pthread.ci (native_thread_create): adjust 4KB (page size)
	  alignment.

Wed Feb 14 21:12:36 2007  Koichi Sasada  <ko1@atdot.net>

	* thread_pthread.ci (CHECK_ERR): call rb_bug()
	  instead of printf() and exit().

Wed Feb 14 16:48:56 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* lib/date/format.rb (Date::Format::Bag::method_missing): need not
	  to use instance variables corresponding each method; use Hash
	  instead.

Wed Feb 14 13:12:06 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* re.c (reg_operand): allow symbols to be operands for regular
	  expression matches.

	* string.c (Init_String): allow Symbol#===.

	* lib/date/format.rb (Date::Format::Bag::to_hash): string
	  added prefixes.

Wed Feb 14 12:58:38 2007  Koichi Sasada  <ko1@atdot.net>

	* thread.c (do_select): fix to iterate select().
	  on cygwin/mswin32, iterate in unblocking region.

	* thread.c (rb_thread_select): don't iterate on this function.
	  (iterate in do_select).

Wed Feb 14 11:39:18 2007  Koichi Sasada  <ko1@atdot.net>

	* thread.c (set_unblock_function): fix function interface.

Wed Feb 14 11:12:02 2007  Koichi Sasada  <ko1@atdot.net>

	* eval_load.c, yarvcore.h: use rb_vm_t#loaded_features instead of
	  rb_features (global variable).

	* yarvcore.c: mark rb_vm_t#loaded_features.

Wed Feb 14 08:46:25 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* compile.c (defined_expr): no longer distinguish ordinary local
	  variables and in-block local variables in defined? value.

Wed Feb 14 03:14:42 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* lib/uri/generic.rb (URI::Generic::userinfo): should support
	  empty password.  [ruby-core:10290]

	* lib/uri/generic.rb (URI::Generic::set_password): password can be
	  cleared by nil.  [ruby-core:10290]

Wed Feb 14 03:10:33 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* parse.y (struct local_vars): no need to warn out-of-scope
	  variables; remove dnames member from struct.

Wed Feb 14 03:04:10 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* parse.y: RVarmap no longer used as yytype; removed.

	* parse.y (dyna_push_gen): no longer need return value.

	* parse.y (dyna_pop_gen): no longer need argument.

	* parse.y (local_push_gen): initialize nofree.

Wed Feb 14 00:30:07 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* ext/socket/socket.c (init_unixsock): path may contain NUL for
	  abstract unix sockets.  [ruby-core:10288]

Tue Feb 13 02:21:12 2007  Sam Roberts  <sroberts@uniserve.com>

	* io.c (rb_f_syscall): Fix buffer overflow with syscall
	  arguments.  [ruby-bugs:PR#8541]

Mon Feb 12 13:57:30 2007  Masaki Suketa  <masaki.suketa@nifty.ne.jp>

	* ext/win32ole/win32ole.c (ole_variant2val): support VT_I8, VT_UI8.

Mon Feb 12 11:48:52 2007  Kouhei Sutou  <kou@cozmixng.org>

	* lib/rss/dublincore.rb, lib/rss/maker/dublincore.rb: dc_rightses
	  -> dc_rights_list. dc_rightses still exists for backward
	  compatibility. [ruby-core:8350]

	* test/rss/test_maker_dc.rb: added tests for dc_rights_list.

Sun Feb 11 22:40:17 2007  Masaki Suketa  <masaki.suketa@nifty.ne.jp>

	* ext/win32ole/win32ole.c (ole_ptrtype2val): ole_type, ole_type_detail
	  should not return "VARIANT,VARIANT".

Sun Feb 11 22:11:05 2007  Kouhei Sutou  <kou@cozmixng.org>

	* lib/rss/xml-stylesheet.rb (RSS::XMLStyleSheet#initialize):
	  kept backward compatibility.

Sun Feb 11 22:10:08 2007  Kouhei Sutou  <kou@cozmixng.org>

	* lib/rss/parser.rb (RSS::ListenerMixin#start_else_element): used
	  const_defined? instead of constants.include?.

Sun Feb 11 18:47:14 2007  Masaki Suketa  <masaki.suketa@nifty.ne.jp>

	* ext/win32ole/win32ole.c (ole_val2olevariantdata):
	  WIN32OLE_VARIANT#new accepts nil when variant type is VT_ARRAY.

	* test/win32ole/test_win32ole_variant.rb: ditto.

	* ext/win32ole/win32ole.c: small refactoring.

Sun Feb 11 07:42:25 2007  Akinori MUSHA  <knu@iDaemons.org>

	* lib/cgi.rb (CGI::QueryExtension::read_multipart): Properly parse
	  a quoted-string in a Content-Disposition value.

Sat Feb 10 20:21:29 2007  Masaki Suketa  <masaki.suketa@nifty.ne.jp>

	* ext/win32ole/win32ole.c: add WIN32OLE#ole_query_interface.
	  thanks to Mikael Pahmp.

	* test/win32ole/test_win32ole.rb: ditto.

Sat Feb 10 17:46:52 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* common.mk: targets which depend on yarvcore.h now depend on
	  rubysig.h too.

	* yarvcore.h (rb_vm_t): use rb_atomic_t instead of int.

Sat Feb 10 00:13:11 2007  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/lib/tk.rb: fix typo (TkConfigMethod::__confinfo_cmd,
	  __conv_keyonly_opts).

Fri Feb  9 12:33:40 2007  Koichi Sasada  <ko1@atdot.net>

	* thread_win32.ci (w32_show_error_message): renamed to w32_error.
	  this function do rb_bug().

	* thread_win32.ci (w32_set_event, w32_reset_event, w32_close_handle,
	  w32_resume_thread): added. fix to use these functions instead calling
	  win32api directly.

	* thread_win32.ci (w32_create_thread): create suspend thread
	  (caller must call w32_resume_thread()).

Fri Feb  9 11:03:40 2007  Koichi Sasada  <ko1@atdot.net>

	* test/ruby/test_readpartial.rb: tests are working on mswin32/cygwin.

Fri Feb  9 05:08:17 2007  Koichi Sasada  <ko1@atdot.net>

	* thread.c, thread_pthread.ci, thread_win32.ci (thread_start_func_1):
	  move cleanup function to thread_start_func_2().

	* thread.c, thread_pthread.ci, thread_win32.ci:
	  add more destruct functions.
	  (native_thread_destroy() and native_mutex_destroy())

	* thread_pthread.ci, thread_pthread.h: make native_mutex_* functions
	  (check error, etc), it's not macro any more.

	* thread_win32.ci (thread_start_func_1): store some values before
	  running thread (to release these after running thread).

	* thread_win32.ci (native_thread_create): fix spaces.

Thu Feb  8 22:44:04 2007  Masaki Suketa  <masaki.suketa@nifty.ne.jp>

	* ext/win32ole/win32ole.c (ole_set_safe_array, ole_variant2val,
	  ole_val_ary2variant_ary): fix WIN32OLE_VARIANT.new bug when
	  1st argument is empty array, and when 2nd argument is
	  VT_ARRAY|VT_BYREF.

	* test/win32ole/test_win32ole_variant.rb: ditto.

Thu Feb  8 22:39:09 2007  Koichi Sasada  <ko1@atdot.net>

	* yarvtest/yarvtest.rb: check target command names.

Thu Feb  8 22:31:45 2007  Koichi Sasada  <ko1@atdot.net>

	* test/ruby/test_clone.rb: fix to current spec
	  (Module should not be occur many times in ancestors).

Thu Feb  8 22:26:14 2007  Koichi Sasada  <ko1@atdot.net>

	* test/ruby/test_string.rb: ("foo" == :foo) and ("foo" === :foo)
	  should be false.

	* ChangeLog: fix last messages.

Thu Feb  8 22:24:06 2007  Koichi Sasada  <ko1@atdot.net>

	* test/ruby/test_module.rb: fix to use Symbol instead of String.

	* test/ruby/test_module.rb: remove space before argument parentheses.

Thu Feb  8 22:02:14 2007  Koichi Sasada  <ko1@atdot.net>

	* test/ruby/marshaltestlib.rb: eval(sym) -> eval(sym.to_s)

Thu Feb  8 21:35:16 2007  Masaki Suketa  <masaki.suketa@nifty.ne.jp>

	* test/win32ole/test_propertyputref.rb (setup): fix typo.

	* test/win32ole/test_win32ole_event.rb: should not use
	  InternetExplorer.gohome to test.

Thu Feb  8 21:02:07 2007  Koichi Sasada  <ko1@atdot.net>

	* thread.c (GVL_UNLOCK_RANGE): rename to BLOCKING_REGION().

	* thread.c (rb_thread_run_parallel): rename to
	  rb_thread_blocking_region().

Thu Feb  8 15:48:44 2007  Koichi Sasada  <ko1@atdot.net>

	* yarvcore.h, thread.c: fix to use pthread on cygwin.

	* yarvcore.h, thread.c: move GVL_UNLOCK_BEGIN() and GVL_UNLOCK_END()
	  from yarvcore.h to thread.c.

	* thread.c: change GVL_UNLOCK_RANGE() arguments
	  (adding ubf as 2nd argument).

	* thread.c: fix to use polling in select on cygwin and mswin32.

	* thread.c, thread_pthread.ci, thread_win32.ci, yarvcore.h:
	  rename:
	  * rb_thread_t#interrupt_function -> unblock_function
	  * rb_interrupt_function_t -> rb_unblock_function
	  * some interrupt function name -> ubf_*
	  * yarv_* -> *

Thu Feb  8 16:08:02 2007  Koichi Sasada  <ko1@atdot.net>

	* common.mk: fix to use RUNRUBY instead of BASERUBY if possible.

	* common.mk ($(INSNS) rule): remove $(PROGRAM) first.

Thu Feb  8 15:43:05 2007  Koichi Sasada  <ko1@atdot.net>

	* process.c: fix to use rb_status_line_set/get/clear().

	* eval_intern.h: fix line break.

Thu Feb  8 15:00:14 2007  Koichi Sasada  <ko1@atdot.net>

	* blockinlining.c, error.c, eval.c, eval_error.h, eval_intern.h,
	  eval_jump.h, eval_load.c, eval_safe.h, gc.c, proc.c, signal.c,
	  thread.c, thread_pthread.ci, thread_win32.ci, vm.c, vm.h,
	  vm_dump.c, vm_evalbody.ci, yarvcore.c, yarvcore.h:
	  fix typo (rb_thead_t -> rb_thread_t).

	* eval_intern.h: remove unused definitions.

	* common.mk: fix around vm_opts.h path
	  and remove harmful argument passed to insns2vm.rb.

Thu Feb  8 03:11:47 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* lib/cgi.rb (CGI::unescapeHTML): invalid decoding for single
	  unescaped ampersand.  a patch from Tietew
	  <tietew+ruby-dev at tietew.net> in [ruby-dev:30292].
	  fixed: [ruby-dev:30289]

Wed Feb  7 23:25:31 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* eval.c (specific_eval): suppress warning.

	* thread_win32.h: undefine _WIN32 on cygwin.  [ruby-dev:30303]

Wed Feb  7 22:41:34 2007  Koichi Sasada  <ko1@atdot.net>

	* eval_intern.h: remove UNSUPPORTED() macro.

	* thread.c: fix to define Continuation methods
	  (they only do rb_notimplement()).

Wed Feb  7 22:33:58 2007  Koichi Sasada  <ko1@atdot.net>

	* eval_intern.h, yarvcore.h: remove unused macro definition.

Wed Feb  7 22:30:28 2007  Koichi Sasada  <ko1@atdot.net>

	* eval.c: fixed to use ANSI function style.

Wed Feb  7 09:35:32 2007  Koichi Sasada  <ko1@atdot.net>

	* this commit is a result of refactoring. only renaming functions,
	  moving definitions place, add/remove prototypes, deleting
	  unused variables and removing yarv.h.
	  This commit doesn't change any behavior of ruby/vm.

	* yarv.h, common.mk: remove yarv.h (contents are moved to yarvcore.h).

	* error.c, eval_intern.h: include yarvcore.h instead yarv.h

	* rename some functions:
	  * debug.[ch]: debug_*() -> ruby_debug_*()
	  * iseq.c: iseq_*() -> rb_iseq_*(), ruby_iseq_disasm()
	  * iseq.c: node_name() -> ruby_node_name()
	  * vm.c: yarv_check_redefinition_opt_method() ->
	          rb_vm_check_redefinition_opt_method()

	* some refactoring with checking -Wall.

	* array.c: remove rb_ary_ptr() (unused) and remove unused
	  local variables.

	* object.c: add a prototype of rb_mod_module_exec().

	* eval_intern.h (ruby_cref): set it inline.

	* eval_load.c (rb_load), yarvcore.c: yarv_load() -> rb_load_internal().

	* parse.y: add a prototype of rb_parse_in_eval() (in eval.c).

	* process.c: add a prototype of rb_thread_stop_timer_thread() (in thread.c).

	* thread.c: remove raw_gets() function (unused) and fix some format
	  mismatch (format mismatchs have remained yet. this is todo).

	* thread.c (rb_thread_wait_fd_rw): fix typo on label name.

	* thread_pthread.ci: comment out codes with USE_THREAD_CACHE.

	* vm.c (rb_svar, rb_backref_get, rb_backref_get,
	  rb_lastline_get, rb_lastline_set) : moved from yarvcore.c.

	* vm.c (yarv_init_redefined_flag): add a prototype and rename
	  yarv_opt_method_table to vm_opt_method_table.

	* vm.c (rb_thread_eval): moved from yarvcore.c.

	* yarvcore.c: remove unused global variables and fix to use nsdr().

Wed Feb  7 03:39:32 2007  Koichi Sasada  <ko1@atdot.net>

	* blockinlining.c, compile.c, compile.h, error.c, eval.c,
	  eval_intern.h, eval_jump.h, eval_load.c, eval_method.h,
	  eval_safe.h, gc.c, insnhelper.h, insns.def, iseq.c, proc.c,
	  process.c, signal.c, thread.c, thread_pthread.ci, thread_win32.ci,
	  vm.c, vm.h, vm_dump.c, vm_evalbody.ci, vm_macro.def,
	  yarv.h, yarvcore.h, yarvcore.c: change type and macro names:
	  * yarv_*_t -> rb_*_t
	  * yarv_*_struct -> rb_*_struct
	  * yarv_tag -> rb_vm_tag
	  * YARV_* -> RUBY_VM_*

	* proc.c, vm.c: move functions about env object creation
	  from proc.c to vm.c.

	* proc.c, yarvcore.c: fix rb_cVM initialization place.

	* inits.c: change Init_ISeq() order (after Init_VM).

	* ruby.h, proc.c: change declaration place of rb_cEnv
	  from proc.c to ruby.c.

Tue Feb 06 22:06:45 2007  NARUSE, Yui  <naruse@ruby-lang.org>

	* ext/nkf/nkf-utf8/{nkf.c,utf8tbl.c}:
	  imported nkf 2007-01-28.
	  * Fixed: can't decode MIME encode JIS string.
	  * Fixed: Fullwitdh-halfwidth conversion.
	  * Support DoCoMo's and Softbank's EMOJI
	  * Support CP932, CP5022x, eucJP-ms UDC
	  * Support UTF-32 encoding
	  * Support beyond BMP
	  [ruby-dev:29700] [ruby-dev:29922] [ruby-dev:30144]

Tue Feb  6 20:36:19 2007  Kouhei Sutou  <kou@cozmixng.org>

	* lib/rss/rss.rb, lib/rss/parser.rb: followed current Ruby
	  specification. [ruby-dev:30274]

Tue Feb  6 20:29:44 2007  Kouhei Sutou  <kou@cozmixng.org>

	* lib/rss/rss.rb, lib/rss/parser.rb: removed needless code for
	  backward compatibility.

Tue Feb  6 18:43:17 2007  Shugo Maeda  <shugo@ruby-lang.org>

	* lib/net/ftp.rb: moved fixes for EPIPE to the correct
	  place. [ruby-core:10204]

Tue Feb  6 16:38:08 2007  Koichi Sasada  <ko1@atdot.net>

	* vm_opts.h: set properties:
	  svn:keywords:  Author Date Id Revision
	  svn:eol-style: native

Tue Feb  6 15:55:46 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* variable.c (ivar_i): need to support class local instance
	  variables.

Tue Feb  6 15:44:11 2007  Koichi Sasada  <ko1@atdot.net>

	* compile.c (iseq_compile_each): fix setting is_local flag.

	* yarvtest/test_class.rb: add a test for class local isntance variable.

Tue Feb  6 14:15:34 2007  Koichi Sasada  <ko1@atdot.net>

	* compile.c, insns.def: remove (get|set)instancevariable2 and add a
	  operand is_local to (get|set)instancevariable.

	* yarvtest/test_class.rb: add a test for class local instance variable.

	* parse.y (rb_decompose_ivar2): remove unused variable oid.

	* tool/insns2vm.rb: remove needless require.

Tue Feb  6 11:18:41 2007  Shugo Maeda  <shugo@ruby-lang.org>

	* lib/net/ftp.rb: check the control connection on EPIPE.
	  Thanks, Simon Williams. [ruby-core:9547]

Tue Feb  6 11:03:27 2007  Koichi Sasada  <ko1@atdot.net>

	* complement last commit.

	* common.mk (*.inc): use VPATH.

	* vm_opts.h: renamed from vm_opts.h.base.

Tue Feb  6 10:02:41 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* tool/insns2vm.rb: use vm_opts.h in VPATH.

Tue Feb  6 03:47:58 2007  Koichi Sasada  <ko1@atdot.net>

	* proc.c: support Binding#eval.

	* yarvtest/test_eval.rb: add a test for above change.

Tue Feb  6 03:13:33 2007  Koichi Sasada  <ko1@atdot.net>

	* proc.c: refactoring (remove K&R style, move Binding stuffs from
	  Init_Proc() to Init_Binding()).

Tue Feb  6 01:07:14 2007  Koichi Sasada  <ko1@atdot.net>

	* intern.h: prepare rb_last_status_get() and rb_last_status_set().
	  Use these functions instead of rb_last_status ([ruby-dev:30264]).

	* process.c: define above functions.

	* ext/pty/pty.c: use above functins.

	* io.c (pipe_finalize): ditto.

	* process.c: ditto.

Mon Feb  5 21:26:56 2007  Koichi Sasada  <ko1@atdot.net>

	* ruby.h: add a prototype of rb_id2str().

Mon Feb  5 21:06:50 2007  Koichi Sasada  <ko1@atdot.net>

	* eval_thread.c, common.mk: remove eval_thread.c.

	* yarvcore.c: rename cYarvThread to rb_cThread.

	* gc.c: remove YARV_* prefix.

	* gc.h: add an include guard and prototype of rb_gc_set_stack_end().

	* inits.c: fix to ANSI prototype style and reorder Init_*().

	* io.c (pipe_finalize): TODO: comment out last_status.

	* process.c, yarvcore.h: fix to use yarv_vm_t#last_status instead of
	  rb_last_status and make last_status_get() to access $?.

	* yarvcore.c (vm_mark): mark yarv_vm_t#last_status.

	* ruby.h: add declarations of rb_cISeq and rb_cVM.

	* thread.c: move eval_thread.c codes to thread.c and remove yarv_*
	  function prefix.

	* thread.c (thread_start_func_2): use yarv_thread_t#first_func if
	  it is not null.

	* vm.c: fix copyright year.

	* yarvcore.c (Init_vm): rename to Init_VM().

Mon Feb  5 04:09:48 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (rb_frame_callee): check if prev_cfp can be accessible.
	  a patch from Yoshinori Sano <yoshinori.sano at gmail.com> in
	  [ruby-dev:30252].  solves [ruby-dev:30200] and [ruby-core:9856].

Sun Feb  4 20:34:41 2007  Kouhei Sutou  <kou@cozmixng.org>

	* test/rss/rss-assertions.rb: removed needless code for backward
	  compatibility.

Sun Feb  4 02:22:59 2007  Akinori MUSHA  <knu@iDaemons.org>

	* lib/cgi.rb (CGI::QueryExtension::read_multipart): Remove a debug
	  print.

Sat Feb  3 23:51:58 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* parse.y (rb_compose_ivar2): function to create a new ivar2
	  symbol from a symbol and a class.  back-ported from matzruby.

	* parse.y (rb_decompose_ivar2): reverse function of
	  rb_compose_ivar2().

	* marshal.c (w_symbol): support class local instance variables.

	* marshal.c (r_object0): ditto.

	* compile.c (defined_expr): ditto.

	* compile.c (iseq_compile_each): ditto.

	* insns.def: add two new instructions: getinstancevariable2 and
	  setinstancevariable2.

Sat Feb  3 23:21:13 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* insns.def (setclassvariable): remove unnecessary operand.

	* compile.c (iseq_compile_each): ditto.

	* common.mk (insns_info.inc): add dependency for insns_info.inc.

Sat Feb  3 14:32:58 2007  Masaki Suketa  <masaki.suketa@nifty.ne.jp>

	* ext/win32ole/win32ole.c (ole_val2olevariantdata, ole_val2variant):
	  fix the bug of WIN32OLE_VARIANT.new when variant type is
	  VT_ARRAY.

	* ext/win32ole/sample/excel1.rb: rewrite using WIN32OLE_VARIANT.

	* test/win32ole/test_win32ole.rb: add some test.

	* test/win32ole/test_win32ole_variant.rb: ditto.

Sat Feb  3 03:35:20 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* Makefile.in, */Makefile.sub, common.mk (vmasm): generalized.

	* common.mk (runruby, benchmark, benchmark-each, tbench): use
	  PROGRAM for the file to be built.

	* proc.c (yarv_proc_alloc): needs return.

	* call_cfunc.ci, compile.c, compile.h, debug.h, eval.c,
	  eval_error.h, eval_jump.h, eval_load.c, eval_thread.c, gc.c,
	  insnhelper.h, insns.def, iseq.c, main.c, numeric.c, parse.y,
	  range.c, ruby.h, signal.c, thread.c, thread_win32.ci, vm.c,
	  vm.h, vm_dump.c, vm_evalbody.ci, yarvcore.c, yarvcore.h:
	  fixed indents and non-C90 comments.

	* regenc.h: revert to before YARV.

	* lib/mkmf.rb (create_makefile): make object files depend on
	  extconf.h even if depend file exists.

Fri Feb  2 23:39:42 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* common.mk (bin): add more dependency.  a patch from Tadashi
	  Saito <shiba at mail2.accsnet.ne.jp>.  [ruby-dev:30245]

Fri Feb  2 18:44:31 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* insns.def (setclassvariable): remove warn argument.

Fri Feb  2 18:36:40 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* common.mk (compile.$(OBJEXT)): add config.h to vm.c and
	  compile.c.

Fri Feb  2 18:27:54 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c: remove duplicated global variables rb_cProc and
	  rb_cBinding.  [ruby-dev:30242]

Fri Feb  2 00:13:44 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* ruby.h (SYMBOL_P): make Symbol immediate again for performance.

	* string.c: redesign symbol methods.

Thu Feb  1 23:25:21 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* parse.y (rb_id2str): store Strings for operator symbols.
	  [ruby-dev:30235]

Thu Feb  1 21:04:39 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* parse.y (assignable_gen): no need to generate NODE_CVDECL.

	* compile.c (iseq_compile_each): no NODE_CVDECL.

Thu Feb  1 20:53:32 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* vm.c (eval_get_cvar_base): destination for class variable access
	  is now strictly innermost surrounding class or module.  warned
	  if accessed from toplevel.

	* variable.c (rb_cvar_get): new class variable look-up scheme:
	  1) look up in the class.  2) if the class is singleton attached
	  to a class (i.e. metaclass) then start look up in the attached
	  class and its ancestors. 3) otherwise, look-up in ancestors of
	  the class.

	* eval.c (cvar_cbase): destination for class variable access is
	  the class/module that holds the method, or cbase outside of
	  methods.

Thu Feb  1 20:31:41 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* variable.c (rb_cvar_set): remove warn argument.

Wed Jan 31 14:52:09 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* test/ruby/test_iterator.rb (TestIterator::test_block_given_within_iterator):
	  add new test.  [ruby-core:10125]

Tue Jan 30 17:01:21 2007  NAKAMURA Usaku  <usa@ruby-lang.org>

	* string.c (rb_str_sub_bang): calling rb_str_modify() should be just
	  before actually modifying the string.
	  fixed: [ruby-dev:30211] (originally reported by zunda)

Tue Jan 30 13:24:06 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* numeric.c (int_pred): add Integer#pred corresponding
	  Integer#succ.  [RCR#5]

Tue Jan 30 12:05:35 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* mkconfig.rb: autoconf 2.61 support.  [ruby-core:10016]

Mon Jan 29 23:52:32 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* tool/compile.rb: replace YARVCore by VM class.

Mon Jan 29 17:52:44 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* lib/date/format.rb (Date::Format::Bag::method_missing): add
	  prefix to avoid making t class-local instance variable.

Mon Jan 29 21:32:37 2007  Masaki Suketa  <masaki.suketa@nifty.ne.jp>

	* ext/win32ole/win32ole.c: add WIN32OLE.locale=, WIN32OLE.locale,
	  WIN32OLE_VARIANT#vartype.

	* test/win32ole/test_win32ole.rb: add test for WIN32OLE.locale=,
	  WIN32OLE.locale.

	* test/win32ole/test_win32ole_variant.rb: add test for
	  WIN32OLE_VARIANT#vartype.

Mon Jan 29 14:14:35 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* tool/parse.rb: replace YARVCore by VM class.
	  http://d.hatena.ne.jp/ysano2005/20070128

Sun Jan 28 08:41:49 2007  Masaki Suketa  <masaki.suketa@nifty.ne.jp>

	* ext/win32ole/win32ole.c: refactoring.

Sat Jan 27 18:36:33 2007  Masaki Suketa  <masaki.suketa@nifty.ne.jp>

	* ext/win32ole/win32ole.c (ole_val2olevariantdata): bug fix.
	  WIN32OLE_VARIANT.new check that 1st argument should T_ARRAY
	  when variant type is VT_ARRAY.

	* test/win32ole/test_win32ole_variant.rb: add some test.

Fri Jan 26 23:55:56 2007  Masaki Suketa  <masaki.suketa@nifty.ne.jp>

	* ext/win32ole/win32ole.c: bug fix of WIN32OLE_VARIANT when variant
	  type is VT_BYREF|VT_VARIANT.

	* test/win32ole/test_win32ole_variant_with_ie.rb: ditto.

Fri Jan 26 12:03:39 2007  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/lib/tk.rb (TkConfigMethod#__confinfo_cmd,
	  __conv_keyonly_optkeys): make them private [ruby-dev:30074].

	* ext/tk/lib/tk/txtwin_abst.rb: fix typo [ruby-dev:30073].

	* ext/tk/lib/tk/canvas.rb (TkCanvas#scan_dragto): lack of an argument.

	* ext/tk/lib/tk/canvas.rb: clarify the including module name
	  [ruby-dev:30080].

	* ext/tk/lib/tk/scrollable.rb: change primary name of modules
	  [ruby-dev:30080].

Fri Jan 26 07:48:57 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* enumerator.c (enumerator_init_copy): need to copy internal
	  structure on clone and dup.  [ruby-dev:30192]

Wed Jan 24 20:34:51 2007  Kouhei Sutou  <kou@cozmixng.org>

	* test/ruby/test_iterator.rb: removed a needless workaround.

Wed Jan 24 18:05:39 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* misc/ruby-mode.el (ruby-font-lock-syntactic-keywords): fix
	  regexp font-lock bug.  [ruby-talk:235758]

Tue Jan 23 18:26:12 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* lib/cgi.rb (CGI::QueryExtension::read_multipart): use == instead
	  of ===.  [ruby-dev:30176]

Tue Jan 23 15:39:25 2007  NAKAMURA Usaku  <usa@ruby-lang.org>

	* Makefile.in, common.mk, configure.in, */{Makefile.sub, configure.bat,
	  setup.mak}: add --with-baseruby configure option.

Mon Jan 22 14:57:25 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* ext/socket/socket.c: fix errors in socket sample code.
	  [ruby-core:09992]

Sat Jan 20 21:05:18 2007  Masaki Suketa  <masaki.suketa@nifty.ne.jp>

	* ext/win32ole/win32ole.c (fole_s_set_code_page): WIN32OLE.codepage=
	  accepts installed codepage.

	* test/win32ole/test_win32ole.rb (test_s_codepage_changed): ditto.

Sat Jan 20 11:18:49 2007  Masaki Suketa  <masaki.suketa@nifty.ne.jp>

	* ext/win32ole/win32ole.c (ole_invoke, ole_invoke2, ole_propertyput):
	  modify WIN32OLERuntimeError message.

	* test/win32ole/test_win32ole.rb: ditto.

Sat Jan 20 06:45:21 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval_proc.c (method_receiver): add new method to get the bound
	  receiver of the method object.  [ruby-talk:234949]

	* eval_proc.c (method_name): new method to get the name of a
	  method.

	* eval_proc.c (method_owner): a new method to get the class or
	  module that defines the method.

Fri Jan 19 17:12:23 2007  Masaki Suketa  <masaki.suketa@nifty.ne.jp>

	* ext/win32ole/win32ole.c (Init_win32ole): add WIN32OLE_VARIANT::Empty,
	  WIN32OLE_VARIANT::Null, WIN32OLE_VARIANT::Nothing.

	* test/win32ole/test_win32ole_variant.rb: ditto.

	* test/win32ole/test_nil2vtempty.rb(test_openSchema): ditto.

Fri Jan 19 06:53:38 2007  Masaki Suketa  <masaki.suketa@nifty.ne.jp>

	* ext/win32ole/win32ole.c (olevariant_free): fix memory leak.

	* ext/win32ole/win32ole.c (ole_val2olevariantdata):
	  WIN32OLE_VARIANT.new accepts nil as first argument for some VARIANT
	  TYPE.

	* test/win32ole/test_win32ole_variant.rb: ditto.

Wed Jan 17 17:31:28 2007  Koichi Sasada  <ko1@atdot.net>

	* some refactoring around yarvcore and proc.

	* eval_proc.c: renamed to proc.c.

	* common.mk: ditto.

	* yarvcore.h, yarvcore.c: rename or remove some global variables
	  removed: mYarvCore, mYarvInsns
	  renamed: cYarvISeq -> rb_cISeq,
	           cYarvProc -> rb_cProc, cYarvBinding -> rb_cBinding
	  ::YarvCore module is removed and ::YarvCore::VM class becomes ::VM.
	  And change/remove some functions which added with YARV.

	* compile.c: ditto.

	* eval.c: ditto.

	* iseq.c: ditto.

	* vm.c: ditto.

	* inits.c: rename Init_yarvcore to Init_vm.

	* yarvcore.c, proc.c: move some functions and initialization
	  from yarvcore.c to proc.c.

	* intern.h, proc.c: add global function rb_binding_new(void).

Tue Jan 16 17:49:29 2007  Koichi Sasada  <ko1@atdot.net>

	* vm.c (eval_search_super_klass): rename to search_super_klass() and
	  use it by th_call_super().

	* insns.def: ditto.

Tue Jan 16 17:48:11 2007  Koichi Sasada  <ko1@atdot.net>

	* common.mk: fix ruby script path.

Tue Jan 16 17:39:44 2007  Koichi Sasada  <ko1@atdot.net>

	* vm.c (invoke_block): fix to specify self.

Tue Jan 16 12:12:27 2007  Koichi Sasada  <ko1@atdot.net>

	* env.h: removed

Tue Jan 16 12:00:06 2007  Koichi Sasada  <ko1@atdot.net>

	* eval_proc.c (rb_proc_new): added.

	* string.c (sym_to_proc): supported.

	* vm.c (invoke_block, th_invoke_yield, th_invoke_proc): fix to support
	  rb_proc_new.

	* yarvcore.c: add a test code.

Sat Jan 13 23:24:59 2007  Masaki Suketa  <masaki.suketa@nifty.ne.jp>

	* ext/win32ole/win32ole.c (ole_free, ole_type_free,
	  olemethod_free, olevariable_free, oleparam_free,
	  ole_event_free): fix memory leak.  [ruby-core:09846]

Wed Jan 10 00:10:23 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* array.c (rb_ary_replace): use ptr and len of orig instead of
	  shared.  fixed: [ruby-dev:30116]

Tue Jan  9 17:48:38 2007  NAKAMURA Usaku  <usa@ruby-lang.org>

	* file.c (rb_find_file): should not call fpath_check() with NULL.
	  fixed: [ruby-core:09867]

Tue Jan  9 12:29:20 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* ext/etc/etc.c (etc_getpwuid, etc_getgrgid): fix to correctly
	  convert uid/gid from VALUE.

	* ext/etc/etc.c (etc_getpwuid): ditto.

Tue Jan  9 03:54:38 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* string.c (rb_str_upto): String#upto from empty string makes
	  inifinite loop.  [ruby-core:09864]

	* string.c (rb_str_upto): use RSTRING_LEN().

Sun Jan  7 18:36:05 2007  Koichi Sasada  <ko1@atdot.net>

	* thread.c (rb_thread_stop_timer_thread(), rb_thread_reset_timer_thread(),
	  rb_thread_start_timer_thread()): added.

	* thread_pthread.ci: add a native_thread_join() and move
	  rb_thread_reset_timer_thread() definition to thread.c.

	* thread_win32.ci: ditto

	* process.c: fix before_exec(), after_exec() to stop timer thread
	  (and restart timer thread if exec failed).  and fix to reset
	  timer thread information when forked child process starts
	  (to fix [ruby-core:09822]).

Sun Jan  7 18:28:17 2007  Koichi Sasada  <ko1@atdot.net>

	* common.mk: add a "compare" rule and fix MATZRUBY variable

Sun Jan  7 17:47:16 2007  Masaki Suketa  <masaki.suketa@nifty.ne.jp>

	* test/win32ole/test_win32ole.rb: add test for WIN32OLE#[],
	  WIN32OLE#[]=.

	* ext/win32ole/win32ole.c: update comment for rdoc of
	  WIN32OLE#[] and WIN32OLE#[]=.

Sun Jan  7 12:13:26 2007  Eric Hodel  <drbrain@segment7.net>

	* lib/rdoc/parsers/parse_c.rb (RDoc::C_Parser#find_class_comment):
	  Look for class and module comments above rb_define_class and
	  rb_define_module.  Patch by Daniel Berger <djberg96 at gmail.com>

Sun Jan  7 10:32:12 2007  Eric Hodel  <drbrain@segment7.net>

	* lib/rdoc/parsers/parse_c.rb (RDoc::C_Parser#handle_constants):
	  Properly handle escaping of : in comments.
	* test/rdoc/parsers/test_parse_c.rb:
	  Test RDoc::C_Parser#do_classes and Rdoc::C_Parser#find_class_comment.

Sun Jan  7 09:31:18 2007  Tadayoshi Funaba  <tadf@dotrb.org>

	* lib/date/format.rb: updated based on date2 4.0.1.

Sat Jan  6 18:46:34 2007  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* io.c (rb_io_getline_fast, rb_io_getline): increase lineno
	  when met the delimiter or EOF.  fixed: [ruby-dev:30081]

	* io.c (prepare_getline_args, rb_io_getline_1): split
	  preparation of arguments and reading.  [ruby-dev:30085]

Sat Jan  6 13:48:36 2007  Koichi Sasada  <ko1@atdot.net>

	* insns.def (send): fix to optimize send() with Symbol.

	* yarvtest/test_method.rb: add another test.

Sat Jan  6 13:43:55 2007  Koichi Sasada  <ko1@atdot.net>

	* common.mk: add PHONY dependency to some rules

Sat Jan  6 11:50:33 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* io.c (argf_read): fix wrong replacement.  [ruby-dev:30070]

Sat Jan  6 09:10:52 2007  Koichi Sasada  <ko1@atdot.net>

	* insns.def: support direct method dispatch with "send" or "funcall".
	  This means that "obj.send :m" skips "BasicObject#send" invocation
	  (method frame creation, etc) and "obj.m" invokes directly.
	  If you make backtrace, there are no enties of "send" method.

	* compile.c (iseq_specialized_instruction): fix to support above

	* eval.c: ditto (remove "static" from rb_f_send and rb_f_funcall

	* yarvcore.c: ditto (add a external IDs for compiler)

	* yarvcore.h: ditto (add a VM_CALL_SEND_BIT macro)

	* yarvtest/test_method.rb: add tests for above changes

	* eval.c: remove unused "Kernel#send" declaration

Sat Jan  6 08:29:17 2007  Masaki Suketa  <masaki.suketa@nifty.ne.jp>

	* ext/win32ole/win32ole.c (Init_win32ole): add
	  WIN32OLE::VARIANT::VT_EMPTY, WIN32OLE::VARIANT::VT_NULL

	* test/win32ole/test_win32ole_variant_m.rb (test_variant): ditto.

Sat Jan  6 03:49:22 2007  Koichi Sasada  <ko1@atdot.net>

	* benchmark/run.rb: change option format

	* common.mk: ditto

Fri Jan  5 22:21:08 2007  Koichi Sasada  <ko1@atdot.net>

	* benchmark/bm_app_pentomino.rb: use Array#dup instead of
	  Array#clone

	* benchmark/bmx_temp.rb: removed

	* benchmark/run.rb: use run.rb instead of run_rite.rb

	* common.mk: ditto

	* benchmark/run_rite.rb: removed

	* common.mk: use $(srcdir)/test.rb to run a test program
	  with "make run"

	* benchmark/bmx_temp.rb: removed and
	  set svn:ignore (bmx_*.rb) to benchmark/

	* test.rb: set svn:ignore

Fri Jan  5 21:03:08 2007  Koichi Sasada  <ko1@atdot.net>

	* yarvtest/yarvtest.rb: fix to compare results

Fri Jan  5 20:52:56 2007  Koichi Sasada  <ko1@atdot.net>

	* compile.c, compile.h: add ADD_CALL_RECEIVER() macro.

	* insns.def (send): use GET_SELF() direct if FCALL.

	* eval.c (rb_f_send): check method dispatch type to permit
	  invoking private method when dispatch type is FCALL/VCALL

	* insns.def (opt_ltlt): remove useless statement.

	* vm.h: remove unused macros.

Fri Jan  5 20:50:31 2007  Koichi Sasada  <ko1@atdot.net>

	* benchmark/run_rite.rb: fix to use readlines instead of
	  read(...).lines (because 1.8 doesn't have String#lines).

Fri Jan  5 20:28:19 2007  Koichi Sasada  <ko1@atdot.net>

	* thread_win32.ci (rb_thread_reset_timer_thread):
	  added ([ruby-dev:30086]).

Fri Jan  5 20:20:36 2007  Koichi Sasada  <ko1@atdot.net>

	* common.mk: add .SUFFIXES rule

Fri Jan  5 15:58:15 2007  Koichi Sasada  <ko1@atdot.net>

	* eval_method.h (rb_alias): fix to check search result

Fri Jan  5 13:59:53 2007  Koichi Sasada  <ko1@atdot.net>

	* eval_method.h (rb_add_method): fix to check old_node

Fri Jan  5 12:03:07 2007  Koichi Sasada  <ko1@atdot.net>

	* compile.c (iseq_compile_each, set_block_local_tbl):
	  support NODE_LAMBDA (partly).

	* sample/test.rb: restore test of NODE_LAMBDA

	* test/ruby/test_lambda.rb: ditto

Fri Jan  5 12:31:23 2007  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* thread_pthread.ci (native_sleep): fix tv_nsec overflow.

Thu Jan  4 20:01:29 2007  Koichi Sasada  <ko1@atdot.net>

	* common.mk: rename yarv-test-[all/each] to compare-test[/-each].
	  purpose of "compare-test" rule is to compare ruby (trunk) and
	  matzruby (branches/matzruby) binary in miniruby level.  MATZRUBY
	  parameter means an path to miniruby of matzruby binary.  to do this
	  comparison test, you should build matzruby branch.

	* yarvtest/yarvtest.rb: fix to use command line option as
	  command names to be compared.

	* yarvtest/runner.rb: remove a debug output.

Thu Jan  4 19:12:27 2007  Koichi Sasada  <ko1@atdot.net>

	* common.mk: fix to use test.rb script in build directory.
	  ($(srcdir)/test.rb -> test.rb)

Thu Jan  4 17:28:05 2007  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* lib/webrick/utils.rb (WEBrick::Utils::TimeoutHandler#initialize):
	  Arrays could not be modified in its each block. [ruby-dev:30063]

Thu Jan  4 16:57:14 2007  Koichi Sasada  <ko1@atdot.net>

	* yarv_version.h: removed.

	* common.mk: remove yarv_version.h from rules

	* yarvcore.h (Init_yarvcore): remove useless constants

Thu Jan  4 17:00:06 2007  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* ext/openssl/ossl_asn1.c (Init_ossl_asn1):
	  OpenSSL::ASN1::ASN1Data#value,#tag,#tag_class and
	  OpenSSL::ASN1::BitString#unused_bits should be public.

Thu Jan 04 13:45:10 2007  Koichi Sasada  <ko1@atdot.net>

	* thread_pthread.ci: fix last changes around PTHREAD_STACK_MIN.

Thu Jan 04 13:42:47 2007  Koichi Sasada  <ko1@atdot.net>

	* common.mk: restore changes.

Thu Jan 04 10:33:54 2007  Koichi Sasada  <ko1@atdot.net>

	* thread_pthread.ci: fix to skip using PTHREAD_STACK_MIN.
	  [ruby-dev:30063]

Thu Jan 04 10:30:11 2007  Koichi Sasada  <ko1@atdot.net>

	* benchmark/run_rite.rb (bm): fix to use lines.

Wed Jan  3 18:49:15 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* io.c (rb_io_getline): lineno update condition was wrong.
	  [ruby-dev:30065]

	* io.c (rb_io_getline_fast): ditto.

Wed Jan  3 11:36:51 2007  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* io.c (ruby_dup): start GC on ENOMEM as well.

Tue Jan  2 10:29:54 2007  Eric Hodel  <drbrain@segment7.net>

	* ext/zlib/zlib.c: fix to compile on YARV
	  ruby_errinfo -> rb_errinfo()

Mon Jan 01 08:07:06 2007  Koichi Sasada  <ko1@atdot.net>

	* ext/tk/tcltklib.c: fix to compile on YARV
	  ruby_errinfo -> rb_errinfo(),
	  ruby_safe_level -> rb_safe_level().

Mon Jan 01 07:57:17 2007  Koichi Sasada  <ko1@atdot.net>

	* test/drb/test_drbssl.rb: fix to skip drb tests.

Mon Jan  1 06:13:11 2007  Eric Hodel  <drbrain@segment7.net>

	* lib/rdoc/parsers/c_parser.rb: Make Rdoc accessible.  Update constant
	  value information.

Mon Jan  1 06:13:11 2007  Eric Hodel  <drbrain@segment7.net>

	* ext/bigdecimal/bigdecimal.c: Update constant comments to provide
	  values for RDoc.

Mon Jan  1 06:05:55 2007  Eric Hodel  <drbrain@segment7.net>

	* lib/rdoc/parsers/parse_c.rb (RDoc::C_Parser#handle_constansts):
	  Allow RDoc comment to give friendly value for rb_define_const.  Patch
	  by Daniel Berger <djberg96 at gmail.com>, [ruby-patches-7499].
	* lib/rdoc/parsers/parse_c.rb (RDoc::C_Parser#handle_constansts): Fix
	  whitespace handling in constant comments.

Mon Jan 01 00:00:00 2007  Koichi Sasada  <ko1@atdot.net>

	* Merge YARV

Sun Dec 31 16:22:48 2006  Eric Hodel  <drbrain@segment7.net>

	* array.c: Fix Array#reject.

Sun Dec 31 00:46:25 2006  Tadayoshi Funaba  <tadf@dotrb.org>

	* lib/date2.rb: removed.

Sun Dec 31 00:15:13 2006  Tadayoshi Funaba  <tadf@dotrb.org>

	* lib/date.rb, lib/date/format.rb: updated based on date2 4.0.

Sat Dec 30 04:38:23 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* enum.c (enum_each_with_index): reuse array for yield parameters.

	* enum.c (enum_min, enum_max): ditto.

Sat Dec 30 04:25:29 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* enum.c (enum_inject): reuse array for yield parameters.

Sat Dec 30 02:54:22 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* ext/stringio/stringio.c (strio_gets): accepts limit argument.

	* ext/stringio/stringio.c (strio_readline, strio_each,
	  strio_readlines): ditto.

Sat Dec 30 02:22:32 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* ext/stringio/stringio.c (strio_getline): add limit capability.

	* io.c (rb_io_gets_m): accepts limit argument.  [ruby-talk:231563]

	* io.c (rb_io_readline, rb_io_readlines, rb_io_each_line, argf_getline):
	  ditto.

	* io.c (appendline): add limit capability.

	* io.c (rb_io_getline_fast, rb_io_getline): ditto.

	* io.c (rb_io_getline): small refactoring for DRY.

	* io.c (rb_io_s_foreach, rb_io_s_readlines): small refactoring.

Thu Dec 28 15:27:38 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* lib/cgi.rb (CGI::Cookie::initialize): use Array() again.
	  [ruby-core:09781]

Wed Dec 27 20:52:32 2006  Masaki Suketa  <masaki.suketa@nifty.ne.jp>

	* ext/win32ole/win32ole.c: remove WIN32OLE::PROPERTY class.

	* ext/win32ole/tests/testWIN32OLE.rb: ditto.

Wed Dec 27 10:04:11 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* object.c (rb_Array): returns 1-element array if the argument
	  does not have to_ary nor to_a.

Tue Dec 26 21:02:14 2006  Masaki Suketa  <masaki.suketa@nifty.ne.jp>

	* test/win32ole/test_folderitem2_invokeverb.rb: The argument
	  of Shell.NameSpace should not be file path.

Tue Dec 26 06:13:08 2006  Minero Aoki  <aamine@loveruby.net>

	* ext/bigdecimal/bigdecimal.c: remove useless method
	  BigDecimal#!=. [ruby-dev:30050]

Thu Dec 21 15:37:17 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* string.c (rb_str_slice_bang): rdoc description bug fixed.
	  [ruby-core:09754]

Wed Dec 20 12:54:31 2006  Koichi Sasada  <ko1@atdot.net>

	* Convert CVS repository to Subversion repository.

Mon Dec 18 08:36:29 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* lib/cgi.rb (CGI::Cookie::initialize): Array(string) no longer
	  works.  [ruby-core:09738]

Fri Dec 15 00:19:53 2006  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* win32/Makefile.sub (COMPILE_RULES): latter rule has higher priority.

	* lib/mkmf.rb (create_makefile): remove static library before update,
	  to get rid of sludge of Borland tlib.exe.

Thu Dec 14 18:29:13 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* ext/readline/readline.c: NetBSD editline does not have
	  rl_username_completion_function() and rl_completion_matches().
	  a patch from Takahiro Kambe <taca at back-street.net>.
	  [ruby-dev:30008]

Thu Dec 14 18:20:43 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* lib/irb/locale.rb (IRB::Locale::puts): typo fixed.  a patch from
	  NAKAMURA Usaku <usa@ruby-lang.org>.  [ruby-dev:30012]

Tue Dec 12 23:33:53 2006  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* lib/optparse.rb (Switch#parse_arg, Switch#conv_arg): splat failures.

Mon Dec 11 11:51:10 2006  Akinori MUSHA  <knu@iDaemons.org>

	* ext/digest/sha2/lib/sha2.rb: Moved one level up from under
	  the superfluous subdirectory digest/.

Mon Dec 11 11:46:18 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* variable.c (rb_define_const): typo fixed.

Mon Dec 11 09:36:29 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* string.c (rb_str_aset): index double decode problem.
	  [ruby-core:09695]

Sat Dec  9 21:39:24 2006  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* eval.c (ruby_cleanup): keep the exception till after END blocks.
	  [ruby-core:09675]

Sat Dec  9 11:22:00 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* lib/irb/locale.rb (IRB::Locale::search_file): ues File.exist?
	  instead of File.exists?.  a patch from Yutaka Kanemoto
	  <kinpoco at gmail.com> in [ruby-dev:30000].

Fri Dec  8 18:11:18 2006  NAKAMURA Usaku  <usa@ruby-lang.org>

	* lib/optparse.rb: cannot put :nodoc: before method definition.
	  put after it.

Fri Dec  8 17:00:13 2006  NAKAMURA Usaku  <usa@ruby-lang.org>

	* bin/rdoc: ues File.exist? instead of File.exists?.

Thu Dec  7 23:50:21 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* object.c (Init_Object): new method Dir.exist?(path).
	  [ruby-core:09663]

	* file.c (Init_File): remove File.exists?; use File.exist?
	  instead.

	* file.c: rename functions to test_* to rb_file_*_p.

Thu Dec  7 09:29:02 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* lib/weakref.rb (WeakRef::__setobj__): should support
	  marshaling.  [ruby-talk:228508]

Wed Dec  6 23:58:36 2006  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* Makefile.in, common.mk (NULLCMD): moved for platforms that empty
	  command does not run.  fixed: [ruby-dev:29994]

	* win32/win32.c (init_stdhandle): redirect unopened IOs to NUL.
	  [ruby-core:09572]

Tue Dec  5 19:01:42 2006  WATANABE Hirofumi  <eban@ruby-lang.org>

	* configure.in (SITE_DIR): fixed to emtpy RUBY_SITE_LIB in config.h on
	  NetBSD.  fixed: [ruby-dev:29358]

Tue Dec  5 18:38:21 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* lib/matrix.rb (Matrix::rank): use quo method to avoid integer
	  division problem.  [ruby-core:09644]

	* lib/matrix.rb (Matrix::rank_e): ditto.

Tue Dec  5 00:59:05 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* misc/ruby-mode.el (ruby-parse-partial): need to parse "/=" as
	  self assignment operator, not regex.  [ruby-talk:227324]

Tue Dec  5 00:19:14 2006  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* intern.h, object.c, variable.c (rb_mod_constants): added an optional
	  flag to search ancestors, which is defaulted to true, as well as
	  const_defined? and const_get.  [ruby-dev:29989]

Mon Dec  4 23:49:28 2006  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* instruby.rb (install_recursive): get rid of warning.

	* lib/optparse.rb (CompletingHash#match): get rid of splat failure.

Mon Dec  4 19:16:39 2006  Akinori MUSHA  <knu@iDaemons.org>

	* ext/digest/lib/digest/hmac.rb: Do alias << update.

Mon Dec  4 10:48:03 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* ruby.h (OFFT2NUM): use LONG2NUM() if sizeof(long) equals to
	  sizeof(off_t).

Mon Dec  4 08:32:25 2006  Shugo Maeda  <shugo@ruby-lang.org>

	* lib/cgi.rb (CGI::QueryExtension::read_multipart): should quote
	  boundary. JVN#84798830

Sun Dec  3 16:16:53 2006  Akinori MUSHA  <knu@iDaemons.org>

	* ext/digest/lib/digest/hmac.rb: Fix problems with update
	  timing. [Reported by: oss-ruby@technorama.net]

Sat Dec  2 07:33:53 2006  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* lib/webrick/httputils.rb (WEBrick::HTTPUtils::FormData::<<):
	  HTTPUtils::parse_header() takes a string.  [ruby-dev:29931]

	* lib/webrick/httputils.rb (WEBrick::HTTPUtils::parse_header):
	  String does no longer have each method.

	* lib/webrick/httputils.rb (WEBrick::HTTPUtils::parse_form_data):
	  ditto.

Sat Dec  2 07:09:04 2006  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* ext/openssl/ossl_ocsp.c: OpenSSL::OCSP::OSCPError should be
	  subclass of OpenSSL::OpenSSLError. [ruby-dev:29980]

Fri Dec  1 16:31:53 2006  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/tcltklib.c: shouldn't run the killed thread at callback.
	  [ruby-talk: 227408]

Tue Nov 28 17:25:11 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* array.c (ary_iter_check): should check modification (size
	  change) during iteration.

	* array.c (rb_ary_initialize, rb_ary_shift, rb_ary_unshift,
	  rb_ary_splice, rb_ary_reverse, rb_ary_sort, rb_ary_delete,
	  rb_ary_delete_at, rb_ary_reject_bang, rb_ary_replace,
	  rb_ary_clear, rb_ary_fill, rb_ary_uniq_bang, rb_ary_compact,
	  rb_ary_shuffle): add iteration check.

Mon Nov 27 09:00:15 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* string.c (rb_str_ord): typo fixed.  reported from Kornelius
	  Kalnbach <murphy@rubychan.de>.  [ruby-core:09621]

Sun Nov 26 16:36:46 2006  URABE Shyouhei  <shyouhei@ruby-lang.org>

	* version.h: addition of RUBY_PATCHLEVEL.
	* version.c: ditto.

Wed Nov 22 16:00:49 2006  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/extconf.rb: support --with-X11/--without-X11 option.

	* ext/tk/README.tcltklib: add description about --with-X11-* option
	  [ruby-talk:225166] and --with-X11/--without-X11 option.

	* ext/tk/tkutil/extconf.rb: able to be called manually
	  [ruby-talk:225950].

Sat Nov 18 23:39:20 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* object.c (rb_obj_tap): a new method.  [ruby-talk:224013]

Wed Nov 15 23:22:54 2006  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* file.c (test_grpowned, rb_stat_grpowned): should honor
	  supplementary group IDs.  [ruby-core:09546]

Tue Nov  7 18:35:18 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (formal_assign): need to pack rest arg information in
	  argc.

Tue Nov  7 18:05:01 2006  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/lib/tk/itemconfig.rb: minor bug fix.

Tue Nov  7 17:52:08 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* class.c (rb_include_module): revert duplicate inclusion of
	  modules.  [ruby-dev:29793]

Tue Nov  7 17:18:11 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (method_missing): update old argument adjustment.

Tue Nov  7 16:41:21 2006  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* eval.c (when_check): need to splat for NODE_ARGSCAT as well.
	  [ruby-dev:29860]

Mon Nov  6 22:23:52 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* string.c (Init_String): remove duplicated definition of
	  Symbol#to_s.

Mon Nov  6 18:54:13 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (svalue_to_avalue): need to splat but no error.

	* eval.c: new macros - YIELD_CALL, YIELD_VALUES.

	* eval.c (rb_yield_values): specify YIELD_VALUES.

	* eval.c (rb_yield_0): use new macros.

	* eval.c (proc_invoke): slightly modified to separate YIELD_CALL
	  and YIELD_VALUES from YIELD_ARY_ARGS.

	* object.c (Init_Object): add nil.to_splat => [].

Mon Nov  6 15:41:55 2006  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/lib/tk/itemconfig.rb: ext/tk/lib/tk/itemconfig.rb: bug
	  fix on 'itemconfiginfo' method, and modify to make it easy to
	  override 'itemconfiginfo' method.

	* ext/tk/lib/tkextlib/tile/treeview.rb: support Tile 0.7.8.

	* ext/tk/lib/tkextlib/version.rb: [new] add Tk::Tkextlib_RELEASE_DATE
	  to get the information from scripts.

	* ext/tk/lib/tk.rb: load 'tkextlib/version.rb', and update RELEASE_DATE

	* ext/tk/lib/tkextlib/SUPPORT_STATUS: update.

	* ext/tk/sample/editable_listbox.rb: [new] the listbox with editable
	  items. It's one of the example about usage of Place geometry manager.

	* ext/tk/sample/tktextio.rb: improve the functions of TkTextIO class.
	  Those are required by 'irbtkw.rbw'.

	* ext/tk/sample/irbtkw.rbw: [new] IRB on Ruby/Tk. It doesn't need any
	  real console. IRB works on a text widget without I/O blocking. That
	  is, thread switching on IRB will work properly, even if on Windows.

Mon Nov  6 00:42:05 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* parse.y (arg_dup_check): vid may be nameless internal id.

Sun Nov  5 19:52:19 2006  Tadayoshi Funaba  <tadf@dotrb.org>

	* lib/date.rb: updated based on date2 3.9.7.

Sat Nov  4 13:09:31 2006  Shugo Maeda  <shugo@ruby-lang.org>

	* lib/net/imap.rb: accept NOMODSEQ. [ruby-core:9002]

Fri Nov  3 00:16:37 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* ext/socket/socket.c (ruby_getnameinfo__aix): AF_INET6 workaround
	  for AIX.  a patch from Yutaka Kanemoto <kinpoco AT gmail.com>.
	  [ruby-dev:29744]

Thu Nov  2 14:19:44 2006  Akinori MUSHA  <knu@iDaemons.org>

	* lib/set.rb (Set#^): Fix XOR operation against a container that
	  holds duplicate values. [ruby-core:9372]

Thu Nov  2 10:00:06 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* string.c: class Symbol is no longer subclass of String. also
	  covers [ruby-core:09366]

Thu Nov  2 08:21:07 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* lib/xmlrpc/create.rb (XMLRPC::Create::conv2value): Symbol should
	  come earlier than String.

	* lib/soap/mapping/rubytypeFactory.rb (RubytypeFactory::obj2soap):
	  ditto.

	* lib/set.rb (TC_Set::test_s_new): strings are no longer
	  Enumerable

	* lib/soap/property.rb (Property::load): ditto.

	* lib/webrick/httputils.rb (WEBrick::HTTPUtils::parse_header): ditto.

	* lib/soap/mimemessage.rb (MIMEMessage::Headers::parse): ditto.

Thu Nov  2 09:08:04 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* array.c: revert lfree shift/unshift boost patch to avoid unknown
	  memory error.

Wed Nov  1 23:24:42 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* ruby.h (struct RArray): revert embedding ptr in RVALUE.

	* array.c: ditto.

Wed Nov  1 23:01:55 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* string.c (hash): use Bob Jenkins' hash algorithm.

Wed Nov  1 02:22:31 2006  Akinori MUSHA  <knu@iDaemons.org>

	* ext/digest/lib/digest/hmac.rb (Digest::HMAC::update): Minor
	  optimization.

	* ext/digest/digest.c (rb_digest_instance_equal): Allow comparing
	  a digest instance with another of a different class.

Wed Nov  1 01:05:13 2006  NAKAMURA Usaku  <usa@ruby-lang.org>

	* eval.c (rb_call0): fixed bug of zsuper with both of opt and rest.
	  fixed: [ruby-list:42928]

Tue Oct 31 17:03:21 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* time.c (time_dup): duplicate the class of original time.
	  [ruby-core:09357]

	* lib/time.rb (Time::make_time, Time::rfc2822, Time::httpdate):
	  should respect subclasses.  [ruby-core:09357]

Tue Oct 31 16:25:22 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* array.c (ary_shared_first): should address offset after
	  ary_shared_array().  [ruby-core:09358]

Mon Oct 30 23:40:52 2006  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* Makefile.in (miniruby): add XLDFLAGS.

	* configure.in (aix): use -bE option for miniruby.  [ruby-dev:29698]

	* dir.c (glob_helper): get rid of possible memory leak.

	* win32/win32.c (cmdglob, rb_w32_cmdvector, rb_w32_opendir,
	  rb_w32_get_environ): not to use GC before initialization.

Mon Oct 30 19:28:02 2006  NAKAMURA Usaku  <usa@ruby-lang.org>

	* bignum.c (rb_big2str0): use better approximation.

Mon Oct 30 18:35:33 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* bignum.c (rb_big2str0): wrong allocation length.  a patch from
	  U.Nakamura <usa at garbagecollect.jp> [ruby-dev:29710]

Mon Oct 30 12:34:02 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (rb_eval): fix commit miss.  [ruby-dev:29707]

Mon Oct 30 11:15:40 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* sprintf.c (rb_str_format): should preserve leading zero
	  information for negative %b and %x.  [ruby-talk:221347]

Sun Oct 29 19:51:31 2006  K.Kosako  <sndgk393 AT ybb.ne.jp>

	* regexec.c: invalid offset value was used in STATE_CHECK_BUFF_INIT().

Sat Oct 28 20:13:18 2006  K.Kosako  <sndgk393 AT ybb.ne.jp>

	* oniguruma.h: Version 4.4.5

	* regint.h: ditto.

	* regerror.c: ditto.

	* regexec.c: ditto.

	* regcomp.c ditto.

	* regparse.c ditto.

Sat Oct 28 07:56:13 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* marshal.c (r_object0): missing break.  [ruby-core:09345]

Fri Oct 27 17:30:31 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* enumerator.c (enum_each_cons): move RETURN_ENUMERATOR() after
	  argument check.

Thu Oct 26 21:05:48 2006  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* ext/openssl/ossl_pkcs7.c (ossl_pkcs7_verify): should clear error.
	  (fix http://bugs.debian.org/394336)

	* ext/openssl/ossl_ns_spki.c (ossl_spki_initialize): ditto.

Thu Oct 26 15:23:47 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* enumerator.c: remove by_slice and by_cons.

Thu Oct 26 15:12:12 2006  NAKAMURA Usaku  <usa@ruby-lang.org>

	* ext/digest/digest.c (Init_digest): typo.

Wed Oct 25 17:16:05 2006  Akinori MUSHA  <knu@iDaemons.org>

	* test/digest/test_digest_hmac.rb: added.

Wed Oct 25 16:34:31 2006  Akinori MUSHA  <knu@iDaemons.org>

	* ext/digest/test.sh: make this script work again.

Wed Oct 25 07:59:42 2006  Tadayoshi Funaba  <tadf@dotrb.org>

	* lib/date/format.rb: updated based on date2 3.9.6.
	  [ruby-core:09323]

Wed Oct 25 00:58:19 2006  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* win32/mkexports.rb, win32/resource.rb: use unique variable names.

Tue Oct 24 19:18:53 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* enumerator.c (enumerator_by_slice): new method added.

	* enumerator.c (enumerator_by_cons): ditto.

Tue Oct 24 18:56:13 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* enumerator.c (enum_each_slice, enum_each_cons): returns
	  Enumerable::Enumerator if no block is given.  [ruby-dev:29246]

	* enumerator.c: remove methods: enum_with_index, enum_slice,
	  enum_cons.  [ruby-dev:29246]

Tue Oct 24 18:51:27 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* enum.c (enum_zip): add RETURN_ENUMERATOR() to zip method.

Mon Oct 23 04:30:04 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* marshal.c (r_object0): use return value from proc given as the
	  second argument to Marshal#load() to allow value replacement in
	  the restoring data.

Sun Oct 22 14:48:31 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* signal.c (Init_signal): avoid duplicated installation of SIGCHLD
	  handler.

Sun Oct 22 16:47:56 2006  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* string.c (rb_str_substr): should be infected with only original
	  string, but not the shared string.  fixed: [ruby-core:09152]

	* string.c (rb_str_new4): keep shared string untainted when orignal
	  string is tainted.  fixed: [ruby-dev:29672]

Sun Oct 22 07:55:11 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* string.c (rb_str_upcase, rb_str_downcase, rb_str_downcase,
	  rb_str_upcase_bang, rb_str_downcase_bang, rb_str_swapcase_bang):
	  add RDoc description that case conversion to be effective only
	  in ASCII region.

Sun Oct 22 05:20:34 2006  URABE Shyouhei  <shyouhei@ice.uec.ac.jp>

	* configure.in: alloca is broken; use C_ALLOCA instead.
	  [ruby-dev:29416]

Sat Oct 21 17:50:40 2006  Akinori MUSHA  <knu@iDaemons.org>

	* ext/digest/lib/digest.rb: Follow the framework updates.

Fri Oct 20 22:00:43 2006  Akinori MUSHA  <knu@iDaemons.org>

	* ext/digest/lib/digest/hmac.rb: Complete half-boiled updates.

	* ext/digest/sha2/lib/digest/sha2.rb: Fix #initialize_clone().

Fri Oct 20 20:28:37 2006  Akinori MUSHA  <knu@iDaemons.org>

	* ext/digest: Prefix C constants with RUBY_ and C type names with
	  rb_ to avoid name clash in writing extensions.

	* ext/digest: Introduce Digest::Class and Digest::Instance for
	  ease of implementing subclasses and add-ons, inspried by
	  gotoyuzo.

	* ext/digest: The Digest::Instance module now requires and assumes
	  that any instance be resettable and clonable, and add some
	  convenient instance methods such as "new()", for creating a new
	  copy, parameter taking "digest()" and "hexdigest()", for instant
	  calculation.  These methods make digest instances work just like
	  digest classes.

	* ext/digest/sha2/lib/digest/sha2.rb:
	  Add the Digest::SHA2 class to wrap up SHA2 variants: SHA256,
	  SHA384 and SHA512, hoping this module would make a decent
	  example of a digest subclass written in Ruby.

	* ext/digest/lib/digest.rb: Adjust autoload entries for SHA2
	  classes.

	* ext/digest/lib/digest/hmac.rb: Follow the framework updates.

Fri Oct 20 10:47:43 2006  NAKAMURA Usaku  <usa@ruby-lang.org>

	* lib/mkmf.rb: fixed the bug of handling COMMON_MACROS.

Fri Oct 20 08:42:38 2006  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* common.mk (NULLCMD): dummy command.

	* bcc32/Makefile.sub (post-install-*): Borland make cannot ignore
	  command-less double-colon rules.  [ruby-dev:29676]

Fri Oct 20 00:37:07 2006  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* bcc32/Makefile.sub ($(LIBRUBY_SO)): execute pre-link hook.

	* ext/extmk.rb: workaround for Borland make.

Wed Oct 18 23:02:40 2006  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* array.c (rb_ary_shift): shorten copy size.  fixed: [ruby-list:42907]

	* signal.c (Init_signal): handle SIGTERM.  fixed: [ruby-list:42895]

	* win32/win32.c (rb_w32_utime): allow NULL to set the current time.
	  [ruby-talk:219248]

Wed Oct 18 13:25:50 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* string.c (rb_str_each_line): String#lines now works when a block
	  is given.  in other words, lines become an alias to each_line.
	  [ruby-core:09218]

	* string.c (rb_str_each_byte): ditto for bytes in place of lines.

Wed Oct 18 00:55:33 2006  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* parse.y (parser_yylex): use particular enums.  [ruby-core:09221]

Tue Oct 17 22:03:08 2006  Minero Aoki  <aamine@loveruby.net>

	* lib/erb.rb: String#each was removed, use #each_line instead.

Tue Oct 17 12:27:32 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* array.c (ary_shared_array): should set NOEMBED flag for a copied
	  array.

Tue Oct 17 08:04:31 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* string.c (rb_str_lines): now takes optional argument for the
	  line separator.

	* io.c (rb_io_lines, rb_io_bytes): new methods.

Mon Oct 16 23:33:18 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* array.c (rb_ary_unshift_m): a bug in lfree shift length
	  calculation.

Mon Oct 16 08:30:43 2006  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* mkconfig.rb: *OBJS are not needed for extension libraries.

	* {bcc32,wince,win32}/Makefile.sub (config.status): fixed typo,
	  missing comma.

Mon Oct 16 00:44:26 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* pack.c (pack_unpack): execute block if given with unpacked value
	  instead of creating an array.  an idea from Tim Bray.

Sun Oct 15 01:03:08 2006  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* lib/test/unit/collector/dir.rb (Collector::Dir#collect): append base
	  directory but not prepend.

	* lib/test/unit/collector/dir.rb (Collector::Dir#collect_file): do not
	  join with dot.  fixed: [ruby-core:09179]

Sat Oct 14 23:39:50 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* parse.y (singleton): no need to re-create NODE_SELF() again.
	  [ruby-core:09177]

Sat Oct 14 23:25:31 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* parse.y (parser_warning, parser_warn): some error message may
	  contain format specifiers.  a patch from Akinori MUSHA <knu at
	  iDaemons.org>.  [ruby-dev:29657]

	* regparse.c (onig_rb_warning, onig_rb_warn): ditto.

	* ext/bigdecimal/bigdecimal.c (VpException): ditto.

	* ext/dl/handle.c (rb_dlhandle_initialize): ditto.

	* ext/gdbm/gdbm.c (rb_gdbm_fatal): ditto.

Sat Oct 14 08:15:42 2006  Akinori MUSHA  <knu@iDaemons.org>

	* ext/digest/digest.c, ext/digest/digest.h,
	  ext/digest/md5/md5init.c, ext/digest/rmd160/rmd160init.c,
	  ext/digest/sha1/sha1init.c, ext/digest/sha2/sha2init.c:
	  Introduce API versioning.

	* ext/digest/digest.c, ext/digest/digest.h,
	  ext/digest/md5/md5init.c, ext/digest/rmd160/rmd160init.c,
	  ext/digest/sha1/sha1init.c, ext/digest/sha2/sha2init.c: Remove
	  the constants DIGEST_LENGTH and BLOCK_LENGTH and turn them into
	  instance methods digest_length() and block_length().  Class
	  methods with the same names are also provided, which take extra
	  parameters for a digest method.

	* ext/digest/lib/digest/hmac.rb: Completely redesign the somewhat
	  bizarre API, now that Digest classes can take hashing
	  parameters.

Sat Oct 14 05:54:05 2006  Akinori MUSHA  <knu@iDaemons.org>

	* ext/digest/digest.c: Improve RDoc documentation further more.

Sat Oct 14 04:33:33 2006  Akinori MUSHA  <knu@iDaemons.org>

	* ext/digest/digest.c: Improve RDoc documentation.

	* ext/digest/digest.c (Init_digest, rb_digest_base_s_digest,
	  rb_digest_base_s_hexdigest): Make Digest::Base::digest() and
	  Digest::Base::hexdigest() take extra arguments, which are passed
	  through to the constructor in an internal call.

	* ext/digest/bubblebabble/bubblebabble.c
	  (rb_digest_base_s_bubblebabble): Ditto for
	  Digest::Base::bubblebabble().

Sat Oct 14 00:55:08 2006  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* bcc32/Makefile.sub (post-install-ext): no longer needed.

	* bcc32/configure.bat: get rid of a quirk of Borland make, which
	  sets empty macro in command line to "1".

Fri Oct 13 22:49:02 2006  Tadayoshi Funaba  <tadf@dotrb.org>

	* lib/date.rb: updated based on date2 3.9.5.

Fri Oct 13 21:00:01 2006  Akinori MUSHA  <knu@iDaemons.org>

	* ext/digest/lib/digest.rb (Digest): Try to auto-load non-standard
	  digest modules when a specified digest class is missing.

	* ext/digest/lib/digest.rb: Define Digest(name) for ease of
	  dynamically selecting a hashing algorithm.

Fri Oct 13 20:53:37 2006  Akinori MUSHA  <knu@iDaemons.org>

	* ext/digest/digest.c (Init_digest): Digest::Base.new() does no
	  longer take an initial string to feed.  This change allows
	  subclasses to take hashing parameters.  A statement such as
	  ``md = Digest::MD5.new(s)'' can be easily rewritten as
	  ``md = Digest::MD5.new << s'' or
	  ``md = Digest::MD5.new.update(s)''.

Fri Oct 13 20:51:55 2006  Akinori MUSHA  <knu@iDaemons.org>

	* ext/digest/digest.c, ext/digest/md5/md5init.c,
	  ext/digest/rmd160/rmd160init.c, ext/digest/sha1/sha1init.c,
	  ext/digest/sha2/sha2init.c: Add RDoc documentation.

	* ext/digest/digest.txt, ext/digest/digest.txt.ja: Removed in
	  favor of embedded RDoc documentation.

Fri Oct 13 20:38:12 2006  Akinori MUSHA  <knu@iDaemons.org>

	* ext/digest/bubblebabble, ext/digest/digest.c: Rip BubbleBabble
	  support out of the base class and have a separate module named
	  digest/bubblebabble.

Fri Oct 13 19:53:59 2006  Akinori MUSHA  <knu@iDaemons.org>

	* ext/digest/digest.c (rb_digest_base_equal): Again, should call
	  digest() of a subclass instead of the one defined in the base
	  class.

Fri Oct 13 18:19:31 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* object.c: Class#inherited RDoc added.  a patch from Daniel
	  Berger <djberg96 at gmail.com>  [ruby-core:08942]

Fri Oct 13 02:42:00 2006  Akinori MUSHA  <knu@iDaemons.org>

	* ext/digest/digest.c (rb_digest_base_equal): Should call digest()
	  of a subclass instead of the one defined in the base class.

Fri Oct 13 02:30:12 2006  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* lib/test/unit/collector/dir.rb (Collector::Dir#collect): prepend
	  base directory to load path.

	* lib/test/unit/collector/dir.rb (Collector::Dir#collect_file): should
	  use the given File-like interface, but not File directly.

	* test/testunit/collector/test_dir.rb (TestDir::FileSystem): implement
	  File-like methods correctly.

Fri Oct 13 01:48:42 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* lib/date.rb (Date::self.complete_hash): need to check if g is
	  nil before dereference.  [ruby-core:09116]

Fri Oct 13 01:05:58 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* string.c (rb_str_partition): RDoc update.  a patch from
	  Mauricio Fernandez <mfp at acm.org>.  [ruby-core:09160]

	* hash.c (rb_hash_compare_by_id): ditto.

Fri Oct 13 00:34:26 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* object.c (rb_mod_cvar_defined): wrong id check.  a patch from
	  Mauricio Fernandez <mfp at acm.org>.  [ruby-core:09158]

	* object.c (rb_mod_cvar_get): typo fixed.  [ruby-core:09168]

	* object.c (rb_mod_cvar_set): ditto.

Thu Oct 12 22:58:11 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* hash.c (rb_hash_compare_by_id): somehow we lost renaming from
	  Hash#identical.  [ruby-core:09163]

Thu Oct 12 18:25:40 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* ext/tk/tkutil/tkutil.c (cbsubst_table_setup): need to handle new
	  character literal (1 char string).

	* lib/mkmf.rb: shut up some warnings from tk's extconf.rb.

Thu Oct 12 02:15:24 2006  Akinori MUSHA  <knu@iDaemons.org>

	* ext/digest/lib/digest/hmac.rb: Make use of String#bytes.

Thu Oct 12 02:12:31 2006  Akinori MUSHA  <knu@iDaemons.org>

	* ext/digest/digest.c (get_digest_base_metadata): Use an instance
	  variable of a class object instead of a class variable for
	  metadata.  This change is only crucial for ruby 1.8 because
	  class variables are inherited to subclasses prior to 1.9, but
	  applying it also to 1.9 will assure compatibilities.

	* ext/digest/md5/md5init.c (Init_md5): Ditto.

	* ext/digest/rmd160/rmd160init.c (Init_rmd160): Ditto.

	* ext/digest/sha1/sha1init.c (Init_sha1): Ditto.

	* ext/digest/sha2/sha2init.c (Init_sha2): Ditto.

Wed Oct 11 21:36:47 2006  Akinori MUSHA  <knu@iDaemons.org>

	* ext/digest/digest.c (rb_digest_base_alloc,
	  rb_digest_base_equal): Simplify the equality check and just
	  compare resulted digests since state-level equality should
	  not be so significant.

	* ext/digest/digest.h: Ditto.

	* ext/digest/*/*.[ch]: Ditto.

Wed Oct 11 17:11:03 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (rb_obj_define_method): add half boiled RDoc document.

Wed Oct 11 16:57:46 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* array.c (rb_ary_replace): should shift lfree pointer before
	  calling xfree.

Wed Oct 11 15:07:42 2006  Akinori MUSHA  <knu@iDaemons.org>

	* ext/digest/lib/digest/hmac.rb: Add digest/hmac, which implements
	  HMAC keyed-hashing algorithm.

Wed Oct 11 15:03:55 2006  Akinori MUSHA  <knu@iDaemons.org>

	* ext/digest/digest.c (rb_digest_base_reset): Do not make
	  recursive calls, but call initialize() when reset() is not
	  defined in a subclass.

Wed Oct 11 14:56:10 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* ext/digest/sha1/sha1ossl.h: libssl 0.9.8c-3 defines no
	  SHA_BLOCK_LENGTH.

Wed Oct 11 14:03:31 2006  Akinori MUSHA  <knu@iDaemons.org>

	* ext/digest/digest.c (rb_digest_base_reset, Init_digest): Add
	  Digest::Base#reset.

	* ext/digest/digest.h: Update the header comment.

	* ext/digest/md5/md5ossl.h, ext/digest/md5/md5init.c (Init_md5):
	  Define DIGEST_LENGTH and BLOCK_LENGTH.

	* ext/digest/rmd160/rmd160init.c (Init_rmd160): Ditto.

	* ext/digest/sha1/sha1init.c (Init_sha1): Ditto.

	* ext/digest/sha2/sha2init.c (Init_sha2): Ditto.

	* ext/digest/depend, ext/digest/extconf.rb: Use $INSTALLFILES
	  rather than adding make targets. [Pointed out by: nobu]

Tue Oct 10 16:39:08 2006  Akinori MUSHA  <knu@iDaemons.org>

	* ext/digest/digest.c (hexdigest_str_new, bubblebabble_str_new):
	  Perform StringValue() checks properly.

Tue Oct 10 13:21:21 2006  Akinori MUSHA  <knu@iDaemons.org>

	* ext/digest/sha1/depend, ext/digest/sha2/depend: Remove obsolete
	  dependencies.

Mon Oct  9 23:46:29 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* lib/parsedate.rb: documentation patch from Konrad Meyer
	  <konrad.meyer@gmail.com>.  [ruby-doc:1238]

	* lib/open3.rb, lib/ping.rb: ditto.

Mon Oct  9 23:40:58 2006  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* ext/extmk.rb, lib/fileutils.rb, lib/mkmf.rb, lib/optparse.rb,
	  lib/shellwords.rb: get rid of shadowing outer local variable.

Mon Oct  9 22:56:12 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* lib/rexml/encoding.rb (REXML::Encoding::check_encoding): spaces
	  are allowed around equal sign.  [ruby-core:09032]

	* lib/rexml/parsers/baseparser.rb (REXML::Parsers::BaseParser): ditto.

Mon Oct  9 01:56:34 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (rb_obj_define_method): add new method
	  Kernel#define_singleton_method.  [ruby-list:42851]

Sat Oct  7 23:53:08 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* string.c (rb_str_scan): small documentation fix.
	  [ruby-core:09007]

Sat Oct  7 23:44:33 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* bignum.c (rb_big_rshift): a bug in right shift of negative
	  bignums.  [ruby-core:09020]

Sat Oct  7 23:33:02 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (formal_assign): packed post splat arguments may conflict
	  with normal arguments.  [ruby-core:09021]

	* eval.c (rb_call0): ditto.

Sat Oct  7 11:53:04 2006  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* object.c (rb_mod_initialize): since module_eval no longer passes
	  self, use module_exec instead.  fixed: [ruby-dev:29637]

Sat Oct  7 00:27:58 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* class.c (rb_include_module): remove unnecessary check.
	  [ruby-talk:218402]

Fri Oct  6 15:19:59 2006  Akinori MUSHA  <knu@iDaemons.org>

	* ext/digest/depend: Fix header installation when the build
	  directory is different from srcdir. [Pointed out by: eban]

Fri Oct  6 09:56:31 2006  NAKAMURA Usaku  <usa@ruby-lang.org>

	* {bcc32,win32,wince}/Makefile.sub (config.status): shouldn't use
	  copy command instead of install. use -run install.

Fri Oct  6 06:53:46 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (rb_yield_0): small refactoring.

	* parse.y (bparam_item): fixed bugs in handling parenthesized LHS.

Fri Oct  6 04:47:07 2006  Akinori MUSHA  <knu@iDaemons.org>

	* ext/digest/depend: Install digest.h.

Fri Oct  6 04:27:40 2006  Akinori MUSHA  <knu@iDaemons.org>

	* ext/digest/lib/md5.rb, ext/digest/lib/sha1.rb: Remove those
	  compatibility stub libraries.

	* sample/openssl/c_rehash.rb: Use digest/md5 instead of obsolete md5.

Fri Oct  6 04:09:51 2006  Akinori MUSHA  <knu@iDaemons.org>

	* ext/digest/digest.c: Make hexdigest() always call digest() internally.

	* ext/digest/digest.c: Add bubblebabble().

Fri Oct  6 02:38:42 2006  Akinori MUSHA  <knu@iDaemons.org>

	* ext/digest/digest.c: Allow subclassing in Ruby.

Fri Oct  6 02:06:10 2006  Akinori MUSHA  <knu@iDaemons.org>

	* ext/digest/digest.c (hexdigest_str_new): Add a string size check.

Thu Oct  5 19:28:35 2006  Akinori MUSHA  <knu@iDaemons.org>

	* ext/digest/digest.[ch]: Since the argument order of
	  hash_final_func_t was inconsistent with others, change it and
	  rename to hash_finish_func_t to avoid confusion.

	* ext/digest/digest.[ch]: Remove and eliminate the use of
	  hash_end_func_t.  Implement hexdigest conversion in the base
	  class.

	* ext/digest/md5/md5.c, ext/digest/md5/md5.h,
	  ext/digest/md5/md5init.c, ext/digest/md5/md5ossl.c,
	  ext/digest/md5/md5ossl.h: Remove MD5_End() and change
	  MD5_Final() to MD5_Finish().

	* ext/digest/rmd160/depend, ext/digest/rmd160/extconf.rb,
	  ext/digest/rmd160/rmd160.c, ext/digest/rmd160/rmd160.h,
	  ext/digest/rmd160/rmd160hl.c, ext/digest/rmd160/rmd160init.c,
	  ext/digest/rmd160/rmd160ossl.c, ext/digest/rmd160/rmd160ossl.h:
	  Remove unused functions RMD160_End(), RMD160_File(),
	  RMD160_Data() and change RMD160_Final() to RMD160_Finish().

	* ext/digest/sha1/extconf.rb, ext/digest/sha1/sha1.c,
	  ext/digest/sha1/sha1.h, ext/digest/sha1/sha1hl.c,
	  ext/digest/sha1/sha1init.c, ext/digest/sha1/sha1ossl.c,
	  ext/digest/sha1/sha1ossl.h: Likewise.

	* ext/digest/sha2/extconf.rb, ext/digest/sha2/sha2.c,
	  ext/digest/sha2/sha2.h, ext/digest/sha2/sha2hl.c,
	  ext/digest/sha2/sha2init.c: Likewise.

Wed Oct  4 18:47:25 2006  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/lib/tkextlib/*: bugfix and update
	  (see ext/tk/ChangeLog.tkextlib).

Wed Oct  4 17:25:14 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (rb_call): check protected visibility based on real self,
	  not ruby_frame->self.  [ruby-talk:217822]

Wed Oct  4 15:46:32 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* parse.y (block_param): should interpret single parenthesized
	  left hand side expression.

Wed Oct  4 08:52:30 2006  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* test/optparse/test_getopts.rb: changed the class name of test case
	  to get rid of conflict with test_optparse.rb.

Tue Oct  3 21:04:29 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* parse.y (dyna_in_block): inline using macro.

	* parse.y (mlhs): simplifies the rule a bit.

	* parse.y (block_param): restrict block parameters to be local
	  variables only.

	* test/ruby/test_iterator.rb (TestIterator::test_nested_iterator):
	  update test suite to conform the last change.

Tue Oct  3 02:31:13 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (splat_value): use "to_splat" instead of "to_ary" to
	  prepare splat values as an array.

	* array.c (Init_Array): define to_splat.

	* range.c (range_to_splat): new method.

	* enumerator.c (enumerator_to_splat): ditto.

Tue Oct  3 01:36:47 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* string.c (rb_str_lines): returns an Enumerator instead of an
	  array of lines.

	* string.c (rb_str_bytes): a new method.

Mon Oct  2 23:47:55 2006  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* lib/test/unit/autorunner.rb (Test::Unit::AutoRunner::COLLECTORS):
	  base directory should be lower precedence.  fixed: [ruby-dev:29622]

	* lib/test/unit/autorunner.rb (Test::Unit::AutoRunner#options): typo.

	* lib/test/unit/collector/dir.rb (Test::Unit::Collector::Dir#collect_file):
	  load expanded path.  fixed: [ruby-dev:29621]

Mon Oct  2 15:47:55 2006  NAKAMURA Usaku  <usa@ruby-lang.org>

	* instruby.rb: batfile should be CRLF'ed.

Mon Oct  2 01:24:26 2006  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* common.mk (test-all): separate directory where running test cases
	  from source tree.

	* lib/test/unit/autorunner.rb (options): added --basedir, --workdir
	  and --load-path options.

	* lib/test/unit/collector/dir.rb (recursive_collect, collect_file):
	  base directory support.

Sun Oct  1 23:56:52 2006  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* Makefile.in, common.mk, ext/extmk.rb, win{32,ce}/Makefile.in: keep
	  LIBRUBY_SO unless need to be removed.

Sun Oct  1 23:12:19 2006  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* lib/optparse.rb (OptionParser#make_switch): pass arguments directly.

Sat Sep 30 15:11:26 2006  Tadayoshi Funaba  <tadf@dotrb.org>

	* lib/date.rb, lib/date/format.rb: updated based on date2 3.9.4.

Fri Sep 29 13:18:24 2006  Akinori MUSHA  <knu@iDaemons.org>

	* ext/digest/lib/digest.rb (Digest): Require digest.so and fix the
	  breakage.  Point out by NAKAMURA Usaku in [ruby-dev:29619].

Fri Sep 29 12:11:04 2006  WATANABE Hirofumi  <eban@ruby-lang.org>

	* jcode.rb (succ!): call original succ! if $KCODE == 'n'.
	  fixed: [ruby-talk:216845]

Fri Sep 29 11:43:40 2006  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* lib/mkmf.rb (try_func): revert fallback checking undeclared function.
	  fixed: [ruby-core:08949]

Fri Sep 29 09:56:56 2006  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* ext/extmk.rb: extout is needed for also clean.
	  fixed: [ruby-core:08944]

	* lib/optparse.rb (OptionParser::Switch#conv_arg): unsplat by
	  Proc#call if no conversion is given.

Thu Sep 28 23:59:31 2006  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* node.h (struct thread): declare win32_exception_list on cygwin and
	  win32 regardless if it is implemented.  Provisional fix for
	  [ruby-core:08917].

Thu Sep 28 20:49:20 2006  NAKAMURA Usaku  <usa@ruby-lang.org>

	* lib/tmpdir.rb: use return value of getdir.call for length.

Wed Sep 27 22:08:16 2006  Akinori MUSHA  <knu@iDaemons.org>

	* ext/digest/md5/md5init.c (Init_md5): Now that we have digest.rb,
	  require "digest" rather than "digest.so".

	* ext/digest/rmd160/rmd160init.c (Init_rmd160): Ditto.

	* ext/digest/sha1/sha1init.c (Init_sha1): Ditto.

	* ext/digest/sha2/sha2init.c (Init_sha2): Ditto.

Wed Sep 27 21:21:08 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* string.c (rb_str_startwith): rename startwith? to start_with?,
	  endwith? to endwith?, respectively.  [ruby-talk:216685]

Wed Sep 27 13:29:01 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* lib/cgi.rb (CGI::TagMaker::nOE_element_def): replace to_s by
	  join.  some other methods as well.  [ruby-dev:29613]

Wed Sep 27 01:04:49 2006  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* lib/mkmf.rb (try_func): check function pointer first and macro next.

	* lib/mkmf.rb (have_type): simplified with typedef and sizeof.

Wed Sep 27 00:08:12 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* array.c (rb_ary_shift): shift/unshift performance boost patch,
	  based on the patch from Eric Mahurin <eric_mahurin at yahoo.com>.
	  [ruby-core:05861]

	* array.c (rb_ary_unshift_m): ditto.

	* array.c (ary_make_shared): ditto.

	* array.c (RESIZE_CAPA): ditto.

	* array.c (rb_ary_free): new function to free memory.  code moved
	  from gc.c.

	* string.c (rb_str_free): ditto.

Tue Sep 26 23:57:03 2006  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* lib/optparse.rb (OptionParser#getopts): use strings as key.
	  fixed: [ruby-dev:29614]

Tue Sep 26 15:29:55 2006  NAKAMURA Usaku  <usa@ruby-lang.org>

	* {win32,wince}/Makefile.sub (CPP): check predefined value.

Tue Sep 26 07:55:16 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* array.c (rb_ary_shift): should not move memory region if array
	  body is shared.  a patch from Kent Sibilev <ksruby at gmail.com>.
	  [ruby-core:08922]

Mon Sep 25 23:10:46 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* dir.c (rb_push_glob): need not to check by FilePathValue().
	  [ruby-dev:29599]

	* dir.c (dir_globs): ditto.

Mon Sep 25 22:26:26 2006  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* file.c (rb_path_end): skip root directory.  fixed: [ruby-core:08913]

	* lib/mkmf.rb (rm_f): get rid of NUL.

	* lib/mkmf.rb (init_mkmf): set default $LDFLAGS.  Patch by Michal
	  Suchanek <hramrach at centrum.cz>.  [ruby-talk:216256]

Mon Sep 25 15:06:18 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* sample/test.rb: "print nil" now prints empty string.

	* test/ruby/test_system.rb (TestSystem::test_system): ditto.

Mon Sep 25 11:26:25 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* hash.c (recursive_hash): remove unused local variable.

	* parse.y (parser_yylex): ditto.

	* parse.y (rb_gc_mark_symbols): fix unmatched prototype .

	* file.c (rb_get_path): check NUL byte in the path string.

Mon Sep 25 08:14:43 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* array.c (rb_ary_shift): should clear shifting top element.
	  [ruby-talk:216055]

	* array.c (rb_ary_shift): avoid creating shared object if array
	  size is small.

Mon Sep 25 08:11:35 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* random.c (rb_f_rand): RDoc typo fix.  a patch from Frederick
	  Cheung <fred at 82ask.com>.  [ruby-talk:216047]

Sun Sep 24 21:19:24 2006  Guy Decoux  <ts@moulon.inra.fr>

	* gc.c (gc_mark_children): NODE_POSTEXE holds Ruby VALUE.
	  [ruby-core:08912]

Sun Sep 24 22:28:20 2006  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* runruby.rb: extension library scripts moved into common directory.

Sun Sep 24 12:10:04 2006  Tadayoshi Funaba  <tadf@dotrb.org>

	* lib/date.rb, lib/date/format.rb: updated based on date2 3.9.3.

Sun Sep 24 06:55:36 2006  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* io.c (rb_io_print): no special handling for nil as well as puts.
	  fixed: [ruby-dev:29586]

Sun Sep 24 06:25:53 2006  why the lucky stiff  <why@ruby-lang.org>

	* eval.c (rb_thread_save_context, rb_thread_restore_context):
	  sandbox hook to save and restore sandbox state.

	* eval.c (thread_no_ensure): added THREAD_NO_ENSURE thread flag.

	* eval.c (rb_thread_kill_bang): Thread#kill! uses the above flag
	  to circumvent ensure, in order to prevent endless loops.
	  contributed by MenTaLguY. [ruby-core:08768]

	* eval.c (rb_thread_kill): fix Thread#kill docs, which returns
	  the thread object in all cases.

	* node.h: expose the rb_jmpbuf_t and rb_thread_t structs, along
	  with the thread flags.  used by the sandbox extension.

	* ruby.h: extern rb_eThreadError, so sandbox can swap it.

Sat Sep 23 21:34:15 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* lib/cgi.rb (CGI::QueryExtension::read_multipart): CGI content
	  may be empty.  a patch from Jamis Buck <jamis at 37signals.com>.

Sat Sep 23 20:54:28 2006  K.Kosako  <sndgk393 AT ybb.ne.jp>

	* oniguruma.h: Version 4.4.4

	* regexec.c: ditto.

	* regcomp.c ditto.

Sat Sep 23 08:35:53 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* lib/rdoc/ri/ri_options.rb: prevent NameError.  [ruby-dev:29597]

Sat Sep 23 01:02:57 2006  Tadayoshi Funaba  <tadf@dotrb.org>

	* lib/date.rb, lib/date/format.rb: updated based on date2 3.9.2.

Fri Sep 22 18:07:17 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* string.c (rb_str_partition): no need to call rb_call_super(),
	  since String is no longer includes Enumerable.

Fri Sep 22 17:33:29 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* hash.c (rb_hash_eql): new method to be used by Hash.

	* hash.c (rb_hash_hash): ditto.

Fri Sep 22 06:53:22 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* bignum.c (rb_big_hash): use rb_memhash().

	* numeric.c (flo_hash): simplified.  klass need not to affect
	  resulting hash value.

Fri Sep 22 02:06:26 2006  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* .cvsignore: ignore timestamp files and installed list file.

Fri Sep 22 01:36:34 2006  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* instruby.rb: include FileUtils unconditionally.

Fri Sep 22 00:36:05 2006  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* numeric.c (Init_Numeric): fix_odd_p and fix_even_p are for Fixnum.
	  patch from Ondrej Bilka <neleai at seznam.cz>.  [ruby-core:08904]

Thu Sep 21 22:56:20 2006  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* common.mk (no-install): not install rdoc actually.

	* common.mk (install-doc, no-install-doc): use instruby.rb.

	* instruby.rb: rdoc installation.

	* ext/extmk.rb: expand ruby executable names.

Thu Sep 21 20:19:22 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* string.c (str_new3): embed shorter strings more eagerly.

Thu Sep 21 17:44:49 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* string.c (rb_str_startwith): a new method to check if a string
	  starts with given prefix.

	* string.c (rb_str_endwith): the opposite of String#startwith?.

Thu Sep 21 16:29:02 2006  WATANABE Hirofumi  <eban@ruby-lang.org>

	* rubytest.rb: use each_line instead of each.

Thu Sep 21 15:06:24 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* numeric.c (int_odd_p): a new method to check even or odd.
	  [RCR#337]

	* numeric.c (int_even_p): ditto.

Thu Sep 21 13:55:07 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* ext/etc/etc.c (etc_getpwuid): uid integer should be wraped in
	  uid_t value.  [ruby-core:08897]

	* ext/etc/etc.c (etc_getpwuid): uid_t may be bigger than plain
	  'int' type.

Thu Sep 21 10:07:09 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* string.c (rb_str_partition): RDoc typo fixed.  [ruby-core:08898]

	* string.c (rb_str_rpartition): fixed separation seek bug.

Thu Sep 21 09:38:12 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* string.c (rb_str_lines): new method to split a string into lines.

	* string.c (Init_String): Strings are no longer Enumerable.  use
	  each_line or lines method explicitly.

	* string.c (Init_String): remove each method. use each_lines.

Wed Sep 20 23:17:41 2006  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* common.mk (pre-install-doc): create data directory before install.

	* lib/mkmf.rb (dir_re): fixed typo.

	* lib/mkmf.rb (install_dirs): remove extra slash.

Wed Sep 20 22:41:45 2006  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* numeric.c (fix_mul): typo again.  patch from Tadashi Saito
	  <shiba at mail2.accsnet.ne.jp>.  fixed: [ruby-core:08893]

Wed Sep 20 19:32:06 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* string.c (rb_str_partition): a new method to separate the string
	  by a separator.  taken from Python 2.5.

	* string.c (rb_str_rpartition): ditto.

Wed Sep 20 09:49:40 2006  NAKAMURA Usaku  <usa@ruby-lang.org>

	* {bcc32,win32,wince}/Makefile.sub (INSTALLED_LIST): need to define
	  this macro to install.

Wed Sep 20 09:43:10 2006  Shugo Maeda  <shugo@ruby-lang.org>

	* lib/net/imap.rb: allow extra spaces in responses.
	  Thanks, Tom Soderlund.

Wed Sep 20 09:25:39 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* ext/gdbm/gdbm.c: add RDoc documentation. a patch from Peter
	  Adolphs <futzilogik at users dot sourceforge dot net>.
	  [ruby-doc:1223]

Tue Sep 19 00:42:15 2006  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* object.c (rb_obj_ivar_defined, rb_mod_cvar_defined): new methods,
	  Kernel#instance_variable_defined? and Module#class_variable_defined?.
	  [ruby-dev:29587]

	* lib/date/format.rb (Date::Bag#method_missing): use new method,
	  instance_variable_defined? to check if an instance variable is
	  defined.  fixed: [ruby-dev:29554]
	  -- This didn't fix anything.

Tue Sep 19 00:07:17 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* string.c (sym_eql): fail early to gain performance.

	* string.c (sym_hash): cache hash value in aux.shared if possible.

	* gc.c (rb_obj_id): no need to treat symbols specially.

	* lib/fileutils.rb (FileUtils::FileUtils): singleton_methods() no
	  longer return an array of strings, but of symbols.

	* lib/delegate.rb (DelegateClass): ditto.

Mon Sep 18 15:29:21 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* dir.c (dir_s_glob): restore GC protection volatile variable.
	  [ruby-dev:29588]

	* re.c (rb_reg_regcomp): ditto.

Mon Sep 18 12:16:48 2006  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* numeric.c (fix_mul): get rid of shift overflow.

Mon Sep 18 10:47:49 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* dir.c (dir_s_glob): remove unused variable.

	* math.c (math_log): ditto.

	* re.c (rb_reg_regcomp): ditto.

	* eval.c (break_jump): ditto.

	* eval.c (rb_thread_yield_0): remove unused function.

Sun Sep 17 23:44:58 2006  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* lib/rdoc/rdoc.rb (RDoc::RDoc#document): scan only files modified
	  after the previous generation.

Sun Sep 17 17:42:13 2006  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* common.mk (install-doc): reverted.

	* instruby.rb: stores file name list without destdir prefix.

	* lib/rdoc/generators/ri_generator.rb: do not chdir twice.

Sun Sep 17 10:42:10 2006  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* numeric.c (fix_mul): fixed typo.  fixed: [ruby-core:08885]

Sat Sep 16 19:47:16 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* README.EXT: should mention new macros: RSTRING_PTR, RSTRING_LEN,
	  RARRAY_PTR, RARRAY_LEN.

	* README.EXT.ja: ditto.

Sat Sep 16 16:39:23 2006  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* Makefile.in, common.in, instruby.rb, ext/extmk.rb, lib/mkmf.rb:
	  use instruby.rb to install extensions instead of ext/extmk.rb.

	* instruby.rb: store installed list into the file.

	* ext/dbm/extconf.rb: allow multiple candidates for dbm-type.

	* ext/io/wait/extconf.rb: suspicious checking_for.

	* ext/pty/pty.c (establishShell): parent pid is not used.

	* ext/pty/pty.c (freeDevice): not used.

	* lib/mkmf.rb (checking_for): improved the messages.

Sat Sep 16 11:03:49 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* array.c (ary_shared_first): should create embedded copies
	  instead of sharing memory region for smaller arrays.

Sat Sep 16 09:37:39 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* struct.c (inspect_struct): do not display a class name for
	  anonymous struct.  The member fields are sufficient.

Fri Sep 15 20:22:15 2006  NARUSE, Yui  <naruse@ruby-lang.org>

	* ext/nkf/nkf-8/nkf.c: imported nkf 2.0.8 rev.110.
	  * Fix: check_bom cuts \xfe\xff\xXX\xXX of UTF-32LE.
	  * Add support --ic=UTF-32.
	  * Fix: can't guess UTF-16 and UTF-32.
	  * Fix: can't decode beyond BMP of UTF-16LE.

	* ext/nkf/nkf.c (guess): Support UTF-32.

	* ext/nkf/lib/kconv.rb (kconv): Support UTF-32.

	* ext/nkf/lib/kconv.rb (to_utf32): new method.

Fri Sep 15 05:23:24 2006  NARUSE, Yui  <naruse@ruby-lang.org>

	* ext/nkf/nkf-8/nkf.c: imported nkf 2.0.8 2006-09-15.
	  Add support for U+10000 - U+10FFFF
	  Add support UTF-32

Fri Sep 15 00:03:07 2006  Tanaka Akira  <akr@fsij.org>

	* ext/digest/lib/digest.rb (Digest::Base.file): open a file in binary
	  mode.  suggested by Kazuhiro NISHIYAMA.  [ruby-dev:29579]

Thu Sep 14 17:21:07 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* numeric.c (fix_mul): avoid bignum multiplication as far as
	  possible.  a patch from Ondrej Bilka <neleai at seznam.cz>.
	  [ruby-core:08825]

Thu Sep 14 16:34:55 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* string.c (rb_str_intern): allow zero length symbols.
	  [ruby-core:08861]

Thu Sep 14 16:11:15 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* string.c (rb_str_intern): raise SecurityError only when $SAFE
	  level is greater than zero.  [ruby-core:08862]

	* parse.y (rb_interned_p): new function to check if a string is
	  already interned.

	* string.c (str_to_id): use rb_str_intern().

Thu Sep 14 14:37:45 2006  Tanaka Akira  <akr@fsij.org>

	* ext/digest/lib/digest.rb (Digest::Base.file): new method.
	  [ruby-dev:29572]

Thu Sep 14 08:30:02 2006  Tanaka Akira  <akr@fsij.org>

	* ext/digest/digest.c (rb_digest_base_inspect): new method.
	  [ruby-dev:29573]

Thu Sep 14 01:13:56 2006  NAKAMURA Usaku  <usa@ruby-lang.org>

	* gc.c (ruby_init_stack): decrease "stack level too deep" in Windows.
	  [ruby-dev:29569]

Thu Sep 14 01:02:25 2006  Tanaka Akira  <akr@fsij.org>

	* ext/digest/lib/digest.rb: new file.
	  [ruby-dev:28689]

Wed Sep 13 18:43:05 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* README.EXT: English adjustment.  [ruby-core:08851] and
	  [ruby-core:08852]

Wed Sep 13 18:25:18 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* misc/ruby-mode.el (ruby-parse-partial): better here-doc support.
	  a patch from Marshall T. Vandegrift <llasram at gmail.com>.
	  [ruby-core:08804]

Wed Sep 13 16:43:36 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* string.c (rb_str_intern): prohibit interning tainted string.

Wed Sep 13 01:14:02 2006  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* lib/optparse.rb (OptionParser#getopts): works with pre-registered
	  options.  [ruby-core:08826]

Tue Sep 12 03:58:39 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* hash.c (rb_hash_compare_by_identity): rename Hash#identical to
	  Hash#compare_by_identity.

Mon Sep 11 16:52:37 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* hash.c (rb_hash_identical): a new method to make a hash to
	  compare keys by their identity.

	* hash.c (rb_hash_identical_p): new method to tell if a hash is
	  identical or not.

	* st.c (st_numcmp, st_numhash): export hash type functions.

Mon Sep 11 11:42:21 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* lib/rexml/source.rb (REXML::Source::encoding): should not
	  convert the body twice.  [ruby-core:08828]

	* lib/rexml/encoding.rb (REXML::Encoding::encoding):
	  Encoding#encoding= to return boolean value to tell if the body
	  is really converted or not.

	* lib/rexml/encoding.rb (REXML::Encoding::encoding): Specific
	  conversion library (e.g. rexml/encodings/UTF-16.rb) to have
	  higher preceding.

	* lib/rexml/encodings/UTF-16.rb (REXML::Encoding::decode_utf16):
	  UTF-16#decode_utf16 should work strings without BOM.

Mon Sep 11 07:39:44 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* string.c (sym_equal): "sym == str" should compare them as
	  strings.  [ruby-dev:29554]

Sun Sep 10 22:59:43 2006  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* instruby.rb (parse_args): remove splat.

Sun Sep 10 20:25:30 2006  Tadayoshi Funaba  <tadf@dotrb.org>

	* lib/date.rb, lib/date/format.rb: updated based on date2 3.9.1.

Sun Sep 10 09:41:29 2006  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* file.c: ISPRINT() needs ctype.h

Sun Sep 10 09:19:47 2006  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* lib/optparse.rb: splat parsed arguments.

Tue Jan 10 09:18:03 2006  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* eval.c (rb_require_safe): prevent extension from loading twice.
	  fixed: [ruby-dev:29523]

Sat Sep  9 23:55:28 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* file.c (rb_f_test): test(0) should not have any special
	  meaning.  [ruby-dev:29425]

	* file.c (rb_f_test): properer error message.

Sat Sep  9 14:08:38 2006  Eric Hodel  <drbrain@segment7.net>

	* lib/test/unit/testcase.rb (Test::Unit::TestCase#run): Rescue
	  Exception in Test::Unit::TestCase#run.  [ruby-core:08783]

Sat Sep  9 04:55:59 2006  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* lib/pstore.rb: open all in binary mode, and get rid of the quirk of
	  msvcrt.  fixed: [ruby-dev:29518]

Sat Sep  9 04:47:45 2006  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* Makefile.in, win32/Makefile.sub (MINIRUBY): append MINIRUBYOPT.

	* mkconfig.rb, ext/extmk.rb, lib/mkmf.rb, win32/mkexports.rb: suppress
	  warnings with $VERBOSE.

	* win32/resource.rb: only file which has more than one icon is DLL.

Fri Sep  8 16:53:30 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* string.c (str_alloc): should allocate a String object, even when
	  asked to allocate a Symbol object.  [ruby-dev:29529]

Fri Sep  8 16:36:27 2006  NAKAMURA Usaku  <usa@ruby-lang.org>

	* ext/extmk.rb (extmake): follow Array#to_s.

	* lib/mkmf.rb (create_makefile): ditto.

	* win32/resource.rb: ditto.

Fri Sep  8 10:00:12 2006  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* lib/webrick/cookie.rb (WEBrick::Cookie.parse_set_cookies): new
	  method to parse multiple cookies per Set-Cookie header.
	  Thanks to Aaron Patterson <aaron_patterson at speakeasy.net>.
	  [ruby-core:08802]

Fri Sep  8 08:59:30 2006  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* win32/Makefile.sub, win32/configure.bat win32/setup.mak: program
	  name transform.

Fri Sep  8 08:25:39 2006  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* lib/optparse.rb: suppress `assigning void value' warning.

Fri Sep  8 01:16:34 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* array.c (Init_Array): #to_s to be an alias to #inspect.
	  [ruby-dev:29520]

	* hash.c (Init_Hash): ditto.

	* lib/mkmf.rb (create_makefile): replace "print array" by
	  "print *array".

	* mkconfig.rb: ditto.

Thu Sep  7 21:02:56 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* object.c (nil_to_s): returns the empty string again.
	  [ruby-dev:29520]

Thu Sep  7 23:27:05 2006  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* file.c (path_check_0, fpath_check): disable path check on cygwin.
	  [ruby-talk:213074]

Thu Sep  7 02:03:45 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* time.c (time_to_s): adopt new date format using digits
	  e.g. "2006-09-07 02:03:45 +9000".

Thu Sep  7 01:54:22 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* string.c (sym_equal): override.  check equivalence.

Wed Sep  6 13:25:04 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* parse.y (symbols_i): need to initialize early-created symbols.
	  [ruby-dev:29496]

Wed Sep 06 12:05:19 2006  NARUSE, Yui  <naruse@ruby-lang.org>

	* ext/nkf/lib/kconv.rb (Kconv::toeuc): remove -m0 [ruby-dev:29505]

Tue Sep  5 22:06:43 2006  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* ext/tk/tcltklib.c: use rb_ary_new3() since RARRAY_LEN() is not l-value.

	* ext/tk/tkutil/tkutil.c: use RARRAY_PTR() and RARRAY_LEN() and etc.
	  fixed: [ruby-dev:29473]

Tue Sep  5 06:47:22 2006  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* time.c (time_to_s): variable declaration after an execution
	  statement.

Tue Sep  5 05:49:41 2006  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* file.c (path_check_0): check if sticky bit is set on parent
	  directories for executable path.  fixed: [ruby-dev:29415]

Tue Sep  5 05:03:46 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* numeric.c (fix_plus): addition in Fixnum will never overflow
	  long.  a patch from Ondrej Bilka <neleai at seznam.cz>.
	  [ruby-core:08794]

	* numeric.c (fix_minus): ditto.

	* bignum.c (rb_big_pow): eagerly truncate resulting bignum.
	  [ruby-core:08794]

Mon Sep  4 23:15:34 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* time.c (time_to_s): make it conform to RFC2822 date format.
	  [ruby-dev:29467]

Mon Sep  4 21:43:57 2006  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* ext/dbm/extconf.rb: create makefile according to the result of check
	  for dbm header.  fixed: [ruby-dev:29445]

Mon Sep  4 21:39:42 2006  Tadayoshi Funaba  <tadf@dotrb.org>

	* lib/date.rb, lib/date/format.rb: updated based on date2 3.9.

Mon Sep  4 21:14:20 2006  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* time.c (time_strftime): include nul character.  fixed: [ruby-dev:29422]

Mon Sep  4 16:39:11 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* lib/cgi.rb (CGI::out): specify -x option for nkf.

	* lib/cgi.rb (CGI::out): should not convert utf-8 implicitly using
	  NKF.  it is too Japanese centric.

Mon Sep  4 14:23:10 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* ext/dbm/extconf.rb (db_check): remove debug print.

Mon Sep  4 06:46:08 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* parse.y (rb_id2sym): intern if id is attrset_id.
	  [ruby-dev:29420] [ruby-dev:29447]

Mon Sep  4 01:25:16 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (rb_f_local_variables): list symbols.

	* struct.c (rb_struct_s_members_m): ditto.

	* variable.c (ivar_i): ditto.

	* variable.c (gvar_i): ditto.

	* variable.c (cv_i): ditto.

Sun Sep  3 20:47:02 2006  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* ruby.h (SYMBOL_P): Qnil and Qfalse are not Symbol.

Sun Sep  3 15:32:44 2006  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* lib/mkmf.rb: get rid of nil.to_s.

Sun Sep  3 06:24:38 2006  Tanaka Akira  <akr@fsij.org>

	* ext/socket/socket.c (ruby_connect): sockerrlen should be socklen_t.

Sun Sep  3 04:40:42 2006  Tanaka Akira  <akr@fsij.org>

	* ext/socket/extconf.rb: check arpa/inet.h for ntohs.

	* ext/socket/socket.c: include arpa/inet.h if available.

Sat Sep  2 23:59:58 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* string.c (Init_String): undef Symbol#new.

	* struct.c (rb_struct_s_def): wrong symbol detection.

Sat Sep  2 23:59:37 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* string.c (str_to_id): a bug caused by premature optimization.

Sat Sep  2 23:53:28 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* object.c (Init_Object): move symbol related code to string.c

	* string.c (Init_String): Symbol as subclass of String.

	* parse.y (rb_intern2): handle symbol as strings.

	* string.c (str_new): substring of symbols are mere strings, not
	  symbols.

Sat Sep  2 23:37:29 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* ruby.h (struct RArray): embed small arrays.
	  (RARRAY_LEN): defined for accessing array members.
	  (RARRAY_PTR): ditto.

	* array.c: use RARRAY_LEN and RARRAY_PTR.

Sat Sep  2 13:23:01 2006  Tanaka Akira  <akr@fsij.org>

	* common.mk (ia64.o): use the compiler driver to assemble ia64.s
	  to use appropriate ABI.

Sat Sep  2 12:06:35 2006  NAKAMURA, Hiroshi  <nahi@ruby-lang.org>

	* lib/soap/generator.rb (SOAP::SOAPGenerator#encode_tag): do not dump
	  XML attribute which value is nil.  value "" and nil both were dumped
	  as 'attr="value"'.  [ruby-dev:29395]

Sat Sep  2 11:47:58 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (rb_eval): should handle when in else clause.  a patch
	  from Eric Hodel <drbrain at segment7.net>.  [ruby-core:08662]

	* parse.y (primary): wrap with NODE_CASE.  [ruby-core:08663]

Sat Sep  2 12:00:32 2006  NAKAMURA, Hiroshi  <nahi@ruby-lang.org>

	* lib/csv.rb (CSV::IOReader#initialize): use String#[](pos, len)
	  instead of String#[](idx) to check utf BOM.  follows String#[](idx)
	  behavior change of 1.9.

Sat Sep  2 11:47:58 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (rb_eval): should handle when in else clause.  a patch
	  from Eric Hodel <drbrain at segment7.net>.  [ruby-core:08662]

	* parse.y (primary): wrap with NODE_CASE.  [ruby-core:08663]

Fri Sep  1 22:07:04 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* ruby.h (RSTRING_EMBED_LEN_MASK): uses 5 bits to support 64bit
	  environment.  [ruby-dev:29369]

Fri Sep  1 22:02:08 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* string.c (rb_str_resize): should copy embedded string to
	  malloc'ed buffer.  a patch from <nobu at ruby-lang.org> in
	  [ruby-dev:29369].  fixed: [ruby-dev:29368]

	* string.c (rb_str_ord): use %ld specifier since STRING_LEN() is a
	  long.  [ruby-dev:29369]

Fri Sep  1 21:41:12 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* ext/socket/socket.c (socks_init): typo fixed.  a patch from Sven
	  Klemm <sven at c3d2.de>.  [ruby-core:08770]

Fri Sep  1 14:22:42 2006  WATANABE Hirofumi  <eban@ruby-lang.org>

	* array.c (rb_ary_shuffle): RDoc fixed.

Fri Sep  1 13:52:57 2006  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/lib/tk/font.rb: TkFont#current_configinfo() doesn't work
	  on Tcl/Tk8.x.

Fri Sep  1 09:32:55 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* lib/irb/ruby-lex.rb (RubyLex::getc): should not push nil into
	  reading buffer (@readed).  reported in
	  <http://jarp.does.notwork.org/diary/200608c.html#200608311>.

Thu Aug 31 23:59:03 2006  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* lib/mkmf.rb (configuration): follow nil.to_s.

Thu Aug 31 20:50:46 2006  NAKAMURA Usaku  <usa@ruby-lang.org>

	* lib/mkmf.rb (create_makefile): follow nil.to_s.

	* win32/resource.rb: ditto.

Thu Aug 31 20:21:47 2006  NAKAMURA Usaku  <usa@ruby-lang.org>

	* eval.c (search_required): use RSTRING_PTR and RSTRING_STR.

	* file.c (test_identical, rb_file_s_truncate): ditto.

	* io.c (pipe_open, rb_io_reopen): ditto.

	* object.c (nil_plus): ditto.

	* process.c (proc_spawn_n, rb_spawn): ditto.

	* util.c (ruby_add_suffix): ditto.

	* ext/Win32API/Win32API.c (Win32API_initialize): ditto.

	* ext/dl/cptr.c (rb_dlptr_s_to_ptr): ditto.

	* ext/openssl/ossl_x509ext.c (ossl_x509extfactory_create_ext): ditto.

	* ext/tk/stubs.c, ext/tk/tcltklib.c, ext/tk/tkutil/tkutil.c: ditto.

	* ext/win32ole/win32ole.c (ole_val2olevariantdata): ditto.

Thu Aug 31 18:23:00 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* ruby.h (struct RString): embed small strings.
	  (RSTRING_LEN): defined for accessing string members.
	  (RSTRING_PTR): ditto.

	* string.c: use RSTRING_LEN and RSTRING_PTR.

Thu Aug 31 17:16:19 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* array.c (rb_ary_shuffle_bang): new method.

	* array.c (rb_ary_shuffle): ditto.

	* random.c (genrand_real): ditto.

	* random.c (genrand_int32): export the function.

	* random.c (Init_Random): initialize random seed at the
	  beginning.

Thu Aug 31 13:12:06 2006  why the lucky stiff  <why@ruby-lang.org>

	* eval.c (ruby_init): rename top_cref to ruby_top_cref and export,
	  along with ruby_cref, for use by the sandbox. [ruby-core:08762]

	* node.h: ditto.

Wed Aug 30 12:01:57 2006  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* numeric.c (flo_hash): improve collision.

	* string.c (rb_memhash): new generic function to calculate hash value
	  for memory chunk.

Tue Aug 29 19:10:10 2006  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* hash.c (rb_hash_s_create): fixed memory leak, based on the patch
	  by Kent Sibilev <ksruby at gmail.com>.  fixed: [ruby-talk:211233]

Mon Aug 28 11:29:46 2006  Eric Hodel  <drbrain@segment7.net>

	* eval.c, parse.y: Revert.
	* ext/.document: Add digest.c.
	* ext/digest/digest.c: Make RDoc show up.
	* ext/io/wait.c: Fix call-seq in RDoc.

Mon Aug 28 08:03:20 2006  Eric Hodel  <drbrain@segment7.net>

	* ext/.document: Add C files with RDoc.
	* ext/digest/digest.c: Convert to RDoc.
	* ext/io/wait.c: ditto.
	* lib/rdoc/parsers/parse_rb.rb: Fix typo.  Submitted by
	  <calamitas at gmail.com>.  [ruby-core:08724]

Mon Aug 28 07:21:47 2006  Eric Hodel  <drbrain@segment7.net>

	* file.c (File#size?): Fix documentation submitted by Rick Ohnemus.
	  ruby-Bugs-5529.  [ruby-core:08725]

Sun Aug 27 21:41:23 2006  K.Kosako  <sndgk393 AT ybb.ne.jp>

	* oniguruma.h: Version 4.4.0

	* regint.h: ditto.

	* regparse.h: ditto.

	* regexec.c: ditto.

	* regcomp.c ditto.

	* regparse.c: ditto.

Sat Aug 26 08:03:03 2006  Tadayoshi Funaba  <tadf@dotrb.org>

	* lib/date.rb, lib/date/format.rb: updated based on date2 3.8.2.

Fri Aug 25 21:15:22 2006  K.Kosako  <sndgk393 AT ybb.ne.jp>

	* common.mk: add regint.h and oniguruma.h to dependence.

	* ext/strscan/depend: ditto.

Fri Aug 25 20:35:57 2006  NAKAMURA Usaku  <usa@ruby-lang.org>

	* test/wsdl/document/echo.rb: removed.

	* test/wsdl/document/test_rpc.rb: remove echo.rb after test.
	  [ruby-dev:29337]

Fri Aug 25 17:02:06 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* gc.c (gc_sweep): typo fixed.

Fri Aug 25 16:05:50 2006  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* object.c (sym_call): check if the receiver is given.

Fri Aug 25 01:10:11 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* object.c (rb_Integer): Integer(nil) should raise TypeError.
	  [ruby-talk:210205]

	* object.c (nil_to_s): no longer returns empty string but "nil".
	  [ruby-talk:210205]

	* lib/mkmf.rb: avoid COMMON_HEADERS being nil.

Wed Aug 23 00:25:14 2006  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* lib/rexml/source.rb (REXML::IOSource#initialize): encoding have to
	  be set with the accessor.  fixed: [ruby-list:42737]

Tue Aug 22 19:21:00 2006  Minero Aoki  <aamine@loveruby.net>

	* lib/net/smtp.rb: parameter `to_addrs' might be an Array,
	  .flatten is required. [ruby-dev:29316]

Tue Aug 22 18:47:51 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* lib/rdoc/parsers/parse_c.rb (RDoc::C_Parser::handle_method):
	  rdoc documents C module methods as instance methods. a patch in
	  [ruby-core:08536].

Tue Aug 22 12:35:57 2006  NARUSE, Yui  <naruse@ruby-lang.org>

	* ext/nkf/lib/kconv.rb (Kconv::RegexpEucjp): fix regexp for
	  euc-jp [ruby-dev:29344]

Sun Aug 20 11:46:52 2006  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* numeric.c (num_step): also return an enumerator object if no block
	  is given.

Sat Aug 19 16:47:51 2006  Masaki Suketa  <masaki.suketa@nifty.ne.jp>

	* ext/win32ole/win32ole.c (hash2named_arg): accept hash argument
	  of symbol key.

	* test/win32ole/test_win32ole.rb
	  ditto.

Sat Aug 19 11:28:08 2006  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* file.c (rb_file_s_rename): use errno if set properly.
	  fixed: [ruby-dev:29293]

Fri Aug 18 01:05:57 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* lib/cgi.rb (CGI::out): specify -m0 to disable MIME decode.  a
	  patch from Fujioka <fuj at rabbix.jp>.  [ruby-dev:29284]

Thu Aug 17 19:15:16 2006  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* file.c (rb_stat_[rRwWxX]): check for super user.
	  fixed: [ruby-core:08616]

Thu Aug 17 14:47:06 2006  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* lib/mkmf.rb: added rdoc by Daniel Berger.  [ruby-core:08177]

Wed Aug 16 17:46:59 2006  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* marshal.c (r_byte): IO#getc returns one byte string now.
	  fixed: [ruby-dev:29255]

Wed Aug 16 17:22:44 2006  NAKAMURA Usaku  <usa@ruby-lang.org>

	* common.mk (pre-install-local): remove unnecessary code.
	  [ruby-dev:29249]

Wed Aug 16 11:45:36 2006  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* process.c (proc_setuid, proc_setgid, proc_seteuid, proc_setegid):
	  get rid of bogus implementations on Mac OS X.

Wed Aug 16 11:09:26 2006  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* ruby.c (set_arg0): fill argv other than the first with an empty
	  string instead of NULL.

Tue Aug 15 11:21:08 2006  Minero Aoki  <aamine@loveruby.net>

	* lib/net/smtp.rb: support SMTP/SSL.  Thanks Kazuhiro NISHIYAMA.

	* lib/net/smtp.rb: new method SMTP.use_ssl?

	* lib/net/smtp.rb: new method SMTP.enable_ssl.

	* lib/net/smtp.rb: new method SMTP.disable_ssl.

	* lib/net/smtp.rb: new method SMTP.default_ssl_port.

	* lib/net/smtp.rb: new method SMTP.default_tls_port.

	* lib/net/smtp.rb: now SMTP#enable_tls accepts a SSLContext
	  object, instead of a verity and cert.  [FEATURE CHANGE]

	* lib/net/smtp.rb: new method SMTP.ssl_context.

	* lib/net/smtp.rb: new method SMTP.default_ssl_context.

	* lib/net/smtp.rb: export SMTP.authenticate.

	* lib/net/smtp.rb: export SMTP.auth_plain.

	* lib/net/smtp.rb: export SMTP.auth_login.

	* lib/net/smtp.rb: export SMTP.auth_cram_md5.

	* lib/net/smtp.rb: export SMTP.starttls.

	* lib/net/smtp.rb: export SMTP.helo.

	* lib/net/smtp.rb: export SMTP.ehlo.

	* lib/net/smtp.rb: export SMTP.mailfrom.

	* lib/net/smtp.rb: export SMTP.rcptto.

	* lib/net/smtp.rb: export SMTP.rcptto_list.

	* lib/net/smtp.rb: export SMTP.data.

	* lib/net/smtp.rb: export SMTP.quit.

Sat Aug 12 22:33:06 2006  Eric Hodel  <drbrain@segment7.net>

	* string.c (String#split): Describe grouping behavior.  Patch by Jan
	  Svitok <jan.svitok at gmail.com>.  [ruby-core:08603]

Sun Aug 13 12:08:02 2006  Tanaka Akira  <akr@fsij.org>

	* ext/socket/socket.c: ANSIfied.  [ruby-core:08601]

Sat Aug 12 15:55:32 2006  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* configure.in, bcc32/Makefile.sub, win32/Makefile.sub, win32/dir.h,
	  win32/win32.c, win32/win32.h: large file support for win32.

Fri Aug 11 15:39:25 2006  Eric Hodel  <drbrain@segment7.net>

	* lib/rdoc/parsers/parse_c.rb (RDoc::C_Parser#find_body): Make RDoc
	  ignore C function prototypes.  Patch by Tilman Sauerbeck
	  <tilman at code-monkey.de>.  [ruby-core:8574]
	* lib/yaml/tag.rb: Replace nodoc with stopdoc so Module methods get
	  documented.

Wed Aug  9 16:53:28 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* lib/net/smtp.rb (Net::SMTP::auth_cram_md5): use ord to retrieve
	  bytes from strings.  a patch from WATANABE Tetsuya
	  <Tetsuya.WATANABE at nifty.com>.  [ruby-dev:29240]

Tue Aug  8 23:49:06 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* lib/irb/extend-command.rb (IRB::ExtendCommandBundle): pacify
	  RDoc.  a patch from Eric Hodel <drbrain at segment7.net>.
	  [ruby-core:08522]

Tue Aug  8 19:26:10 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* lib/resolv.rb (Resolv::DNS::Message::MessageDecoder::get_string):
	  affected by str[0] returns 1 char string.  [ruby-dev:29223]

	* lib/resolv.rb (Resolv::DNS::Message::MessageDecoder::get_labels):
	  ditto.

Tue Aug  8 12:28:43 2006  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* parse.y (arg): allow newlines before ternary colon.  [ruby-dev:29189]

Mon Aug  7 17:56:59 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* ext/bigdecimal/bigdecimal.c, ext/digest/rmd160/rmd160ossl.c,
	  ext/digest/sha1/sha1ossl.c, ext/readline/readline.c: move
	  inclusion of config.h to pacify AIX.  a patch from Yutaka
	  Kanemoto <kinpoco at gmail.com>.  [ruby-dev:29197]

Mon Aug  7 15:55:08 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* ext/syck/syck.c (syck_move_tokens): should avoid negative
	  memmove.  [ruby-list:42625]

Mon Aug  7 14:37:48 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* configure.in, common.mk: AIX link issue.  a patch from Yutaka
	  Kanemoto <kinpoco at gmail.com>.  [ruby-dev:29190]

	* ext/socket/socket.c: AIX socket support.  [ruby-dev:29190]

Mon Aug  7 12:05:28 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* dln.c, eval.c, gc.c, ruby.h: shut up AIX alloca warning.
	  a patch from Yutaka Kanemoto <kinpoco at gmail.com>.
	  [ruby-dev:29191]

Sun Aug  6 20:34:24 2006  Tadayoshi Funaba  <tadf@dotrb.org>

	* lib/date/format.rb (str[fp]time): %[EO]U didn't denote %U.

Sun Aug  6 17:12:12 2006  Tanaka Akira  <akr@fsij.org>

	* io.c (io_reopen): STDERR.reopen(open("/dev/tty", "w")) should not
	  clear FMODE_PREP in STDERR.

Sat Aug  5 22:53:41 2006  K.Kosako  <sndgk393 AT ybb.ne.jp>

	* oniguruma.h: Version 4.2.2

	* regint.h: ditto.

	* regparse.h: ditto.

	* regexec.c: ditto.

	* regcomp.c ditto.

	* regerror.c: ditto.

	* regparse.c: ditto.

Sat Aug  5 17:07:43 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* parse.y (top_local_setup): local_vars[-1] should point
	  ruby_scope itself to protect local_tbl from garbage collection.
	  [ruby-dev:29049]

Sat Aug  5 13:49:43 2006  Tadayoshi Funaba  <tadf@dotrb.org>

	* lib/date/format.rb (str[fp]time): "%\n" means "\n".

Fri Aug  4 12:13:22 2006  Eric Hodel  <drbrain@segment7.net>

	* lib: Clean up files for RDoc.
	* lib/.document: Include most of the standard library in RDoc
	  generation.
	* lib/rdoc/ri/ri_formatter.rb: Don't unescape HTML in HtmlFormatter.
	  Submitted by <ksruby at gmail.com>.  [ruby-core:08392].
	* lib/drb/ssl.rb: Close socket on SSLError [ruby-core:7197]

Fri Aug  4 18:59:49 2006  Keiju Ishitsuka  <keiju@ruby-lang.org>

	* lib/irb/{init.rb,ruby-lex.rb,slex.rb}: can't input '\c' for
	  [ruby-core: 7122]. and support for ruby1.8.X

Fri Aug  4 14:02:14 2006  James Edward Gray II  <james@grayproductions.net>

	* lib/date/format.rb (__strptime, strftime): allow multi-line patterns
	  in Date#strftime the same as Time#strftime accepts.
	  fixed: [ruby-core:08466]

Fri Aug  4 13:56:51 2006  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* pack.c (pack_pack): check argument overrun for 'P'.  based on a
	  patch by rucila <rucila at yahoo.cojp>.  fixed: [ruby-dev:29182]

Fri Aug  4 02:42:29 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* sprintf.c (rb_str_format): a bug in %c type check.

Fri Aug  4 01:28:19 2006  Tanaka Akira  <akr@fsij.org>

	* io.c (io_reopen): STDERR.reopen(File.open("/dev/null", "w")) should
	  not fclose stderr.

Thu Aug  3 15:16:44 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* range.c (range_include): should always call Enumerable#include?
	  (not #===) for non numeric end points.  [ruby-core:08477]
	  [ruby-core:08496]

Mon Jul 31 16:51:40 2006  NAKAMURA Usaku  <usa@ruby-lang.org>

	* win32/win32.c (exit_handler): new function; release winsock and
	  environment work area.

	* win32/win32.c (NTInitialize): setup exit_handler.

	* win32/win32.c (StartSockets): use exit_handler.

	* win32/win32.c (rb_w32_getenv): use GetEnvironmentStrings() instead
	  of GetEnvironmentVariable(), because the latter cannot distinguish
	  whether a null environment variable exists or not.
	  fixed: [ruby-talk:205123]

Mon Jul 31 16:15:13 2006  Tanaka Akira  <akr@fsij.org>

	* test/ruby/test_process.rb (TestProcess#test_rlimit_nofile):
	  setrlimit may fail with EINVAL.
	  reported by MIYAMUKO Katsuyuki.  [ruby-dev:29174]

Mon Jul 31 09:22:12 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* ruby.h: use ifdef (or defined) for macro constants that may or
	  may not be defined to shut up gcc's -Wundef warnings.
	  [ruby-core:08447]

Mon Jul 31 13:38:13 2006  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* lib/webrick/httprequest.rb (WEBrick::HTTPReuqest#parse_uri): improve
	  for the value of IPv6 address in the Host: header field.

Sun Jul 30 23:26:12 2006  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* eval.c (rb_call0): trace call/return of method defined from block.
	  fixed: [ruby-core:08329]

	* eval.c (rb_trap_eval): make the current thread runnable to deal with
	  exceptions which occurred within the trap.  fixed: [ruby-dev:27729]

	* lib/cgi/session.rb, lib/cgi/session/pstore.rb: suppress warnings.
	  fixed: [ruby-talk:204896]

Sat Jul 29 06:12:06 2006  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/lib/multi-tk.rb: freeze ip_name for security reason.

Sat Jul 29 01:23:52 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* lib/logger.rb: improves the amount of documentation that Rdoc
	  picks up when processing logger.rb by moving the require
	  statement back before the comment block.  a patch from Hugh
	  Sasse <hgs at dmu.ac.uk>.  [ruby-core:08422]

Fri Jul 28 17:18:03 2006  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* ext/curses/curses.c (NUM2CH, CH2FIX): use single char strings.

Fri Jul 28 14:09:14 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (rb_call): fixed typo in cache look-up.  [ruby-dev:29167]

Fri Jul 28 10:41:35 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (rb_call): a bug in method cache look-up.
	  http://www.rubyist.net/~matz/20060720.html#c04

Fri Jul 28 10:19:28 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* sprintf.c (rb_f_sprintf): documentation update patch from Jacob
	  Fugal <lukfugl at gmail.com>.  [ruby-core:08418]

Fri Jul 28 09:41:45 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* time.c (time_to_s): fixed typo.  [ruby-dev:29162]

Fri Jul 28 00:26:47 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* math.c (domain_check): ANSI style function arguments

	* math.c (math_log): too few argument to domain_check().

Thu Jul 27 21:19:54 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* math.c (domain_check): a new function to check domain error
	  explicitly for systems that return NaN like FreeBSD.
	  [ruby-core:07019]

	* math.c (math_acos, math_asin, math_acosh, math_atanh, math_log,
	  math_log10, math_sqrt): use domain_check().

	* math.c (math_sqrt): fix documentation flaw.

Thu Jul 27 22:21:52 2006  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* time.c (time_to_s): fixed format mismatch.

Thu Jul 27 18:12:12 2006  WATANABE Hirofumi  <eban@ruby-lang.org>

	* time.c: need to declare time_utc_offset.

Thu Jul 27 17:01:01 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* io.c (io_close): always calls "close" method of the receiver.
	  [ruby-core:6911] [ruby-core:8112]

Thu Jul 27 16:41:15 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* ext/openssl/ossl.h: move <ruby.h> inclusion point to shut up
	  Solaris compiler.  [ruby-core:08114]

	* time.c (time_to_s): use +0900 style timezone string for local time.
	  [ruby-dev:29143]

Wed Jul 26 22:20:59 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* configure.in: add support for as and ASFLAGS.  [ruby-dev:29138]

Wed Jul 26 21:59:33 2006  Minero Aoki  <aamine@loveruby.net>

	* lib/net/http.rb (Net::HTTP#post, request_post, request): should
	  set Content-Type: x-www-form-urlencoded by default.

	* lib/net/http.rb (Net::HTTPHeader#content_type): should return
	  nil when there's no Content-Type.

	* lib/net/http.rb (Net::HTTPHeader#sub_type): should return nil
	  when there's no sub Content-Type (e.g. "Content-Type: text").

	* lib/net/http.rb (Net::HTTPHeader#type_params): wrongly failed
	  when there's no Content-Type.

Wed Jul 26 18:38:13 2006  Minero Aoki  <aamine@loveruby.net>

	* ext/strscan/strscan.c (strscan_do_scan): always return nil if
	  p->curr exceeds string size.

Wed Jul 26 18:33:31 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (Init_eval): rename #invoke_method and
	  #invoke_functional_method to __send and __send! respectively.

	* eval.c (remove_method): prohibit removing __send and __send!.

	* eval.c (rb_undef): prohibit undef'ing  __send and __send!.

	* eval.c (rb_eval): prohibit redefining  __send and __send!.

	* lib/delegate.rb (Delegator): preserve __send.

Wed Jul 26 18:14:19 2006  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* ext/pty/pty.c (getDevice): retry once after GC on failure.
	  [ruby-core:08282]

Wed Jul 26 17:43:20 2006  Minero Aoki  <aamine@loveruby.net>

	* ext/strscan/strscan.c (strscan_do_scan):
	  StringScanner.new("").scan(//) should return "". [ruby-Bugs:4361]

Wed Jul 26 17:28:16 2006  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* sprintf.c (rb_str_format): prepend ".." to %u for negative bignum,
	  but not "-".  fixed: [ruby-core:08167]

Wed Jul 26 16:39:07 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* string.c (rb_str_scan): add string modification check.
	  [ruby-core:7216]

Wed Jul 26 16:06:03 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* lib/cgi.rb (CGI::QueryExtension::read_multipart): check
	  multipart boundary end.  a patch from Fujioka <fuj at rabbix.jp>
	  [ruby-dev:28470]

Wed Jul 26 01:02:59 2006  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* configure.in: suppress warnings by automake 1.8 or later.

Tue Jul 25 14:46:14 2006  NAKAMURA Usaku  <usa@ruby-lang.org>

	* lib/mkmf.rb (configuration): typo.

Tue Jul 25 13:14:32 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* process.c (rb_proc_times): rename hz to hertz to avoid name
	  crash on AIX.  [ruby-dev:29126]

Mon Jul 24 22:03:40 2006  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* eval.c (backtrace): skip frames successive on node and method name.

Mon Jul 24 15:51:52 2006  Tanaka Akira  <akr@fsij.org>

	* ext/readline/readline.c (readline_readline): rl_deprep_term_function
	  may be NULL with libedit.  reported by Ryan Davis.  [ruby-dev:29070]

Mon Jul 24 15:19:55 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (rb_call0): revert last change.  [ruby-dev:29112]
	  [ruby-core:08374]

Sun Jul 23 22:59:49 2006  Tanaka Akira  <akr@fsij.org>

	* test/socket/test_unix.rb: disabled on cygwin.
	  reported by Kouhei Yanagita.  [ruby-dev:29080]

Fri Jul 21 23:57:26 2006  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* ruby.c (proc_options): script is never used while recursing.

Fri Jul 21 21:21:08 2006  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* eval.c (rb_call0): include funcalled methods in caller list.
	  fixed: [ruby-core:08290]

Fri Jul 21 17:52:24 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* object.c (rb_cstr_to_dbl): "9_e8" should consider "_e8" as
	  trailing garbage so that it should return 9.0.  [ruby-dev:29088]

Fri Jul 21 12:11:00 2006  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* ext/extmk.rb, lib/mkmf.rb (with_destdir): remove drive letter before
	  prepending destdir on DOSISH.

Fri Jul 21 04:17:22 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (rb_call): try local method look-up first for fcall, then
	  normal method look-up.  [ruby-talk:202564]

	* eval.c (rb_get_method_body): save local method cache separately.

	* eval.c (search_method): export info whether method is local or
	  not.

Thu Jul 20 20:27:07 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* object.c (rb_mod_attr): make Module#attr to be an alias to
	  attr_reader.  [RCR#331]

Thu Jul 20 15:07:14 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* ruby.h: export classes/modules to implement sandbox.
	  [ruby-core:08283]

Wed Jul 19 19:40:00 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (rb_yield_0): should check args_args before lambda
	  argument check.  [ruby-dev:29029]

Tue Jul 18 23:53:59 2006  NAKAMURA Usaku  <usa@ruby-lang.org>

	* process.c (rb_f_system): shouldn't block SIGCHLD if it's not
	  exist.

Tue Jul 18 22:10:13 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* process.c (rb_f_system): block SIGCHLD during the process
	  execution, like glibc system(3) does.  [ruby-talk:202361]

Tue Jul 18 23:10:43 2006  NAKAMURA Usaku  <usa@ruby-lang.org>

	* win32/win32.c (open_ifs_socket): should not use plain malloc.

	* win32/win32.c (rb_w32_opendir): should not use plain realloc.

Tue Jul 18 18:05:49 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* test/ruby/test_float.rb (TestFloat::test_strtod): update test to
	  conform strtod change.

Tue Jul 18 16:52:29 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (yield_under_i): argument should be passed in avalue
	  form.  [ruby-dev:29044]

Tue Jul 18 15:49:42 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* pack.c (pack_unpack): propagate association array to copied
	  string.  [ruby-core:08223]

	* pack.c (pack_unpack): return referenced string itself if it has
	  same length as specified.  a patch from <nobu at ruby-lang.org>
	  in [ruby-core:08225].

	* pack.c (pack_pack): taint 'p' packed strings.

Tue Jul 18 15:19:07 2006  NAKAMURA Usaku  <usa@ruby-lang.org>

	* intern.h (st_foreach_safe): fix prototype.

	* node.h (NODE_LMASK): bigger than long on LLP64.

	* missing/vsnprintf.c (BSD__uqtoa): new function to support LLP64.
	  all changes are derived from [ruby-dev:29045]

Tue Jul 18 14:03:02 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* lib/webrick/httpserver.rb (WEBrick::HTTPServer::unmount): remove
	  inpect argument from sprintf.  [ruby-dev:29039]

Tue Jul 18 10:53:37 2006  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* object.c (rb_cstr_to_dbl): limit out-of-range message.

	* util.c (ruby_strtod): return end pointer even if ERANGE occurred.
	  fixed: [ruby-dev:29041]

Mon Jul 18 00:43:05 2006  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* util.c (ruby_strtod): stop at dot not followed by digits.
	  fixed: [ruby-dev:29035]

Tue Jul 18 00:01:27 2006  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* ext/extmk.rb: remove LIBRUBY_SO if static linked extensions exist.

Mon Jul 17 23:30:46 2006  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* configure.in (rb_cv_msvcrt): defaulted to msvcrt.  Workaround for a
	  bug of cygwin 1.5.20.

Mon Jul 17 22:55:31 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* ext/io/wait/wait.c (io_ready_p): protoize.

Mon Jul 17 13:43:05 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* pack.c (define_swapx): should not use plain malloc.

	* ext/curses/curses.c (curses_getmouse): ditto.

Mon Jul 17 12:58:41 2006  WATANABE Hirofumi  <eban@ruby-lang.org>

	* configure.in: should use ac_cv_lib_dl_dlopen=no on MinGW.

Mon Jul 17 11:47:35 2006  NAKAMURA Usaku  <usa@ruby-lang.org>

	* st.c: still need to include config.h on some platforms.

Sat Jul 15 01:09:22 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* st.c (malloc): use xmalloc/xcalloc instead of plain
	  malloc/calloc, to detect memory allocation failure.  see
	  <http://www.nongnu.org/failmalloc/>.

Fri Jul 14 13:08:13 2006  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/lib/tk.rb: add methods for new features of latest Tcl/Tk8.5.

	* ext/tk/lib/tk/namespace.rb: ditto.

Fri Jul 14 02:30:12 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* lib/monitor.rb: document patch from Hugh Sasse <hgs at dmu.ac.uk>.
	  [ruby-core:08205]

Fri Jul 14 00:10:15 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* array.c (rb_ary_pop): may cause realloc oscillation.  a patch
	  from MORITA Naoyuki <mlgetter at kidou.sakura.ne.jp>.
	  [ruby-dev:29028]

Thu Jul 13 22:23:56 2006  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/lib/tk/composite.rb: improve handling of the classname on the
	  option database for the widget class which includes TkComposite.

Thu Jul 13 00:40:57 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* ruby.h (FIX2LONG): returns integer of size of VALUE.
	  [ruby-dev:29024]

	* ruby.h (FIX2ULONG): ditto.

Wed Jul 12 20:05:23 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* parse.y (f_args): allow post mandatory arguments after optional
	  arguments.  [ruby-dev:29014]

	* parse.y (new_args_gen): allow post_args without rest_args.

	* eval.c (formal_assign): ditto.

	* parse.y (new_args_gen): check post argument duplication.

Tue Jul 11 20:58:18 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* ruby.h: export rb_cMethod.  [ruby-talk:201259]

Tue Jul 11 19:13:33 2006  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/lib/multi-tk.rb: remove restriction on the class of
	  pseudo-toplevel.

Tue Jul 11 18:00:57 2006  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/lib/multi-tk.rb: security fix.

Tue Jul 11 17:28:08 2006  NAKAMURA Usaku  <usa@ruby-lang.org>

	* string.c (rb_str_dump): need to extend len for \b.

Tue Jul 11 15:29:15 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* bignum.c (rb_int2big): use SIGNED_VALUE.  [ruby-dev:29019]

	* bignum.c (rb_int2inum, rb_uint2inum): use VALUE sized integer.

	* bignum.c (rb_big2long, rb_big2ulong): ditto.

	* numeric.c (rb_num2long, rb_num2ulong): ditto.

	* numeric.c (check_int, check_uint): ditto.

	* bignum.c (rb_quad_pack): typo fixed.

Tue Jul 11 13:40:52 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* bignum.c (bignorm): sizeof(long) may be smaller than
	  sizeof(VALUE).  [ruby-dev:29013]

	* ruby.h (FIXNUM_MAX): fixnum may be bigger than long.

	* ruby.h (SIGNED_VALUE): signed integer of size of VALUE.

Mon Jul 10 23:37:14 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* lib/soap/rpc/proxy.rb (Proxy::Operation::response_doc): remove
	  splat star from return statements.

	* lib/soap/rpc/proxy.rb (Proxy::Operation::response_obj): retrieve
	  the first value from the result array if response has only one
	  value.

Mon Jul 10 22:00:00 2006  Shigeo Kobayashi  <shigek@ruby-lang.org>

	* ext/bigdecimal/bigdecimal.c: Allows '_' to appear within
	  digits.  [ruby-dev:28872]

	* ext/bigdecimal/lib/bigdecimal/util.rb: Bug in to_r reported by
	  [ruby-list:42533] fixed.

Mon Jul 10 19:22:19 2006  Tanaka Akira  <akr@fsij.org>

	* gc.c (gc_sweep): expand heap earlier.
	  reported by MORITA Naoyuki.  [ruby-dev:28960]

Mon Jul 10 18:59:34 2006  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/lib/tk/font.rb: sorry. mistaken to patch.

Mon Jul 10 18:46:52 2006  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/tcltklib.c: make SEGV risk lower at exit.

	* ext/tk/lib/tk.rb: ditto.

	* ext/tk/lib/multi-tk.rb: fail to call function-style methods on slave
	  interpreters. The strategy (MultiTkIp_PseudoToplevel_Evaluable) to
	  fix the problem is a little tricky. You may have to take care of
	  conflicting with it.

	* ext/tk/lib/tk.rb: a little change for the pseudo-toplevel strategy.

	* ext/tk/lib/tk/font.rb: ditto.

	* ext/tk/lib/tk/msgcat.rb: ditto.

	* ext/tk/lib/tkextlib/itk/incr_tk.rb: ditto.

	* ext/tk/sample/demos-en/widget: fail to call function-style methods
	  on sample scripts. To fix it, a strategy which similar to the way
	  on MultiTiIp is used. Please take care when re-write and re-run a
	  demo script on the Widget-Demo code viewer.

	* ext/tk/sample/demos-jp/widget: ditto.

Mon Jul 10 17:32:38 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* sample/test.rb: update test suites.

	* test/ruby/test_assignment.rb (TestAssignment::test_yield): ditto.

	* test/ruby/test_iterator.rb (TestIterator::test_itertest): ditto.

Mon Jul 10 14:43:47 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (rb_call): remove erroneously restored prot_tag->blkid
	  initialization.  [ruby-dev:28997]  [ruby-dev:29000]

Mon Jul 10 13:58:08 2006  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* signal.c (install_nativethread_sighandler): commented out.

Mon Jul 10 09:29:12 2006  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* eval.c (rb_clear_cache_for_remove): clear entries for included
	  module.  fixed: [ruby-core:08180]

Mon Jul 10 02:22:58 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (proc_invoke): should not overwrite block information in
	  current frame.  [ruby-dev:28957]

	* eval.c (rb_yield_0): retrieve proper block object from the frame
	  record.

	* eval.c (proc_alloc): return preserved block object if it's
	  available.

Mon Jul 10 01:48:38 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* st.h (st_data_t): use pointer sized integer for st_data_t.
	  [ruby-dev:28988]

Sun Jul  9 18:06:47 2006  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* lib/mkmf.rb (try_constant): fix for value 1 at cross compiling.

	* lib/mkmf.rb (create_makefile): prevent substitution of macro
	  definition.  fixed: http://www.yotabanana.com/lab/20060624.html#p02

Sun Jul  9 07:58:48 2006  Ryan Davis  <ryand@zenspider.com>

	* lib/rdoc/parsers/parse_f95.rb: massive overhaul from Yasuhiro
	  Morikawa including new file suffixes, function support, public
	  variables and constants, derived-types, defined operators and
	  assignments, namelists, and subroutine and function
	  arguments. Truly massive.

	* lib/rdoc/diagram.rb: diagrams are now cached.

	* lib/irb/completion.rb: fixed a crasher when completing against
	  an unnamed class/module.

	* lib/rdoc/parsers/parse_c.rb: private comment (--/++) support in
	  C-file rdoc.

	* lib/debug.rb: minor clarification in help.

	* lib/pp.rb: minor clarification on exception.

Sun Jul  9 00:54:11 2006  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* eval.c (next_jump): deal with destination of next.
	  fixed: [ruby-core:08169]

Fri Jul  7 17:49:16 2006  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* string.c (rb_str_ord): extract lower byte.  fixed: [ruby-dev:28980]

	* lib/jcode.rb (String#succ!): fix for 1.9.  fixed: [ruby-dev:28979]

Fri Jul  7 14:05:03 2006  NAKAMURA Usaku  <usa@ruby-lang.org>

	* win32/Makefile.sub (config.h): define FUNC_STDCALL/FUNC_CDECL.
	  from [ruby-dev:28970].

Fri Jul  7 00:38:49 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* hash.c (rb_hash_default): should not call default procedure if
	  no key is given.  [ruby-list:42541]

Thu Jul  6 23:30:04 2006  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* process.c (rb_proc_times): use sysconf(_SC_CLK_TCK) value prior to
	  HZ and CLK_TCK.  fixed: [ruby-talk:200293]

Thu Jul  6 21:50:06 2006  Minero Aoki  <aamine@loveruby.net>

	* ext/racc/cparse/cparse.c: sync with original code, rev 1.8.

	* ext/racc/cparse/cparse.c: should mark CparseParams objects.

	* lib/racc/parser.rb: sync with original code, rev 1.8.

	* lib/racc/parser.rb: update coding style.

Wed Jul  5 05:28:45 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* parse.y (block_param): should allow block argument after splat
	  and post splat args.

Wed Jul  5 01:12:19 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* test/ruby/test_lambda.rb (TestLambdaParameters::test_lambda_as_iterator):
	  -> style block no longer available.  [ruby-dev:28958]

Tue Jul  4 21:48:56 2006  NAKAMURA Usaku  <usa@ruby-lang.org>

	* ruby.c (proc_options): supress warning on DOSISH.

Tue Jul  4 15:12:49 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (rb_call): should not set prot_tag->blkid since it would
	  never catch breaks at this level.  [ruby-dev:28922]

Tue Jul  4 04:48:36 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* bignum.c: ruby 1.9 HEAD 64 bit warnings clean up from
	  <ville.mattila at stonesoft.com>.   [ruby-core:08120]

Mon Jul  3 19:04:38 2006  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/tcltklib.c (ip_make_menu_embeddable): help to make a menu
	  widget embeddable (pack, grid, and so on) like as a general widget.
	  However, an embeddable menu may require to be definied some event
	  bindings for general use.

	* ext/tk/lib/tk/event.rb: [bug fix] Tk.callback_break and
	  Tk.callback_continue don't work on MultiTkIp.

	* ext/tk/lib/multi-tk.rb: ditto.

	* ext/tk/lib/tk.rb: lack of Tk.callback_return.

	* ext/tk/lib/tk/menu.rb: improve creating clone menus.

Mon Jul  3 14:42:06 2006  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* ext/etc/extconf.rb (PW_UID2VAL, PW_GID2VAL): defaulted to conversion
	  from int, and sys/types.h needs to be included before grp.h.
	  fixed: [ruby-dev:28938]

Mon Jul  3 10:44:01 2006  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* io.c (popen_exec): close file descriptors other than standard I/Os.
	  fixed: [ruby-dev:28924]

Mon Jul  3 05:15:29 2006  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* test/openssl/test_asn1.c: String#[]= doesn't accept Integer.

Mon Jul  3 01:14:15 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* string.c (rb_str_inspect): encode \b (\010) for escape.
	  [ruby-dev:28927]

	* string.c (rb_str_dump): ditto.

Sun Jul  2 19:03:30 2006  Minero Aoki  <aamine@loveruby.net>

	* ext/racc/cparse/cparse.c: sync with original code, rev 1.7.

	* ext/racc/cparse/cparse.c: must require version.h to get
	  RUBY_VERSION_CODE.

Sun Jul  2 18:42:27 2006  Minero Aoki  <aamine@loveruby.net>

	* ext/racc/cparse/cparse.c: sync with original source code, rev
	  1.6.

	* ext/racc/cparse/cparse.c: do not use rb_iterate to give a block
	  to the method, use rb_block_call instead. [ruby-dev:28445]

Sun Jul  2 11:22:03 2006  Tanaka Akira  <akr@m17n.org>

	* io.c (io_reopen): STDOUT.reopen(filename, "w+") didn't work.
	  (rb_io_reopen): STDOUT.reopen(File.open(filename, "w+")) didn't work.

Sat Jul  1 23:55:42 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (PUSH_FRAME): initialize frame->self.  [ruby-dev:28911]

Sat Jul  1 17:00:42 2006  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* test/webrick/utils.rb: use Proc#yield instead of Proc#call.
	  [ruby-dev:28914]

Sat Jul  1 15:15:49 2006  Tanaka Akira  <akr@m17n.org>

	* test/socket/test_nonblock.rb: add timeout to send/receive
	  an empty UDP packet.
	  [ruby-dev:28820]

Fri Jun 30 23:46:23 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* configure.in: should test isinf for Solaris with GCC compiler.
	  a patch from <ville.mattila at stonesoft.com>.  [ruby-core:07791]

	* configure.in: -shared patch from Andrew Morrow
	  <andrew.c.morrow at gmail.com>.  [ruby-core:08100]

Fri Jun 30 19:35:41 2006  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* lib/webrick/httputils.rb (WEBrick::HTTPUtils._escape): should
	  use String#ord to get ascii code from the one-character string.
	  [ruby-dev:28901]

Thu Jun 29 23:56:01 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* gc.c (gc_mark_children): a bug in NODE_BLOCK_PASS marking.
	  [ruby-dev:28908]

Thu Jun 29 23:04:36 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* parse.y: use ARGSPUSH instead of ARGSCAT to prevent too much
	  splat expansion.

	* eval.c (when_check): need to handle ARGSPUSH as well.

	* eval.c (block_orphan): lambda and proc from method are always
	  orphan.

	* gc.c (gc_mark_children): proper marking for NODE_LAMBDA.

Thu Jun 29 22:47:30 2006  Tanaka Akira  <akr@m17n.org>

	* eval.c (SETUP_ARGS0): avoid GC problem.
	  [ruby-dev:28902]

Thu Jun 29 18:58:51 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* ext/bigdecimal/bigdecimal.c (BigDecimal_version): fix patch
	  failure.

Thu Jun 29 18:00:51 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* ext/bigdecimal/bigdecimal.c: add RDoc document.  a patch from
	  mathew <meta at pobox.com>.   [ruby-core:07050]

Wed Jun 28 14:53:09 2006  Eric Hodel  <drbrain@segment7.net>

	* lib/optparse.rb: RDoc patch from Robin Stocker <robin@nibor.org>
	  [ruby-core:08087]

Wed Jun 28 23:23:48 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* object.c (rb_cstr_to_dbl): underscores should appear only
	  between digits.  [ruby-dev:28891]

Wed Jun 28 19:04:34 2006  Tanaka Akira  <akr@m17n.org>

	* test/socket/test_unix.rb: test_seqpacket_pair removed.
	  [ruby-dev:28846]

Wed Jun 28 13:51:21 2006  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* eval.c (when_check): arbitrary values are allowed after splats.
	  fixed: [ruby-dev:28879]

Wed Jun 28 09:16:18 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* parse.y (primary): remove meaningless else-only case statement
	  syntax.

Wed Jun 28 08:08:13 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (rb_eval): problem to handle else part.  [ruby-dev:28873]

Wed Jun 28 01:48:23 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (rb_eval): support splat in when expression list.
	  [ruby-dev:28822]

	* eval.c (when_check): a new auxiliary function for case match.

	* eval.c (when_cond): ditto.

Wed Jun 28 01:05:37 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* object.c (rb_cstr_to_dbl): should not skip '_' at the beginning
	  of a string.  [ruby-dev:28830]

	* bignum.c (rb_cstr_to_inum): ditto.

Tue Jun 27 23:03:49 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* string.c: RDoc update for =~ method.  a patch from Alex Young
	  <alex at blackkettle.org>.  [ruby-core:08068]

Tue Jun 27 22:47:18 2006  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/tcltklib.c: forgot to update TCLTKLIB_RELEASE_DATE.

	* ext/tk/lib/tk.rb (tk_tcl2ruby): [bug fix] sometimes fail to convert
	  a tcl string to a ruby object if the tcl string includes "\n".

Tue Jun 27 20:05:14 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* io.c (pipe_open): backout unnecessary fix on 2006-06-26.
	  [ruby-dev:28865]

	* eval.c (rb_yield_0): exact argument number check now done only
	  for lambda Proc.

	* eval.c (rb_yield_0): add check for number of arguments, if
	  there's one lambda block parameter.

Tue Jun 27 16:04:05 2006  WATANABE Hirofumi  <eban@ruby-lang.org>

	* win32/win32.h: define isascii on MinGW for msvcrt compatibility.

	* configure.in: set ac_cv_header_sys_time_h=no on MinGW
	  for msvcrt compatibility.

Tue Jun 27 11:36:02 2006  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* ext/etc/etc.c (setup_passwd, setup_group): allow bignum uid, gid and
	  so on.  [ruby-talk:199102]

Tue Jun 27 10:46:53 2006  Tanaka Akira  <akr@m17n.org>

	* eval.c (rb_yield_0): avoid core dump.  [ruby-dev:28840]

Mon Jun 26 11:03:00 2006  Eric Hodel  <drbrain@segment7.net>

	* lib/rdoc/ri: Add options to limit the ri search path.

Tue Jun 27 01:31:59 2006  Tanaka Akira  <akr@m17n.org>

	* ext/socket/socket.c (bsock_recv_nonblock): new method
	  BasicSocket#recv_nonblock.
	  (udp_recvfrom_nonblock): renamed from ip_recvfrom_nonblock.
	  IPSocket#recvfrom_nonblock is moved to UDPSocket#recvfrom_nonblock.
	  (unix_recvfrom_nonblock): removed.
	  UNIXSocket#recvfrom_nonblock is removed.

Tue Jun 27 00:52:40 2006  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* ext/ripper/eventids2.c (token_assoc): added tCHAR, which is not
	  under 256 now.  fixed: [ruby-dev:28832]

Mon Jun 26 23:42:57 2006  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* eval.c (call_trace_func): no check for argument number of the
	  callback.  fixed: [ruby-dev:28812]

Mon Jun 26 18:37:44 2006  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/tcltklib.c (ip_delete): fix SEGV when a slave-ip is
	  deleted on callback.

Mon Jun 26 15:40:26 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* ext/socket/socket.c (sock_accept): revert to avoid ambiguity of
	  argument evaluation order.  [ruby-dev:28861]

	* ext/socket/socket.c (sock_accept_nonblock): ditto.

Mon Jun 26 10:47:42 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* io.c (pipe_open): avoid closing uninitialized file descriptors.
	  a patch from <tommy at tmtm.org> [ruby-dev:28600]

Sun Jun 25 23:02:12 2006  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* Makefile.in, mkconfig.rb: catch-up for latest autoconf.

Sun Jun 25 17:44:16 2006  Tanaka Akira  <akr@m17n.org>

	* parse.y (paren_args): wrap $2 by escape_Qundef because it may be
	  Qundef.  [ruby-dev:28843]

Sun Jun 25 17:18:33 2006  Masaki Suketa  <masaki.suketa@nifty.ne.jp>

	* ext/win32ole/win32ole.c(ole_invoke): support some kind of
	  method of word. [ruby-Bugs#3237]

	* test/win32ole/test_word.rb: ditto.

Sat Jun 24 23:48:08 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* parse.y: replace terminal token names with more descriptive
	  name, i.e. kEND to keyword_end.  [ruby-list:42477]

Sat Jun 24 23:37:41 2006  Tanaka Akira  <akr@m17n.org>

	* eval.c (rb_eval): use rb_ary_new2 instead of rb_ary_new4 to avoid
	  GC problem.
	  (rb_yield_values): use rb_ary_new2 instead of rb_ary_new4.

	* array.c (rb_ary_new4): don't set len as n if contents is not
	  initialized.  make it safe with GC.

	  [ruby-dev:28826]

Fri Jun 23 23:35:32 2006  Tanaka Akira  <akr@m17n.org>

	* ruby.h, lib/drb/drb.rb, lib/drb/invokemethod.rb: remove Values class.
	  [ruby-dev:28805]

Fri Jun 23 17:27:52 2006  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* eval.c (rb_block_pass): removed.

	* eval.c (rb_thread_start_1): use rb_proc_yield() instead of
	  rb_block_pass().  fixed: [ruby-dev:28794]

Thu Jun 22 11:52:02 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* lib/net/http.rb (Net::HTTPResponse): duplicated error 501;
	  HTTPInternalServerError should be error 500.  [ruby-core:08037]

Thu Jun 22 11:47:52 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* variable.c (rb_mod_name): returns nil for anonymous modules.
	  [ruby-talk:198440]

Thu Jun 22 10:31:39 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* string.c (rb_str_aref): "abc"[3] should not return an empty
	  string but nil.  [ruby-dev:28786]

Thu Jun 22 05:15:58 2006  Tanaka Akira  <akr@m17n.org>

	* ext/socket/socket.c (sock_s_socketpair): try GC only once.
	  [ruby-dev:28778]

Wed Jun 21 21:20:31 2006  Tadayoshi Funaba  <tadf@dotrb.org>

	* lib/date.rb (jd_to_commercial): now works fine even if in
	  mathn-ized context.

Wed Jun 21 17:29:57 2006  NAKAMURA Usaku  <usa@ruby-lang.org>

	* ext/socket/getaddrinfo.c (freeaddrinfo, get_name): fixed typo.

	* ext/tk/tcltklib.c (tcl_eval, tcl_global_eval): ditto.

	* ext/zlib/zlib.c (rscheck): constified.

Wed Jun 21 17:18:55 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* lib/pp.rb (PP::PPMethods::seplist): should have preserved
	  original reference to the array.  [ruby-dev:28747]

Wed Jun 21 14:35:06 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* parse.y (block_param): do not use multiple assignment for a sole
	  block parameter.  [ruby-dev:28710]

	* eval.c (rb_yield_0): pass a raw yielded value to a sole block
	  parameter if a value is passed by yield.

	* eval.c (proc_invoke): args may not be an array.

	* eval.c (rb_proc_yield): pass original value without wrapping
	  it in an array.

Wed Jun 21 14:06:47 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* parse.y (method_call): remove (fn)(args) style lambda
	  invocation, add fn.(args) instead.

Wed Jun 21 08:39:54 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* lib/xmlrpc/create.rb (XMLRPC::Create::conv2value): merge Date
	  and Time processing.  [ruby-core:08033]

Wed Jun 21 03:01:10 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c, file.c, etc.: code-cleanup patch from Stefan Huehner
	  <stefan at huehner.org>.  [ruby-core:08029]

Wed Jun 21 01:40:25 2006  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* parse.y (reswords): modifier token is no longer returned in fname
	  state.  fixed: [ruby-dev:28775]

Tue Jun 20 23:28:34 2006  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* ext/extmk.rb (parse_args): provisional catch-up for the recent changes.

	* lib/optparse.rb (OptionParser::List#summarize, OptionParser#order!): ditto.

Tue Jun 20 11:07:55 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (proc_invoke): intercept break and return from lambda
	  Proc objects.  [ruby-dev:28742]

	* eval.c (proc_invoke): remove unnecessary YIELD_PROC_CALL flag.

	* eval.c (YIELD_EXACT_ARGS): renamed from YIELD_LAMBDA_CALL, which
	  is no longer related to the behavior turned on by this flag.

	* eval.c (return_jump): no need to care about PROT_YIELD.

	* eval.c (break_jump): no jump to toplevel PROT_THREAD tag.

	* eval.c (rb_yield_0): fix confusion between lambda (which is a
	  property of a proc) and pcall (which depends on whether it's
	  called via yield or call).

	* eval.c (rb_thread_yield): no need to specify YIELD_LAMBDA_CALL.

	* eval.c (rb_block_pass): update blkid in prot_tag.

Mon Jun 19 23:40:59 2006  NARUSE, Yui  <naruse@ruby-lang.org>

	  * ext/nkf/lib/kconv.rb: remove default -m0 and fix document.

	  * ext/nkf/nkf-8/{nkf.c, config.h, utf8tbl.c, utf8tbl.h}:
	    imported nkf 2.0.7.

Mon Jun 19 17:02:14 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* sample/test.rb (proc_return3): return within non lambda block
	  should terminate surrounding method.  [ruby-dev:28741]

Mon Jun 19 13:22:48 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* ext/socket/socket.c (unix_sysaccept): typo fixed.

	* ext/socket/socket.c (sock_connect): remove an unused local
	  variable tmpaddr.

Mon Jun 19 02:10:32 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* ext/socket/socket.c (tcp_accept_nonblock): forgot to remove
	  abandoned hacks.  [ruby-dev:28740]

Mon Jun 19 00:00:17 2006  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/lib/multi-tk.rb: fix bug: initialize improper tables.

Sun Jun 18 20:28:43 2006  Masaki Suketa  <masaki.suketa@nifty.ne.jp>

	* ext/win32ole/win32ole.c (fole_methods): The return value
	  of WIN32OLE#ole_methods should include PROPERTYPUTREF methods.

	* ext/win32ole/win32ole.c (fole_put_methods): The return value
	  of WIN32OLE#ole_put_methods should include PROPERTYPUTREF methods.

	* test/win32ole/test_ole_methods.rb: ditto.

	* ext/win32ole/win32ole.c (ole_propertyput): support
	  PROPERTYPUTREF. [ruby-talk:183042]

	* test/win32ole/test_propertyputref.rb: ditto.

Sat Jun 17 23:42:26 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (Init_eval): add aliases invoke_method and
	  invoke_functional_method corresponding send and funcall
	  respectively.  [ruby-talk:197512]

	* parse.y (parser_yylex): returns the most typical keyword token
	  on EXPR_FNAME.  [ruby-core:7995]

	* ext/socket/socket.c: protoize.

Sat Jun 17 22:17:17 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* lib/mathn.rb (Integer::prime_division): raise ZeroDivisionError
	  on zeros.  [ruby-dev:28739]

Sat Jun 17 14:53:32 2006  Tanaka Akira  <akr@m17n.org>

	* lib/pathname.rb (Kernel#Pathname): new method.

Sat Jun 17 02:01:00 2006  Tanaka Akira  <akr@m17n.org>

	* lib/pp.rb (Kernel#pretty_inspect): defined for pretty printed
	  string.

Fri Jun 16 01:41:00 2006  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* eval.c (rb_proc_arity): get rid of segfault for mere splat.

	* gc.c (gc_mark_children): NODE_BLOCK_PASS needs u3 to be marked.

Thu Jun 15 22:06:56 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* parse.y (then): remove ':' from 'then' and 'do' rules.

Wed Jun 14 18:00:20 2006  Eric Hodel  <drbrain@segment7.net>

	* enum.c (enum_any): Documentation typo.

Wed Jun 14 15:01:09 2006  Eric Hodel  <drbrain@segment7.net>

	* lib/rdoc/parsers/parse_rb.rb (RDoc::RubyParser#warn): Don't print
	  warnings when -q is set.

Wed Jun 14 16:11:37 2006  NAKAMURA Usaku  <usa@ruby-lang.org>

	* eval.c (rb_f_method_name, rb_f_callee_name): document typo.

Wed Jun 14 15:19:14 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* hash.c (env_aset): raise TypeError on nil with more descriptive
	  message.  [ruby-core:07990]

Tue Jun 13 17:22:19 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* ext/socket/socket.c (Init_socket): remove obsolete constants:
	  IPsocket, TCPsocket, SOCKSsocket, TCPserver, UDPsocket,
	  UNIXsocket, UNIXserver.

Tue Jun 13 09:07:27 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (formal_assign): post splat arguments should have had
	  higher priority than optional arguments, since they are
	  mandatory.  [ruby-dev:28715]

	* eval.c (VIS_MASK): broken. should be 15.  [ruby-dev:28715]

	* io.c (argf_getc): should return one-character string.
	  [ruby-dev:28715]

	* io.c (rb_io_readchar): ditto.

Sun Jun 11 23:20:07 2006  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* object.c (sym_call): disallow to call private methods.

	* lib/optparse.rb (OptionParser::Arguable#getopts): pass self to the
	  parser.

Sun Jun 11 09:56:41 2006  NAKAMURA Usaku  <usa@ruby-lang.org>

	* win32/win32.h (write): not need to define on bcc.

Sun Jun 11 08:30:33 2006  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* lib/optparse.rb (OptionParser#getopts): new methods.

Sun Jun 11 07:27:11 2006  NAKAMURA Usaku  <usa@ruby-lang.org>

	* lib/rdoc/ri/ri_writer.rb: use String#ord.

Sun Jun 11 04:38:20 2006  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* object.c (sym_to_proc): imported Symbol#to_proc from ActiveSupport.

Sat Jun 10 18:02:40 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* ext/bigdecimal/lib/bigdecimal/newton.rb (Newton::nlsolve): typo
	  fixed: raize -> raise.  [ruby-talk:196608]

Sat Jun 10 17:49:53 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* string.c (rb_str_ord): new method.

	* parse.y (rbracket): allow optional newline before closing
	  brackets.

Sat Jun 10 15:12:29 2006  NAKAMURA Usaku  <usa@ruby-lang.org>

	* eval.c (rb_f_method_name, rb_f_callee_name): new functions.
	  new global method `__method__' and `__callee__'.

Sat Jun 10 10:13:13 2006  NAKAMURA Usaku  <usa@ruby-lang.org>

	* lib/getoptlong.rb (GetoptLong#set_options): receive arguments
	  as Array.

	* lib/irb/slex.rb: use Proc#yield.

	* lib/rdoc/markup/simple_markup/inline.rb: follow the new behavior
	  of String#[].

	* lib/rdoc/ri/ri_writer.rb: ditto.

Sat Jun 10 08:17:23 2006  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* math.c (log2): may be a macro.

	* parse.y (args, block_param, f_args): pass f_post_arg to #params.

	* util.c (powersOf10): constified.

	* ext/readline/readline.c: include extconf.h first.

	* ext/ripper/eventids2.c: removed tLAMBDA_ARG.

	* ext/tk/tcltklib.c (lib_fromUTF8_core): removed conflict.

	* ext/tk/tkutil/tkutil.c (cbsubst_get_subst_arg): rb_id2name() is
	  defined as const now.

	* ext/win32ole/win32ole.c (fole_missing): ditto.

	* lib/mkmf.rb (create_makefile): force to create extconf header.

	* lib/optparse.rb (order!): use Proc#yield.

Sat Jun 10 06:53:22 2006  NAKAMURA Usaku  <usa@ruby-lang.org>

	* eval.c (CALLARGS): remove last semicolon. C90 compiler doesn't
	  allow any lines (even if they're empty) within variable
	  declarations.

Fri Jun  9 09:56:32 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* sprintf.c (rb_str_format): allow %c to print one character
	  string (e.g. ?x).

Thu Jun  8 14:00:02 2006  NAKAMURA Usaku  <usa@ruby-lang.org>

	* win32/win32.[ch] (rb_w32_read, rb_w32_write): new functions.
	  use recv() and send() when fd is socket. fixed: [ruby-dev:28694]

Wed Jun  7 16:22:51 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* lib/tempfile.rb (Tempfile::make_tmpname): put dot between
	  basename and pid.  [ruby-talk:196272]

Wed Jun  7 16:16:29 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* parse.y (do_block): remove -> style block.

	* parse.y (parser_yylex): remove tLAMBDA_ARG.

Wed Jun  7 14:51:22 2006  NAKAMURA Usaku  <usa@ruby-lang.org>

	* win32/win32.c (errmap): add some winsock errors.

Wed Jun  7 09:14:44 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (rb_call0): binding for the return event hook should have
	  consistent scope.  [ruby-core:07928]

Tue Jun  6 23:25:49 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (proc_invoke): return behavior should depend whether it
	  is surrounded by a lambda or a mere block.

Mon Jun  5 18:12:12 2006  Tanaka Akira  <akr@m17n.org>

	* ext/socket/socket.c (sock_s_unpack_sockaddr_in): reject
	  non-AF_INET/AF_INET6 sockaddr.
	  (sock_s_unpack_sockaddr_un): reject non-AF_UNIX sockaddr.
	  [ruby-dev:28691]

Sun Jun  4 20:40:19 2006  Tanaka Akira  <akr@m17n.org>

	* ext/socket/socket.c: fix sockaddr_un handling.
	  [ruby-dev:28677]

Sat Jun  3 23:53:18 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (formal_assign): handles post splat arguments.

	* eval.c (rb_call0): ditto.

Sat Jun  3 13:10:41 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* st.c (strhash): use FNV-1a hash.

Fri Jun  2 20:01:24 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* parse.y (parser_yylex): removed experimental ';;' terminator.

Fri Jun  2 19:00:40 2006  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* ext/openssl/extconf.rb: use create_header.

	* ext/openssl/ossl.h, ext/openssl/openssl_missing.h:
	  include RUBY_EXTCONF_H.

Fri Jun  2 17:16:52 2006  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* lib/mkmf.rb (CLEANINGS): remove extconf.h by distclean if created.

Fri Jun  2 00:11:19 2006  Tanaka Akira  <akr@m17n.org>

	* ext/socket/socket.c (s_recvfrom): alen may be zero with UNIXSocket
	  too.  (tested on NetBSD 3.0)
	  (s_recvfrom_nonblock): extracted from sock_recvfrom_nonblock.
	  (sock_recvfrom_nonblock): use s_recvfrom_nonblock.
	  (ip_recvfrom_nonblock): new method: IPSocket#recvfrom_nonblock
	  (unix_recvfrom_nonblock): new method: UNIXSocket#recvfrom_nonblock
	  (s_accept_nonblock): extracted from sock_accept_nonblock.
	  (sock_accept_nonblock): use s_accept_nonblock.
	  (tcp_accept_nonblock): new method: TCPServer#accept_nonblock
	  (unix_accept_nonblock): new method: UNIXServer#accept_nonblock

Thu Jun  1 19:12:37 2006  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* win32/win32.c (rb_w32_cmdvector): backslashes inside single-quotes
	  no longer has special meanings.  fixed: [ruby-list:42311]

Thu Jun  1 17:55:42 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (rb_node_arity): should be aware of post splat arguments.

	* eval.c (rb_proc_arity): ditto.

Thu Jun  1 16:17:26 2006  NAKAMURA Usaku  <usa@ruby-lang.org>

	* win32/win32.c (rb_w32_getcwd): runtime's getcwd() will not success
	  if the length of the cwd is longer than MAX_PATH.
	  fixed [ruby-list:42335]

Thu Jun  1 16:07:48 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* parse.y (f_args): syntax rule enhanced to support arguments
	  after the splat.

	* parse.y (mlhs_basic): ditto for multiple assignments

	* parse.y (block_param): ditto for block parameters.

	* parse.y (f_post_arg): mandatory formal arguments after the splat
	  argument.

	* parse.y (new_args_gen): generate nodes for mandatory formal
	  arguments after the splat argument.

	* eval.c (rb_eval): dispatch mandatory formal arguments after the
	  splat argument.

Thu Jun  1 11:33:32 2006  NAKAMURA Usaku  <usa@ruby-lang.org>

	* win32/win32.c (rb_w32_getcwd): set errno if not set.
	  fixed [ruby-list:42346]

Thu Jun  1 00:45:52 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* parse.y (args): allow more than one splat in the argument list.

Wed May 31 18:38:11 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* parse.y (method_call): allow aref [] to accept all kind of
	  method argument, including assocs, splat, and block argument.

	* eval.c (SETUP_ARGS0): prepare block argument as well.

Tue May 30 18:13:53 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* lib/mathn.rb (Integer): remove Integer#gcd2. [ruby-core:07931]

Mon May 29 22:40:13 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (error_line): print receivers true/false/nil specially.

	* eval.c (rb_proc_yield): handles parameters in yield semantics.

	* eval.c (nil_yield): gives LocalJumpError to denote no block
	  error.

	* io.c (rb_io_getc): now takes one-character string.

Sat May 27 22:46:38 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (proc_invoke): save and restore block in the current frame.
	  fixed: [ruby-core:07833], [ruby-talk:191639]

Sat May 27 11:29:46 2006  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* ext/extmk.rb (extmake): remove extinit files if no statically linked
	  extensions.

Fri May 26 19:56:46 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* string.c (rb_str_hash): use FNV-1a hash from Fowler/Noll/Vo
	  hashing algorithm.

Fri May 26 09:05:11 2006  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* ruby.h, lib/mkmf.rb (create_header): clear command line options for
	  macros moved to extconf.h.

	* ext/extmk.rb (extract_makefile, extmk): made RUBY_EXTCONF_H and
	  EXTSTATIC permanent.

	* ext/{dbm,digest/*,socket,zlib}/extconf.rb: used $defs and $INCFLAGS.

	* {bcc32,win32,wince}/Makefile.sub (COMPILE_C, COMPILE_CXX): added
	  $(INCFLAGS).

	* lib/mkmf.rb (configuration): add $defs unless extconf.h was created.

Thu May 25 01:52:07 2006  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* lib/mkmf.rb (pkg_config): particular config commands support.

	* ext/extmk.rb: deal with $static set in extconf.rb.

	* mkconfig.rb: merge multiple entries to an entry with multiple lines.

	* lib/mkmf.rb: allow a series of commands to link.

	* win32/Makefile.sub: embed manifests.

	* win32/setup.mak: suffix OS name by runtime version.

Wed May 24 23:52:11 2006  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* configure.in (ac_install_sh): ignore dummy install-sh.
	  [ruby-talk:193876]

Wed May 24 17:55:13 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* string.c (rb_str_aref): str[0] now returns 1 character string,
	  instead of a fixnum.	[Ruby2]

	* parse.y (parser_yylex): ?c now returns 1 character string,
	  instead of a fixnum.	[Ruby2]

	* string.c (rb_str_aset): no longer support fixnum insertion.

Wed May 24 03:10:44 2006  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* ext/openssl/lib/openssl/ssl.rb
	  (OpenSSL::SSL::SocketForwarder#setsockopt,getsockopt): typo fixed.

Mon May 22 16:32:03 2006  Tanaka Akira  <akr@m17n.org>

	* rubyio.h (rb_io_set_nonblock): declared.

	* io.c (rb_io_set_nonblock): new function.
	  (io_getpartial): nonblocking read support.
	  (io_read_nonblock): new method: IO#read_nonblock.
	  (io_write_nonblock): new method: IO#write_nonblock.

	* ext/socket/socket.c (s_accept): retry for EWOULDBLOCK.
	  revert [ruby-talk:113807].
	  (sock_connect_nonblock): new method: Socket#connect_nonblock.
	  (sock_accept_nonblock): new method: Socket#accept_nonblock.
	  (sock_recvfrom_nonblock): new method: Socket#recvfrom_nonblock.

	  [ruby-core:7917]

Mon May 22 15:57:39 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (umethod_bind): should not update original class.
	  [ruby-dev:28636]

Mon May 22 13:38:57 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (ev_const_get): should support constant access from
	  within instance_eval().  [ruby-dev:28327]

Sun May 21 09:50:31 2006  K.Kosako  <sndgk393 AT ybb.ne.jp>

	* regexec.c: add STK_NULL_CHECK_END to IS_TO_VOID_TARGET().
	  [ruby-list:42234]

Thu May 18 22:37:20 2006  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* lib/webrick/config.rb (WEBrick::Config::HTTP): add new parameters,
	  :InputBufferSize and :OutputBufferSize.

	* lib/webrick/utils.rb (WEBrick::Utils.timeout): add new timeout
	  method. this implementation is expected to be compatible with
	  timeout.rb and faster than timeout.rb.

	* lib/webrick/httprequest.rb (WEBrick::HTTPRequest#_read_data):
	  Timeout.timeout is replaced by WEBrick::Utils.timeout.

	* lib/webrick/httprequest.rb: WEBrick::HTTPRequest::BUFSIZE is
	  replaced by config[:InputBufferSize].

	* lib/webrick/httpresposne.rb: WEBrick::HTTPResponse::BUFSIZE is
	  replaced by config[:OutputBufferSize].

	* lib/webrick/server.rb: get rid of unnecessary require.

	* test/webrick/test_utils.rb: test for WEBrick::Utils.timeout.

Thu May 18 17:51:32 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* time.c (time_timeval): should round for usec floating
	  number.  [ruby-core:07896]

	* time.c (time_add): ditto.

Thu May 18 00:42:12 2006  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* ext/extmk.rb, lib/mkmf.rb: use BUILD_FILE_SEPARATOR in Makefiles.

Wed May 17 17:55:26 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* dir.c (sys_warning): should not call a vararg function
	  rb_sys_warning() indirectly.	[ruby-core:07886]

Tue May 16 17:23:19 2006    <sinara@blade.nagaokaut.ac.jp>

	* numeric.c (flo_divmod): the first element of Float#divmod should
	  be an integer. [ruby-dev:28589]

	* test/ruby/test_float.rb: add tests for divmod, div, modulo and remainder.

Tue May 16 15:34:18 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* re.c (rb_reg_initialize): should not allow modifying literal
	  regexps.  frozen check moved from rb_reg_initialize_m as well.

Tue May 16 09:20:16 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* re.c (rb_reg_initialize): should not modify untainted objects in
	  safe levels higher than 3.

	* re.c (rb_memcmp): type change from char* to const void*.

	* dir.c (dir_close): should not close untainted dir stream.

	* dir.c (GetDIR): add tainted/frozen check for each dir operation.

Mon May 15 21:37:12 2006  K.Kosako  <sndgk393 AT ybb.ne.jp>

	* re.c (rb_reg_prepare_re): don't use onig_recompile().

Mon May 15 17:42:39 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* lib/rdoc/parsers/parse_rb.rb (RDoc::RubyParser::parse_symbol_arg):
	  typo fixed.  a patch from Florian Gross <florg at florg.net>.

Sat May 13 16:14:05 2006  Tanaka Akira  <akr@m17n.org>

	* lib/pp.rb (PP.mcall): new method.
	  (Struct#pretty_print): call Kernel#class and Struct#members even if
	  overridden.
	  (Struct#pretty_print_cycle): ditto.
	  [ruby-core:7865]

Fri May 12 15:54:48 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (EXEC_EVENT_HOOK): trace_func may remove itself from
	  event_hooks.	no guarantee for arbitrary hook deletion.
	  [ruby-dev:28632]

Thu May 11 19:57:00 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* util.c (ruby_strtod): differ addition to minimize error.
	  [ruby-dev:28619]

Thu May 11 18:30:11 2006  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* ext/openssl/ossl_cipher.c (add_cipher_name_to_ary): should return
	  value. [ruby-dev:28627]

Thu May 11 18:10:43 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* util.c (ruby_strtod): should not raise ERANGE when the input
	  string does not have any digits.  [ruby-dev:28629]

Wed May 10 23:40:21 2006  K.Kosako  <sndgk393 AT ybb.ne.jp>

	* oniguruma.h: Version 4.0.3

	* regexec.c: ditto.

Mon May  8 09:10:31 2006  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* ext/openssl/extconf.rb: add check for OBJ_NAME_do_all_sorted.

	* ext/openssl/ossl_cipher.c (ossl_s_ciphers): new method
	  OpenSSL::Cipher.ciphers. it returns all the cipher names.

	* ext/openssl/ossl_cipher.c (ossl_cipher_init): refine warning message.

	* ext/openssl/lib/openssl/cipher.rb: reimplement without eval() and
	  add constants AES128, AES192, AES256. [ruby-dev:28610]

	* ext/openssl/lib/openssl/digest.rb: reimplement without eval().

	* test/openssl/test_cipher.rb, test_digest: fix about reimplemented
	  features.

	* sample/openssl/cipher.rb: rewrite all.

Sun May  7 03:09:51 2006  Stephan Maka  <stephan@spaceboyz.net>

	* lib/resolv.rb (Resolv::DNS::Requester::ConnectedUDP#initialize):
	  Use AF_INET6 for nameservers containing colons.

Sat May  6 23:40:03 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (proc_invoke): should restore old ruby_frame->block.
	  thanks to ts <decoux at moulon.inra.fr>.  [ruby-core:07833]
	  also fix [ruby-dev:28614] as well.

Sat May  6 00:38:42 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* signal.c (trap): sig should be less then NSIG.  Coverity found
	  this bug.  a patch from Kevin Tew <tewk at tewk.com>.
	  [ruby-core:07823]

Thu May  4 22:13:22 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* math.c (math_log2): add new method inspired by
	  [ruby-talk:191237].

	* math.c (math_log): add optional base argument to Math::log().
	  [ruby-talk:191308]

Thu May  4 02:24:16 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* ext/syck/emitter.c (syck_scan_scalar): avoid accessing
	  uninitialized array element.	a patch from Pat Eyler
	  <rubypate at gmail.com>.  [ruby-core:07809]

	* array.c (rb_ary_fill): initialize local variables first.  a
	  patch from Pat Eyler <rubypate at gmail.com>.	 [ruby-core:07810]

	* ext/syck/yaml2byte.c (syck_yaml2byte_handler): need to free
	  type_tag.  a patch from Pat Eyler <rubypate at gmail.com>.
	  [ruby-core:07808]

Wed May  3 02:12:07 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* ext/socket/socket.c (make_hostent_internal): accept ai_family
	  check from Sam Roberts <sroberts at uniserve.com>.
	  [ruby-core:07691]

Mon May  1 17:58:16 2006  Masaki Suketa  <masaki.suketa@nifty.ne.jp>

	* ext/win32ole/win32ole.c (add_event_call_back): should not
	  delete event handler when the event name is not entried.

Mon May  1 08:32:10 2006  Masaki Suketa  <masaki.suketa@nifty.ne.jp>

	* ext/win32ole/win32ole.c (ole_param_ole_type): should return
	  "unknown type" string when ITypeInfo::GetFuncDesc failed.

Sat Apr 29 22:43:37 2006  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* ext/openssl/ossl_asn1.c (ossl_asn1_decode0): should initialize
	  flag. [ruby-core:07785]

Fri Apr 28 10:53:16 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* util.c (ruby_strtod): should not cut off 18 digits for no
	  reason.  [ruby-core:07796]

Thu Apr 27 01:38:10 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* array.c (rb_ary_fill): internalize local variable "beg" to
	  pacify Coverity.  [ruby-core:07770]

Wed Apr 26 16:59:24 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* pack.c (pack_unpack): now supports CRLF newlines.  a patch from
	  <tommy at tmtm.org>.	[ruby-dev:28601]

Wed Apr 26 16:55:19 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* applied code clean-up patch from Stefan Huehner
	  <stefan at huehner.org>.  [ruby-core:07764]

Tue Apr 25 18:00:05 2006  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/tcltklib.c (delete_slaves): maybe increment the reference
	  count of a NULL Tcl_Obj [ruby-core:07759].

Tue Apr 25 07:55:31 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* lib/jcode.rb (String::tr_s): should have translated non
	  squeezing character sequence (i.e. a character) as well.  thanks
	  to Hiroshi Ichikawa <gimite at gimite.ddo.jp> [ruby-list:42090]

Fri Apr 21 15:19:13 2006  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/tcltklib.c (lib_eventloop_ensure): refer freed pointer
	  [ruby-core:07744] and memory leak.

Fri Apr 21 12:14:52 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* ext/socket/socket.c: document update patch from Sam Roberts
	  <sroberts at uniserve.com>.  [ruby-core:07701]

Thu Apr 20 08:43:54 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* lib/mathn.rb (Integer): need not to remove gcd2.  a patch from
	  NARUSE, Yui <naruse at airemix.com>.	[ruby-dev:28570]

Wed Apr 19 13:55:27 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* parse.y (arg): too much NEW_LIST()

	* eval.c (SETUP_ARGS0): remove unnecessary access to nd_alen.

Wed Apr 19 11:57:04 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (rb_eval): use ARGSCAT for NODE_OP_ASGN1.
	  [ruby-dev:28585]

	* parse.y (arg): use NODE_ARGSCAT for placeholder.

Wed Apr 19 11:13:17 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* lib/getoptlong.rb (GetoptLong::get): RDoc update patch from
	  mathew <meta at pobox.com>.  [ruby-core:07738]

Wed Apr 19 10:13:27 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* variable.c (rb_const_set): raise error when no target klass is
	  supplied.  [ruby-dev:28582]

Tue Apr 18 17:40:37 2006  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/lib/multi-tk.rb: add a binding to a container for a slave IP.

	* ext/tk/lib/tk.rb: update RELEASE_DATE.

	* ext/tk/tcltklib.c: forget to reset a Tcl interpreter.

	* ext/tk/stubs.c: fix potential bugs about handling rb_argv0.

Mon Apr 10 01:03:10 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* prec.c (prec_prec_f): documentation patch from
	  <gerardo.santana at gmail.com>.  [ruby-core:07689]

Sat Apr  8 02:34:34 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* bignum.c (rb_big_pow): second operand may be too big even if
	  it's a Fixnum.  [ruby-talk:187984]

Sat Apr  8 02:12:38 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* README.EXT: update symbol description.  [ruby-talk:188104]

Sat Apr  8 18:06:28 2006  Masaki Suketa  <masaki.suketa@nifty.ne.jp>

	* ext/win32ole/win32ole.c: add WIN32OLE_METHOD#inspect,
	  WIN32OLE_PARAM#inspect.

	* test/win32ole/test_win32ole_method.rb: ditto.

	* add test/win32ole/test_win32ole_param.rb.

Fri Apr  7 22:11:30 2006  Masaki Suketa  <masaki.suketa@nifty.ne.jp>

	* ext/win32ole/win32ole.c(foletypelib_initialize): WIN32OLE_TYPELIB.new
	  accepts OLE file.

	* test/win32ole/test_win32ole_typelib.rb(test_initialize): ditto.

Thu Apr  6 23:28:47 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* COPYING: explicitly note GPLv2.  [ruby-talk:187922]

Thu Apr  6 16:43:06 2006  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* intern.h (rb_obj_instance_exec, rb_mod_module_exec): add declaration.

Thu Apr  6 11:18:37 2006  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/lib/tk/panedwindow.rb: lack of arguments. [ruby-core:7681]

Thu Apr  6 01:04:47 2006  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/tcltklib.c: fix SEGV when embedding to an application.
	  [ruby-core:7600]

	* ext/tk/tcltklib.c: fix SEGV at exit. [ruby-talk:186489]

	* ext/tk/tkutil/tkutil.c: follow to changing specification of
	  instance_eval on ruby-1.9.x.

	* ext/tk/lib/tk.rb: ditto.

	* ext/tk/lib/multi-tk.rb: ditto.

	* ext/tk/lib/tk.rb: remove warning about redefinition of methods.

	* ext/tk/lib/tk/variable.rb: remove warning about unseting Tcl
	  variables.

Wed Apr  5 00:22:54 2006  Tanaka Akira  <akr@m17n.org>

	* lib/pathname.rb: use a subclass for instantiation except
	  methods take pathname argument.  suggested by Evan Phoenix.
	  [ruby-core:7618]

Tue Apr  4 22:15:41 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* parse.y: remove some obsolete syntax rules (unparenthesized
	  method calls in argument list).

Sat Apr  1 15:11:27 2006  Masaki Suketa  <masaki.suketa@nifty.ne.jp>

	* ext/win32ole/win32ole.c: add WIN32OLE_TYPE#inspect,
	  WIN32OLE_VARIABLE#inspect

	* remove ext/win32ole/tests/testOLEVARIABLE.rb, testOLETYPE.rb
	  testOLETYPELIB.rb.

	* testall.rb: ditto.

	* add test/win32ole

Fri Mar 31 14:24:55 2006  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* enumerator.c (enumerator_with_index): removed suspicious return
	  statement.

Wed Mar 29 23:06:48 2006  Masaki Suketa  <masaki.suketa@nifty.ne.jp>

	* ext/win32ole/win32ole.c (ole_invoke): change the behavior of
	  WIN32OLE#[], WIN32OLE#[]=. These methods invoke DISPID_VALUE.

	* ext/win32ole/sample/excel2.rb: ditto.

	* ext/win32ole/tests/testWIN32OLE.rb: ditto.

Wed Mar 29 10:11:31 2006  NAKAMURA Usaku  <usa@ruby-lang.org>

	* ext/nkf/nkf-utf8/nkf.c (nkf_each_char_to_hex, encode_fallback_subchar,
	  e2w_conv): support C90 compiler.

Mon Mar 27 22:45:37 2006  NARUSE, Yui  <naruse@ruby-lang.org>

	* ext/nkf/nkf-utf8/{nkf.c, utf8tbl.c}: imported nkf 2.0.6.
	  * Add --ic / --oc option and mapping tables.
	  * Add fallback option.
	  * Add --no-best-fit-chars option.
	  * Fix some bugs.

	* ext/nkf/nkf.c (nkf_split_options): added for parse option string.

	* ext/nkf/lib/kconv.rb (Kconv.to*): add -m0.
	  Note that Kconv.to* still imply -X.

	* ext/nkf/test.rb: Removed.  Obsolete by test/nkf.

	* ext/.document: enabled documents in nkf and kconv

	* ext/nkf/nkf.c, ext/nkf/lib/kconv.rb: Add rdoc.

Mon Mar 27 03:17:21 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (rb_call0): insecure calling should be checked for non
	  NODE_SCOPE method invocations too.

	* eval.c (rb_alias): should preserve the current safe level as
	  well as method definition.

Sun Mar 26 22:02:51 2006  K.Kosako  <sndgk393 AT ybb.ne.jp>

	* re.c: refactoring for options.

	* parse.y: ditto.

Fri Mar 24 21:11:02 2006  K.Kosako  <sndgk393 AT ybb.ne.jp>

	* re.c (match_aref): RDoc description updated.

	* string.c (rb_str_sub): ditto.

	* string.c (rb_str_gsub): ditto.

Fri Mar 24 17:20:03 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* process.c (rb_f_sleep): remove RDoc description about SIGALRM
	  which is not valid on the current implementation. [ruby-dev:28464]

Thu Mar 23 21:40:47 2006  K.Kosako  <sndgk393 AT ybb.ne.jp>

	* re.c (rb_reg_regsub): prohibit \1, \2 ...\9 in replaced string
	  for named regex pattern.

Thu Mar 23 21:06:23 2006  K.Kosako  <sndgk393 AT ybb.ne.jp>

	* oniguruma.h: Version 4.0.2

	* regparse.c: ditto.

	* regcomp.c ditto.

	* regerror.c: ditto.

Thu Mar 23 10:47:03 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (method_missing): should support argument splat in
	  super.  a bug in combination of super, splat and
	  method_missing.  [ruby-talk:185438]

Thu Mar 23 00:01:32 2006  K.Kosako  <sndgk393 AT ybb.ne.jp>

	* re.c (rb_reg_regsub): add back reference by name \k<name> in
	  replace string.

	* re.h: add regexp argument to rb_reg_regsub().

	* string.c (rb_str_sub_bang): ditto.

	* string.c (str_gsub): ditto.

Tue Mar 21 22:14:01 2006  K.Kosako  <sndgk393 AT ybb.ne.jp>

	* re.c (match_alloc): initialize member regexp.

	* re.c (match_aref): add String and Symbol argument. [ruby-dev:28448]

	* re.h: add member regexp to RMatch.

	* gc.c (gc_mark_children): add gc_mark() to regexp member.

Mon Mar 20 12:05:18 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* configure.in: Solaris SunPro compiler -rapth patch from
	  <kuwa at labs.fujitsu.com>.  [ruby-dev:28443]

Mon Mar 20 11:12:38 2006  NAKAMURA Usaku  <usa@ruby-lang.org>

	* ext/win32ole/win32ole.c (folevariant_value): could not compile
	  with C90 compiler.

Mon Mar 20 09:40:23 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* configure.in: remove enable_rpath=no for Solaris.
	  [ruby-dev:28440]

Sun Mar 19 09:46:30 2006  Masaki Suketa  <masaki.suketa@nifty.ne.jp>

	* ext/win32ole/win32ole.c (ole_val2olevariantdata): change behavior
	  of converting	 OLE Variant object with VT_ARRAY|VT_UI1 and Ruby
	  String object.

	* ext/win32ole/win32ole.c (folevariant_value): ditto.

	* ext/win32ole/tests/testOLEVARIANT.rb: ditto.

Wed Mar 15 16:51:11 2006  NAKAMURA Usaku  <usa@ruby-lang.org>

	* lib/mkmf.rb (create_makefile): support libraries without *.so.

Wed Mar 15 16:39:29 2006  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* ext/openssl/ossl_ssl.c, ext/openssl/ossl_nsspki.c: should use
	  "rb_str_new(0, 0)" to make empty string.

Sun Mar 12 17:02:10 2006  Masaki Suketa  <masaki.suketa@nifty.ne.jp>

	* ext/win32ole/win32ole.c(ole_val2olevariantdata): support VT_ARRAY in
	  WIN32OLE_VARIANT.new().

	* ext/win32ole/tests/testOLEVARIANT.rb: ditto.

	* ext/win32ole/tests/testOLEPARAM.rb: test method name should not be
	  duplicated.

Sat Mar 11 14:24:06 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* ruby.1: a clarification patch from David Lutterkort
	  <dlutter at redhat.com>.  [ruby-core:7508]

Sun Mar  5 18:40:58 2006  Minero Aoki  <aamine@loveruby.net>

	* lib/fileutils.rb: do not repeat command options.

Sun Mar  5 18:35:03 2006  Minero Aoki  <aamine@loveruby.net>

	* lib/net/http.rb (send_request_with_body): #content_type never
	  return false, use #main_type instead. [ruby-core:07476]

Sat Mar  4 15:26:40 2006  Tanaka Akira  <akr@m17n.org>

	* gc.c (id2ref): fix symbol test.

Sat Mar  4 01:08:07 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* lib/rdoc/ri/ri_paths.rb (RI::Paths): adding paths from rubygems
	  directories.	a patch from Eric Hodel <drbrain at segment7.net>.
	  [ruby-core:07423]

Fri Mar  3 17:59:00 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (rb_clear_cache_by_class): clearing wrong cache.

Fri Mar  3 21:22:42 2006  Tanaka Akira  <akr@m17n.org>

	* lib/fileutils.rb (FileUtils.cp_r): implement :remove_destination
	  option.

	* ext/extmk.rb: use :remove_destination to install extension libraries
	  to avoid SEGV.  [ruby-dev:28417]

Fri Mar  3 14:41:04 2006  Minero Aoki  <aamine@loveruby.net>

	* ext/dl/.cvsignore: ignore callback.h.

	* ext/ripper/.cvsignore: ignore eventids2table.c.

	* ext/socket/.cvsignore: ignore constants.h.

Thu Mar  2 18:58:18 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (rb_thread_fd_writable): should not re-schedule output
	  from KILLED thread (must be error printing).

Thu Mar  2 09:12:05 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* array.c (rb_ary_flatten_bang): allow specifying recursion
	  level.  [ruby-talk:182170]

	* array.c (rb_ary_flatten): ditto.

Thu Mar  2 08:02:42 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* gc.c (add_heap): a heap_slots may overflow.  a patch from Stefan
	  Weil <weil at mail.berlios.de>.

Wed Mar  1 17:13:37 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (rb_call): use separate cache for fcall/vcall
	  invocation.

	* eval.c (rb_eval): NODE_FCALL, NODE_VCALL can call local
	  functions.

	* eval.c (rb_mod_local): a new method to specify newly added
	  visibility "local".

	* eval.c (search_method): search for local methods which are
	  visible only from the current class.

	* class.c (rb_class_local_methods): a method to list local methods.

Thu Mar  2 17:54:45 2006  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* gc.c: commited magic for reducing RVALUE size on windows. (24->20byte)
	  [ruby-core:7474]

Thu Mar  2 14:12:26 2006  Tanaka Akira  <akr@m17n.org>

	* gc.c: align VALUE with sizeof(RVALUE) globally.
	  (is_pointer_to_heap): check alignment out of loop.
	  (id2ref): avoid collision between symbols and objects.
	  (rb_obj_id): ditto.  moved from object.c.
	  [ruby-talk:178364] [ruby-core:7305]

Thu Mar  2 12:55:16 2006  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* win32/win32.c (filetime_to_unixtime): should set tm_isdst to -1.
	  stat() didn't treat daylight saving time property on WinNT.
	  [ruby-talk:182100]

Wed Mar  1 00:15:51 2006  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* lib/rdoc/parsers/parse_rb.rb (read_escape): could not handle /\^/.
	  merged Mr. Ishizuka's lib/irb/ruby-lex.rb 's patch rev 1.29.
	  [ruby-talk:181631] [ruby-dev:28404]

Tue Feb 28 19:32:14 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* object.c (Init_Object): add BasicObject class as a top level
	  BlankSlate class.

Mon Feb 27 00:19:16 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* ruby.h (SYM2ID): should not cast to signed long.
	  [ruby-core:07414]

Fri Feb 24 20:21:38 2006  Masatoshi SEKI  <m_seki@mva.biglobe.ne.jp>

	* test/drb/drbtest.rb (add_service_command): quote pathnames in the
	  server's command line for space contained directory names.
	  Thanks, arton. [ruby-dev:28386]

Fri Feb 24 12:10:07 2006  NAKAMURA Usaku  <usa@ruby-lang.org>

	* instruby.rb: install *.exe.manifest and *.dll.manifest if exist.
	  It's for VC++8.

Fri Feb 24 11:17:45 2006  NAKAMURA Usaku  <usa@ruby-lang.org>

	* win32/win32.c (NtInitialize): need to set a handler for VC++8.

Thu Feb 23 22:39:59 2006  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* bcc32/Makefile.sub: use borlndmm.dll if possible. bcc32's RTL internal
	  memory manager cannot handle large memory block properly.
	  ex: 10000.times { "" << "." * 529671; GC.start } # crash
	  [ruby-dev:28230]

Thu Feb 23 13:23:03 2006  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* eval.c (SETUP_ARGS0): fixed memory corruption. [ruby-dev:28360]

Wed Feb 22 21:16:55 2006  Tanaka Akira  <akr@m17n.org>

	* lib/pathname.rb (Pathname#each_filename): use split_names properly.

Wed Feb 22 16:24:05 2006  NAKAMURA Usaku  <usa@ruby-lang.org>

	* test/webrick/test_cgi.rb: should support platforms which search
	  library path from the interpreter's path.
	  And, support test without install incidentally.

Wed Feb 22 14:21:03 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* bignum.c (bignorm): x may not be a bignum.  [ruby-dev:28367]

Wed Feb 22 09:22:40 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (proc_alloc): add proper check for creation of a lambda
	  without a block.

Tue Feb 21 02:07:39 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* parse.y (f_arglist): should set command_start = Qtrue for
	  command body.  [ruby-talk:180648]

Mon Feb 20 22:30:17 2006  Tanaka Akira  <akr@m17n.org>

	* mkconfig.rb: alias Config to RbConfig for compatibility.

Mon Feb 20 18:21:41 2006  Tanaka Akira  <akr@m17n.org>

	* io.c (rb_io_reopen): flush before reopening a file.
	  reported by Mathieu Bouchard.  [ruby-core:7396]

Mon Feb 20 17:29:50 2006  Tanaka Akira  <akr@m17n.org>

	* mkconfig.rb: generate RbConfig instead of Config.

	* instruby.rb, rubytest.rb, runruby.rb, bcc32/Makefile.sub,
	  ext/extmk.rb, ext/dl/extconf.rb, ext/iconv/charset_alias.rb,
	  lib/mkmf.rb, lib/rdoc/ri/ri_paths.rb,
	  lib/webrick/httpservlet/cgihandler.rb,
	  test/dbm/test_dbm.rb, test/gdbm/test_gdbm.rb,
	  test/ruby/envutil.rb, test/soap/calc/test_calc_cgi.rb,
	  test/soap/header/test_authheader_cgi.rb, test/soap/ssl/test_ssl.rb,
	  win32/mkexports.rb, win32/resource.rb: Use RbConfig instead of
	  Config.

Mon Feb 20 13:46:19 2006  NAKAMURA Usaku  <usa@ruby-lang.org>

	* lib/find.rb: should raise ENOENT if root entry does not exist,
	  without opening it. [ruby-dev:28345]

Mon Feb 20 12:27:53 2006  Kent Sibilev  <ksruby@gmail.com>

	* lib/rational.rb (Integer::gcd): small typo fix.
	  [ruby-core:07395]

Mon Feb 20 10:03:59 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* variable.c (rb_const_get_0): Object should have been the lowest
	  in const lookup precedence.  [ruby-dev:28343]

Mon Feb 20 09:17:11 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* lib/delegate.rb (Delegator): should not delegate "funcall".

Mon Feb 20 09:13:42 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* lib/webrick/httpservlet/cgihandler.rb (WEBrick::HTTPServlet::CGIHandler):
	  qualify the access for Config constant.  [ruby-dev:28338]

	* lib/resolv.rb (Resolv::DNS::Resource::IN::A): qualify
	  ClassValue.  [ruby-dev:28338]

Mon Feb 20 01:05:27 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* lib/rational.rb (Integer::gcd): replaced by gcd4 in
	  [ruby-core:07390].  [ruby-core:07377]

Mon Feb 20 00:57:02 2006  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* ext/openssl/ossl.h (OSSL_Debug): should not use __func__.
	  [ruby-dev:28339]

Mon Feb 20 00:13:49 2006  Tanaka Akira  <akr@m17n.org>

	* lib/open-uri.rb: add :ssl_verify_mode option.
	  suggested by Will Glynn.

	* lib/open-uri.rb: add :ssl_ca_cert option.

Sun Feb 19 04:46:29 2006  Guy Decoux  <ts@moulon.inra.fr>

	* eval.c: initial value for block_unique must be 1.
	  [ruby-talk:180420]

Sat Feb 18 23:58:26 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* lib/tracer.rb (Tracer::Tracer.add_filter): turn on tracer mode
	  only when caller() level size is one.  [ruby-core:07389]

	* lib/rdoc/parsers/parse_rb.rb: need not to require "tracer".
	  [ruby-core:07389]

	* sample/rtags.rb: ditto.

Sat Feb 18 21:16:27 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (rb_obj_instance_eval): RDoc description updated.  a
	  patch from Ozgur Murat Homurlu <ozgurmurath at gmail.com>.
	  [ruby-core:07381]

Sat Feb 18 01:01:17 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* variable.c (rb_const_get_0): skip ruby_wrapper in const search
	  to give it lower priority (just above Object).  need not to
	  change rb_const_defined_0() since it's only a precedence matter;
	  they are defined anyway.

Sat Feb 18 00:22:39 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* lib/tracer.rb: merged a minor clarification patch from Daniel
	  Berger <Daniel.Berger at qwest.com>.  [ruby-core:07376]

Fri Feb 17 17:30:20 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (ev_const_get): simplified using rb_const_get_fallback().

	* eval.c (ev_const_defined): adopt to ev_const_get() using
	  rb_const_defined_fallback().

	* variable.c (rb_const_get_fallback): new function to implement
	  constant search.

	* variable.c (rb_const_defined_fallback): new function to
	  implement constant definition check.

	* variable.c (rb_const_get_0): adopt to new behavior.  constants
	  are looked up in the order of: current class, super classes (but
	  Object), lexically external classes/modules, and Object.

	* variable.c (rb_const_defined_0): ditto.

Fri Feb 17 11:20:53 2006  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* util.c (ruby_strtod): Float("1e") should fail. [ruby-core:7330]

	* pack.c (EXTEND32): unpack("l") did not work where sizeof(long) != 4.
	  [ruby-talk:180024]

	* pack.c (pack_unpack): fixed integer overflow on template "w".
	  [ruby-talk:180126]

Fri Feb 17 09:39:29 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (rb_thread_wait_for): sleep should always sleep for
	  specified amount of time.  [ruby-talk:180067]

Wed Feb 15 16:52:52 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (rb_eval): NODE_OP_ASGN1 should allow splat in its
	  argument list.  [ruby-core:07366]

	* parse.y (arg): avoid unnecessary extra argument.
	  [ruby-core:07366]

	* eval.c (rb_eval): honor visibility on OP_ASGN1 and
	  OP_ASGN2. [ruby-core:07366]

Wed Feb 15 15:20:23 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (error_line): remove void control path.  [ruby-dev:28335]

Wed Feb 15 10:09:51 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (yield_under_i): should not pass self as an argument to
	  the block for instance_eval.  [ruby-core:07364]

Wed Feb 15 09:20:35 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (rb_obj_instance_eval): should be no singleton classes for
	  true, false, and nil.  [ruby-dev:28186]

Tue Feb 14 20:26:00 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* enumerator.c (enumerator_each): return self if no block is
	  given.  [yarv-dev:882]

Tue Feb 14 18:48:33 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (DMETHOD_P): accessing wrong frame.  [ruby-dev:28181]

	* eval.c (proc_invoke): preserve FRAME_DMETH flag.

Tue Feb 14 15:15:22 2006  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* ext/zlib/zlib.c: supress warning on test/zlib. [ruby-dev:28323]

Tue Feb 14 13:47:22 2006  NAKAMURA Usaku  <usa@ruby-lang.org>

	* win32/win32.c (rb_w32_utime): drop read-only attribute before
	  changing file time.

Tue Feb 14 13:38:01 2006  NAKAMURA Usaku  <usa@ruby-lang.org>

	* win32/Makefile.sub (config.h): should define HAVE_LONG_LONG with
	  VC++8.

Tue Feb 14 11:42:38 2006  NAKAMURA Usaku  <usa@ruby-lang.org>

	* time.c (search_time_t): support non 32bit time_t environments.

	* win32/Makefile.sub (config.h): VC++8 has ``long long'' type.

	* win32/Makefile.sub (config.h): VC++8's time_t is 64bit value.

Mon Feb 13 18:01:52 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (copy_node_scope): remove duplicated semicolons at end.
	  a patch from KIMURA Koichi <kimura.koichi at canon.co.jp>.
	  [ruby-dev:28332]

	* eval.c (VIS_MODE): remove unnecessary argument.
	  [ruby-dev:28332]

Mon Feb 13 13:49:48 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* parse.y (parser_parse_string): mention "regexp" in a error
	  message.  a patch from Mauricio Fernandez <mfp at acm.org>
	  [ruby-core:07340]

Mon Feb 13 00:01:32 2006  K.Kosako  <sndgk393 AT ybb.ne.jp>

	* oniguruma.h: Version 4.0.1

	* regparse.c (onig_free_shared_cclass_table): fix memory leaks.

	* regcomp.c (optimize_node_left): change from IS_POSIXLINE() to IS_MULTILINE().

	* regint.h: rename ANCHOR_ANYCHAR_STAR_PL to ANCHOR_ANYCHAR_STAR_ML.

	* regparse.h: ditto.

	* regexec.c: ditto.

Sat Feb 11 21:57:29 2006  Masaki Suketa  <masaki.suketa@nifty.ne.jp>

	* ext/win32ole/win32ole.c: add WIN32OLE.create_guid.

	* ext/win32ole/tests/testWIN32OLE.rb: ditto.

Sat Feb 11 01:57:44 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (rb_f_autoload): check if ruby_cbase is nil (during
	  instance_eval for objects cannot have singleton classes,
	  e.g. fixnums and symbols).  [ruby-dev:28178]

Fri Feb 10 12:31:05 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (rb_eval): should support NODE_ZSUPER in NODE_ITER.
	  [ruby-dev:28326]

	* eval.c (ZSUPER_ARGS): support macro.

Wed Feb  8 10:26:06 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* gc.c (rb_gc_call_finalizer_at_exit): turn on during_gc while
	  invoking finalizers.

	* gc.c (rb_gc_finalize_deferred): ditto.

Tue Feb  7 23:03:13 2006  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* ext/zlib/zlib.c: should not access ruby objects in finalizer.
	  [ruby-dev:28286]

Tue Feb  7 18:42:00 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* io.c (rb_write_error2): use fwrite(3) if rb_stderr is not
	  updated or is already freed.  [ruby-dev:28313]

Mon Feb  6 16:02:51 2006  WATANABE Hirofumi  <eban@ruby-lang.org>

	* file.c (rb_thread_flock): ERROR_NOT_LOCKED is not an error on Cygwin.
	  In such situation, flock() should return 0.

Mon Feb  6 14:36:29 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (error_line): include the class name of a surrounding
	  method in error position description.

Mon Feb  6 00:14:57 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* enum.c (enum_find_index): a new method Enumerable#find_index.
	  [ruby-talk:178495]

Sun Feb  5 23:29:31 2006  Tanaka Akira  <akr@m17n.org>

	* ruby.h (struct RStruct): embed 3 or less elements structs.
	  (RSTRUCT_LEN): defined for accessing struct members.
	  (RSTRUCT_PTR): ditto.

	* struct.c: use RSTRUCT_LEN and RSTRUCT_PTR.
	  (struct_alloc): allocate small structs in embedded format.
	  (rb_struct_init_copy): ditto.

	* gc.c (gc_mark_children): use RSTRUCT_LEN and RSTRUCT_PTR.
	  (obj_free): ditto.

	* marshal.c (w_object): use RSTRUCT_LEN and RSTRUCT_PTR.

Sun Feb  5 21:01:49 2006  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* numeric.c (fix_to_s): removed workaround for radix 2. Historically,
	  rb_fix2str could only handle radix 8, 10, 16. (Rev1.37) But for now,
	  it can handle radix 2..36. [ruby-Bugs#3438] [ruby-core:7300]

Sun Feb  5 18:49:00 2006  Minero Aoki  <aamine@loveruby.net>

	* lib/net/http.rb (add_field, get_fields): keep 1.8.2
	  compatibility.  This patch is contributed by Rob Pitt.

Sun Feb  5 16:33:50 2006  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* lib/mkmf.rb (create_makefile): Kernel#sub! was removed on HEAD.

Sun Feb  5 14:26:54 2006  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* lib/pstore.rb: should return default value if name is not found.
	  [ruby-core:7304]

	* lib/pstore.rb: should raise PStore::Error if not in transaction.

Sat Feb  4 22:51:43 2006  Tanaka Akira  <akr@m17n.org>

	* eval.c: apply the FreeBSD getcontext/setcontext workaround
	  only before FreeBSD 7-CURRENT.

Sat Feb  4 21:10:06 2006  NAKAMURA Usaku  <usa@ruby-lang.org>

	* win32/win32.c (LK_ERR): ERROR_NOT_LOCKED is not an error.
	  In such situation, flock() should return 0.

Sat Feb  4 15:52:56 2006  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* numeric.c (fix_to_s): (2**32).to_s(2) fails with exception where
	  sizeof(int) == 4 < sizeof(long). [ruby-core:7300]

Sat Feb  4 15:02:05 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* oniguruma.h: merge Oniguruma 4.0.0  [ruby-dev:28290]

Fri Feb  3 19:25:53 2006  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* ruby.h: fixed prototype.

	* ext/syck/rubyext.c: defined symbol ID as global variable as others.

Fri Feb  3 17:57:02 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c: unify ruby_class (for method definition) and ruby_cbase
	  (for constant reference).

Fri Feb  3 15:02:10 2006  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* ext/syck/syck.c (syck_move_tokens): should reset p->cursor or etc
	  even if skip == 0. This causes buffer overrun.
	  (ex: YAML.load('--- "..' + '\x82\xA0' * 511 + '"'))

Fri Feb  3 00:01:31 2006  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* ext/syck/emitter.c (syck_emitter_write): should not set '\0' on
	  emitter's marker. if marker points to the end of buffer, this is
	  buffer overrun. (ex: YAML.dump("." * 12288))

Thu Feb  2 17:13:01 2006  NAKAMURA Usaku  <usa@ruby-lang.org>

	* lib/rdoc/parsers/parse_rb.rb (RDoc::RubyParser#get_tk): added
	  support of :'string' style Symbol.

Thu Feb  2 16:01:24 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (rb_call0): use TMP_ALLOC() instead of allocating
	  a temporary array object.

	* eval.c (eval): need not to protect $SAFE value.
	  [ruby-core:07177]

	* error.c (Init_Exception): change NameError to direct subclass of
	  Exception so that default rescue do not handle it silently.

Thu Feb  2 14:45:53 2006  Ville Mattila  <ville.mattila@stonesoft.com>

	* configure.in: The isinf is not regognized by autoconf
	  library guesser on solaris 10. [ruby-core:7138]

Wed Feb  1 22:01:47 2006  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* configure.in, hash.c (ruby_setenv): use setenv(3) and unsetenv(3)
	  where they are supported. modifing environ variable seems to
	  segfault solaris 10. [ruby-core:7276] [ruby-dev:28270]

	* ruby.c (set_arg0): if use setenv(3), environ space cannot be used
	  for altering argv[0].

Tue Jan 31 14:46:28 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* struct.c (rb_struct_select): update RDoc description.
	  [ruby-core:7254]

Tue Jan 31 11:58:51 2006  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/lib/multi-tk.rb: add MultiTkIp#eval and bg_eval.

	* ext/tk/lib/tk/namespace.rb: TkNamespace#eval was enbugged at the
	  last commit. Now it will return a proper object.

Tue Jan 31 08:07:02 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* numeric.c (int_upto): return an enumerator if no block is
	  attached to the method.

	* numeric.c (int_downto): ditto.

	* numeric.c (int_dotimes): ditto.

	* enum.c (enum_first): new method Enumerable#first to take first n
	  elements from an enumerable.

	* enum.c (enum_group_by): new method Enumerable#group_by that
	  groups enumerable values according to their block values.

Tue Jan 31 00:08:22 2006  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* ext/syck/rubyext.c (syck_resolver_transfer): workaround for SEGV.
	  ex: ruby -ryaml -e 'YAML.load("!map:B {}")' [ruby-core:7217]

Sat Jan 28 07:49:30 2006  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* lib/rdoc/usage.rb: support "a:0:33" style caller[-1]. In this case
	  file name is "a:0". I don't know this really happens though...
	  [ruby-Bugs:3344]

Thu Jan 26 15:55:52 2006  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* ext/socket/socket.c: turn on do_not_reverse_lookup by default.

Wed Jan 25 22:29:04 2006  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* configure.in, dln.c, file.c, intern.h, missing.h (eaccess): use
	  system routine if provided.  fixed: [ruby-core:07195]

Sun Jan 22 23:27:13 2006  Go Noguchi  <gonoguti@yahoo.co.jp>

	* lib/test/unit/autorunner.rb (process_args): ignore arguments after
	  '--' so that test scripts can handle them.  fixed: [ruby-dev:28258]

Sun Jan 22 22:09:52 2006  Tanaka Akira  <akr@m17n.org>

	* eval.c (POST_GETCONTEXT): define separately from PRE_GETCONTEXT on
	  IA64 to avoid reusing variable address.

Sun Jan 22 20:03:35 2006  Tanaka Akira  <akr@m17n.org>

	* eval.c (ruby_setjmp): define PRE_GETCONTEXT and POST_GETCONTEXT
	  instead of FUNCTION_CALL_MAY_RETURN_TWICE.
	  define PRE_GETCONTEXT to clear carry flag for workaround of
	  FreeBSD/i386 getcontext/setcontext bug.
	  [ruby-dev:28263]

Thu Jan 19 22:19:18 2006  Minero Aoki  <aamine@loveruby.net>

	* lib/fileutils.rb (mv): should remove file after copying.
	  [ruby-dev:28223]

Wed Jan 18 23:37:06 2006  Tanaka Akira  <akr@m17n.org>

	* eval.c (FUNCTION_CALL_MAY_RETURN_TWICE): don't clobber %l7 of SPARC
	  if enable-shared.
	  (ruby_setjmp): call FUNCTION_CALL_MAY_RETURN_TWICE after getcontext
	  too.
	  reported by Pav Lucistnik and Marius Strobl.
	  http://lists.freebsd.org/pipermail/freebsd-sparc64/2006-January/003739.html

Tue Jan 17 23:59:56 2006  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* object.c (rb_mod_const_get, rb_mod_const_defined): added optional
	  flag to search ancestors, which is defaulted to true.
	  fixed: [ruby-talk:175899]

	* eval.c (rb_mod_method_defined): ditto.

Tue Jan 17 11:31:47 2006  NAKAMURA Usaku  <usa@ruby-lang.org>

	* win32/setup.mak (MAKE): workaround for nmake 8.

Tue Jan 17 11:06:19 2006  NAKAMURA Usaku  <usa@ruby-lang.org>

	* win32/Makefile.sub: invoke .bat via shell. workaround for nmake 8.

Mon Jan 16 10:13:38 2006  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* ext/syck/emitter.c (syck_emit_seq, syck_emit_map, syck_emit_item):
	  should output complex key mark even if map's key is empty seq/map.
	  [ruby-core:7129]

Sat Jan 14 03:38:54 2006  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* file.c (rb_file_s_chmod): avoid warning where sizeof(int) !=
	  sizeof(void*).

Fri Jan 13 19:26:15 2006  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* lib/rdoc/diagram.rb:
	    - properly quote bare element attributes
	    - terminates dangling elements (e.g. <img>, <br>, <link>, etc)
	    - converts "CVS" to the more HTML-friendly acronym element
	    - adds missing type attributes to style elements

	  based on Paul Duncan's patch <pabs@pablotron.org> [ruby-core:7028]

	* lib/rdoc/generators/html_generator.rb: ditto.
	* lib/rdoc/generators/template/html/hefss.rb: ditto.
	* lib/rdoc/generators/template/html/html.rb: ditto.
	* lib/rdoc/generators/template/html/kilmer.rb: ditto.

Thu Jan 12 11:53:08 2006  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/sample/tkballoonhelp.rb: [bug fix] couldn't add to a widget
	  which is constructed with TkComposite module.
	  [new feature] support 'command' option which is called just before
	  popping up the balloon help.

Wed Jan 11 00:12:29 2006  Masatoshi SEKI  <m_seki@mva.biglobe.ne.jp>

	* lib/erb.rb (ERB::Compiler): add instance variable @insert_cmd to
	  change <%='s behavior.

Tue Jan 10 19:42:33 2006  Tanaka Akira  <akr@m17n.org>

	* gc.c (garbage_collect): mark ruby_current_node.
	  if an exception is raised in a finalizer written in C called by
	  rb_gc_call_finalizer_at_exit, ruby_set_current_source may use
	  collected ruby_current_node and mark_source_filename may corrupt
	  memory.

Tue Jan 10 13:30:34 2006  akira yamada  <akira@ruby-lang.org>

	* ext/syck/rubyext.c (syck_resolver_transfer): should be able to load
	  !ruby/object:Bignum syntax 1.8.3 dumped. [ruby-core:6159]

Tue Jan 10 12:47:41 2006  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* lib/yaml/rubytypes.rb (Fixnum): Bignum could not be loaded in
	  ruby 1.8.3/1.8.4. [ruby-core:6115]

	* lib/yaml/rubytypes.rb (Numeric): Subclass of Numeric could not
	  be dumped properly. [ruby-core:7047]

Tue Jan 10 12:00:48 2006  Aaron Schrab  <aaron @nospam@ schrab.com>

	* lib/yaml/rubytypes.rb (Symbol#yaml_new): YAML loading of quoted
	  Symbols broken. [ruby-Bugs:2535]

Tue Jan 10 07:26:52 2006  Tanaka Akira  <akr@m17n.org>

	* gc.c (gc_stress): renamed from always_gc and enabled by default.
	  (gc_stress_get): new function for GC.stress.
	  (gc_stress_set): new function for GC.stress=.

Mon Jan  9 19:58:56 2006  arton  <artonx@yahoo.co.jp>

	* ext/zlib/extconf.rb: zlib compiled DLL version 1.2.3 distributed by
	  http://www.zlib.net/ has zdll.lib. [ruby-dev:28209]

Mon Jan  9 14:25:00 2006  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* win32/Makefile.sub (OPTFLAGS): I have experienced trouble on y- flag,
	  (VisualC++6) so use -O2b2xg- if  $(MSC_VER) < 1400. [ruby-core:7040]

Mon Jan  9 14:25:00 2006  Kero van Gelder  <rubyforge @nospam@ kero.tmfweb.nl>

	* lib/webrick/httpservlet/filehandler.rb: fixed typo. [ruby-core:7075]

Sun Jan  8 14:15:27 2006  Tanaka Akira  <akr@m17n.org>

	* eval.c (GCC_VERSION_BEFORE): check __INTEL_COMPILER.
	  Intel C++ Compiler defines __GNUC__.
	  http://www.intel.com/software/products/compilers/clin/docs/ug_cpp/lin1077.htm

Sat Jan  7 15:40:07 2006  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* parse.y (singleton): get rid of segfault on syntax error.
	  fixed: [ruby-core:07070]

Sat Jan  7 06:24:18 2006  Tanaka Akira  <akr@m17n.org>

	* eval.c (rb_fd_isset): compare the result of FD_ISSET with 0 to
	  avoid FreeBSD bug.  FreeBSD defines FD_ISSET as just a bitmap of
	  unsigned long.  So returning the value from rb_fd_isset discards
	  upper 32bits on LP64 environment.
	  http://www.freebsd.org/cgi/query-pr.cgi?pr=ia64/91421

Fri Jan  6 02:20:18 2006  Tanaka Akira  <akr@m17n.org>

	* configure.in: don't force getcontext on IA64.

	* eval.c (ruby_setjmp): add an argument for just before getcontext.
	  (THREAD_SAVE_CONTEXT): call rb_thread_save_context just
	  before getcontext.
	  [ruby-dev:28205]

Sun Jan  1 15:28:46 2006  Tanaka Akira  <akr@m17n.org>

	* missing.h (isinf): avoid macro expansion
	  "extern int isinf(double);" to
	  "extern int ((sizeof(double)==sizeof(float))?_Isinff(double):_Isinf(double));" on
	  HP-UX.

Sun Jan  1 14:42:54 2006  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* win32/win32.c (rb_w32_seekdir): should not segfault even if passed
	  the location which rb_w32_telldir didn't return. (and should change
	  `bits' position) [ruby-core:7035]

	* win32/dir.h: ditto. (stores `loc' instead of `bitpos')

	* test/ruby/test_dir.rb: added.

Sat Dec 31 22:57:00 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* eval.c (rb_thread_save_context): should not recycle scope object used
	  in a thread.  fixed: [ruby-dev:28177]

Sat Dec 31 19:50:38 2005  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* ext/syck/rubyext.c: attribute name was truncated with Rev1.64.

Sat Dec 31 11:53:16 2005  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* lib/generator.rb: (Generator#initialize): should kill @loop_thread
	  before starting new thread. (occurs when called via Generator#rewind)
	  [ruby-dev:28184]

Fri Dec 30 18:22:42 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* gc.c (garbage_collect): mark objects referred from aborting threads.
	  [ruby-dev:28190]

	* win32/Makefile.sub: VC++8 support.

Fri Dec 30 15:17:35 2005  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* lib/generator.rb (Generator#initialize): ensured to stop @loop_thread.
	  Mr. Tanaka pointed out one Thread.pass is not enough. [ruby-dev:28185]

Fri Dec 30 12:20:57 2005  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* lib/generator.rb (Generator#initialize): fixed dead lock. this occurred
	  when end? was called before @loop_thread was stopped. [ruby-core:7029]

Fri Dec 30 01:04:52 2005  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* lib/generator.rb: should work with another thread. (more robust code)
	  [ruby-dev:28177]

Thu Dec 29 23:59:37 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* eval.c (rb_gc_mark_threads): keep unmarked threads which won't wake
	  up alone, and mark threads in the loading table.  [ruby-dev:28154]

	* eval.c (rb_gc_abort_threads), gc.c (gc_sweep): kill unmarked
	  threads.  [ruby-dev:28172]

Thu Dec 29 17:02:07 2005  Tanaka Akira  <akr@m17n.org>

	* test/ruby/envutil.rb (EnvUtil.rubybin): search "ruby" instead of
	  "miniruby".  [ruby-dev:28140]

Thu Dec 29 14:35:10 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (rb_mod_define_method): should save safe_level in the
	  proc object.  [ruby-dev:28146]

Thu Dec 29 11:22:34 2005  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* lib/generator.rb: reimplemented Generator class with Thread instead of
	  callcc, in order to fix memory leak. [ruby-dev:28142]

Wed Dec 28 14:10:05 2005  Tanaka Akira  <akr@m17n.org>

	* ia64.s: remove .pred.safe_across_calls directive.
	  reported by WATANABE Tetsuya.  [ruby-dev:28141]

Wed Dec 28 01:32:39 2005  Tanaka Akira  <akr@m17n.org>

	* eval.c (struct thread): add bstr_max.
	  (rb_thread_save_context): use realloc instead of REALLOC_N
	  to avoid GC.

Tue Dec 27 23:59:53 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* lib/optparse.rb (CompletingHash#match): fix for 1.9.

Tue Dec 27 16:59:52 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* test/drb/drbtest.rb (DRbService::self.ext_service): increase
	  timeout limit.  a patch from Kazuhiro NISHIYAMA
	  <zn at mbf.nifty.com>. [ruby-dev:28132]

Tue Dec 27 14:17:55 2005  Tanaka Akira  <akr@m17n.org>

	* configure.in: define IA64 for portability.  (HP aC++/ANSI C doesn't
	  define __ia64__.)
	  don't check libunwind stuff.
	  check __libc_ia64_register_backing_store_base.

	* defines.h: declare rb_ia64_bsp and rb_ia64_flushrs.
	  (flush_register_windows): call rb_ia64_flushrs on IA64.

	* ia64.s: new file for IA64.
	  it is separated from C program files because
	  Intel C++ Compiler for IA64 doesn't support inline assembly.

	* common.mk (ia64.$(OBJEXT)): new target.

	* ruby.h (RUBY_INIT_STACK): defined.
	  (ruby_init_stack): declared for RUBY_INIT_STACK.

	* main.c (main): precedes RUBY_INIT_STACK before ruby_init.

	* gc.c (rb_gc_register_stack_start): new global variable on IA64.
	  (garbage_collect): simplify register stack marking code.
	  don't use libunwind.
	  (Init_stack): initialize rb_gc_register_stack_start.
	  (ruby_init_stack): new function for RUBY_INIT_STACK.

	* eval.c (struct thread): add bstr_pos member for original position of
	  register stack.
	  (rb_thread_save_context): simplify register stack saving code.
	  don't use libunwind.
	  (rb_thread_restore_context_0): new function.  moved from
	  rb_thread_restore_context except the stack position checking code.
	  don't use libunwind for IA64 register stack.
	  (register_stack_extend): new function.
	  (stack_extend): make it self-recursive with
	  the stack position checking code in old rb_thread_restore_context.
	  (rb_thread_restore_context): just call stack_extend.
	  (flush_register_windows): removed.

	  [ruby-dev:28127]

Tue Dec 27 14:09:39 2005  Minero Aoki  <aamine@loveruby.net>

	* process.c: new method Process.exec. [ruby-dev:28107]

Tue Dec 27 08:22:15 2005  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* ext/openssl/lib/openssl/ssl.rb (OpenSSL::SSL::SSLSocket#post_connection_check):
	  treat wildcard character in commonName. [ruby-dev:28121]

Mon Dec 26 08:50:36 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (ev_const_get): fixed a bug in constant reference during
	  instance_eval.  [yarv-dev:707]

	* eval.c (ev_const_defined): ditto.

	* lib/yaml.rb (YAML::add_domain_type): typo fixed.  a patch from
	  Joel VanderWerf <vjoel at path.berkeley.edu>.
	  [ruby-talk:165285] [ruby-core:6995]

Fri Dec 23 10:30:23 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* ext/digest/sha2/sha2.c (ULL): support AIX C.  a patch from
	  Kailden <kailden at gmail.com>.  [ruby-core:06984]

Wed Dec 21 16:47:35 2005  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* file.c (w32_io_info): should return handle because FileIndex is
	  valid only while file is open. [ruby-dev:28088]

Wed Dec 21 12:12:21 2005  Tanaka Akira  <akr@m17n.org>

	* test/pathname/test_pathname.rb (test_kernel_open): use
	  File.identical?.
	  [ruby-talk:171804]

Tue Dec 20 22:41:17 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* eval.c (eval_under_i): evaluate source in caller's frame.
	  [ruby-dev:28076]

Tue Dec 20 12:53:23 2005  why the lucky stiff  <why@ruby-lang.org>

	* ext/syck/rubyext.c (syck_emitter_reset): to ensure compatibility
	  with previous Ruby versions, documents are no longer headless.

Tue Dec 20 12:33:01 2005  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* ext/syck/rubyext.c (syck_node_transform): ruby object holding
	  explicitly freed SyckNode caused SEGV. [ruby-dev:28067]

	... I think syck GC problem was solved now!

Tue Dec 20 01:46:48 2005  Tanaka Akira  <akr@m17n.org>

	* io.c (rb_f_backquote): fix a GC problem on
	  IA64 with gcc 4.0.3 20051216 (prerelease) -O3.

Mon Dec 19 23:32:39 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* Makefile.in (XCFLAGS): separated as well as win32/Makefile.sub.

	* main.c (always_gc): dllimport is required for VC to import a DLL
	  symbol.  fixed: [ruby-dev:28051]

	* parse.y (rb_symname_p): fixed wrong validation.  [ruby-dev:28047]

Mon Dec 19 23:09:24 2005  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* st.c: uses malloc instead of xmalloc to avoid GC. syck uses st_insert
	  in gram.c to insert node from rb_syck_bad_anchor_handler into
	  SyckParser's hash table. if GC occurs in st_insert, it's not under
	  SyckParser's mark system yet. so RString can be released wrongly.

	* ext/syck/syck.h (S_FREE): small hack. no need to check if pointer is
	  NULL or not before S_FREE.

	* ext/syck/rubyext.c (syck_parser_assign_io): rb_check_string_type can
	  return new RString. if so, it becomes unreachable from GC after
	  returns syck_parser_assign_io, and can be freed by GC. (dangling
	  in syck io system) so extends its life time till syck_parse is called.

	* ext/syck/rubyext.c (syck_parser_s_alloc): always allocates bonus,
	  so no need to check if NULL, and "volatile VALUE hash"
	  is not needed. (bonus->port was not protected in syck_emitter_reset)

	* ext/syck/rubyext.c (syck_mark_parser): ditto.

	* ext/syck/rubyext.c (syck_parser_load): ditto.

	* ext/syck/rubyext.c (syck_parser_load_documents): ditto.

	* ext/syck/rubyext.c (syck_emitter_s_alloc): ditto.

	* ext/syck/rubyext.c (syck_mark_emitter): ditto.

	* ext/syck/rubyext.c (syck_emitter_reset): ditto.

	* ext/syck/rubyext.c (syck_scalar_value_set): "should set newly
	  allocated memory instead of RString's internal storage" stuff again.
	  by this, should call syck_free_node instead of rb_syck_free_node.

	* ext/syck/rubyext.c (syck_node_type_id_set): ditto.

	... I believe syck GC problem was solved by this.

Mon Dec 19 12:20:59 2005  Tanaka Akira  <akr@m17n.org>

	* eval.c (FUNCTION_CALL_MAY_RETURN_TWICE): activate only
	  before gcc 4.0.3 on SPARC and IA64.

Mon Dec 19 11:37:47 2005  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* ext/syck/rubyext.c: sorry, I reverted my "should set newly
	  allocated memory instead of RString's internal storage" stuff.
	  node allocated in rubyext.c seems to be freed by rb_syck_free_node
	  not syck_free_node, and it won't free data.str->ptr and type_id.

	 (I still think this is unsafe because RString(foo)->ptr becomes
	  dangling pointer when RString is modified or freed, but anyway
	  I misunderstood, so go back to original code for now)

Sat Dec 17 21:50:41 2005  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* ext/syck/rubyext.c (syck_emitter_reset): should initialize
	  emitter->bonus->oid. otherwise rb_gc_mark crashes.

	* ext/syck/rubyext.c (syck_mark_parser): should mark anchor nodes
	  because they hold ruby objects. (ie: rb_syck_bad_anchor_handler)

Sat Dec 17 11:00:17 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* ext/syck/rubyext.c (rb_syck_compile): avoid potential memory
	  leak.

	* ext/syck/rubyext.c (syck_set_ivars): avoid potential memory
	  leak by explicit symbol allocation.

Sat Dec 17 03:57:01 2005  Tanaka Akira  <akr@m17n.org>

	* bignum.c (rb_big_rshift): fix a GC problem on
	  IA64 with gcc 4.0.3 20051216 (prerelease).

Sat Dec 17 03:30:23 2005  Tanaka Akira  <akr@m17n.org>

	* eval.c (bmcall): fix a GC problem by tail call on
	  IA64 with gcc 4.0.3 20051216 (prerelease).

Fri Dec 16 17:53:45 2005  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* ext/syck/rubyext.c (rb_syck_compile): fixed memory leak.

	* ext/syck/rubyext.c: should protect global variable from GC.

Fri Dec 16 11:44:43 2005  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* ext/syck/rubyext.c (syck_resolver_tagurize): fixed memory leak.

	* ext/syck/rubyext.c (syck_node_type_id_set): should set newly
	  allocated memory instead of RString's internal storage.

	* ext/syck/rubyext.c (syck_scalar_value_set): ditto.

	... these fixes won't fix [ruby-dev:27839]. more work is needed.

Fri Dec 16 04:38:55 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* lib/delegate.rb (Delegator::method_missing): should delegate
	  block as well.

Thu Dec 15 19:57:12 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* lib/cgi.rb (CGI::QueryExtension::MorphingBody): fix criteria to
	  use Tempfile.  A fix from Zev Blut <rubyzbibd at ubit.com>.
	  [ruby-core:06076]

	* string.c: remove global functions work on $_.

Thu Dec 15 12:35:14 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* lib/tmpdir.rb: merged RDoc patch from Eric Hodel <drbrain at
	  segment7.net>.  [ruby-core:06894]

Thu Dec 15 01:33:31 2005  Tanaka Akira  <akr@m17n.org>

	* ext/zlib/zlib.c (zstream_run): fix a GC problem by tail call on
	  x86_64 with gcc 4.0.3 20051111 (prerelease) (Debian 4.0.2-4)

Wed Dec 14 23:50:20 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* lib/rdoc/parsers/parse_c.rb (find_class_comment): fix for class
	  document with prototypes.  [ruby-core:06863]

Wed Dec 14 23:39:53 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* dir.c (has_magic): glob names contain alphabets to enable case fold
	  search.  [ruby-dev:27735]

	* dir.c (Init_Dir): FNM_SYSCASE which is default case fold flag.
	  [ruby-dev:23296]

Wed Dec 14 12:01:26 2005  Tanaka Akira  <akr@m17n.org>

	* marshal.c (r_object0): fix a GC problem for reading a bignum on
	  IA64 with gcc 3.3.5 (Debian 1:3.3.5-13).

Tue Dec 13 12:23:47 2005  Tanaka Akira  <akr@m17n.org>

	* re.c (rb_reg_regcomp): fix a GC problem on x86_64 with
	  gcc 3.3.5 (Debian 1:3.3.5-13).

Tue Dec 13 01:44:16 2005  Tanaka Akira  <akr@m17n.org>

	* array.c (rb_ary_diff): fix a GC problem on IA64 with
	  gcc 3.3.5 (Debian 1:3.3.5-13).
	  When rb_ary_push is called, there was no register which contains
	  `hash' but `&RHASH(hash)->tbl' instead.

Tue Dec 13 00:08:09 2005  Tanaka Akira  <akr@m17n.org>

	* sprintf.c (rb_str_format): fix a GC problem.
	  [ruby-dev:28001]

Mon Dec 12 15:51:22 2005  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* test/openssl/test_ssl.rb (test_parallel): call GC.start to close
	  unused files. [ruby-dev:27981]

Mon Dec 12 09:58:09 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* range.c (range_cover): new method Range#cover? added.  the
	  method name might be changed.  thanks to takano32 at
	  http://www.rubyist.net/~matz/20051210.html#c08 for name
	  suggestion.  [ruby-talk:167182]

Mon Dec 12 00:33:56 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* ext/digest/digest.c (rb_digest_base_s_digest): add volatile to
	  protect temporary context object.  [ruby-dev:27979]

	* ext/iconv/iconv.c (Init_iconv): rb_gc_register_address() should
	  be called before actual variable initialization.
	  [ruby-dev:27986]

Sun Dec 11 23:54:07 2005  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/*: update to support libraries in ActiveTcl8.4.12.0
	  (see ext/tk/ChangeLog.tkextlib).

	* ext/tk/sample/scrollframe.rb: add a new sample.

Sun Dec 11 22:07:58 2005  Masatoshi SEKI  <m_seki@mva.biglobe.ne.jp>

	* test/rinda/test_rinda.rb (test_remote_array_and_hash): pseudo remote
	  objects are protected against GC. [ruby-dev:27911]

Sat Dec 10 01:06:06 2005  Keiju Ishitsuka  <keiju@ruby-lang.org>

	* lib/matrix.rb: add Matrix#determinant_e, Matrix#rank_e.
	  [ruby-dev:27820] and related thread.

Sat Dec 10 00:31:42 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* eval.c (calling_scope_t): gave names to magic numbers for rb_call().
	  [ruby-dev:27978]

Fri Dec  9 23:31:02 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* lib/rexml/encoding.rb (encoding=): give priority to particular
	  conversion to iconv.  [ruby-core:06520]

Fri Dec  9 23:16:51 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* range.c (range_include): return false unless included in numeric
	  range.  fixed: [ruby-dev:27975]

Thu Dec  8 02:07:19 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* eval.c (umethod_bind): adjust invoking class for module method.
	  [ruby-dev:27964]

Thu Dec  8 00:40:52 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (call_trace_func): klass parameter should be a
	  class/module that defines calling method.  [ruby-talk:169307]

Wed Dec  7 17:10:27 2005  Kazuhiro NISHIYAMA  <zn@mbf.nifty.com>

	* sprintf.c (rb_f_sprintf): [ruby-dev:27967]

Wed Dec  7 16:39:18 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* range.c (range_include): use discrete membership for non Numeric
	  values, for example, String.

	* numeric.c (num_scalar_p): new method. [ruby-dev:27936]

	* lib/complex.rb (Complex#scalar?): ditto.

Wed Dec  7 15:31:35 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* sprintf.c (rb_str_format): integer overflow check added.

	* sprintf.c (GETASTER): ditto.

Wed Dec  7 01:02:04 2005  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/README.macosx-aqua: [new document] tips to avoid the known
	  bug on platform specific dialogs of Tcl/Tk Aqua on MacOS X.

	* ext/tk/tcltklib.c: fix bug on switching threads and waiting on the
	  deleted interpreter on vwait and tkwait command.

	* ext/tk/lib/multi-tk.rb: kill the meaningless loop for the deleted Tk
	  interpreter.

	* ext/tk/sample/demos-jp/image3.rb: [bug fix] wrong argument.

	* ext/tk/sample/demos-en/image3.rb: ditto.

	* ext/tk/sample/demos-jp/menu.rb: fix message for MacOS X.

	* ext/tk/sample/demos-jp/menu8x.rb: ditto.

	* ext/tk/sample/demos-en/menu.rb: ditto.

Tue Dec  6 16:48:40 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* gc.c (ruby_xmalloc2): change check condition for integer
	  overflow.  [ruby-dev:27399]

	* gc.c (ruby_xrealloc2): ditto.

Tue Dec  6 16:37:57 2005  Yuya Nishida  <yuya@j96.org>

	* eval.c (exec_under): avoid accessing ruby_frame->prev.
	  [ruby-dev:27948]

Fri Dec  2 19:06:06 2005  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* dir.c (Compare): should not fold double byte alphabet on win9x.

Thu Dec  1 00:50:33 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* eval.c (rb_funcall2): allow to call protected methods.
	  fixed: [ruby-dev:27890]

Wed Nov 30 23:52:17 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* parse.y (struct parser_params): fields common to ripper must be
	  placed at each same offset.

	* parse.y (NEWHEAP, ADD2HEAP): set count after pointer was set.
	  fixed: [ruby-dev:27896]

Wed Nov 30 13:43:07 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* misc/ruby-mode.el (ruby-expr-beg): support $! at the end of
	  expression.   [ruby-dev:27868]

Mon Nov 28 20:24:22 2005  Tanaka Akira  <akr@m17n.org>

	* lib/pp.rb (PP::PPMethods#object_address_group): mask an address with
	  word size.

Tue Nov 29 23:57:05 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* parse.y (struct parser_params): heap must be placed at same offset
	  also in ripper.y.  fixed: [ruby-dev:27846]

	* parse.y (yycompile): prevent vparser from tail call optimization.
	  fixed: [ruby-dev:27851]

	* parse.y (parser_mark): value needs to be marked.
	  fixed: [ruby-dev:27845]

Tue Nov 29 22:45:30 2005  Masatoshi SEKI  <m_seki@mva.biglobe.ne.jp>

	* lib/drb/observer.rb (notify_observers): follow change of observer.rb.
	  fixed: [ruby-core:6796]

Mon Nov 28 20:24:22 2005  Tanaka Akira  <akr@m17n.org>

	* lib/pp.rb (PP::PPMethods#object_address_group): adjust address format.

Mon Nov 28 18:55:22 2005  NAKAMURA Usaku  <usa@ruby-lang.org>

	* ext/socket/socket.c (init_inetsock_internal): remove setting
	  SO_REUSEADDR option on server socket on Cygwin.
	  fixed: [ruby-core:6765] ([ ruby-Bugs-2872 ])

Mon Nov 28 13:11:45 2005  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* win32/win32.c (rb_w32_strerror): remove all CR and LF. (avoid broken
	  error message on bccwin32 + winsock)

Mon Nov 28 09:15:50 2005  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* lib/mkmf.rb (create_makefile): should not change sodir with
	  dir.gsub!. (bccwin32 failed to install third party extensions)
	  [ruby-dev:27834]

Sun Nov 27 05:37:20 2005  Tanaka Akira  <akr@m17n.org>

	* lib/pathname.rb: use File.basename to decompose pathnames.
	  experimental Windows support.

Sun Nov 27 00:56:13 2005  NAKAMURA, Hiroshi  <nahi@ruby-lang.org>

	* lib/wsdl/xmlSchema/complexContent.rb: missing
	  ComplexContent#elementformdefault method.

Sat Nov 26 19:57:45 2005  WATANABE Hirofumi  <eban@ruby-lang.org>

	* dln.c (conv_to_posix_path): should initialize posix.

Fri Nov 25 20:34:56 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* lib/xmlrpc/datetime.rb (DateTime::to_a): comparison with non
	  array-convertible object must return false.

Fri Nov 25 14:34:09 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* range.c (range_max): treat end exclusion without iteration if
	  the end value is an integer.  [ruby-talk:167433]

Fri Nov 25 12:52:57 2005  Kouhei Sutou  <kou@cozmixng.org>

	* lib/rss/rss.rb: added backward compatibility codes.
	* lib/rss/parser.rb: ditto.
	* test/rss/test_parser.rb: ditto.
	* test/rss/test_2.0.rb: ditto.

	* test/rss/test_content.rb: use #__send__ instead of #funcall for
	  no private method.

Fri Nov 25 12:39:56 2005  Kouhei Sutou  <kou@cozmixng.org>

	* lib/rss/rss.rb: improved type conversion.
	* lib/rss/1.0.rb: ditto.
	* lib/rss/0.9.rb: ditto.
	* lib/rss/2.0.rb: ditto.
	* lib/rss/image.rb: ditto.
	* lib/rss/syndication.rb: ditto.

	* test/rss/test_2.0.rb: added type conversion tests.
	* test/rss/test_accessor.rb: ditto.
	* test/rss/test_to_s.rb: ditto.
	* test/rss/test_syndication.rb: ditto.
	* test/rss/test_setup_maker_2.0.rb: ditto.
	* test/rss/test_setup_maker_1.0.rb: ditto.
	* test/rss/test_setup_maker_0.9.rb: ditto.
	* test/rss/test_maker_sy.rb: ditto.
	* test/rss/test_maker_image.rb: ditto.
	* test/rss/test_maker_2.0.rb: ditto.
	* test/rss/test_maker_0.9.rb: ditto.
	* test/rss/test_image.rb: ditto.

	* test/rss/test_maker_1.0.rb: use assert instead of assert_equal.

	* test/rss/rss-assertions.rb: improved type conversion assertions.

Fri Nov 25 10:38:20 2005  Kouhei Sutou  <kou@cozmixng.org>

	* lib/rss/image.rb: added Image prefix.

	* lib/rss/maker/image.rb: ditto.

Fri Nov 25 10:33:02 2005  Kouhei Sutou  <kou@cozmixng.org>

	* test/rss/test_2.0.rb: added RSS 2.0 tests.

	* test/rss/rss-assertions.rb: extended XML stylesheet assertion.

	* lib/rss/0.9.rb: added initialize method.

	* test/rss/test_1.0.rb: cleanup.

Fri Nov 25 10:29:48 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* range.c (range_min): use <=> comparison rather than iteration.
	  [ruby-talk:167420]

	* range.c (range_max): ditto.

Thu Nov 24 01:31:44 2005  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* file.c (w32_io_info): CreateFile failed on Win9x if file was already
	  opened. (FILE_SHARE_READ was needed, but actually I don't understand
	  the flags of CreateFile well...)

Wed Nov 23 23:52:35 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* numeric.c (num_div): use floor rather than rb_Integer().
	  [ruby-dev:27674]

Wed Nov 23 22:34:15 2005  Kouhei Sutou  <kou@cozmixng.org>

	* lib/rss/parser.rb: added entity handling type predicate.
	* lib/rss/rexmlparser.rb: ditto.
	* lib/rss/xmlparser.rb: ditto.
	* lib/rss/xmlscanner.rb: ditto.

	* lib/rss/xmlscanner.rb: more robust entity handling.

	* test/rss/test_parser.rb: added an entity handling test.

Wed Nov 23 20:59:01 2005  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/lib/tk.rb: add Tk.pkgconfig_list and Tk.pkgconfig_get
	  [Tk8.5 feature].

	* ext/tk/lib/tk/text.rb: supports new indices modifiers on a Text
	  widget [Tk8.5 feature].

	* ext/tk/lib/tk/virtevent.rb: add TkNamedVirtualEvent.

	* ext/tk/lib/tk/autoload.rb: ditto.

	* ext/tk/lib/tk/event.rb: add :data key for virtual events [Tk8.5
	  feature].

Wed Nov 23 18:52:45 2005  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* file.c (w32_io_info): should not call GetFileInformationByHandle
	  for pipe.

	* file.c (w32_io_info): checks return value from rb_w32_get_osfhandle.

	* file.c (w32_io_info): now can identify directory on WinNT.

Wed Nov 23 18:46:53 2005  Kouhei Sutou  <kou@cozmixng.org>

	* lib/rss/: use #__send__ instead of #send.
	* test/rss/: ditto.

Wed Nov 23 18:32:56 2005  Kouhei Sutou  <kou@cozmixng.org>

	* test/rss/test_taxonomy.rb: use #reject directory.

Wed Nov 23 18:26:00 2005  Kouhei Sutou  <kou@cozmixng.org>

	* lib/rss/taxonomy.rb: changed class or module prefix to
	  Taxonomy from Taxo.
	* lib/rss/maker/taxonomy.rb: ditto.

Wed Nov 23 18:21:11 2005  Kouhei Sutou  <kou@cozmixng.org>

	* lib/rss/maker/taxonomy.rb: implemented taxonomy module for RSS
	  Maker.
	* lib/rss/taxonomy.rb: supported RSS Maker.
	* lib/rss/maker.rb: added taxonomy module support.

	* lib/rss/rss.rb: adjusted to other element API.
	* lib/rss/1.0.rb: adjusted to other element API but backward
	  compatibility is reserved.
	* lib/rss/0.9.rb: ditto.

	* test/rss/test_maker_taxo.rb: added test case for taxonomy module
	  for RSS Maker.
	* test/rss/test_setup_maker_1.0.rb: added tests for taxo:topic.

	* test/rss/test_setup_maker_1.0.rb: added backward compatibility
	  test.
	* test/rss/test_setup_maker_0.9.rb: ditto.
	* test/rss/test_setup_maker_2.0.rb: ditto.

	* test/rss/rss-testcase.rb: added convenience method for setting
	  up taxo:topic.
	* test/rss/rss-assertions.rb: added assertion for taxo:topic.

	* sample/rss/blend.rb: followed new API.

Wed Nov 23 17:42:24 2005  Kouhei Sutou  <kou@cozmixng.org>

	* lib/rss/rss.rb: fixed a indentation bug.

	* lib/rss/taxonomy.rb: fixed <taxo:topic> #to_s bug.

	* test/rss/test_taxonomy.rb: added a #to_s test.

Wed Nov 23 03:40:49 2005  Guy Decoux  <ts@moulon.inra.fr>

	* re.c (KR_REHASH): should cast to unsigned for 64bit CPU.
	  [ruby-core:06721]

Wed Nov 23 07:26:44 2005  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* ext/openssl/extconf.rb: check for X509V3_EXT_nconf_nid.

	* ext/openssl/ossl_x509ext.c (MakeX509ExtFactory): should use
	  OPENSSL_malloc to allocate X509V3_CTX.

	* ext/openssl/ossl_x509ext.c (ossl_x509extfactory_create_ext): use
	  X509V3_EXT_nconf_nid to avoid SEGV (and to build extensions which
	  values are placed in separate section).

	* test/openssl/test_x509ext.rb: new file.

Wed Nov 23 01:22:57 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* file.c (test_identical): test if two files are identical.

	* file.c (rb_f_test): support DOSISH systems where st_ino is not
	  reliable.  fixed: [ruby-core:06672]

	* win32.h, win32.c (rb_w32_osid): check the running platform.

Tue Nov 22 23:52:06 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* lib/optparse.rb: match incomplete (in current enconding) multibyte
	  string.  http://inamode6.tokuhirom.dnsalias.org/show/1551

Tue Nov 22 18:36:11 2005  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* win32/win32.c (winnt_stat): set mapped errno instead of ENOENT.

Tue Nov 22 14:36:54 2005  NAKAMURA Usaku  <usa@ruby-lang.org>

	* file.c (rb_file_s_basename): skip slashes just after UNC top slashes.

	* test/ruby/test_path.rb (test_dirname, test_basename): follow new
	  spec. and add new tests.

Tue Nov 22 13:30:15 2005  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* win32/win32.c (rb_w32_stat): Dir.chdir('//server/shared');
	  p Dir.glob('*') should work on WinNT. (implemented our own
	  stat(2) on WinNT) [ruby-list:41552] [ruby-dev:27711]

Tue Nov 22 02:31:53 2005  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/lib/tkextlib/tile.rb: bug fix (Tk::Tile::USE_TTK_NAMESPACE
	  is not defined).

Tue Nov 22 01:45:21 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* file.c (rb_file_s_basename): DOSISH_UNC is defined on cygwin but
	  DOSISH is not.  fixed: [ruby-dev:27797]

Mon Nov 21 22:50:48 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* file.c (rb_path_skip_prefix, rb_file_s_basename): UNC without path
	  should not be splitted.  fixed: [ruby-dev:27776] [ruby-dev:27786]

	* parse.y (dsym): prohibit empty symbol literal by interpolation.
	  fixed: [ruby-talk:166529]

Mon Nov 21 16:03:48 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* win32/setup.mk: findstr doesn't exist on win9x.
	  fixed: [ruby-dev:27756]

Sun Nov 20 21:39:27 2005  K.Kosako  <sndgk393 AT ybb.ne.jp>

	* regparse.c (fetch_token_in_cc): tok->escaped should be
	  initialized.  [ruby-dev:27763]

Sun Nov 20 22:34:06 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* parse.y (rb_symname_p): [ not followed by ] is not valid symbol.
	  fixed: [ruby-talk:166520]

Sat Nov 19 19:57:54 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* lib/fileutils.rb (FileUtils::ln): ln documentation fix.
	  [ruby-core:06661]

Sat Nov 19 08:19:38 2005  Zach Dennis  <zdennis@mktec.com>

	* ext/socket/socket.c: Socket Documentation. [ruby-core:6552]

Sat Nov 19 07:34:32 2005  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/lib/tk/font.rb: remove dependency on Ruby's version (1.8
	  or 1.9).

	* ext/tk/lib/tkextlib/ICONS/icons.rb: ditto.

	* ext/tk/sample/tkextlib/treectrl/demo.rb: ditto.

Fri Nov 18 18:07:05 2005  NAKAMURA Usaku  <usa@ruby-lang.org>

	* file.c (rb_file_s_dirname): should use skipprefix for UNC path.
	  pointed out by nobu ([ruby-dev:27744]). fixed: [ruby-core:5076]

Fri Nov 18 17:35:09 2005  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/lib/multi-tk.rb: add restriction to access the entried
	  command table and manipulate other IPs (for reason of security).
	  Now, a IP object can be controlled by only its master IP or the
	  default IP.

	* ext/tk/lib/remote-tk.rb: add restriction to manipulate.

	* ext/tk/tcltklib.c (ip_is_slave_of_p): add TclTkIp#slave_of?(ip)
	  to check manipulability.

	* ext/tk/lib/tk.rb: bug fix on handling of Tcl's namespaces.

	* ext/tk/lib/tk/namespace.rb: ditto.

Fri Nov 18 16:47:33 2005  NAKAMURA Usaku  <usa@ruby-lang.org>

	* file.c (rb_file_s_dirname): added checks for some patterns with drive
	  letter. fixed: [ruby-dev:27738]

	* test/ruby/test_path.rb (test_dirname): added tests for above
	  patterns.

Fri Nov 18 12:19:16 2005  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* win32/win32.h (S_IFIFO): r,w = IO.pipe; r.stat.pipe? now
	  returns true on VisualC++6.

Thu Nov 17 17:58:00 2005  Kouhei Sutou  <kou@cozmixng.org>

	* lib/rss/1.0.rb: added convenience method 'resources'.

	* lib/rss/taxonomy.rb: ditto.

	* test/rss/rss-assertions.rb: added test for 'resources'.

	* test/rss/test_taxonomy.rb: ditto.

Thu Nov 17 17:53:30 2005  Kouhei Sutou  <kou@cozmixng.org>

	* lib/rss/taxonomy.rb: implemented taxonomy module.

	* test/rss/test_taxonomy.rb: added tests for taxonomy support.

Thu Nov 17 17:40:19 2005  Kouhei Sutou  <kou@cozmixng.org>

	* lib/rss/1.0.rb: added rdf:Bag.

Thu Nov 17 13:52:00 2005  Kouhei Sutou  <kou@cozmixng.org>

	* lib/rss/rss.rb: removed needless argument 'prefix'.

	* lib/rss/parser.rb: ditto.

Wed Nov 16 23:24:17 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* common.mk (static-ruby): overridable.

	* ext/extmk.rb (parse_args): force to link extensions statically only
	  if static is given for extstatic.

	* ext/extmk.rb (RUBY, RUBYW): overridable.

Wed Nov 16 01:29:31 2005  Kouhei Sutou  <kou@cozmixng.org>

	* lib/rss/trackback.rb: added TrackBack prefix.

	* lib/rss/maker/trackback.rb: ditto.

Wed Nov 16 01:26:13 2005  Kouhei Sutou  <kou@cozmixng.org>

	* lib/rss/rss.rb (RSS::VERSION): 0.1.5 -> 0.1.6.

	* test/rss/test_version.rb (RSS::TestVersion#test_version): ditto.

Tue Nov 15 23:54:24 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* file.c (file_load_ok): eaccess() returns 0 on success.
	  fixed: [ruby-dev:27713]

Tue Nov 15 16:36:03 2005  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* array.c (rb_ary_fill): previous commit disabled this usage:

	    a = [0,1,2,3,4,5,6,7,8,9]
	    a.fill {|i| a[i] * 10} #=> [nil, nil, ...., nil]

	  previous commit has the advantage of early garbage collection, but
	  potentially this would break some script. so I reverted behavior.

Tue Nov 15 16:15:23 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* file.c (file_load_ok): use eaccess() instead of actually opening
	  the file.  [ruby-talk:156378]

	* lib/jcode.rb (String::reverse): add new methods.
	  [ruby-list:41245]

Tue Nov 15 15:49:34 2005  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* array.c (rb_ary_fill): tail elements were vanished when the middle
	  part of array was filled. (ie: [0,1,2,3,4].fill(-1,2,1) => [0,1,-1])

	* test/ruby/test_array.rb (test_fill): added.

Tue Nov 15 14:39:16 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* array.c (rb_ary_fill): should adjust array length correctly when
	  an array is expanded in the fill process.  [ruby-core:06625]

Mon Nov 14 23:49:57 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* file.c (rb_file_s_readlink): ERANGE will occur only on GPFS.
	  [ruby-dev:27699]

Mon Nov 14 17:36:22 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* array.c (rb_ary_first): RDoc update from Daniel Berger
	  <djberg96@yahoo.com>.  [ruby-core:06577].

Sun Nov 13 10:55:24 2005  Minero Aoki  <aamine@loveruby.net>

	* lib/uri/common.rb (escape): regard second argument as a
	  character set. [ruby-dev:27692]

Sat Nov 12 08:36:40 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* configure.in, eval.c, intern.h: check fd_mask type.

	* configure.in (socketpair): need to be checked.

Fri Nov 11 19:53:47 2005  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* eval.c, intern.h: failed to compile where NFDBITS is defined but
	  howmany() is not defined. [ruby-dev:27680]

	* io.c (is_socket): failed to compile where S_ISSOCK is not defined.

	* io.c (pipe_open): failed to compile where socketpair is not supported.

Fri Nov 11 08:20:56 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* Makefile.in (OUTFLAG): keep trailing spaces.  [ruby-dev:27666]

	* mkconfig.rb: substitution references added.

Fri Nov 11 07:39:49 2005  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* configure.in: undef HAVE_LINK on BeOS. (link(2) always returns
	  EINVAL, and this causes error in test/fileutils.)

	* file.c: override chown(2) and fchown(2) on BeOS. (these functions
	  should not change user/group id if -1 is passed as corresponding
	  argument, and this causes error in test/fileutils too)
	  [ruby-dev:27672]

Thu Nov 10 21:05:03 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* lib/shellwords.rb: fix for blank but not empty string.
	  fixed: [ruby-dev:27663]

Wed Nov  9 08:39:38 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* lib/shellwords.rb: refactored.  [ruby-core:06581]

Tue Nov  8 17:35:53 2005  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* intern.h, eval.c (rb_thread_signal_raise): constified.

	* signal.c: cosmetic change.

Tue Nov  8 15:32:27 2005  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* lib/drb/ssl.rb (DRb::SSLConfig#accept): fixed typo.
	  [ruby-dev:27560] [ruby-core:4627]

Mon Nov  7 20:54:57 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* ext/iconv/iconv.c: iconvctl() support.  [EXPERIMENTAL]

Mon Nov  7 16:23:23 2005  NAKAMURA Usaku  <usa@ruby-lang.org>

	* ext/openssl/ossl.h: need to include winsock2.h before including
	  windows.h by some openssl headers.

Mon Nov  7 13:43:51 2005  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/stubs.c (_nativethread_consistency_check): use simpler
	  (low cost) way to check whether the Tcl interpreter was compiled
	  with threads enabled of not.

	* ext/tk/tcltklib.c: reduce warnings.

	* ext/tk/tkutil/tkutil.c: ditto.

Mon Nov  7 00:06:12 2005  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* lib/yaml.rb: removed :nodoc: to generate Kernel doc. [ruby-core:6324]

Sun Nov  6 23:39:13 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* ext/iconv/iconv.c (Iconv::BrokenLibrary): exception when detected a
	  bug of underlying library.

Sun Nov  6 21:43:22 2005  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* ext/tk/stubs.c (ruby_tcl_create_ip_and_stubs_init): should touch
	  interpreter after initialization is done. [ruby-dev:27638]

Sun Nov  6 20:13:27 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* file.c (rb_file_s_readlink): readlink(2) on AIX fails with ERANGE if
	  buffer size is less than required.  fixed: [ruby-dev:27634]

Sat Nov  5 13:42:50 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* configure.in, cygwin/GNUmakefile.in (mingw): use def file to alias
	  symbols.  [ruby-dev:27532]

	* bcc32/mkexports.rb, win32/mkexports.rb: make aliases in DLL.

	* win32/win32.c, win32/win32.h: replace symbols only when RUBY_EXPORT
	  is defined.

Thu Nov  3 07:57:39 2005  Minero Aoki  <aamine@loveruby.net>

	* lib/open-uri.rb (open_loop): find_proxy should return nil when
	  proxy does not exist. [ruby-dev:27630]

Wed Nov  2 20:25:28 2005  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/extconf.rb: ext/tk/extconf.rb: change the check parameter
	  for Win32.

Wed Nov  2 19:03:06 2005  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/tcltklib.c (ip_rbUpdateObjCmd, ip_rb_threadUpdateObjCmd):
	  passed improper flags to DoOneEvent().

	* ext/tk/tkutil/tkutil.c: use rb_obj_respond_to() instead of
	  rb_respond_to().

Tue Nov  1 14:20:11 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (rb_call_super): should call method_missing if super is
	  called from Kernel method.

	* eval.c (exec_under): frame during eval should preserve external
	  information.

Tue Nov  1 10:48:49 2005  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* ext/openssl/extconf.rb: should check ERR_peek_last_error().
	  [ruby-dev:27597]

	* ext/openssl/ossl.c (ossl_raise): ditto.

Mon Oct 31 17:34:46 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* configure.in: use proper option for Sun linker. A patch from
	  Shinya Kuwamura <kuwa at labs.fujitsu.com>.  [ruby-dev:27603]

Mon Oct 31 05:46:08 2005  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* ext/openssl/ossl_cipher.c (ossl_cipher_update): input data must
	  not be empty. [ruby-talk:161220]

	* test/openssl/test_cipher.rb: add test for Cipher#update("").

Mon Oct 31 05:38:26 2005  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* lib/webrick/httpservlet/cgihandler.rb
	  (WEBrick::HTTPServlet::CGIHandler#do_GET): the value of Set-Cookie:
	  header field should be splited into each cookie.  [ruby-Bugs:2199]

	* lib/webrick/cookie.rb (WEBrick::Cookie.parse_set_cookie): new method
	  to parse the value of Set-Cookie: header field.

	* test/webrick/test_cookie.rb, test/webrick/test_cgi.rb,
	  test/webrick/webrick.cgi: add some test for cookie.

Mon Oct 31 02:33:25 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* numeric.c (fix_rshift): RDoc fix.  [ruby-core:6351]

	* util.h (strtod): add #undef for platforms defines strtod()
	  macro.   [ruby-dev:27563]

Mon Oct 31 02:31:41 2005  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* test/ruby/test_float.rb (test_precision): test by assert_in_delta.
	  [ruby-dev:27575]

Sat Oct 29 01:58:25 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* ext/etc/etc.c: document update from mathew <meta@pobox.com>.
	  [ruby-core:06473]

	* ext/fcntl/fcntl.c: ditto.

Sat Oct 29 16:56:03 2005  Tadayoshi Funaba  <tadf@dotrb.org>

	* lib/date.rb: added seven predicates sunday? to saturday?.

	* lib/date.rb: added two methods {prev,next}_month,
	  that are almost same as << and >>.

Thu Oct 27 20:34:43 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* enumerator.c (enumerator_allocate): allow subclassing.

Thu Oct 27 16:45:31 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* string.c (scan_once): wrong condition to use mbclen2().
	  [ruby-dev:27535]

Thu Oct 27 11:53:17 2005  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* missing.h, missing/memcmp.c, missing/memmove.c:
	  ANSI compatible interface.

Wed Oct 26 09:15:48 2005  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* ext/syck/implicit.c (syck_type_id_to_uri): should return
	  newly allocated memory. otherwise, type_id will be freed
	  twice. [ruby-dev:27384] [ruby-core:6385]

Wed Oct 26 01:58:19 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* configure.in (RUBY_EXTERN): macro to export symbols in shared
	  library.  [ruby-core:05528]

	* defines.h, {bcc32,win32,wince}/Makefile.sub (RUBY_EXTERN): moved to
	  configuration pass.

	* ext/extmk.rb (extmake): RUBY_EXTERN for static linked extensions.

Tue Oct 25 20:06:59 2005  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* ruby.h (Qfalse, Qtrue, Qnil, Qundef): make sure these immediate
	  values have VALUE type. there is an environment where sizeof(VALUE)
	  != sizeof(int) like IA64. if 32bit integer (Qtrue) is passed to ANYARGS
	  and received by 64bit integer (VALUE), upper bits may have garbage value.
	  [ruby-dev:27513]

Tue Oct 25 15:32:00 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* lib/rational.rb: applied documentation patch from Gavin Sinclair
	  <gsinclair@gmail.com>.  [ruby-core:06364]

	* lib/irb.rb (IRB::Irb::eval_input): handle prompts with newlines
	  in irb auto-indentation mode.  [ruby-core:06358]

Tue Oct 25 14:21:46 2005  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* gc.c (garbage_collect): sorry, previous commit was incorrect.
	  [ruby-core:6386]

Tue Oct 25 13:40:16 2005  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* gc.c (garbage_collect): return now whether there're rooms for new
	  objects, rather than whether GC run. fixed: [ruby-core:6376]

Tue Oct 25 02:12:08 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* lib/rdoc/markup/simple_markup.rb (SM::SimpleMarkup::LABEL_LIST_RE):
	  reduce redundant backtrack.  [ruby-talk:161771]

Tue Oct 25 00:35:33 2005  Masatoshi SEKI  <m_seki@mva.biglobe.ne.jp>

	* lib/rinda/*: RDoc documentation from Eric Hodel
	  <drbrain@segment7.net> added.

Mon Oct 24 21:14:29 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* configure.in, io.c: use sys/syscall.h if syscall.h is not available.
	  [ruby-core:06247]

Mon Oct 24 20:38:25 2005  NAKAMURA Usaku  <usa@ruby-lang.org>

	* ext/Win32API/lib/win32/resolv.rb (get_info): support multiple DNS.
	  fixed: [ruby-list:40058], [ruby-dev:27479]

Mon Oct 24 11:01:11 2005  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/lib/tk/canvas.rb (TkCanvasItemConfig::__item_val2ruby_optkeys):
	  typo fixed.  [ruby-talk:162187]

	* ext/tk/lib/tk/menu.rb (TkMenuEntryConfig::__item_val2ruby_optkeys):
	  ditto.  [ruby-core:06359]

Mon Oct 24 07:57:56 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* ext/tk/lib/tk/canvas.rb (TkCanvasItemConfig::__item_val2ruby_optkeys):
	  typo fixed.  [ruby-talk:162187]

	* ext/tk/lib/tk/menu.rb (TkMenuEntryConfig::__item_val2ruby_optkeys):
	  ditto.  [ruby-core:06359]

	* lib/matrix.rb (Matrix::initialize): use funcall instead of send
	  to allow private methods to be called.  A report from
	  Jean-Claude Arbaut <jcarbaut@laposte.net>.  [ruby-core:06359]

Mon Oct 24 00:41:18 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* time.c (time_sunday): added predicate methods for the days of the
	  week.  [ruby-list:41340]

Sun Oct 23 07:11:11 2005  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/extconf.rb: improve messages [ruby-core:06325].

	* ext/tk/lib/tk.rb, ext/tk/lib/tk/canvas.rb, ext/tk/lib/tk/entry.rb,
	  ext/tk/lib/tk/frame.rb, ext/tk/lib/tk/image.rb,
	  ext/tk/lib/tk/itemconfig.rb, ext/tk/lib/tk/labelframe.rb,
	  ext/tk/lib/tk/listbox.rb, ext/tk/lib/tk/menu.rb,
	  ext/tk/lib/tk/radiobutton.rb, ext/tk/lib/tk/scale.rb,
	  ext/tk/lib/tk/spinbox.rb, ext/tk/lib/tk/text.rb,
	  ext/tk/lib/tk/toplevel.rb: improve conversion of option values.

	* ext/tk/lib/tkextlib/*: ditto.

	* ext/tk/lib/tkextlib/*: update to support ActiveTcl8.4.11.2.

	* ext/tk/lib/tkextlib/trofs/*: support Trofs 0.4.3.

	* ext/tk/lib/tkextlib/tile/*: support Tile 0.7.2.

	* ext/tk/lib/tkextlib/vu/*: support vu 2.3.0.

	* ext/tk/lib/tkextlib/tcllib/*: support Tcllib 1.8 (Tklib 0.3).

Sat Oct 22 23:54:07 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* ext/extmk.rb, lib/mkmf.rb (with_config): support --with-extension
	  options.  [ruby-dev:27449]

Sat Oct 22 14:25:43 2005  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* util.[hc] (ruby_add_suffix): constified.

	* util.[hc] (ruby_scan_{oct,hex}): fixed typo. (renamed from
	  scan_{oct,hex})

	* util.c: almostly ANSI styled. (except for functions depending on
	  macro and K&R technique)

Sat Oct 22 13:26:57 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* object.c (sym_inspect), parse.y (parser_yylex, rb_symname_p): check
	  if valid as a symbol name more strictly.  [ruby-dev:27478]

	* test/ruby/test_symbol.rb: tests for [ruby-core:03573].

	* time.c (rb_strftime): removed meaningless volatile modifiers, and
	  concatenate successive nul characters at once.  [ruby-dev:27472]

	* ext/tk/lib/tk/font.rb, ext/tk/lib/tkextlib/ICONS/icons.rb,
	  ext/tk/sample/tkextlib/treectrl/demo.rb, lib/net/imap.rb,
	  lib/rss/parser.rb, test/rss/test_content.rb,
	  test/rss/test_dublincore.rb, test/rss/test_syndication.rb,
	  test/rss/test_trackback.rb, test/ruby/test_eval.rb,
	  test/socket/test_socket.rb, test/socket/test_udp.rb:
	  Object#fcall was renamed as Object#funcall.

Sat Oct 22 10:08:28 2005  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* missing.h, missing/*.c: SUSv3 compatible strcasecmp and strncasecmp,
	  ANSI compatible strtol and strtoul, and ANSI styled other functions.

Fri Oct 21 19:16:08 2005  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* rubysig.h (CHECK_INTS): fixed typo. (I believe bit-or is improper)

Fri Oct 21 17:49:32 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* bin/erb (ERB::Main::run): typo fixed.  [ruby-core:06337]

Fri Oct 21 15:42:28 2005  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* intern.h, struct.c (rb_struct_iv_get): constified.

	* marshal.c: avoid one VC++6 warning for implicit conversion
	  from int to char.

	* ruby.h: ANSI styled.

	* bcc32/Makefile.sub (HAVE_HYPOT): added.

	* ext/socket/extconf.rb: BeOS is only one platform should call
	  closesocket, so check __BEOS__ macro directly. (I was worried
	  accidently HAVE_CLOSESOCKET is defined on windows again because
	  it has it)

	* ext/socket/{getaddrinfo.c,socket.c}: ditto.

	... these are all cosmetic changes.

Fri Oct 21 15:23:23 2005  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* bignum.c (bignew_1): convertion from `int' to `char' discards
	  upper bits, (ie. (char)0xff00 -> 0) so it's better to test if
	  nonzero and set 0 or 1 instead of simply casting ... as a flag usage.
	  (but I believe this won't cause actual bug in current implementation)
	  [ruby-dev:27055]

	* time.c: should use LONG_LONG instead of `long long'.

Thu Oct 20 22:22:49 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* parser.y (struct parser_params): parser never modify input string.

	* ext/ripper/tools/preproc.rb (prelude): do not append surplus
	  newlines to fix line numbers.

Thu Oct 20 11:41:57 2005  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* class.c, eval.c, hash.c, st.c, variable.c: changed /* ??? */ stuff
	  protoize generated to ANYARGS.

Thu Oct 20 11:18:11 2005  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* eval.c, file.c, ruby.c: removed strchr, strrchr, strstr definition
	  because they are defined in missing.h.

	* missing.h, missing/strchr.c, missing/strstr.c: ANSI styled.

Thu Oct 20 09:36:06 2005  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* lib/mkmf.rb (create_makefile): Borland make seems not to allow
	  empty dependency list. If this change is not good, please correct
	  it.

Thu Oct 20 07:55:09 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* lib/mkmf.rb (create_makefile): get rid of a restriction
	  of Borland make.  fixed: [ruby-dev:27460]

	* ext/ripper/depend: ditto.

Wed Oct 19 23:58:03 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* lib/mkmf.rb (create_makefile): do not create unnecessary empty
	  directories.  fixed: [ruby-dev:27451]

Wed Oct 19 08:28:32 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* file.c (rb_file_join): elements may contain null pointer strings.
	  report and fixed by Lloyd Zusman (hippoman): [ruby-core:06326]

Wed Oct 19 02:34:33 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* enumerator.c, eval.c, gc.c, parse.y, regparse.c, sjis.c, time.c:
	  made internal symbols static.  [ruby-dev:27435]

Tue Oct 18 10:58:27 2005  NAKAMURA Usaku  <usa@ruby-lang.org>

	* ext/dl/depend, ext/dl/extconf.rb, ext/socket/depend,
	  ext/socket/extconf.rb: shouldn't define DESTCLEANFILES in depend,
	  use $distcleanfiles in extconf.rb.

	* win32/Makefile.sub (distclean-local): should remove .config.h.time.

Mon Oct 17 09:42:50 2005  NAKAMURA Usaku  <usa@ruby-lang.org>

	* mkconfig.rb: fixup configure_args for mswin32 configure.

	* win32/configure.bat (srcdir, target): ditto.

Mon Oct 17 05:01:50 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* env.h: move struct METHOD and struct BLOCK from eval.c to
	  support NodeWrap and ParseTree.

Sun Oct 16 22:16:51 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* ext/extmk.rb: omit non-existing directories.

Sun Oct 16 14:40:54 2005  Masatoshi SEKI  <m_seki@mva.biglobe.ne.jp>

	* lib/rinda/rinda.rb (Rinda::Tuple#initialize): check remote hash
	  tuple. fixed: [ruby-list:41227]

	* test/rinda/test_rinda.rb: test it.

Sun Oct 16 03:38:07 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* rubysig.h (CHECK_INTS): prevent signal handler to run during
	  critical section.  [ruby-core:04039]

	* eval.c (load_wait): need not to call rb_thread_schedule()
	  explicitly.  [ruby-core:04039]

	* eval.c (rb_thread_schedule): clear rb_thread_critical.
	  [ruby-core:04039]

Sun Oct 16 00:13:14 2005  NAKAMURA Usaku  <usa@ruby-lang.org>

	* win32/configure.bat: remove unnecessary line which prevents
	  creating Makefile.

Sat Oct 15 23:52:07 2005  Shugo Maeda  <shugo@ruby-lang.org>

	* lib/net/ftp.rb: (getbinaryfile): allow nil for localfile, and
	  returns retrieved data if localfile is nil.

	* lib/net/ftp.rb: (gettextfile): ditto.

Sat Oct 15 19:51:29 2005  Masatoshi SEKI  <m_seki@mva.biglobe.ne.jp>

	* bin/erb: typo fixed, again. thanks, Doug Kearns.

Fri Oct 14 23:09:31 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* win32/Makefile.sub (MKFILES): update MKFILES if configure files get
	  changed.

	* win32/configure.bat, win32/setup.mak (configure_args): store
	  arguments to configure files.

Fri Oct 14 22:05:45 2005  NAKAMURA Usaku  <usa@ruby-lang.org>

	* win32/win32.c (ioctl): should set errno.

Fri Oct 14 16:39:37 2005  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* lib/webrick/config.rb (Config::FileHandler): :UserDir should be nil.
	  It is harmful to permit the access to ~/public_html by default.
	  suggested by Hiroyuki Iwatsuki.

Fri Oct 14 04:58:38 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (rb_obj_instance_exec): create instance_exec and
	  module_exec which pass arguments to the block.

	* eval.c (rb_f_funcall): rename fcall to funcall to follow
	  tradition.

Thu Oct 13 23:29:51 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* parse.y (HEAPCNT): bison allocates indivisible size.
	  fixed: [ruby-core:06261]

	* io.c, pack.c, ext/syck/rubyext.c, ext/syck/syck.h, missing/isinf.c:
	  get rid of warnings.  fixed: [ruby-core:06247]

Wed Oct 12 12:51:56 2005  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* ext/openssl/ossl.c (Init_openssl): should call
	  OpenSSL_add_ssl_algorithms().

Wed Oct 12 11:08:54 2005  WATANABE Hirofumi  <eban@ruby-lang.org>

	* file.c (rb_f_test): typo in RDoc comments.

Tue Oct 11 21:41:58 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* configure.in (RUBY_FUNC_ATTRIBUTE): check prefixed attribute form
	  first.  [ruby-dev:27398]

	* array.c, enum.c, eval.c, util.c: safer function pointer usage.
	  fixed: [ruby-core:06143]

	* util.h (qsort): removed the definition incompatible to ANSI.
	  fixed: [ruby-core:06147]

	* eval.c (rb_obj_respond_to): check if obj responds to the given
	  method with the given visibility.  [ruby-dev:27408]

	* eval.c (rb_respond_to): conform to Object#respond_to?.  [ruby-dev:27411]

Tue Oct 11 00:01:21 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* st.c (st_free_table): do not call free() but xfree().
	  [ruby-core:06205]

Sat Oct  8 19:49:42 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* eval.c (Init_Binding): add Binding#dup method.  [yarv-dev:666]

	* io.c (rb_io_init_copy): clear PREP flag for copied IO.
	  fixed: [ruby-dev:27371]

	* parse.y (rb_parser_malloc, rb_parser_free): manage parser stack on
	  heap.  [ruby-list:41199]

	* parse.y (ripper_initialize): use rb_respond_to().

	* ext/ripper/depend (check): get rid of re-generating ripper.y always.

	* ext/iconv/charset_alias.rb: parse config.charset_alias file directly.

	* ext/nkf/lib/kconv.rb (Kconv.conv): get rid of nil.to_a.

	* lib/scanf.rb (Scanf::FormatSpecifier#letter, #width): use matched
	  substring directly.

	* test/ruby/test_assignment.rb, test/ruby/test_iterator.rb: followed
	  change of sample/test.rb.

	* test/net/http/test_http.rb: removed superfluous splatting stars.

Fri Oct  7 16:41:43 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (splat_value): call rb_Array() to convert svalue to
	  values.  [ruby-dev:27397]

Fri Oct  7 09:54:00 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* lib/cgi.rb (CGI::Cookie::parse): Cookies from Nokia devices may
	  not be parsed correctly.  A patch from August Z. Flatby
	  (augustzf) in [ruby-Patches-2595].  [ruby-core:06183]

Thu Oct  6 22:51:30 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* object.c (rb_Array): Array() to raise error for objects without
	  to_ary, nor to_a.

	* object.c (nil_to_a): revert NilClass#to_a.

Thu Oct  6 20:10:38 2005  Minero Aoki  <aamine@loveruby.net>

	* ext/strscan/strscan.c (strscan_free): remove useless code.
	  [ruby-dev:26368] [ruby-dev:27389]

Thu Oct  6 01:02:19 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* range.c (rb_range_beg_len): should return Qfalse for non-range
	  object.

Wed Oct  5 04:42:38 2005  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* lib/xmlrpc/server.rb (XMLRPC::Server#initialize): should mount the
	  servlet on "/".

Wed Oct  5 04:06:49 2005  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* lib/xmlrpc/server.rb (XMLRPC::Server#serve): delete wrong call
	  of "join".

Mon Oct  3 00:04:00 2005  Kazuhiro NISHIYAMA  <zn@mbf.nifty.com>

	* pack.c (EXTEND16): [ruby-dev:27383]

Sat Oct  1 23:55:24 2005  NAKAMURA Usaku  <usa@ruby-lang.org>

	* win32/win32.c (do_select, rb_w32_select): brush up.

Sat Oct  1 12:57:02 2005  Tanaka Akira  <akr@m17n.org>

	* bignum.c (rb_big_rand): removed.  [ruby-dev:25405]

Sat Oct  1 01:46:51 2005  Tanaka Akira  <akr@m17n.org>

	* lib/open-uri.rb (OpenURI.open_loop): prohibit multiple proxy
	  options.

Thu Sep 29 10:26:18 2005  Tanaka Akira  <akr@m17n.org>

	* ext/dl/cptr.c (rb_dlptr_s_to_ptr): abolish sizeof(FILE).
	  [ruby-dev:27317]

Thu Sep 29 10:15:14 2005  Tanaka Akira  <akr@m17n.org>

	* lib/open-uri.rb (:proxy_http_basic_authentication): new option.

Thu Sep 29 07:22:05 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* eval.c (rb_f_send): underscores need to be escaped.
	  fixed by Doug Kearns.  [ruby-core:06053]

Thu Sep 29 00:57:35 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* eval.c (ev_const_get), variable.c (rb_const_get_0): retry only when
	  autoload succeeded.

	* variable.c (rb_autoload_load): now return true if autoload
	  succeeded.  fixed: [ruby-dev:27331]

Wed Sep 28 23:40:04 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* file.c (rb_stat_inspect): constified.

Wed Sep 28 15:12:28 2005  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* lib/webrick/cgi.rb (WEBrick::CGI#start): req.query_string should
	  refer the value of QUERY_STRING. [ruby-list:41186]

	* lib/webrick/httprequest.rb (WEBrick::HTTPRequest#query_string=):
	  add new method.

Wed Sep 28 10:45:44 2005  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/tcltklib.c: cannot compile with Tcl/Tk8.0.x [ruby-dev:27335].

Wed Sep 28 07:56:52 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* lib/yaml/basenode.rb (YAML::BaseNode::match_segment): fix typo.
	  [ruby-dev:27237], [ruby-core:05854]

	* lib/yaml/tag.rb (Module#yaml_as): suppress warnings.

	* lib/yaml/types.rb (YAML::PrivateType, YAML::DomainType): ditto.

Wed Sep 28 03:16:41 2005  NAKAMURA Usaku  <usa@ruby-lang.org>

	* rubysig.h: fixed build problem with --enable-pthread on platforms
	  which don't have setitimer().

Mon Sep 26 22:32:13 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (set_trace_func): add rb_secure(4) to prevent adding
	  tracing function.

Mon Sep 26 20:59:28 2005  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* parse.y: changed to ANSI function style.

Sun Sep 25 12:02:04 2005  Masatoshi SEKI  <m_seki@mva.biglobe.ne.jp>

	* bin/erb: typo fixed.

Sun Sep 25 11:54:11 2005  Masatoshi SEKI  <m_seki@mva.biglobe.ne.jp>

	* lib/rinda/tuplespace.rb (Rinda::TemplateEntry::initialize): pull
	  up method. Tabs converted to spaces.

Sun Sep 25 09:34:22 2005  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* parse.y: replaced `foo _((boo))' with `foo(boo)'.

Sun Sep 25 08:19:53 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* test/rss/test_content.rb, test/rss/test_syndication.rb: use fcall
	  instead of send in order to override visibility.

Sun Sep 25 01:46:43 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* misc/ruby-mode.el (ruby-calculate-indent): arrange deep-indent
	  closing parenthesis at same column as the opening.

Sun Sep 25 01:33:41 2005  Tanaka Akira  <akr@m17n.org>

	* process.c (proc_setrlimit): make the third argument (rlim_max)
	  optional.

Sun Sep 25 00:42:11 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* misc/ruby-mode.el (ruby-expr-beg): deal with heredoc separately.
	  fixed: [ruby-list:41168]

	* misc/ruby-mode.el (ruby-calculate-indent): not to deepen indent
	  level for continuous line inside parentheses.
	  http://nabeken.tdiary.net/20050915.html#p02

Sat Sep 24 21:19:39 2005  Minero Aoki  <aamine@loveruby.net>

	* ext/strscan/strscan.c: document enhancement.

	* ext/strscan/strscan.c: update copyright year.

	* ext/strscan/strscan.c: update coding style.

Sat Sep 24 20:20:05 2005  Minero Aoki  <aamine@loveruby.net>

	* test/net/http/test_http.rb (teardown): Net::HTTP.version_1_1 breaks
	  many other tests; ensure that Net::HTTP is version 1.2 after test.
	  [ruby-dev:27312]

Sat Sep 24 11:44:28 2005  Minero Aoki  <aamine@loveruby.net>

	* test/net/http/test_http.rb: new file.

Sat Sep 24 08:54:05 2005  Minero Aoki  <aamine@loveruby.net>

	* lib/fileutils.rb (cd): no longer accept :noop option, related
	  code is useless. [ruby-core:05858] [ruby-Bugs:2494]

Sat Sep 24 08:30:00 2005  Tanaka Akira  <akr@m17n.org>

	* lib/pathname.rb (Pathname#sub): new method.

Sat Sep 24 08:29:36 2005  Minero Aoki  <aamine@loveruby.net>

	* lib/fileutils.rb: fix visibility of FileUtils::NoWrite, Verbose,
	  DryRun. [ruby-core:05954]

	* test/fileutils/test_nowrite.rb: test it.

	* test/fileutils/test_dryrun.rb: new file.

	* test/fileutils/test_verbose.rb: new file.

Sat Sep 24 07:59:01 2005  Minero Aoki  <aamine@loveruby.net>

	* sample/ripper/colorize.rb: removed (replaced by ruby2html.rb).

	* sample/ripper/ruby2html.rb: added.

Sat Sep 24 06:35:15 2005  Minero Aoki  <aamine@loveruby.net>

	* ext/ripper: no longer generates .rb files.

	* parse.y (Init_ripper): ripper_init_eventids*() takes 1 argument,
	  self (class Ripper).

	* ext/ripper/depend: target removed: `lib/ripper/core.rb'.

	* ext/ripper/depend: new target `eventids2table.c'.

	* ext/ripper/depend: new target `check'.

	* ext/ripper/eventids2.c: include eventids2table.c.

	* ext/ripper/eventids2.c: initialize SCANNER_EVENT_TABLE.

	* ext/ripper/extconf.rb: update $cleanfiles list.

	* ext/ripper/tools/generate.rb: no longer generate ripper/core.rb.

	* ext/ripper/tools/generate.rb: new mode `check'.

	* ext/ripper/tools/generate.rb: new mode `eventids2table'.

	* ext/ripper/lib/ripper/core.rb.in: removed.

	* ext/ripper/lib/ripper/core.rb: added.

	* ext/ripper/lib/ripper/filter.rb: update copyright year.

	* ext/ripper/lib/ripper/lexer.rb: ditto.

	* ext/ripper/lib/ripper/sexp.rb: ditto.

Sat Sep 24 02:40:20 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* lib/delegate.rb: document update from James Edward Gray II
	  <james@grayproductions.net>.  [ruby-core:05942]

Sat Sep 24 02:05:51 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* process.c (proc_daemon): should restrict execution on levels
	  higher than $SAFE=2.  suggested by URABE Shyouhei
	  <shyouhei@ice.uec.ac.jp>.

Fri Sep 23 20:10:35 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* ext/ripper/tools/generate.rb, ext/ripper/tools/preproc.rb: StringIO
	  is not available for miniruby.  fixed: [ruby-dev:27307]

Fri Sep 23 17:36:48 2005  Masaki Suketa  <masaki.suketa@nifty.ne.jp>

	* ext/win32ole/win32ole.c: avoid core dump with WIN32OLE_EVENT.
	  [ruby-dev:27133]

Fri Sep 23 16:27:39 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* lib/forwardable.rb: replaced by new implementation from
	  <Daniel.Berger@qwest.com>.  [ruby-core:05899]

Fri Sep 23 07:07:47 2005  Minero Aoki  <aamine@loveruby.net>

	* test/ripper/depend: use --output option instead of redirect;
	  nmake does not remove a target when the target file is created by
	  redirect. [ruby-dev:26466]

	* test/ripper/tools/preproc.rb: new option --output.

Fri Sep 23 06:57:52 2005  Minero Aoki  <aamine@loveruby.net>

	* test/ripper/tools/generate.rb: check parser event arity.

	* test/ripper/tools/generate.rb: detect crash of parser-event-IDs
	  and scanner-event-IDs.

Fri Sep 23 06:01:30 2005  Minero Aoki  <aamine@loveruby.net>

	* test/ruby/test_file.rb: check File#chown(nil,nil).
	  [ruby-dev:27140]

Fri Sep 23 05:57:23 2005  Minero Aoki  <aamine@loveruby.net>

	* ext/ripper: refactoring code generation tools. [ruby-dev:27247]
	  [ruby-dev:27273]

	* ext/ripper/depend: use generate.rb.

	* ext/ripper/lib/ripper/core.rb: removed.

	* ext/ripper/tools/generate-eventids1.rb: removed (code moved to
	  generate.rb).

	* ext/ripper/tools/generate-ripper_rb.rb: removed (code moved to
	  generate.rb).

	* ext/ripper/tools/list-parse-event-ids.rb: removed (code moved to
	  generate.rb).

	* ext/ripper/tools/list-scan-event-ids.rb: removed (code moved to
	  generate.rb).

	* ext/ripper/lib/ripper/core.rb: removed.

	* ext/ripper: refactoring tests. [ruby-dev:27273]

	* ext/ripper/test/check-event-arity.rb: removed (code moved to
	  tools/generate.rb).

	* ext/ripper/test/check-event-coverage.rb: removed (code moved to
	  test/ripper/test_parser_events.rb).

	* ext/ripper/test/check-scanner-event-coverage.rb: removed (code
	  moved to test/ripper/test_scanner_events.rb).

	* ext/ripper/test/list-called-events.rb: removed.

	* ext/ripper/test/src_rb: removed.

	* ext/ripper/test/validate.rb: removed.

	* test/ripper/test_scanner_events.rb: check event coverage.

	* ext/ripper/lib/ripper/core.rb.in: update copyright year.

Thu Sep 22 23:40:19 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* lib/mkmf.rb (find_executable0): default path if environment is not
	  set.  [ruby-dev:27281]

	* ext/ripper/extconf.rb (have_command): replaced with find_executable.

Thu Sep 22 17:31:48 2005  Shugo Maeda  <shugo@ruby-lang.org>

	* test/readline/test_readline.rb (TestReadline::replace_stdio):
	  merged the patch of [ruby-dev:25232] instead of [ruby-dev:25223].
	  (merged from ruby_1_8 branch)

Wed Sep 21 23:30:44 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* lib/mkmf.rb (configuration): generalized nmake dependent code.

Wed Sep 21 14:16:30 2005  NAKAMURA Usaku  <usa@ruby-lang.org>

	* ext/ripper/depend (SUFFIXES): no longer needed.

	* ext/ripper/depend (c): avoid nmake problem. fixed [ruby-dev:27191]

Wed Sep 21 08:52:25 2005  why the lucky stiff  <why@ruby-lang.org>

	* ext/syck/token.c: correctly compute indentation of a block
	  scalar's parent node. [ruby-talk:150620]

Wed Sep 21 08:20:24 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* README.EXT, README.EXT.ja: add new features.

Wed Sep 21 07:43:58 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* lib/optparse.rb (default_argv, Arguable#options): defaults strings
	  to be parsed to Arguable instance.

Wed Sep 21 02:44:09 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* file.c (path_check_0): disallow sticky world writable directory
	  in PATH (and $LOAD_PATH).  [ruby-dev:27226]

Wed Sep 21 00:32:22 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* numeric.c (fix_idiv): 1.div(1.0) should return integer value.
	  [ruby-dev:27235]

Tue Sep 20 22:25:43 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* ext/io/wait/lib/nonblock.rb: disable on platforms non-blocking flag
	  is not available.  fixed: [ruby-dev:27187]

	* file.c (rb_stat_inspect): protoized function pointer.

Tue Sep 20 18:23:04 2005  Tanaka Akira  <akr@m17n.org>

	* eval.c (thread_mark): mark th->last_status.  [ruby-dev:27179]

Tue Sep 20 18:20:33 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* lib/yaml.rb: require 'yaml/constants'.  [ruby-core:5776]

Tue Sep 20 17:48:34 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* lib/xmlrpc/client.rb (XMLRPC::Client::do_rpc): add charset
	  information to content-type header.[ruby-core:5127]

	* lib/xmlrpc/server.rb (CGIServer::serve): ditto.

	* lib/xmlrpc/server.rb (ModRubyServer::serve): ditto.

	* lib/xmlrpc/server.rb (WEBrickServlet::service): ditto.

Tue Sep 20 17:26:42 2005  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* test/webrick/test_cgi.rb: set ENV["PATH"] to CGIEnvPath on
	  windows. bcc32's runtime is not installed into system directory,
	  so it cannot be found without this setting. [ruby-dev:27166]

Tue Sep 20 17:14:10 2005  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* io.c: PIPE_BUF is not defined on BeOS. use _POSIX_PIPE_BUF instead.
	  [ruby-dev:27185]

Tue Sep 20 17:10:38 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* test/dbm/test_dbm.rb (TestDBM::test_s_open_error): remove
	  test_s_open_error test to detect duplicate open.
	  [ruby-dev:27202]

Tue Sep 20 15:39:40 2005  why the lucky stiff  <why@ruby-lang.org>

	* ext/syck/emitter.c (syck_scan_scalar): prevent indicators from
	  appearing alone or at the end of plain scalars. [ruby-core:5826]

	* ext/syck/emitter.c (syck_emit_scalar): treat typed scalar nodes
	  as complex keys.

	* lib/syck.h: version 0.60.

	* lib/yaml/basenode.rb (YAML::BaseNode#at): transform keys during
	  key searches.

	* ext/syck/rubyext.c: loading of binary-typed nodes.  prevent
	  emission of plain strings that look like symbols, but which aren't.

Tue Sep 20 05:48:26 2005  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* test/xmlrpc/test_webrick_server.rb (setup_http_server):
	  should not include 'webrick/https' unless 'use_ssl' because
	  it fails where openssl is not installed.

Tue Sep 20 01:24:45 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (splat_value): use to_a to splat non Array object.

	* object.c (nil_to_a): remove nil.to_a.  [experimental]

Tue Sep 20 01:01:41 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* lib/mathn.rb (Fixnum): remove debug print.

	* lib/rational.rb (Rational): ditto.

Tue Sep 20 00:34:07 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* io.c (io_close): call rb_io_close() directly if io is a T_FILE
	  object.  [ruby-dev:27156]

Mon Sep 19 18:58:10 2005  Minero Aoki  <aamine@loveruby.net>

	* file.c (rb_file_chown): should accept nil. [ruby-dev:27171]

Mon Sep 19 18:29:54 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* file.c (file_expand_path): allow pathnames to expand.
	  [ruby-dev:27152]

Mon Sep 19 15:12:15 2005  Minero Aoki  <aamine@loveruby.net>

	* ext/ripper/depend: do not make ripper/core.rb. [ruby-dev:26462]

Mon Sep 19 14:49:19 2005  Minero Aoki  <aamine@loveruby.net>

	* ext/ripper/eventids2.c: add prefix `t' to tLAMBDA-related lexer
	  events.

	* ext/ripper/lib/ripper/core.rb: updated.

Mon Sep 19 14:39:46 2005  Minero Aoki  <aamine@loveruby.net>

	* parse.y (do_block): do_block event dispatches 2 args.
	  [ruby-dev:26964]

	* ext/ripper/lib/ripper/core.rb: updated.

	* ext/ripper/tools/list-parser-event-ids.rb: check arity mismatch.

Mon Sep 19 07:45:37 2005  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* ext/openssl/ossl_pkey.h, ossl_pkey_rsa.c, ossl_pkey_dsa.c:
	  an instance variable "private" is added to OpenSSL::PKey class.
	  this ivar is a flag that shows whether there is a private key
	  in the instance.

	* ext/openssl/ossl_engine.c: (ossl_engine_load_privkey): set private
	  key flag.

	* test/openssl/test_pkey_rsa.rb: add test about private detection.

Mon Sep 19 06:38:03 2005  Minero Aoki  <aamine@loveruby.net>

	* lib/fileutils.rb: method renaming: collect_methods ->
	  collect_method.

Mon Sep 19 05:58:59 2005  Minero Aoki  <aamine@loveruby.net>

	* lib/fileutils.rb: use module_function instead of single extend.

	* test/fileutils/test_fileutils.rb: test existence of singleton
	  methods.

Mon Sep 19 05:32:41 2005  Minero Aoki  <aamine@loveruby.net>

	* lib/fileutils.rb (remove_entry_secure): does not use chdir(2).

Mon Sep 19 03:17:48 2005  Tanaka Akira  <akr@m17n.org>

	* file.c (rb_thread_flock): wrap the flock system call by
	  TRAP_BEG/TRAP_END to enable signals.  [ruby-dev:27122]

	* ext/socket/socket.c (bsock_send): wrap the sendto and send system
	  call by TRAP_BEG/TRAP_END to enable signals when writing to a socket
	  which is full.  [ruby-dev:27132]

	* io.c (rb_io_syswrite): wrap the write system call by
	  TRAP_BEG/TRAP_END to run signal hander in syswrite method.
	  [ruby-dev:27134]

Mon Sep 19 01:07:38 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* numeric.c (Init_Numeric): should define Fixnum#div.
	  [ruby-dev:27129]

	* file.c (rb_thread_flock): wrap flock(2) by TRAP_BEG and
	  TRAP_END.  [ruby-dev:27122]

	* file.c (rb_file_join): call FilePathValue() to all Pathnames to
	  join.  [ruby-dev:27127]

	* file.c (rb_get_path): call StringValueCStr() to ensure no nul
	  bytes in path strings.

	* gc.c (garbage_collect): need value for return.  [ruby-dev:27127]

Sun Sep 18 02:10:47 2005  why the lucky stiff  <why@ruby-lang.org>

	* lib/yaml/rubytypes.rb: remove comments that are bungling up
	  the rdoc and ri output.  output symbols as plain scalars.

	* ext/syck/rubyext.c (syck_emitter_reset): emit headless
	  documents always.

	* ext/syck/emitter.c (syck_scan_scalar): quote scalars with any
	  kind of surrounding line space, tabs or spaces alike.

	* ext/syck/token.c: accept tabs as whitespace, not for indentation,
	  but strip from plain scalars.

	* test/yaml/test_yaml.rb: remove outdated tests.

Sun Sep 18 01:10:37 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* gc.c (garbage_collect): return false if no GC run.

Sat Sep 17 23:25:04 2005  sheepman  <sheepman@sheepman.sakura.ne.jp>

	* lib/mathn.rb (Rational::inspect): should preserve original
	  operand.  [ruby-core:05806]

Sat Sep 17 23:20:27 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* lib/cgi.rb (CGI::Cookie): should handle multiple values for a
	  cookie name.  [ruby-talk:156140]

	* test/socket/test_tcp.rb (TestTCPSocket::test_recvfrom): typo
	  fixed.  [ruby-dev:27123]

Sat Sep 17 20:58:56 2005  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* win32/win32.c (rb_w32_select): fixed deadlock bug.
	  because select(2) modifies its fd_set arguments, it must be
	  restored sometimes.

	* win32/win32.c (rb_w32_select): performance improvement when
	 'always readable/writable handles' and sockets are passed.
	  sockets should be polled every time.

	    require "net/http"

	    Thread.new {
	      loop do
		STDOUT.write(".") # busy on console (this is worst case though)
	      end
	    }

	    # socket operation took long time. (sometimes timed out)
	    Net::HTTP.start("www.ruby-lang.org") do |http|
		http.get("/cgi-bin/cvsweb.cgi/ruby/array.c?rev=1.179")
	    end

Sat Sep 17 14:54:40 2005  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* test/ruby/test_readpartial.rb (test_open_pipe, test_with_stdio):
	  these tests are working now, so turned on. (windows)

Sat Sep 17 14:18:15 2005  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* win32/win32.c (rb_w32_select): I hope performance problem was
	  solved.

Sat Sep 17 13:45:22 2005  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* win32/win32.c (rb_w32_select): console support is back.
	  but still has performance problem because I loosely took 1 second
	  for wait time. I'll fix it later. (The reason I drastically changed
	  the code is that I wanted to implement the fileset management as
	  single function, and I was worried that if pipe or console
	  was always available, socket may not be processed any time)

Sat Sep 17 11:24:16 2005  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* win32/win32.c (rb_w32_select): select for socket didn't work.
	  this caused deadlock in drb test. this happened because GetFileType
	  for socket handle returns FILE_TYPE_PIPE. Of course, it's not a
	  pipe. So socket handle didn't reach winsock's select function.

	* win32/win32.c (rb_w32_select): read for pipe was still blocked
	  even if writer handle was closed.

	    r,w = IO.pipe

	    Thread.new {
	      sleep 3; puts "------- 1"
	      w.puts("foo")
	      sleep 3; puts "------- 2"
	      w.puts("boo")
	      sleep 3; puts "------- 3"
	      w.close
	    }

	    until r.eof? # should break by w.close but didn't.
	      puts r.gets
	    end

	* win32/win32.c (rb_w32_select): temporary reverted console support
	  but it'll be back soon.

Sat Sep 17 10:42:13 2005  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/lib/multi-tk.rb: MultiTkIp#eval_string and bg_eval_string
	  should call Kernel.eval on caller's safe-level instead of slave's
	  safe-level (Of course, the given script should be evaluated on
	  slave's safe-level).

Sat Sep 17 09:45:26 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* string.c (rb_str_substr): should propagate taintness even for
	  empty strings.  [ruby-dev:27121]

	* string.c (rb_str_aref): should infect result if range argument
	  is tainted.  [ruby-dev:27121]

Sat Sep 17 08:35:39 2005  Kouhei Sutou  <kou@cozmixng.org>

	* lib/rss/maker/base.rb (RSS::Maker::ItemsBase#normalize): fixed
	  strange RSS::Maker::Item#max_size behavior.
	  Thanks to Kazuhiko <kazuhiko@fdiary.net>.

	* test/rss/test_maker_1.0.rb (RSS::TestMaker10#test_items): ditto.

Sat Sep 17 08:02:53 2005  Shugo Maeda  <shugo@ruby-lang.org>

	* lib/net/imap.rb: supported DIGEST-MD5.  Thanks, Mathieu Arnold.

	* lib/net/imap.rb: use fcall instead of send.  Thanks, Satoru
	  Takabayashi.

Fri Sep 16 22:45:49 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* file.c (rb_file_s_extname): empty string for path name ending with a
	  period.  fixed: [ruby-core:05651]

	* file.c (rb_file_join): smarter behavior at edge cases.
	  fixed: [ruby-core:05706]

	* gc.c (rb_memerror, ruby_xmalloc, ruby_xrealloc, rb_newobj): just
	  abondon if no memory available, when interpreter is not running.
	  [ruby-dev:27104]

	* gc.c (garbage_collect): return whether GC could run.

	* dir.c (rb_push_glob): fix delimiter bug.  fixed: [ruby-dev:27105]

	* dir.c (dir_s_aref, dir_s_glob): allow multiple patterns.
	  [ruby-dev:27110]

	* win32/win32.c (cmdglob): enable brace expansion.

Fri Sep 16 18:34:01 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* ext/syck/node.c (syck_replace_str): was using return from the
	  void function.  a patch from MIYAMUKO Katsuyuki
	  <miyamuko at mtb.biglobe.ne.jp>.  [ruby-dev:27111]

Fri Sep 16 14:48:48 2005  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/lib/multi-tk.rb: fix typo on MultiTkIp#bg_eval_string

Fri Sep 16 12:02:12 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* ext/syck/rubyext.c (syck_resolver_transfer): remove C++ style
	  comment (//).  [ruby-core:05793]

Fri Sep 16 00:17:03 2005  NAKAMURA, Hiroshi  <nahi@ruby-lang.org>

	* test/logger/test_logger.rb: unintentionally overwritten changes by
	  Usa.  reverted.

Fri Sep 16 00:03:11 2005  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* lib/webrick/cgi.rb (WEBrick::CGI::Socket#initialize): should set
	  $stdout.binmode.

Thu Sep 15 23:25:21 2005  NAKAMURA, Hiroshi  <nahi@ruby-lang.org>

	* lib/{soap,wsdl,xsd}, test/{soap,wsdl,xsd}: imported soap4r/1.5.5.

	  #nnn is a ticket number at http://dev.ctor.org/soap4r

	  * SOAP

	    * allow to configure an envelope namespace of SOAP request. (#124)
		TemporaryNamespace = 'http://www.w3.org/2003/05/soap-envelope'
		@client.options["soap.envelope.requestnamespace"] =
		  TemporaryNamespace
		@client.options["soap.envelope.responsenamespace"] =
		  TemporaryNamespace
		@client.do_proc(...)

	    * let SOAP request XML indent space configuable.  see
	      "soap.envelope.no_indent" option. (#130)

	    * let external CES configuable.
	      ex. client["soap.mapping.external_ces"] = 'SJIS'.  $KCODE is used
	      by default. (#133)
		external CES ::= CES used in Ruby object of client and server
		internal CES ::= CES used in SOAP/OM

	    * add iso-8859-1 external CES support. (#106)

	    * fixed illegal 'qualified' handling of elements.  it caused
	      ASP.NET inteoperability problem. (#144)

	    * added 'soap.envelope.use_numeric_character_reference' (boolean)
	      option to let query XML use numeric character reference in XML,
	      not plain UTF-8 character.  !GoogleSearch server seems to not
	      allow plain UTF-8 character since 2005-08-15 update. (#147)

	    * SOAP::Header::SimpleHeader (de)serialization throws an exception
	      on !SimpleHeader.on_(in|out)bound when header is a String.  so we
	      could not use a simple single element headerItem.  fixed.  thanks
	      to emil. (#129)

	    * out parameter of rpc operation did not work.  (#132)

	    * follow HTTP redirect only if using http-access2.  (#125) (#145)

	    * add a workaround for importing an WSDL whose path begins with
	      drive letter.  (#115)

	  * WSDL

	    * SOAP Data which is defined as a simpletype was not mapped
	      correctly to Ruby obj when using wsdl2ruby.rb generated classdef
	      file. (#123)

	    * rpc/literal support. (#118)

	    * re-implemented local element qualify/unqualify control.  handles
	      elementFormDefault and form in WSDL.  (#119)

	    * Array of an element which has simpleType causes a crash. (#128)

	    * prarmeterOrder may not contain return part so it can be shorter
	      than parts size.  Thanks to Hugh.  (#139)

	  * Samples

	    * added !BasicAuth client sample. (#117)

	    * added Base64 client/server sample.

	    * added Flickr SOAP interface client sample. (#122)

	    * added !SalesForce client sample. (#135)

	    * updated Thawte CA certificate for !GoogleAdWords sample.

	    * updated a client script with the newer version made by Johan.
	      thanks!

	    * shortened long file names. (#120)

	    * fixed typo in authheader sample. (#129)

	    * updated deprecated method usage.  (#138)

Thu Sep 15 22:40:27 2005  NAKAMURA Usaku  <usa@ruby-lang.org>

	* test/ruby/test_signal.rb (test_exit_action): skip the test using
	  fork on fork-less platforms.

Thu Sep 15 13:54:33 2005  Tanaka Akira  <akr@m17n.org>

	* lib/open-uri.rb: add :read_timeout option.
	  [ruby-core:4848]

Thu Sep 15 11:39:18 2005  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/lib/tk/dialog.rb: If a dialog does not show up yet,
	  TkDialogObj#name raises an exception. [ruby-talk:156109]

Thu Sep 15 11:01:58 2005  NAKAMURA Usaku  <usa@ruby-lang.org>

	* win32/win32.c (rb_w32_pipe_exec): remove unnecessary CloseHandle().

	* win32/win32.c (extract_console_fd, peek_console): new functions.

	* win32/win32.c (rb_w32_select): check consoles by polling them.

Thu Sep 15 00:18:24 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* lib/net/telnet.rb (Net::Telnet::waitfor): replace sysread with
	  readpartial.  [ruby-talk:127641]

Wed Sep 14 23:28:28 2005  NAKAMURA Usaku  <usa@ruby-lang.org>

	* win32/win32.c (collect_file_fd): rename from extract_file_fd.

	* win32/win32.c (extract_pipe_fd, peek_pipe): new functions.

	* win32/win32.c (rb_w32_select): check pipes by polling them.

Wed Sep 14 22:40:26 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* dir.c (ruby_glob): glob function not using ruby exception system.

Wed Sep 14 17:24:22 2005  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* dir.c: changed `foo (*bar)_((boo))' to `foo (*bar)(boo)`.

	* enumerator.c, eval.c, gc.c, intern.h, io.c, process.c, ruby.c,
	  ruby.h, signal.c: ditto.

Wed Sep 14 15:06:22 2005  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* bignum.c: changed `foo _((boo))' to `foo(boo)`. [ruby-dev:27056]

	* defines.h, dir.c, dln.h, enumerator.c, env.h, error.c, eval.c, file.c,
	  gc.c, hash.c, inits.c, intern.h, io.c, lex.c, marshal.c, missing.h,
	  node.h, numeric.c, pack.c, process.c, re.h, ruby.c, ruby.h, rubyio.h,
	  rubysig.h, signal.c, sprintf.c, st.h, string.c, struct.c, time.c,
	  util.c, util.h, variable.c: ditto.

Tue Sep 13 22:09:40 2005  NAKAMURA, Hiroshi  <nahi@ruby-lang.org>

	* lib/logger.rb (Logger): added formatter accessor to logger for
	  dictating the way in which the logger should format the messages it
	  displays.  Thanks to Nicholas Seckar (cf. [ruby-talk:153391]) and
	  Daniel Berger.

	* lib/logger.rb (Logger): added VERSION constant.

	* lib/logger.rb: removed document for LogDevice. It is an
	  implementation detail and is not a public interface.

	* test/logger/test_logger.rb: added tests.

Tue Sep 13 21:47:17 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* eval.c (BEGIN_CALLARGS): pop halfly pushed status.
	  fixed: [ruby-dev:26881]

Tue Sep 13 20:24:37 2005  Tanaka Akira  <akr@m17n.org>

	* ruby.h (PRINTF_ARGS): new macro for printf style argument checking.

Tue Sep 13 15:41:29 2005  Minero Aoki  <aamine@loveruby.net>

	* lib/net/http.rb: wrote docuemntation of HTTPRequest/HTTPResponse
	  classes.

Tue Sep 13 14:27:47 2005  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* string.c, missing.h: failed to build on powerpc-apple-darwin7.9.0
	  because of crypt argument's constness mismatch. (I hope this works)
	  (http://mput.dip.jp/autobuild/ruby-trunk/log/20050913T110001.gz)

Tue Sep 13 12:33:05 2005  why the lucky stiff  <why@ruby-lang.org>

	* lib/yaml.rb: reworking YAML::Stream to use the new
	  emitter.

	* lib/yaml/stream.rb: ditto.

	* lib/yaml/rubytypes.rb: added Object#yaml_new.

	* lib/yaml/tag.rb: the tag_subclasses? method now
	  shows up in the class.  allow taguri to be set using an accessor.
	  continue support of Object#to_yaml_type.

	* ext/syck/rubyext.c: new emitter code.  yaml_new and yaml_initialize
	  get called, should they be present.  consolidated all the diaspora of 	  internal node types into the family below YAML::Syck::Node -- Map,
	  Seq, Scalar -- all of whom are SyckNode structs pointing to
	  Ruby data.  moved Object#yaml_new into the node_import and made it
	  the default behavior.  the target_class is always called wih
	  yaml_new, prepended a parameter, which is the klass.  loaded nodes
	  through GenericResolver show their style.
	  new Resolver#tagurize converts type ids to taguris.

	* ext/syck/implicit.re: were 'y' and 'n' seriously omitted??

	* ext/syck/emitter.c: renovated emitter, walks the tree in advance.
	  consolidated redundant block_styles struct into
	  the scalar_style struct.  (this means loaded nodes can now
	  be sent back to emitter and preserve at least its very basic
	  formatting.)

	* ext/syck/gram.c: headless documents of any kind allowed.

	* ext/syck/node.c: new syck_replace_str methods and syck_empty_*
	  methods for rewriting node contents, while keeping the ID
	  and other setup info.  added syck_seq_assign.

	* ext/syck/syck.h: reflect block_styles and new node functions.

Tue Sep 13 08:09:18 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* lib/ostruct.rb (new_ostruct_member): Object#send no longer call
	  private methods.  [ruby-dev:27044]

	* test/rss/test_dublincore.rb, test/rss/test_trackback.rb,
	  test/ruby/test_eval.rb, test/socket/test_socket.rb: ditto.

	* test/ruby/test_lambda (test_call_with_block): lambda makes new scope
	  for formal block parameter.

Tue Sep 13 01:17:45 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (proc_save_safe_level): no need to restrict safe level
	  memoize in $SAFE>=3.  [ruby-dev:27050]

Tue Sep 13 00:02:33 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* file.c (apply2files): stricter callback definition.

	* file.c (rb_path_check): constified.

Mon Sep 12 20:53:06 2005  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* test/openssl/test_pkcs7.rb (test_enveloped): skip this test
	  to avoid a bug of PKCS7_enctypt() (only if ext/openssl is
	  compiled with OpenSSL-0.9.7d or earlier versions).
	  http://www.mail-archive.com/openssl-dev@openssl.org/msg17376.html

Mon Sep 12 20:32:00 2005  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* win32/win32.[hc] (rb_w32_argv_size, ...): reverted my latest change
	  to avoid incompatible pointer warning. (mingw32)

Mon Sep 12 19:58:53 2005  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* dln.c: avoid warning of const to non-const convertion.
	  [ruby-dev:27041]

	* eval.c, io.c, ruby.c: ditto.

Mon Sep 12 19:26:29 2005  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* array.c: moved to ANSI function style from K&R function style.
	  (used protoize on windows, so still K&R remains on #ifdef part of
	   other platforms. And  `foo _((boo))' stuff is still there)
	   [ruby-dev:26975]

	* bignum.c, class.c, compar.c, dir.c, dln.c, dmyext.c, enum.c,
	  enumerator.c, error.c, eval.c, file.c, gc.c, hash.c, inits.c,
	  io.c, main.c, marshal.c, math.c, numeric.c, object.c, pack.c,
	  prec.c, process.c, random.c, range.c, re.c, regcomp.c, regenc.c,
	  regerror.c, regexec.c, regparse.c, regparse.h, ruby.c, signal.c,
	  sprintf.c, st.c, string.c, struct.c, time.c, util.h, variable.c,
	  version.c: ditto.

Mon Sep 12 14:03:33 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* test/dbm/test_dbm.rb: remove locking test, which may not be
	  supported on some platforms.  [ruby-dev:27030]

Sun Sep 11 23:23:02 2005  Shugo Maeda  <shugo@ruby-lang.org>

	* lib/net/imap.rb (starttls): supported the STARTTLS command.

Sun Sep 11 22:18:07 2005  Masatoshi SEKI  <m_seki@mva.biglobe.ne.jp>

	* bin/erb (ERB::Main#run): set ERB#filename so that it is used
	  when reporting syntax/runtime errors. Tabs converted to spaces.

Sat Sep 10 22:34:19 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* array.c, bignum.c: protoize.

Sat Sep 10 00:23:01 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (splat_value): simpler and consistent array conversion
	  for argument splat.  [yarv-dev:599]

Fri Sep  9 16:45:25 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* string.c (rb_str_times): make empty strings to keep taintness,
	  and a little improvement.  [ruby-dev:26900]

	* ext/iconv/iconv.c (iconv_try), ext/iconv/extconf.rb: get rid of meta
	  characters in command line option.  fixed: [ruby-talk:155369]

	* ext/iconv/iconv.c: protoized.

Thu Sep  8 14:58:11 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* merged a patch from Takahiro Kambe <taca at back-street.net> to
	  support DragonFly BSD.  [ruby-dev:26984]

Thu Sep  8 13:14:57 2005  Tadashi Saito  <shiba@mail2.accsnet.ne.jp>

	* missing/strchr.c (strrchr): fixed a bug in detecting NUL in a
	  string.  [ruby-dev:26985]

Wed Sep  7 17:29:27 2005  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* ext/openssl/ossl_engine.c (ossl_engine_s_by_id):
	  OpenSSL::Engine.by_id calls given block before calling
	  ENGINE_init (block parameter is the return value of this method
	  itself).  this functionality is useful to load dynamic shared
	  engines.

		require "openssl"
		pkcs11 = OpenSSL::Engine.by_id("dynamic"){|e|
		  e.ctrl_cmd("SO_PATH", "/usr/lib/opensc/engine_pkcs11.so")
		  e.ctrl_cmd("LIST_ADD", "1")
		  e.ctrl_cmd("LOAD")
		}
		pkcs11.ctrl_cmd("PIN", "secret")
		key = pkcs11.load_private_key

	* ext/openssl/ossl_engine.c (ossl_engine_ctrl_cmd): new method
	  OpenSSL::Engine#ctrl_cmd. it wraps ENGINE_ctrl_cmd_string.

	* ext/openssl/ossl_engine.c (ossl_engine_get_cmds): new method
	  OpenSSL::Engine#cmds. it returms engine command definitions.

Wed Sep  7 15:48:37 2005  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* ext/openssl/ossl_asn1.c (asn1str_to_str): new function.

	* ext/openssl/ossl_pkcs7.c: new class OpenSSL::PKCS7::RecipientInfo.
	  this class wraps PKCS7_RECIP_INFO struct.

	* ext/openssl/ossl_pkcs7.c: OpenSSL::PKCS7::Signer is renamed to
	  OpenSSL::PKCS7::SignerInfo. ("Signer" remains as an alias of
	  SignerInfo.)

	* test/openssl/test_pkcs7.rb: new file.

Wed Sep  7 12:55:08 2005  Tanaka Akira  <akr@m17n.org>

	* lib/open-uri.rb: abolish mod === tempfile to avoid a problem
	  [ruby-dev:26967].

Wed Sep  7 10:45:15 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* eval.c (rb_thread_switch): convert all exceptions to
	  SystemExit.  fixed: [ruby-core:05724]

	* eval.c (rb_thread_terminated): show backtrace before propagate
	  exceptions to main thread.

Wed Sep  7 09:21:41 2005  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* win32/win32.[hc] (rb_w32_utime): constified.

	* win32/win32.h (rb_w32_stat): added prototype.

	* win32/win32.[hc] (rb_w32_argv_size,rb_w32_join_argv,rb_w32_aspawn):
	  changed `char *const *' to `const char *const *'. (constify string)

Wed Sep  7 08:35:04 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* Makefile.in, configure.in (MINIOBJS): miniruby on HP-UX can not load
	  extension libraries.

	* bignum.c (bignew_1, bigadd): K&R style argument actually can't be
	  defined as char.

	* missing/vsnprintf.c: ANSI compiler supports const keyword.

	* ext/digest/sha2/extconf.rb: reject platforms which has inttypes.h
	  but no 64bit integer.

	* lib/mkmf.rb (what_type?): guesstimate type.

	* ext/etc/etc.c (setup_passwd), ext/etc/extconf.rb: pw_age might be
	  char*.  fixed: [ruby-core:05470]

Wed Sep  7 08:32:07 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* string.c (rb_str_times): should taint empty strings as well.

	* object.c (Init_Object): make class_variable_{get,set} public.
	  [ruby-dev:26965]

Mon Sep  5 22:28:46 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* parse.y (stmt, mlhs_node, lhs, arg, method_call): aref_args might be
	  nothing.  fixed: [ruby-dev:26952]

	* ext/ripper/eventids2.c: added new tokens.  fixed: [ruby-dev:26952]

Mon Sep  5 17:03:07 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* lib/find.rb: should raise ENOENT if root entry does not exist.
	  [ruby-list:41054]

	* lib/ostruct.rb: a patch from Florian Gross <florgro at gmail.com>
	  merged to allow recursive inspect (and to_s) for OpenStruct.
	  [ruby-core:05532]

Mon Sep  5 08:20:19 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* lib/observer.rb: a patch from nornagon <nornagon at gmail.com>
	  merged to allow arbitrary names for update methods.
	  [ruby-core:05416]

Mon Sep  5 07:01:12 2005  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* ext/openssl/openssl/lib/openssl/buffering.rb (Buffering#do_write):
	  should clear data from the buffer which already been output.

Sun Sep  4 15:01:35 2005  Minero Aoki  <aamine@loveruby.net>

	* parse.y (f_arg): Ripper should not do semantic check.
	  [ruby-dev:26948]

Sat Sep  3 23:52:35 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (rb_f_fcall): new method to avoid inefficiency of
	  obj.instance_eval{send(...)} tricks.

Sat Sep  3 13:59:31 2005  Tanaka Akira  <akr@m17n.org>

	* lib/pathname.rb (Pathname#descend): Pathname.new("./a/b/c").descend
	  didn't yield "."
	  (Pathname#ascend): ditto.

Fri Sep  2 23:51:54 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* parse.y (f_arg): f_norm_arg is a VALUE in ripper, not an ID.
	  fixed: [ruby-dev:26942]

	* lib: do not use __send__ to access private methods.  [ruby-dev:26935]

Thu Sep  1 17:11:25 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (rb_call0): wrong condition for $SAFE restoration.

Thu Sep  1 14:12:45 2005  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/lib/multi-tk.rb: On Tcl8.5, MultiTkIp#invoke_hidden doesn't
	  work (gives wrong order of arguments).

	* ext/tk/lib/multi-tk.rb: add MultiTkIp#invoke_hidden_on_namespace
	  to support '-namespace' option of 'interp invokehidden' command
	  on Tcl8.5.

Wed Aug 31 14:41:30 2005  NAKAMURA Usaku  <usa@ruby-lang.org>

	* win32/Makefile.sub (OPTFLAGS): default global optimization to
	  disabled for all VC++ versions.  fixed: [ruby-dev:26897]

Wed Aug 31 10:36:09 2005  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* process.c (proc_detach, proc_setmaxgroups): missing argument type
	  declaration. (I recommend ANSI-style function)

Wed Aug 31 06:59:01 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* string.c (rb_str_scan): already String#scan behaves differently
	  regarding if block is given.

Tue Aug 30 23:49:34 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* array.c, dir.c, enum.c, hash.c, io.c, range.c, string.c, struct.c:
	  let enumerable methods return Enumerator.  [ruby-dev:26924]

	* intern.h (RETURN_ENUMERATOR): utility macro for enumerable methods.

Tue Aug 30 23:25:45 2005  NAKAMURA, Hiroshi  <nahi@ruby-lang.org>

	* lib/debug.rb: no need to restart at exit.

Tue Aug 30 23:20:19 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* eval.c (rb_rescue2): initialization miss.  fixed: [ruby-dev:26917]

	* lib/mkmf.rb (xsystem, xpopen): no longer expand by Config.

	* lib/mkmf.rb (link_command, cc_command, cpp_command): expand
	  variables at once, and quote hdrdir.  fixed: [ruby-core:05680]

	* lib/mkmf.rb (libpathflag): quote paths.

Tue Aug 30 19:34:27 2005  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* ext/digest/md5/md5ossl.h, ext/digest/rmd160/rmd160ossl.h,
	  ext/digest/sha1/sha1ossl.h: include <stddef.h> to avoid
	  error in compilation with OpenSSL-0.9.8. [ruby-list:41068]

Tue Aug 30 16:19:40 2005  Keiju Ishitsuka  <keiju@ruby-lang.org>

	* lib/irb/init.rb: bug fix. [ruby-dev: 26920]

Tue Aug 30 16:13:00 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* enum.c (enum_count): new method.  [ruby-dev:26895]

Tue Aug 30 12:45:15 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (rb_f_send): do not call private methods if the receiver
	  is specified.  [ruby-talk:153672]

Mon Aug 29 19:47:18 2005  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* lib/rdoc/usage.rb: improper exceptions. [ruby-dev:26870]

	* lib/rdoc/usage.rb: support the case when non-ruby code exists before
	  shebang. (this is needed when ri.bat is executed on windows)

Mon Aug 29 18:58:05 2005  Keiju Ishitsuka  <keiju@ruby-lang.org>

	* lib/irb/init.rb: make IRB -I option that is same befavior for ruby.
	  [ruby-dev:26872]

	* lib/irb/locale.rb: support to print help message when OS locale is
	  ja_JP.utf-8. [ruby-dev:26872]

Mon Aug 29 01:43:05 2005  Tanaka Akira  <akr@m17n.org>

	* lib/pathname.rb (Pathname#descend): new method.
	  (Pathname#ascend): ditto.

Mon Aug 29 00:35:09 2005  Tanaka Akira  <akr@m17n.org>

	* lib/time.rb: require 'date/format' instead of 'parsedate'.
	  (Time.parse): extract fractional seconds using Date._parse.
	  (Time.strptime): extract fractional seconds using Date._strptime.
	  [ruby-talk:153859]

Sat Aug 27 20:13:31 2005  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* ext/curses/curses.c ({curses,window}_clrtoeol): added. suggested
	  by Reyn Vlietstra.

	* ext/curses/curses.c: chtype in curses is not `char', rahter `long'.
	  [ruby-Bugs:2298]

	* ext/curses/view.rb: String =~ String is deprecated.

Thu Aug 25 15:48:58 2005  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* ext/win32ole/win32ole.c: supress warnings. (win32)

Wed Aug 24 11:01:26 2005  NAKAMURA Usaku  <usa@ruby-lang.org>

	* test/logger/test_logger.rb (test_shifting_size): should close log
	  device before unlink, since some platform cannot unlink opened
	  file.

Tue Aug 23 06:07:02 2005  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* ext/openssl/lib/digest.rb: added SHA224, SHA256, SHA384 and SHA512.
	  these features are enabled if this library is compiled with
	  OpenSSL 0.9.8 or later.

	* test/openssl/test_digest.rb: add test for new digests.

Tue Aug 23 05:47:04 2005  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* ext/openssl/ossl_ns_spki.c (ossl_spki_initialize): try to decode
	  the argument as a string.

	* ext/openssl/ossl_ns_pki.c (ossl_spki_to_der): new method.

	* ext/openssl/ossl_x509store.c (ossl_x509store_initialize): should
	  set @time to avoid warning.

	* ext/openssl/ossl_x509store.c (ossl_x509store_set_default_paths,
	  X509_STORE_add_cert, X509_STORE_add_crl): should raise error if
	  wrapped functions fails.

	* ext/openssl/ossl_ssl.c (ossl_sslctx_set_ciphers): fix error message.

	* ext/openssl/ossl_x509req.c (ossl_x509req_set_attributes): get rid
	  of unused variable.

	* test/openssl/test_ns_spki.rb: add new file.

	* test/openssl/test_x509store.rb: add test for error.

Tue Aug 23 01:11:40 2005  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* sprintf.c (ruby__sfvwrite): should move `buf' to the end of
	  `result'. [ruby-dev:26859]

Mon Aug 22 23:51:19 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* parse.y: ONIG_OPTION_CAPTURE_GROUP conflicts with
	  RE_OPTION_ONCE.  [ruby-dev:26852]

Mon Aug 22 20:11:35 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* missing/vsnprintf.c (BSD__sprint): needs to call vwrite function
	  pointer.  fixed: [ruby-dev:26854]

Sat Aug 20 23:55:25 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* parse.y (parser_yylex): update paren_nest for brackets [].

Sun Aug 21 00:10:23 2005  NAKAMURA, Hiroshi  <nahi@ruby-lang.org>

	* lib/wsdl/xmlSchema/importer.rb (WSDL::XMLSchema::Importer#fetch): add
	  a workaround for importing an WSDL whose path begins with drive
	  letter.  [ruby-dev:26242]

Sat Aug 20 22:05:25 2005  K.Kosako  <sndgk393 AT ybb.ne.jp>

	* regexec.c (code_is_in_cclass_node): check code size.
	  [ruby-dev:26840]

Sat Aug 20 22:37:13 2005  NAKAMURA, Hiroshi  <nahi@ruby-lang.org>

	* lib/logger.rb (write, shift_log?, shift_log): file shifting race
	  condition bug fixed.  [ruby-dev:26764]

	* test/logger/test_logger.rb: tests.

Fri Aug 19 18:13:39 2005  Tanaka Akira  <akr@m17n.org>

	* lib/time.rb (Time.apply_offset): fix a problem with last day of
	  month.  reported by Lucas Nussbaum.  [ruby-talk:152866]

Thu Aug 18 11:05:36 2005  NAKAMURA Usaku  <usa@ruby-lang.org>

	* win32/win32.c (socketpair_internal): need to call open_ifs_socket()
	  to create sockets instead of winsock's socket().
	  fixed: [yarv-dev:581]

Wed Aug 17 23:58:05 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* eval.c (terminate_process): take String message.

	* eval.c (rb_thread_switch): propagate the exception caused thread
	  termination directly.  fixed: [ruby-core:05552]

Wed Aug 17 21:20:05 2005  NARUSE, Yui  <naruse@ruby-lang.org>

	* ext/nkf/lib/kconv.rb: ensure that symbol_to_option is private_class_method
	  and all other methods are module_function
	  fixed: [ruby-dev:26808]

Wed Aug 17 00:05:46 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (rb_add_method): preserve safe level in the environment
	  where a method is defined .

	* eval.c (rb_call0): restore preserved safe level in the method
	  execution.

	* parse.y (lambda): need separate block variable stack
	  manipulation and lpar_beg maintenance.  based on a patch found
	  in [ruby-core:05551] from Mauricio Fernandez <mfp at acm.org>.

	* parse.y (parser_yylex): adjust lpar_beg after tLAMBEG and
	  kDO_LAMBDA. [ruby-core:05551]

Mon Aug 15 07:24:38 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* intern.h (rb_check_to_integer): add declaration.

	* object.c (rb_to_integer, rb_check_to_integer): argument constified.

Mon Aug 15 00:38:51 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* eval.c (rb_rescue2): reduce PUSH_TAG() as well as NODE_RESCUE.
	  [ruby-dev:26800]

	* range.c (range_check, range_init): reduce uselse exceptions.

Mon Aug 15 00:34:11 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* parse.y (yycompile): remove unreachable code.  [yarv-dev:570]

Sat Aug 13 22:16:12 2005  Minero Aoki  <aamine@loveruby.net>

	* lib/fileutils.rb (remove_entry_secure): forgot final chdir.

Sat Aug 13 22:07:49 2005  Minero Aoki  <aamine@loveruby.net>

	* lib/fileutils.rb (remove_entry_secure): uses chdir(2) and check
	  if current directory is correct. [ruby-dev:26100] [ruby-dev:26226]

Sat Aug 13 21:11:05 2005  Masaki Suketa  <masaki.suketa@nifty.ne.jp>

	* ext/win32ole/win32ole.c: add WIN32OLE_VARIANT class.

	* ext/win32ole/tests/testall.rb: ditto.

	* ext/win32ole/tests/testOLEVARIANT.rb: ditto.

Sat Aug 13 18:51:26 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* eval.c (rb_block_pass): distinguish current block from others.
	  fixed: [ruby-dev:26274]

	* ext/stringio/stringio.c (strio_set_string): disallow nil.
	  http://www.rubyist.net/~nobu/t/20050811.html#c05

Sat Aug 13 08:01:59 2005  NARUSE, Yui  <naruse@ruby-lang.org>

	* ext/nkf/lib/kconv.rb: Kconv.kconv is now alias of Kconv.conv
	* ext/nkf/lib/kconv.rb: remove nkf dependend symbols fomr SYMBOL_TO_OPTION

Fri Aug 12 17:06:53 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* parse.y (f_larglist): allow optional arguments even when
	  parentheses are omitted.  based on Nobu's patch from
	  http://www.rubyist.net/~nobu/t/20050805.html

	* parse.y (parser_yylex): update & maintain lpar_beg for detect
	  lambda parameters.

Thu Aug 11 23:29:03 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* ext/stringio/stringio.c: keep holding string after closed.

Thu Aug 11 20:48:40 2005  Tadashi Saito  <shiba@mail2.accsnet.ne.jp>

	* numeric.c (fix_equal, fix_cmp, fix_gt, fix_ge, fix_lt, fix_le):
	  reduce coercing when a method knows about a operand type.
	  [ruby-dev:26789]

Thu Aug 11 13:01:48 2005  Kouhei Sutou  <kou@cozmixng.org>

	* lib/rss: fixed sort bug. [ruby-list:41018]

	* lib/rss/1.0.rb (RSS::RDF::Channel#setup_maker_attributes):
	  removed self.

	* lib/rss/maker/base.rb (RSS::Maker::ItemsBase#<=>): use #date
	  instead of @date.
	  (RSS::Maker::Base::self.def_array_element): added #size.

	* lib/rss/maker/1.0.rb
	  (RSS::Maker::RSS10::Channel#to_rss,
	   RSS::Maker::RSS10::Items::Item#to_rss): cleared dc_dates set
	  upped by using #date.

	* lib/rss/maker/dublincore.rb
	  (RSS::Maker::ChannelBase, RSS::Maker::ItemsBase::ItemBase):
	  fixed opposite alias.

	* test/rss/test_setup_maker_1.0.rb
	  (RSS::TestSetupMaker10::test_setup_maker_items_sort): added some
	  tests for RSS::Maker::ItemsBase#do_sort.

Wed Aug 10 12:01:20 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* lib/delegate.rb: simplifies Delegator classes; SimpleDelegator
	  now uses method_missing for all methods.

Wed Aug 10 10:38:50 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* bignum.c (rb_big_mul0): multiply two numbers (x, y) without
	  normalizing the result.  x should be a big number.
	  [ruby-dev:26778]

	* bignum.c (rb_big_pow): use rb_big_mul0() instead of
	  rb_big_mul().

	* array.c (rb_ary_or, rb_ary_and, rb_ary_plus, rb_ary_diff):
	  revert the change on 2005-08-03.  Set operation on other item
	  should have in separate methods.

	* parse.y (shadowing_lvar_gen): warn when arguments shadows
	  external local variables.

	* parse.y (f_opt): optional arguments should not clobber external
	  local variables.

	* parse.y (f_rest_arg): rest arguments should not clobber external
	  local variables.

Wed Aug 10 10:29:40 2005  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/lib/tk.rb: fix bug on handling __ruby2val_optkeys().

	* ext/tk/lib/tk/itemconfig.rb: fix bug on handling
	  __item_ruby2val_optkeys().

	* ext/tk/lib/tk/canvas.rb: didn't check __item_ruby2val_optkeys().

	* ext/tk/lib/tkextlib/blt/component.rb: ditto.

Tue Aug  9 21:53:17 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* eval.c (formal_assign): let default values override
	  arguments to zsuper.  fixed: [ruby-dev:26743]

Tue Aug  9 20:30:19 2005  Tadashi Saito  <shiba@mail2.accsnet.ne.jp>

	* bignum.c (rb_big_coerce): allow bignum x bignum coercing.
	  [ruby-dev:26778]

Tue Aug  9 15:12:04 2005  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/tcltklib.c: remove dangerous 'rb_jump_tag's.

	* ext/tk/lib/tk.rb: add __val2ruby_optkeys and __ruby2val_optkeys to
	  help to convert option values between ruby and tcl.

	* ext/tk/lib/tk/itemconfig.rb: add __item_val2ruby_optkeys and
	  __item_ruby2val_optkeys to help to convert option values between
	    ruby and tcl.

	* ext/tk/lib/tk/radiobutton.rb: use __ruby2val_optkeys for 'variable'
	  option (for the reason of backward compatibility).

	* ext/tk/lib/tk/composite.rb: clarify the arguments of super().

	* ext/tk/lib/tk/spinbox.rb: ditto.

	* ext/tk/lib/tk/text.rb: ditto.

	* ext/tk/lib/tk/validation.rb: ditto.

	* ext/tk/lib/tkextlib/*: support to treat tkvariable-type
	  configure options.

Tue Aug  9 08:24:05 2005  Mauricio Fernandez  <mfp@acm.org>

	* parse.y (f_block_arg), eval.c (rb_yield_0): deal with dynamic
	  variable lambda arguments.  [ruby-core:05540]

Mon Aug  8 22:13:48 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* eval.c (assign): deal with new block argument.
	  fixed: [ruby-core:05536]

	* eval.c (rb_node_arity): follow change of NODE_ARGS.
	  fixed: [ruby-dev:26761]

Mon Aug  8 21:28:13 2005  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* test/ruby/test_fnmatch.rb: separated from test_file.rb.

Mon Aug  8 20:40:35 2005  NAKAMURA, Hiroshi  <nahi@ruby-lang.org>

	* test/ruby/test_method.rb: added.  [ruby-dev:26761]

Mon Aug  8 01:26:37 2005  Mauricio Fernandez  <mfp@acm.org>

	* parse.y (f_larglist): mistake in syntax rule.  [ruby-core:05535]

Mon Aug  8 05:16:55 2005  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* ext/openssl/ossl.c (ossl_raise): should use ERR_peek_last_error
	  to get last error on the current thread. And should report
	  if errors are on the stack while OpenSSL.debug is true.

	* ext/openssl/ossl.c (ossl_get_errors): new method for debugging
	  this library.

Mon Aug  8 05:15:19 2005  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* lib/webrick/httpproxy.rb (HTTPProxyServer#intialize),
	  lib/webrick/httpserver.rb (HTTPServer#intialize),
	  lib/webrick/httpservlet/cgihandler.rb (CGIHandler#initialize),
	  lib/webrick/httpservlet/erbhandler.rb (ERBHandler#initialize),
	  lib/webrick/httpservlet/filehandler.rb(DefaultFileHandler#initialize):
	  super (called with no arguments) takes default value of optional
	  arguments. [ruby-dev:26743]

	* lib/webrick/httputils.rb: add a media-type "text/html" for .xhtml.

Sun Aug  7 23:52:39 2005  NAKAMURA, Hiroshi  <nahi@ruby-lang.org>

	* test/ruby/test_super.rb: added optional arg tests.  [ruby-dev:26743]
	  the tests expects 1.8 behavior at this time.

Sat Aug  6 12:35:24 2005  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/lib/{tk.rb,tk/itemconfig.rb}: configure creates
	  TkVariable if key name is 'variable' or 'textvariable'
	  by default. [ruby-dev:26749]

	* ext/tk/lib/tk/{label,radiobutton}.rb: removed its own
	  {variable,textvariable} function.

	* ext/tk/lib/tk/variable.rb: retains backward conpatibility.

Fri Aug  5 12:48:31 2005  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* ext/tk/tcltklib.c: fixed memory leak when tk_funcall raised
	  exception. (copies argv into heap in tk_funcall instead of
	  caller)

Fri Aug  5 12:36:40 2005  NAKAMURA Usaku  <usa@ruby-lang.org>

	* lib/mkmf.rb (create_makefile): need to convert path separetor
	  before invoking install command.

Fri Aug  5 08:08:05 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (return_jump): fix "can't across thread" error message
	  when no thread associated.
	  http://www.namikilab.tuat.ac.jp/~sasada/diary/200507.html#d31

Fri Aug  5 00:25:12 2005  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* ext/tk/tcltklib.c: refactoring - extract ruby string <->
	  tcl object conversion as get_str_from_obj and get_obj_from_str.

Fri Aug  5 00:19:33 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* enumerator.c (Init_Enumerator): provided features should have
	  extensions.

	* eval.c (rb_feature_p): returns type of the feature instead of
	  extension.

	* eval.c (search_required): ruby library should be prior to statically
	  linked extentions.  fixed: [ruby-dev:26711]

	* eval.c (formal_assign): returns position of rest arguments variable.

	* parse.y (f_rest_arg): use anonymous variable for rest arguments.
	  fixed: [ruby-dev:26647]

	* extmk.rb (extmake): needs to be wrapped in an Array.

Thu Aug  4 20:03:18 2005  Tadashi Saito  <shiba@mail2.accsnet.ne.jp>

	* numeric.c (Init_Numeric): do not share implementation among
	  Fixnum#/ and Fixnum#div.  [ruby-core:05531]

Thu Aug  4 18:38:36 2005  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/tcltklib.c: cannot compile for Tcl7.6/Tk4.2.

	* ext/tk/tcltklib.c: add nativethread consistency check.

	* ext/tk/stubs.c: ditto.

	* ext/tk/lib/tk.rb: forgot to define TclTkIp.encoding and encoding=
	  when Tcl is 7.6 or 8.0.

	* ext/tk/lib/tk/wm.rb: support to make some methods as options of
	  root or toplevel widget. [ruby-talk:150336]

	* ext/tk/lib/tk/root.rb: ditto.

	* ext/tk/lib/tk/toplevel.rb: ditto.

	* ext/tk/lib/tkextlib/SUPPRT_STATUS: update RELEASE_DATE

Thu Aug  4 13:30:15 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* numeric.c (fix_div): should not convert the result into
	  integer.  [ruby-core:05524]

Thu Aug  4 08:03:39 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* ext/extmk.rb (extmake): should not modify $mflags for each
	  extentions.

Thu Aug  4 00:25:48 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* common.mk, Makefile.in, {bcc32,win32,wince}/Makefile.sub: integrated
	  macro definitions.

	* bcc32/Makefile.sub: LIBRUBY_SO should use DLDOBJS, not EXTOBJS.

	* {win32,wince}/Makefile.sub: separate config.h for compiler versions.

Thu Aug  4 00:24:59 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* sprintf.c: replacing is no longer needed.

Wed Aug  3 21:59:16 2005  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/lib/tk/variable.rb: TkVariable#trace didn't work on
	  TkVariable retrived from TkVariable.new_hash.ref. [ruby-dev:26721]

Wed Aug  3 12:40:28 2005  Tadashi Saito  <shiba@mail2.accsnet.ne.jp>

	* numeric.c (fix_plus): reduce coercing when a method knows about
	  a operand type.  [ruby-dev:26723]

	* numeric.c (fix_minus, fix_mul, fix_quo, fix_div, fix_mod,
	  fix_divmod, fix_pow): ditto.

	* bignum.c (rb_big_div, rb_big_modulo): export to reduce
	  coercing.

Wed Aug  3 10:13:52 2005  NAKAMURA Usaku  <usa@ruby-lang.org>

	* configure.in, {bcc32,win32,wince}/Makefile.sub (HAVE_SNPRINTF,
	  HAVE_VSNPRINTF): use win32/win32.c's implementation instead of
	  missing/vsnprintf.c's.

	* win32/win32.[ch] (rb_w32_snprintf, rb_w32_vsnprintf): reverted.

Wed Aug  3 10:05:08 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* configure.in: check vsnprintf() and snprintf().

	* sprintf.c, missing/vsnprintf.c: made vsnprintf() and snprintf()
	  private.  fixed: [ruby-dev:26651]

Wed Aug  3 08:22:13 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* ext/socket/socket.c (ruby_connect): revert [ruby-talk:111654]
	  changes at 2004-09-07.  [ruby-dev:26656]

Wed Aug  3 06:53:35 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* array.c (rb_ary_or): wraps the operand in an array if it is not
	  an array.  [ruby-talk:150495] [EXPERIMENTAL]

	* array.c (rb_ary_and, rb_ary_plus, rb_ary_diff): ditto.

Tue Aug  2 10:23:12 2005  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* ext/tk/tcltklib.c: use Tcl_[GS]etVar2Ex instead of
	  Tcl_Obj[GS]etVar2. (avoid Tcl_NewStringObj on supported platforms)

	* ext/tk/tcltklib.c: use ip_{get,set,unset}_variable2_core from
	  ip_{get,set,unset}_variable.

	* ext/tk/tcltklib.c: replaced Tcl_Panic with rb_bug.

Tue Aug  2 01:40:38 2005  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* lib/ping.rb (Ping.pingecho): should rescue StandardError.
	  [ruby-dev:26677]

Mon Aug  1 19:02:23 2005  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* ext/tk/tcltklib.c: refactoring - replaced rb_ivar_defined &
	  rb_ivar_get with single rb_attr_get call.

Mon Aug  1 18:44:08 2005  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* ext/tk/tcltklib.c (Tcl_GetStringResult): refactoring - define
	  alternative macro on Tcl7.x or earlier.

Mon Aug  1 13:53:55 2005  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* ext/tk/tcltklib.c (deleted_ip): refactoring - interpreter
	  deletion check. [ruby-dev:26664]

Mon Aug  1 01:08:21 2005  Masatoshi SEKI  <m_seki@mva.biglobe.ne.jp>

	* lib/drb/drb.rb (check_insecure_method): use private_methods and
	  protected_methods instead of respond_to? to check method visibility.
	  [ruby-dev:26616]

	* test/drb/drbtest.rb: ditto.

	* test/drb/ut_drb.rb: ditto.

Sat Jul 30 18:49:44 2005  Masaki Suketa  <masaki.suketa@nifty.ne.jp>

	* ext/win32ole/win32ole.c: add WIN32OLE_TYPE#ole_typelib,
	  WIN32OLE_TYPE#implemented_ole_types.

	* ext/win32ole/tests/testOLETYPE.rb: ditto.

Fri Jul 29 16:12:02 2005  Keiju Ishitsuka  <keiju@ruby-lang.org>

	* lib/irb/context.rb: fix `irb --readline` option. [ruby-dev:40955]

Fri Jul 29 09:59:38 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* eval.c (rb_call0): fix calling zsuper from a method with anonymous
	  rest argument.  [ruby-dev:26639]

	* eval.c (rb_yield_0): push yielded node instead of yielding.
	  fixed: [yarv-dev:549]

Thu Jul 28 21:49:17 2005  IWATSUKI Hiroyuki  <don@na.rim.or.jp>

	* parse.y (rb_parser_end_seen_p): exclude from ripper.
	  <http://moonrock.jp/~don/d/200507.html#d28_t2>

	* sprintf.c (clearerr): remove standard macro before re-definition.
	  <http://moonrock.jp/~don/d/200507.html#d28_t3>

Thu Jul 28 18:09:55 2005  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/stubs.c: When --enable-tcltk-stubs, the initialize
	  routine creates a Tcl/Tk interpreter and deletes it. However,
	  init cost of Tk's MainWindow is not so small. And that makes it
	  impossible to use libraries written with Tcl functions only on
	  an environment without a graphical display. This changes support
	  delaying initalization of Tk_Stubs until the script needs Tk.

	* ext/tk/stubs.h: New file. Define prototypes and return codes of
	  functions on stubs.c.

	* ext/tk/tcltklib.c: Support delaying initalization of Tk_Stubs
	  until the script needs Tk.

	* ext/tk/tcltklib.c: Show friendly error messages for errors on
	  initialization.

	* ext/tk/tcltklib.c: Avoid SEGV on ip_finalize() when ruby is
	  exiting and $DEBUG is true. (Not fix. If you know the reason of
	  why, please fix it.)

	* ext/tk/tkutil/tkutil.c (ary2list, ary2list2): bug fix on handling
	  of encoding.

	* ext/tk/lib/multi-tk.rb: MultiTkIp#eval_string and bg_eval_string
	  don't work propery.

	* ext/tk/lib/tk.rb: Forget extending Tk::Encoding module to Tk.

	* ext/tk/lib/tk/variable.rb: TkVarAccess fails to initialize the
	  object for an element of a Tcl's array variable.

Thu Jul 28 17:23:37 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* parse.y (f_larglist): allow block argument in lambda parameter
	  list without parenthesis.

Thu Jul 28 17:14:01 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* hash.c (each_i): typo fixed.  [ruby-dev:26622]

Thu Jul 28 15:04:11 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* parse.y (f_arg): better argument name duplication check

	* parse.y (new_args_gen): factored out name duplication check for
	  optional and rest arguments.

	* parse.y (new_bv_gen): allow shadowing outer local variables;
	  warning remains.

Thu Jul 28 13:46:06 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* parse.y (ripper_warningS): the argument was omitted.
	  [ruby-dev:26621]

Thu Jul 28 11:30:57 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* parse.y (f_larglist): allow bv_decl at the end of lambda
	  argument list.  [EXPERIMENTAL]

	* parse.y (new_bv_gen): allow local variable shadowing, with
	  warning in verbose mode.

Wed Jul 27 23:23:54 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* gc.c (obj_free): make message format consistent with one from
	  gc_mark().  [ruby-talk:149668]

	* sprintf.c (quad_t): prepare quad_t as well.  [ruby-talk:149668]

Wed Jul 27 22:11:37 2005  Kouhei Sutou  <kou@cozmixng.org>

	* sample/rss/tdiary_plugin: removed. because the plugin
	  is imported in the tDiary plugin packages.

Wed Jul 27 19:11:53 2005  Minero Aoki  <aamine@loveruby.net>

	* lib/fileutils.rb (cd): follow :noop option change. (This patch
	  is contributed by Doug Kearns)

Wed Jul 27 16:25:59 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* parse.y (lambda): Perl6 style -> lambda expression. [NEW]
	  [VERY EXPERIMENTAL]

Wed Jul 27 10:43:14 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* gc.c (id2ref): must not assign pointers to long int.  use
	  LONG_LONG instead if SIZEOF_LONG < SIZEOF_VOIDP.
	  [ruby-talk:149645]

	* ruby.h: use LONG_LONG to simplify the change.
	  [ruby-talk:149645]

Wed Jul 27 10:59:02 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* dir.c (dir_each): rewinddir(3) before iteration.
	  [ruby-talk:149628]

Wed Jul 27 02:34:58 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (rb_f_throw): replace all '0x%lx' by '%p'.
	  [ruby-talk:149553]

	* missing/vsnprintf.c (BSD_vfprintf): '%p' need to handle 64bit
	  size pointer.  [ruby-talk:149553]

Tue Jul 26 22:41:28 2005  Minero Aoki  <aamine@loveruby.net>

	* ext/ripper/lib/ripper/sexp.rb: new method Ripper.sexp_raw.

	* ext/ripper/lib/ripper/sexp.rb (Ripper.sexp): returns more
	  readable tree.  This is suggested by Kirill A. Shutemov.

Tue Jul 26 22:05:12 2005  Minero Aoki  <aamine@loveruby.net>

	* lib/net/http.rb: merge a patch contributed by Daniel Berger,
	  with some modification. (RubyForge #2128)

Tue Jul 26 18:11:33 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* ruby.h: support LLP64 model.  [ruby-talk:149524]

Tue Jul 26 12:57:40 2005  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* ext/openssl/openssl_missin.c: include <openssl/engine.h> before
	  <openssl/x509_vfy.h> to avoid compilation error of mswin32.
	  suggested by NAKAMURA Usaku.

Mon Jul 25 23:48:55 2005  NAKAMURA Usaku  <usa@ruby-lang.org>

	* win32/win32.[ch]: (rb_w32_vsnprintf, rb_w32_snprintf): removed.

Mon Jul 25 21:30:46 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* common.mk: Borland MAKE doesn't look for file names which have paths
	  from VPATH.  fixed: [ruby-dev:26604]

	* ruby.h (NORETURN, DEPRECATED): moved just after config.h.

	* {win32,wince}/Makefile.sub: vsnprintf() is in missing now.

	* {bcc32,win32,wince}/Makefile.sub: moved CPPFLAGS only for ruby
	  source to XCFLAGS.

Mon Jul 25 14:10:02 2005  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/lib/multi-tk.rb: fix en-bugged part in the last commit.

Mon Jul 25 13:45:18 2005  NAJIMA Hiroki  <najima@mickey.ai.kyutech.ac.jp>

	* io.c: check HAVE_SYS_IOCTL_H before including the header.
	  [ruby-dev:26610]

Sat Jul 23 16:48:12 2005  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* ext/openssl/ossl_engine.c (ossl_engine_s_load): should check
	  OPENSSL_NO_STATIC_ENGINE.

Sat Jul 23 11:46:30 2005  Tanaka Akira  <akr@m17n.org>

	* eval.c (rb_fd_select): the all three fd_sets must be long enough for
	  select.  fixed: [ruby-talk:149059]

Sat Jul 23 10:01:41 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* sprintf.c (rb_vsprintf, rb_sprintf): new functions return new String,
	  using missing/vsnprintf.c.  [ruby-dev:26580]

	*  missing/vsnprintf.c: made the output changeable.

Fri Jul 22 21:06:08 2005  Tadashi Saito  <shiba@mail2.accsnet.ne.jp>

	* bignum.c (rb_big_eq): reduce isnan().  [ruby-dev:26600]

	* numeric.c (flo_eq, flo_gt, flo_ge, flo_lt, flo_le): ditto.

Fri Jul 22 15:02:39 2005  Kouhei Sutou  <kou@cozmixng.org>

	* lib/rss/rss.rb: moved copyright description to lib/rss.rb.

	* lib/rss.rb: added for convenience.

	* sample/rss/re_read.rb: added #to_s sample.

	* sample/rss/blend.rb: use 'require "rss"' instead of
	  'require "rss/*"'.
	* sample/rss/list_description.rb: ditto.
	* sample/rss/rss_recent.rb: ditto.
	* sample/rss/tdiary-plugin/rss-recent.rb: ditto.

	* sample/rss/tdiary-plugin/rss-recent.rb: 0.0.6 -> 0.0.7.

Fri Jul 22 14:37:43 2005  Kouhei Sutou  <kou@cozmixng.org>

	* lib/rss/parser.rb (RSS::Parser#initialize): accept HTTP/FTP
	  URI and local file path too.

	* test/rss/test_parser.rb (RSS::TestParser#test_parse): test
	  for the above.

Fri Jul 22 07:01:42 2005  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/tkutil/tkutil.c (tk_conv_args): forget to revert
	  thread_critical and gc_disable when raise ArgumentError.

	* ext/tk/lib/remote-tk.rb: RemoteTkIp doesn't need to include TkUtil.

	* ext/tk/tcltklib.c: add TclTkIp#has_mainwindow? method.

	* ext/tk/lib/tk.rb: add Tk.has_mainwindow? method.

	* ext/tk/lib/multi-tk.rb: add MultiTkIp#has_mainwindow? method.

	* ext/tk/lib/remote-tk.rb: add RemoteTkIp#has_mainwindow? method.

	* ext/tk/lib/multi-tk.rb: slave IP fail to exit itself when $SAFE==4.

	* ext/tk/lib/multi-tk.rb: remove constants from MultiTkIp module to
	  avoid access from external.

	* ext/tk/lib/multi-tk.rb: check_root flag is ignored on slave IPs'
	  mainloop.

	* ext/tk/lib/multi-tk.rb: hang-up Tk.mainloop called on a slave IP
	  with $SAFE==4.

	* ext/tk/lib/multi-tk.rb: MultiTkIp#bg_eval_proc doesn't work
	  properly.

	* ext/tk/lib/multi-tk.rb: add MultiTkIp#set_cb_error(proc) and
	  cb_error(exc) to log errors at callbacks on safe slave IPs.

	* ext/tk/lib/multi-tk.rb: fail to get an available slave IP object
	  when call Tk.mainloop in the block which is given to new_* method,
	    because cannot finish initialize while the root widget is alive.

	* ext/tk/lib/multi-tk.rb: fail to control a slave IP when Tk.mainloop
	  runs on the IP.

Thu Jul 21 01:00:00 2005  NARUSE, Yui  <naruse@ruby-lang.org>

	* ext/nkf/nkf-utf8/{nkf.c,utf8tbl.c,config.h}:
	  import 1.76
	  [ruby-dev:26592] nkf constification

Wed Jul 20 19:18:52 2005  NAKAMURA Usaku  <usa@ruby-lang.org>

	* io.c (S_ISREG): need to define S_ISREG before it is used first.

Wed Jul 20 18:33:15 2005  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* io.c (wsplit_p): patch for the environment where
	  fcntl(F_GETFL, O_NONBLOCK) is not supported. in that case,
	  set FMODE_WSPLIT without fcntl check. [ruby-dev:26566]

Wed Jul 20 18:07:11 2005  Tanaka Akira  <akr@m17n.org>

	* io.c (rb_io_ctl): update FMODE_WSPLIT_INITIALIZED and FMODE_WSPLIT
	  by F_SETFL.

Wed Jul 20 10:04:51 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* variable.c (rb_class_path): need to adjust snprintf() len for
	  teminating NUL.  [ruby-dev:26581]

Wed Jul 20 03:58:52 2005  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* ext/socket/socket.c: sorry, BeOS also uses HAVE_CLOSESOCKET,
	  so reverted.

	* ext/socket/extconf.rb: should not define HAVE_CLOSESOCKET
	  on windows.

Wed Jul 20 03:12:21 2005  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* ext/socket/socket.c: should not undef close() on win32.
	  it's defined to rb_w32_close(), otherwise handle leaks.
	  [ruby-Bugs-2131]

Wed Jul 20 00:48:16 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* error.c (syserr_initialize): don't use str before StringValue()
	  check.  [ruby-dev:26579]

Tue Jul 19 22:47:29 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* error.c (syserr_initialize): add 1 byte for snprintf() size for
	  NUL at the end.  [ruby-dev:26574]

Tue Jul 19 17:16:34 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* signal.c (trap): remove sigexit(); handle "EXIT" via sig_exec().
	  [ruby-dev:26440]

	* io.c (rb_io_inspect): replace sprintf() with "%s" format all
	  over the place by snprintf() to avoid integer overflow.

Tue Jul 19 14:10:50 2005  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* ext/tk/tcltklib.c: rbtk_eventloop_depth is used as int.

	* ext/tk/tcltklib.c: rbtk_pending_exception is tested with
	  NIL_P, so should assign Qnil instead of 0 (Qfalse).

	* ext/tk/tcltklib.c (ip_invoke_real): fixed memory leak when
	  ip is deleted.

Tue Jul 19 13:19:46 2005  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/lib/tk/variable.rb: For symmetry, add TkVariable#string. It
	  returns a string even if the default value type of the TkVariable
	  object is not "string".

Mon Jul 18 21:39:18 2005  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* eval.c (rb_call0): make the pointer to NODE volatile
	  instead of NODE itself.

Mon Jul 18 14:32:21 2005  Tanaka Akira  <akr@m17n.org>

	* eval.c (rb_call0): make body volatile to avoid possible optimization
	  problem.
	  [ruby-dev:26195]

Mon Jul 18 12:23:27 2005  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* ext/io/wait/wait.c: wrong backport from trunk, and compile error on
	  platforms fd_set is not a bit set.  fixed: [ruby-dev:26562]

Mon Jul 18 09:36:25 2005  Tanaka Akira  <akr@m17n.org>

	* rubyio.h (FMODE_WSPLIT, FMODE_WSPLIT_INITIALIZED): new constant.

	* io.c (wsplit_p): new function.
	  (io_fflush): split writing data by PIPE_BUF if wsplit_p is true in
	  multi-threaded mode.
	  (io_fwrite): ditto.
	  [ruby-dev:26540]

Mon Jul 18 05:00:00 2005  NARUSE, Yui  <naruse@ruby-lang.org>

	* ext/nkf/nkf-utf8/nkf.c: import nkf.c 1.73
	  fix: TestKconv 1F

Sun Jul 17 13:46:54 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* ext/io/wait/extconf.rb, ext/io/wait/wait.c: Win32 platforms support.

Sat Jul 16 23:43:16 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* enumerator.c (Init_Enumerator): wrong argument specs.
	  [ruby-core:05481]

Sat Jul 16 15:52:50 2005  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* win32/win32.[hc]: constified socket functions. [ruby-dev:26553]

Fri Jul 15 23:59:03 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* lib/rdoc/parsers/parse_c.rb (handle_class_module): handle a
	  module enclosed in a built-in module.  fixed: [ruby-talk:148239]

	* lib/rdoc/parsers/parse_c.rb (find_body): allow macros as methods.

	* lib/rdoc/parsers/parse_c.rb (find_call_seq): allow :nodoc: modifier
	  in C.  [ruby-core:04572]

Fri Jul 15 23:20:03 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* enumerator.c (Init_Enumerator): use an internal directly.

Fri Jul 15 07:58:10 2005  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* lib/webrick/server.rb (WEBrick::GenericServer#accept_client):
	  sockets should be non-blocking mode. [ruby-dev:26405]

	* lib/webrick/utils.rb (WEBrick::Utils.set_non_blocking): new method.

Fri Jul 15 00:11:36 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* enum.c (enumeratorize): create new enumerator for current method if
	  no block is given.

	* enumerator.c: moved from ext/enumerator.

Thu Jul 14 18:27:35 2005  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* win32/win32.c (rb_w32_strerror): should return correct message
	  for ENAMETOOLONG and ENOTEMPTY. (bcc32) [ruby-dev:26533]

	* win32/win32.c (rb_w32_strerror): stripped CR LF on the tail.
	  (bcc32) [ruby-dev:26533]

Thu Jul 14 00:45:42 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* LEGAL (ext/nkf/nkf-utf8): updated from nkf1.7 to nkf-utf8.

Wed Jul 13 22:44:00 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* parse.y: remove static variables.  [ruby-dev:26530]

Wed Jul 13 19:36:29 2005  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* win32/win32.c (rb_w32_mkdir): should set EEXIST (not EACCES)
	  if file or directory already exists. (bcc32) [ruby-dev:26508]

	* win32/win32.c (rb_w32_rmdir): should set ENOTDIR (not EINVAL)
	  if it is not directory. (bcc32, win32)

	* win32/win32.c (rb_w32_rmdir, rb_w32_unlink): restore
	  FILE_ATTRIBUTE_READONLY flag on function failure.

Wed Jul 13 12:40:00 2005  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/tcltklib.c: TclTkLib.do_one_event doesn't work.

	* ext/tk/lib/tk.rb: Tk.thread_update is available.

Tue Jul 12 23:32:11 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* lib/mkmf.rb: keep curdir unexpanded.

Mon Jul 11 23:50:17 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* eval.c, intern.h (rb_proc_call, rb_obj_method, rb_method_call):
	  export.

	* ext/enumerator/enumerator.c (enumerator_with_index): [EXPERIMENTAL]
	  added a new method Enumerator#with_index.  [ruby-talk:147728]

Mon Jul 11 08:31:29 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* regparse.c (fetch_escaped_value): mask values following \c in
	  regexp.  fixed: [ruby-dev:26500]

Sun Jul 11 05:18:17 2005  Michael Neumann  <mneumann@ruby-lang.org>

	* lib/xmlrpc/server.rb (XMLRPC::Server): Switch from GServer over to
	  WEBrick. This makes file lib/xmlrpc/httpserver.rb obsolete (at least it is
		no further used by the XML-RPC library).

Mon Jul 11 02:50:23 2005  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* lib/webrick/cgi.rb (WEBrick::CGI::Socket#request_line):
	  mistook to merge the patch of [ruby-dev:26235] at
	  revision 1.11.

Sun Jul 10 23:58:04 2005  Tanaka Akira  <akr@m17n.org>

	* lib/pathname.rb (Pathname#unlink): try Dir.unlink first to
	  avoid unlink a directory by root.
	  cf. [ruby-dev:26237]

Sun Jul 10 12:47:01 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* lib/debug.rb (debug_command): added a deficient format specifier.
	  fixed: [ruby-core:05419]

Sat Jul  9 22:02:37 2005  Masaki Suketa  <masaki.suketa@nifty.ne.jp>

	* ext/win32ole/win32ole.c (ole_method_dispid): convert dispid
	  in Ruby and C by INT2NUM and NUM2INT.

	* ext/win32ole/win32ole.c (ole_invoke2): ditto.

	* ext/win32ole/test/testWIN32OLE.rb: ditto.

	* ext/win32ole/test/testOLEMETHOD.rb: ditto.

Fri Jul  8 15:45:04 2005  Kouhei Sutou  <kou@cozmixng.org>

	* lib/rss/rss.rb (RSS::VERSION): 0.1.4 -> 0.1.5.

	* test/rss/test_version.rb (RSS::TestVersion#test_version):
	  ditto.

	* lib/rss/0.9.rb (RSS::Rss::Channel::Item::Category):
	  domain attribute of <category> is optional. Thanks to
	  Chris Lee <clee@kde.org>.

	* test/rss/test_parser.rb (RSS::TestParser#test_category20):
	  adjusted test case.

Wed Jul  6 18:45:53 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* object.c (rb_obj_pattern_match): now returns nil.
	  [ruby-core:05391]

Mon Jul  4 14:35:52 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* sample/svr.rb: service can be stopped by ill-behaved client; use
	  tsvr.rb instead.

Mon Jul  4 13:25:21 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* missing/erf.c: original erf.c by prof. Okumura is confirmed to
	  be public domain.  reverted BSD implementation.

Wed Jul  6 11:15:21 2005  NAKAMURA Usaku  <usa@ruby-lang.org>

	* win32/win32.c (open_ifs_socket): new function.

	* win32/win32.c (StartSockets, rb_w32_socket): use open_ifs_socket()
	  instead of socket().
	  all changes are derived from [ruby-core:5388].

Wed Jul  6 00:15:00 2005  NARUSE, Yui  <naruse@ruby-lang.org>

	* ext/nkf/nkf-utf8/{nkf.c,utf8tbl.c,config.h}:
	  imported nkf.c 1.70 (support UTF-8-MAC)

	* ext/nkf/lib/kconv.rb: add :utf8mac and :internalunicode

Tue Jul  5 23:44:06 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* instruby.rb: expand source library path.

Tue Jul  5 23:27:14 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* array.c (sort_2): get rid of yet another bcc's bug.
	  fixed: [ruby-core:05152]

	* eval.c (rb_thread_save_context): must not switch contexts during
	  re-allocating stack.  fixed: [ruby-core:05219]

Tue Jul  5 15:15:10 2005  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/tkutil.c: fix typo.

Tue Jul  5 14:52:56 2005  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/tcltklib.c: bug fix on treating Unicode strings.

	* ext/tk/tcltklib.c: add methods to treat encoding mode.

	* ext/tk/MANUAL_tcltklib.eng: add description of TclTkLib#encoding,
	  encoding_system, and so on.

	* ext/tk/MANUAL_tcltklib.eucj: ditto.

	* ext/tk/tkutil/tkutil.c: fail to create a Tcl's list string from
	  an array including multiple kind of encoded strings.

	* ext/tk/lib/tk.rb: ditto.

	* ext/tk/lib/multi-tk.rb: 2nd arg of _{to|from}UTF8 is omissible.

	* ext/tk/lib/remote-tk.rb: ditto.

	* ext/tk/lib/tk.rb: override TclTkLib#encoding and encoding= to
	  use TkCore::INTERP.encoding and encoding=.

	* ext/tk/lib/tk.rb: when "require 'tk'" and $KCODE=='NONE', check
	  DEFAULT_TK_ENCODING to decide Ruby/Tk's system encoding mode.

	* ext/tk/lib/tk/encodedstr.rb: check both of Tk.encoding and
	  Tk.encoding_system. Tk.encoding has higher priority.

	* ext/tk/lib/tk/optiondb.rb: ditto.

	* ext/tk/lib/tk/spinbox.rb: ditto.

	* ext/tk/lib/tk/validation.rb: ditto.

	* ext/tk/lib/tk/namespace.rb: arguemnts for TclTkIp#_merge_tklist
	  should be UTF-8 strings.

Mon Jul  4 19:29:32 2005  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* lib/set.rb: test change to follow revision 1.28. (duck typing?)

Mon Jul  4 11:23:50 2005  NAKAMURA Usaku  <usa@ruby-lang.org>

	* test/{dbm,gdbm,sdbm}/test_{dbm,gdbm,sdbm}.rb: skip some tests
	  which using fork on fork-less platforms.

Sun Jul  3 23:26:30 2005  NAKAMURA, Hiroshi  <nahi@ruby-lang.org>

	* test/wsdl/document/test_rpc.rb: compare formatted time string of
	  Time objects instead of comparing Time objects itself to avoid
	  unintended conflict of usec part.  [ruby-dev:26220]

Sat Jul  2 22:41:04 2005  Tanaka Akira  <akr@m17n.org>

	* ext/socket/socket.c (unix_send_io, unix_recv_io): support x86-64 and
	  IA64.

Sat Jul  2 17:06:23 2005  Tanaka Akira  <akr@m17n.org>

	* defines.h (FLUSH_REGISTER_WINDOWS): defined for IA64.
	  (flush_register_windows): declare flush_register_windows.

	* eval.c (flush_register_windows): new function.

	* ruby.h (NOINLINE): move up to be effective in defines.h.

Sat Jul  2 15:19:41 2005  Tanaka Akira  <akr@m17n.org>

	* configure.in: check select_large_fdset.

	* eval.c: use select_large_fdset to support large file descriptors
	  on Solaris.  [ruby-dev:26404]

Fri Jul  1 17:55:08 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* bignum.c (rb_big_neg): may be accessing bogus pointer value.

Fri Jul  1 15:50:12 2005  NAKAMURA Usaku  <usa@ruby-lang.org>

	* missing/erf.c: need to include some headers for some platforms.

	* win32/win32.h (copysign, scalb): define for compatibility with
	  other platforms. [ruby-dev:26430]

Fri Jul  1 15:37:42 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* missing/crypt.c: modified to make it compilable on platforms
	  other than BSD.  [ruby-dev:26430]

	* missing/erf.c: ditto.  code from <exp.c> merged.

Fri Jul  1 12:44:56 2005  Tanaka Akira  <akr@m17n.org>

	* lib/open-uri.rb (OpenURI.open_http): refine post_connection_check
	  call.

Fri Jul  1 11:34:08 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* missing/crypt.c: replaced with 4.4BSD version.

	* missing/erf.c: ditto.

	* missing/vsnprintf.c: removed the third provision from the old
	  BSD license.  [ruby-core:05177]

Fri Jul  1 01:45:21 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* enum.c (enum_min, enum_max): must not return Qundef.
	  fixed: [ruby-core:05299]

Fri Jul  1 00:18:40 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* lib/delegate.rb (Delegator::respond_to): respond_to? must check
	  destination object.  [ruby-talk:146894]

Thu Jun 30 23:52:12 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* signal.c (trap): non-string trap hander was ignored.
	  fixed: [ruby-dev:26417]

Thu Jun 30 19:00:21 2005  Keiju Ishitsuka  <keiju@ruby-lang.org>

	* lib/irb/ruby-lex.rb (RubyLex::identify_number): alternative implements
	  for [ruby-dev:26410]. And support a numeric form of 0d99999.

Thu Jun 30 17:28:10 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* lib/irb/ruby-lex.rb (RubyLex::identify_number): should not treat
	  plain zero as an octal number.  [ruby-dev:26410]

Thu Jun 30 15:13:16 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (rb_eval): pre-evaluate argument for unambiguous
	  evaluation order.  [ruby-dev:26383]

Thu Jun 30 14:48:23 2005  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* lib/net/http.rb (Net::HTTP#connect, Net::HTTP#request): should
	  not send proxy username and password to origin servers.
	  [ruby-dev:25673]

	* lib/net/http.rb (Net::HTTP::ProxyDelta#edit_path): should not
	  send HTTPS scheme URL to origine servers. [ruby-dev:25689]

Thu Jun 30 09:53:56 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* lib/delegate.rb (Delegator::method_missing): forward unknown
	  method to the destination.  suggested by
	  <christophe.poucet@gmail.com>.  [ruby-talk:146776]

Wed Jun 29 00:03:20 2005  Kazuhiro NISHIYAMA  <zn@mbf.nifty.com>

	* regparse.c (fetch_token): avoid warning of unused goto tag.
	  [ruby-dev:26389]

Tue Jun 28 21:59:29 2005  Kazuhiro NISHIYAMA  <zn@mbf.nifty.com>

	* dir.c, eval.c, parse.y, process.c, ruby.c: avoid warning "unused
	  variable" [ruby-dev:26387]

	* dir.c (glob_helper): avoid warning "enumeration value `RECURSIVE'
	  not handled in switch" [ruby-dev:26392]

Tue Jun 28 01:52:00 2005  NARUSE, Yui  <naruse@ruby-lang.org>

	* ext/nkf/lib/kconv.rb: add Kconv::VERSION
	* ext/nkf/lib/kconv.rb (conv): can process arrayed options
	* ext/nkf/nkf-utf8/nkf.c: imported Revision 1.69
	* ext/nkf/nkf-utf8/utf8tbl.c: imported Revision 1.9

Sat Jun 25 23:30:51 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* process.c (detach_process_watcher): terminate process watcher
	  thread right after rb_waitpid() succeed.  [ruby-talk:146430]

Sat Jun 25 17:12:20 2005  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* lib/webrick/httputils.rb (WEBrick::HTTPUtils.parse_query): should
	  discard if key=val pair is empty. patch from Gary Wright.

Sat Jun 25 15:49:18 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* enum.c (enum_min, enum_max, enum_min_by, enum_max_by): do not ignore
	  nil as the first element.

Sat Jun 25 15:13:54 2005  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* lib/set.rb (Set#==): [ruby-dev:25206] (ported from ruby_1_8 branch)

Sat Jun 25 11:37:00 2005  NARUSE, Yui  <naruse@ruby-lang.org>

	* ext/nkf/lib/kconv.rb: remove constants
	  Iconv_Shift_JIS, Uconv_EUC_JP, Iconv_UTF8
	* ext/nkf/lib/kconv.rb: add module functions to Kconv
	  conv, {eucjp, shiftjis, utf8}?, guess_as_symbol
	* ext/nkf/lib/kconv.rb: add instance methods to String
	  conv, {eucjp, shiftjis, utf8}?
	* ext/nkf/lib/kconv.rb: add aliases Kconv.to_* and String#to_*

Fri Jun 24 17:00:00 2005  Shigeo Kobayashi  <shigeo@tinyforest.jp>

	* ext/bigdecimal/bigdecimal.c: patch from "NATORI Shin"
	  (u-tokyo.ac.jp) applied to fix rounding bug.

Fri Jun 24 13:17:45 2005  akira yamada  <akira@ruby-lang.org>

	* lib/uri/common.rb, lib/uri/generic.rb: fixed typo in documents and
	  replaced some existent domain name with "example.com".

Fri Jun 24 12:23:19 2005  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/lib/tk.rb: fix typo on Tk.grid_propagate.

	* ext/tk/lib/tk.rb: Tk.event_generate and TkWindow#event_generate
	  accept TkEvent::Event object as context argument.

	* ext/tk/lib/tk/event.rb: add TkEvent::Event#valid_fields and
	  valid_for_generate to get field parameters of event_generate.

Thu Jun 23 23:55:59 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* runruby.rb: should load built rbconfig.rb.

Thu Jun 23 16:53:15 2005  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/lib/tk/canvastag.rb: TkcGroup.new cannot include given items.
	  TkcGroup#exclude calls wrong method.
	  Add alias TkcGroup#add [ruby-talk:146049].

	* ext/tk/lib/tk/canvas.rb: TkCanvas#dtag and some subcommands of
	  TkCanvas#addtag fail to treat a TkcTag argument.

	* ext/tk/lib/tk/event.rb: add TkEvent::Event#generate to help to send
	  current event to other widgets.

Mon Jun 20 18:44:04 2005  Tanaka Akira  <akr@m17n.org>

	* eval.c (FUNCTION_CALL_MAY_RETURN_TWICE): DUMMY_SETJMP is replaced
	  because setjmp is not enough to fix getcontext and SPARC register
	  window problem.

Mon Jun 20 17:15:51 2005  NAKAMURA Usaku  <usa@ruby-lang.org>

	* ext/dbm/dbm.c (fdbm_closed): new method DBM#closed?

	* ext/gdbm/gdbm.c (fgdbm_closed): new method GDBM#closed?

	* ext/sdbm/init.c (fsdbm_closed): new method SDBM#closed?

	* test/dbm/test_dbm.rb, test/gdbm/test_gdbm.rb, test/sdbm/test_sdbm.rb
	  (teardown): close all db objects before deleting data files.

	* win32/win32.{ch} (unlink): hook runtime function to change
	  file attribute before unlinking.
	  merge from 1.8, see [ruby-dev:26360]

Mon Jun 20 02:15:35 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* gc.c (define_final): document fix: finalizers never get called
	  before target object is destroyed.

Mon Jun 20 01:26:49 2005  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* ext/openssl/openssl_missing.c, ext/openssl/ossl.h,
	  ext/openssl/ossl_asn1.c, ext/openssl/ossl_bio.c,
	  ext/openssl/ossl_pkcs12.h, ext/openssl/ossl_x509req.c: avoid
	  compiler warnings. suggested by Michal Rokos.

Sun Jun 20 00:22:02 2005  Michael Neumann  <mneumann@ruby-lang.org>

	* lib/xmlrpc/utils.rb: Patch by Nobuhiro IMAI fixes the following
	  problem: Default value modification on
	  Module#public_instance_methods (false -> true) breaks
	  s.add_handler(XMLRPC::iPIMethods("sample"), MyHandler.new) style
	  security protection.

	* lib/xmlrpc/client.rb: Aliased XMLRPC::Client#new2 as
	  XMLRPC::Client#new_from_uri, and #new3 as #new_from_hash.

Sun Jun 19 14:09:07 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* gc.c (run_final): reduce unnecessary object allocation during
	  finalization.

	* gc.c (rb_gc_call_finalizer_at_exit): deferred finalizers list should
	  be cleared before calling them.  fixed: [ruby-talk:145790]

Sat Jun 18 01:15:36 2005  Shugo Maeda  <shugo@ruby-lang.org>

	* ext/readline/readline.c (readline_readline): do not set
	  rl_{in,out}stream.

	* ext/readline/readline.c (readline_s_set_input): new method.

	* ext/readline/readline.c (readline_s_set_output): new method.

	* lib/irb/input-method.rb: set Readline.input and Readline.output.

Fri Jun 17 13:01:40 2005  Tanaka Akira  <akr@m17n.org>

	* lib/time.rb (Time.parse): fix previous leap seconds support.
	  (Time.rfc2822): ditto.
	  (Time.xmlschema): ditto.

Thu Jun 16 15:41:32 2005  NAKAMURA Usaku  <usa@ruby-lang.org>

	* ruby.c (load_file): '!' is already read. reported by gotoyuzo.

Thu Jun 16 15:09:38 2005  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* ext/tk/tcltklib.c (ip_rb_threadVwaitCommand): Tcl_Release
	  was missing.

Thu Jun 16 13:34:48 2005  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/lib/tk.rb: add Tk.getMultiple{Open|Save}File() which return
	  an Array of selected files.

Thu Jun 16 12:53:24 2005  Tanaka Akira  <akr@m17n.org>

	* lib/time.rb (Time.parse): "Fri Jan  1 08:59:60 +0900 1999" was
	  parsed as "Fri Jan 01 09:00:00 JST 1999" even on an environment
	  which supports leap seconds.
	  (Time.rfc2822): ditto.
	  (Time.xmlschema): ditto.

Thu Jun 16 00:13:41 2005  Tanaka Akira  <akr@m17n.org>

	* lib/resolv.rb (Resolv::DNS::Resource#ttl): new attribute.
	  (Resolv::DNS::Resource#==): ignore @ttl.
	  (Resolv::DNS::Resource#hash): ditto.
	  (Resolv::DNS::Message::MessageDecoder#get_rr): save TTL in a
	  Resource object.
	  based on [ruby-core:5190] by Eric Hodel.

Wed Jun 15 18:26:39 2005  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/lib/tk.rb: support "tk inactive" sub-command [for Tcl/Tk8.5a3]

	* ext/tk/lib/tk/namespace.rb: support "namespace path" sub-command and
	  'namespace ensemble' sub-command [for Tcl/Tk8.5a3]

Tue Jun 14 02:02:43 2005  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/tkutil/tkutil.c: add TkUtil::CallbackSubst.subst_arg(m, ...)
	  & _define_attribute_aliases(hash) to get substitution-argument from
	  attributes (e.g. subst_arg(:x,:y,:num,:button) --> "%x %y %b %b ").

	* ext/tk/lib/tk/event.rb: use _define_attribute_aliases().

Mon Jun 13 13:03:08 2005  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* hash.c (ruby_setenv): fixed SEGV. [ruby-dev:26186]

Mon Jun 13 01:54:20 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* signal.c (sigexit): call rb_thread_signal_exit() instead of
	  rb_exit().  [ruby-dev:26347]

	* eval.c (rb_thread_signal_exit): a new function to exit on main
	  thread.

	* eval.c (rb_thread_switch): exit status should be retrieved from
	  ruby_errinfo.

	* eval.c (rb_f_exit): ensure exit(0) should call
	  exit(EXIT_SUCCESS).

Mon Jun 13 01:20:02 2005  Tanaka Akira  <akr@m17n.org>

	* eval.c (rb_gc_mark_threads): curr_thread may not be part of the
	  thread list.  [ruby-dev:26312]

Sat Jun 11 22:34:44 2005  Minero Aoki  <aamine@loveruby.net>

	* parse.y: missing arg_paren event.  This patch is contributed by
	  Mitchell N Charity.

Fri Jun 10 23:55:17 2005  Tanaka Akira  <akr@m17n.org>

	* eval.c (unknown_node): show more information.  [ruby-dev:26196]

Fri Jun 10 23:35:34 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* missing/mkdir.c: remove. [ruby-core:05177]

Fri Jun 10 22:54:18 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* missing.h: fd_set stuffs need sys/types.h.  fixed: [ruby-core:05179]

Thu Jun  9 23:58:12 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* ext/Win32API/Win32API.c (Win32API_Call): disable global
	  optimization. fixed: [ruby-core:05143]

Thu Jun  9 23:35:22 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* enum.c (enum_inject): default the result value to Qundef to use
	  first element as initial value if not given.

Thu Jun  9 19:55:41 2005  Tanaka Akira  <akr@m17n.org>

	* eval.c (ruby_longjmp): new macro to call longjmp, setcontext, etc.
	  (ruby_setjmp): new macro to call setjmp, getcontext, etc.
	  (ruby_setjmp): call setjmp before getcontext to avoid IA64 register
	  stack problem.
	  [ruby-talk:144939]

	* gc.c (Init_stack): remove IA64_MAGIC_STACK_LIMIT.

Thu Jun  9 18:24:16 2005  Tanaka Akira  <akr@m17n.org>

	* configure.in, eval.c, gc.c: use libunwind only on HP-UX.
	  [ruby-dev:26297]

Thu Jun  9 14:46:32 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* hash.c (env_aset): do not treat nil as key-removing value.
	  [ruby-list:40865]

	* parse.y (method_call): allow aref expression ([]) to take a
	  block.

	* parse.y (block_dup_check): a function to check duplication of
	  a block argument and an actual block.

Thu Jun  9 11:55:34 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* lib/delegate.rb (SimpleDelegator::__setobj__): need check for
	  recursive delegation.  [ruby-core:04940]

Thu Jun  9 11:50:43 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* lib/cgi.rb: add underscore aliases CGI::escape_html,
	  CGI::unescape_html, CGI::escape_element, CGI::unescape_element.
	  [ruby-core:05058]

Wed Jun  8 18:47:10 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* misc/ruby-mode.el (ruby-expr-beg): fix looking point drift.

Wed Jun  8 12:25:59 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* array.c (rb_ary_nitems): add the block feature to Array#nitems.
	  suggested by Bertram Scharpf <lists@bertram-scharpf.de> in
	  [ruby-talk:134083].

Wed Jun  8 11:11:34 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* bignum.c (get2comp): revert all prior changes, and calculate
	  proper 2's complement for negative numbers.

Wed Jun  8 08:33:10 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* enum.c (enum_min_by, enum_max_by): return nil if no iteration.
	  fixed: [ruby-dev:26245]

	* eval.c (rb_need_block): ensure a block is given.

	* eval.c (backtrace): skip successive frames sharing same node.

Wed Jun  8 01:27:06 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* bignum.c (bignorm): fixed a bug in normalizing negative numbers
	  reported from Honda Hiroki <hhonda@ipflex.com>.  normalizing
	  should not trim leading zeros from negative numbers.

	* bignum.c (rb_cstr_to_inum): must remove leading zeros for this
	  case.

Wed Jun  8 00:15:08 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* ext/socket/socket.c (ruby_getaddrinfo__aix): merged a patch from
	  KUBO Takehiro <kubo at jiubao.org> to support AIX.  [ruby-list:40832]

Wed Jun  8 00:09:01 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* lib/yaml/rubytypes.rb (Array::to_yaml): merged a patch from
	  Tilman Sauerbeck <tilman at code-monkey.de>.  [ruby-core:05055]

	* lib/yaml/rubytypes.rb (Hash::to_yaml): ditto.

Wed Jun  8 00:00:01 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* ext/curses/curses.c (curses_insertln): merged a patch from
	  TAKAHASHI Tamotsu <ttakah at lapis.plala.or.jp>.  [ruby-ext:02305]

Tue Jun  7 19:34:15 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* lib/irb/init.rb (IRB::IRB.rc_file_generators): more flexible
	  IRB.rc_file_generators.  [ruby-core:05163]

Tue Jun  7 18:39:31 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* lib/thread.rb: RDoc documentation from Eric Hodel
	  <drbrain@segment7.net> added.  [ruby-core:05148]

Tue Jun  7 18:30:04 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* lib/mkmf.rb (create_makefile): add .SUFFIXES from depend file.
	  fixed: [ruby-dev:26294]

Tue Jun  7 17:20:39 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* parse.y (parser_yylex): allow ';;' to be block terminator in
	  place of 'end'.  [highly experimental]

	* misc/ruby-mode.el (ruby-block-end-re): allow ';;' to be a
	  negative indent trigger.  [highly experimental]

	* parse.y (parser_yylex): small error fixed.

Tue Jun  7 16:45:49 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* parse.y (parser_yylex): "respond_to?:foo" should be interpreted
	  as "respond_to? :foo" at the command level.  [ruby-talk:144303]

Tue Jun  7 16:32:53 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* sprintf.c (rb_f_sprintf): raise exception on debug mode (-d),
	  not verbose mode (-v/-w).  [ruby-core:05123]

	* sprintf.c (rb_f_sprintf): warn always on verbose mode.

Tue Jun  7 10:30:49 2005  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/lib/multi-tk.rb: slave-ip fails to call procedures
	  delegated by master-ip.

Mon Jun  6 16:35:18 2005  NAKAMURA Usaku  <usa@ruby-lang.org>

	* ext/ripper/depend: add .y to .SUFFIXES for nmake.

Sun Jun  5 23:00:35 2005  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/lib/tk/console.rb: create console when required

	* ext/tk/sample/tkextlib/tile/demo.rb: fix TypeError & create Console

Sun Jun  5 10:23:52 2005  Tanaka Akira  <akr@m17n.org>

	* signal.c (ruby_signal): don't set SA_RESTART.
	  [ruby-dev:26276]

Sat Jun  4 14:55:18 2005  Tanaka Akira  <akr@m17n.org>

	* test/dbm/test_dbm.rb: merged from ext/dbm/testdbm.rb.

	* test/gdbm/test_gdbm.rb: merged from ext/gdbm/testgdbm.rb.

	* test/sdbm/test_sdbm.rb: renamed from ext/sdbm/testsdbm.rb with
	  modification to use test/unit.

Fri Jun  3 23:23:02 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* intern.h (rb_fdset_t): deal with fd bit sets over FD_SETSIZE.
	  fixed: [ruby-dev:26187]

	* eval.c (rb_fd_init, rb_fd_term, rb_fd_zero, rb_fd_set, rb_fd_clr,
	  rb_fd_isset, rb_fd_copy): ditto.

	* io.c (rb_io_wait_readable, rb_io_wait_writable, rb_f_select): ditto.

	* ext/io/wait/wait.c (io_wait): ditto.

	* ext/socket/socket.c (wait_connectable, unix_recv_io): ditto.

Fri Jun  3 14:06:12 2005  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/lib/multi-tk.rb: fix typo.

Thu Jun  2 23:42:57 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* parse.y: pragma support on ripper.  [ruby-dev:26266]

Thu Jun  2 00:02:16 2005  Minero Aoki  <aamine@loveruby.net>

	* struct.c: accessing >10 member caused segmentation fault.
	  [ruby-dev:26247]

	* test/ruby/test_struct.rb: test it.

Wed Jun  1 11:30:09 2005  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* bcc32/Makefile.sub: can use single quote character in DESTDIR.
	  [ruby-dev:26205]

	* bcc32/Makefile.sub: Dir.glob in 1.9 doesn't treat \ as path separator.
	  [ruby-dev:26254]

Wed Jun  1 00:11:06 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* parse.y (method_call): new experiment: "(expr)(args...)" to
	  invoke "expr.call(args...)".  [EXPERIMENTAL]

Tue May 31 23:43:41 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* parse.y (command): revert implicit "call" for local variables.

Tue May 31 15:52:45 2005  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* lib/webrick/httpserver.rb (WEBrick::HTTPServer#run): should
	  break the loop if the socket reached to EOF. [ruby-talk:142285]

	* lib/webrick/httpserver.rb (WEBrick::HTTPServer#run): send response
	  without reading the whole request body if keep-alive is diabled.
	  [experimental]

Mon May 30 23:48:29 2005  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/lib/tk/macpkg.rb: add PACKAGE_NAME information of Tcl/Tk
	  Extension.

	* ext/tk/lib/tk/msgcat.rb: ditto.

	* ext/tk/lib/tk/winpkg.rb: ditto.

	* ext/tk/lib/tkextlib/*: ditto.

Sat May 28 16:39:21 2005  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* test/openssl/test_x509store.rb: add test for expired CRL
	  and refine some assertions.

Sat May 28 05:15:44 2005  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* ext/openssl/ossl_x509store.c (ossl_x509stctx_set_time): should
	  not set internal flag directry.

Sat May 28 02:00:11 2005  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* lib/webrick/cgi.rb (WEBrick::CGI::Socket#request_line):
	  ENV["REQUEST_URI"] is better to get correct Request-URI
	  than ENV["SCRIPT_NAME"] + ENV["PATH_INFO"].  [ruby-dev:26235]

Fri May 27 16:32:04 2005  WATANABE Hirofumi  <eban@ruby-lang.org>

	* lib/mkmf.rb: use the semicolon as the path separator
	  in the environment of MSYS.  fixed: [ruby-dev:26232]

Thu May 26 20:31:21 2005  Minero Aoki  <aamine@loveruby.net>

	* lib/fileutils.rb (remove_entry_secure): add documentation.

	* lib/fileutils.rb (remove_entry_secure): should not invoke
	  unlink(2) against a directory.

Thu May 26 08:29:19 2005  Akiyoshi, Masamichi  <akiyoshi@hp.com>

	* vms/vmsruby_private.c, vms/vmsruby_private.h: private routines
	  for VMS port are added.

	* eval.c (ruby_init): change to call VMS private intialization routine.

Thu May 26 07:39:07 2005  Minero Aoki  <aamine@loveruby.net>

	* lib/fileutils.rb (rm_r): use lchown(2), not chown(2).
	  [ruby-dev:26226]

	* lib/fileutils.rb (cd): remove :noop option. (feature change)

	* lib/fileutils.rb (cp_r): should copy symlink as symlink, for
	  also tree root. (feature change)

	* lib/fileutils.rb (cp_r): new option :dereference_root.

	* lib/fileutils.rb: new method remove_entry.

	* lib/fileutils.rb: new method remove_entry_secure.

	* lib/fileutils.rb: add documentation.

Thu May 26 06:08:11 2005  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/lib/tk.rb: add shortcut-methods of tk_call + tk_split_list

Wed May 25 20:06:27 2005  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/lib/tk.rb: TkComm#tk_split_*list fail to split a kind of SJIS
	  strings. To avoid the trouble, add arguments to control converting
	  encoding, and do split on a UTF8 string.

	* ext/tk/lib/multi-tk.rb: modify to attend encoding.

	* ext/tk/lib/remote-tk.rb: ditto.

	* ext/tk/lib/tk/itemconfig.rb: ditto.

	* ext/tk/lib/tk/listbox.rb: ditto.

	* ext/tk/lib/tk/namespace.rb: ditto.

	* ext/tk/lib/tk/panedwindow.rb: ditto.

	* ext/tk/lib/tk/text.rb: ditto.

	* ext/tk/lib/tk/textmark.rb: ditto.

	* ext/tk/lib/tk/texttag.rb: ditto.

	* ext/tk/lib/tk/variable.rb: ditto.

	* ext/tk/lib/tk/winfo.rb: ditto.

	* ext/tk/lib/tkextlib/iwidgets/scrolledlistbox.rb: ditto.

	* ext/tk/lib/tkextlib/iwidgets/scrolledtext.rb: ditto.

	* ext/tk/lib/tk.rb: add TkWindow#lower_window/raise_window and
	  Tk#lower_window/raise_window by reason of method-name conflict

	* ext/tk/lib/tk/canvas.rb: bug fix on TkCanvas#delete when given
	  non-TkcItem arguments.

	* ext/tk/lib/tkextlib/iwidgets/scrolledcanvas.rb: ditto.

Wed May 25 19:48:12 2005  Minero Aoki  <aamine@loveruby.net>

	* lib/fileutils.rb (rm_r): does chown(2). [ruby-dev:26199]

Wed May 25 12:59:48 2005  Tanaka Akira  <akr@m17n.org>

	* lib/open-uri.rb (OpenURI::Meta::RE_QUOTED_STRING): a content of
	  quoted-string should be zero or more characters.

Tue May 24 23:42:16 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* numeric.c (fix_pow): support Fixnum ** Float case directly
	  without coercing.  [ruby-talk:142697] [ruby-talk:143054]

Tue May 24 16:57:24 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* ruby.c (require_libraries): caused SEGV when continuation jumped
	  in to the required library code.

Tue May 24 17:45:59 2005  Shugo Maeda  <shugo@ruby-lang.org>

	* test/readline/test_readline.rb: do not test libedit.
	  fixed: [ruby-dev:26217]

Tue May 24 06:45:31 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* misc/ruby-mode.el (ruby-font-lock-syntactic-keywords): string
	  literals to be matched non-greedy.

Tue May 24 00:39:14 2005  NAKAMURA, Hiroshi  <nahi@ruby-lang.org>

	* test/soap/calc: method name 'set' was able to crash with a class Set.
	  [ruby-dev:26210]

	* test/wsdl/document/test_rpc.rb: dateTime comparison failed under
	  TZ=right/Asia/Tokyo (with leap second.) [ruby-dev:26208]

Mon May 23 16:23:06 2005  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/extconf.rb: Framework support on MacOS X Tiger.

	* ext/tk/README.tcltklib: add description of Framework support options.

Mon May 23 15:07:34 2005  NAKAMURA Usaku  <usa@ruby-lang.org>

	* win32/Makefile.sub ($(PROGRAM)): add dependency on $(LIBRUBY_SO).
	  [experimental]

Mon May 23 12:21:37 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* re.c (make_regexp): should not return junk address during
	  compile time.  [ruby-dev:26206]

Sun May 22 21:54:06 2005  NAKAMURA, Hiroshi  <nahi@ruby-lang.org>

	* lib/{soap,wsdl,xsd}, test/{soap,wsdl,xsd}: imported soap4r/1.5.4.

	  == SOAP client and server ==

	  === for both client side and server side ===

	  * improved document/literal service support.
	    style(rpc,document)/use(encoding, literal) combination are all
	    supported.  for the detail about combination, see
	    test/soap/test_style.rb.

	  * let WSDLEncodedRegistry#soap2obj map SOAP/OM to Ruby according to
	    WSDL as well as obj2soap.  closes #70.

	  * let SOAP::Mapping::Object handle XML attribute for doc/lit service.
	    you can set/get XML attribute via accessor methods which as a name
	    'xmlattr_' prefixed (<foo name="bar"/> -> Foo#xmlattr_name).

	  === client side ===

	  * WSDLDriver capitalized name operation bug fixed.  from
	    1.5.3-ruby1.8.2, operation which has capitalized name (such as
	    KeywordSearchRequest in AWS) is defined as a method having
	    uncapitalized name. (converted with GenSupport.safemethodname
	    to handle operation name 'foo-bar').  it introduced serious
	    incompatibility; in the past, it was defined as a capitalized.
	    define capitalized method as well under that circumstance.

	  * added new factory interface 'WSDLDriverFactory#create_rpc_driver'
	    to create RPC::Driver, not WSDLDriver (RPC::Driver and WSDLDriver
	    are merged).  'WSDLDriverFactory#create_driver' still creates
	    WSDLDriver for compatibility but it warns that the method is
	    deprecated.  please use create_rpc_driver instead of create_driver.

	  * allow to use an URI object as an endpoint_url even with net/http,
	    not http-access2.

	  === server side ===

	  * added mod_ruby support to SOAP::CGIStub.  rename a CGI script
	    server.cgi to server.rb and let mod_ruby's RubyHandler handles the
	    script.  CGIStub detects if it's running under mod_ruby environment
	    or not.

	  * added fcgi support to SOAP::CGIStub.  see the sample at
	    sample/soap/calc/server.fcgi.  (almost same as server.cgi but has
	    fcgi handler at the bottom.)

	  * allow to return a SOAPFault object to respond customized SOAP fault.

	  * added the interface 'generate_explicit_type' for server side
	    (CGIStub, HTTPServer).  call 'self.generate_explicit_type = true'
	    if you want to return simplified XML even if it's rpc/encoded
	    service.

	  == WSDL ==

	  === WSDL definition ===

	  * improved XML Schema support such as extension, restriction,
	    simpleType, complexType + simpleContent, ref, length, import,
	    include.

	  * reduced "unknown element/attribute" warnings (warn only 1 time for
	    each QName).

	  * importing XSD file at schemaLocation with xsd:import.

	  === code generation from WSDL ===

	  * generator crashed when there's '-' in defined element/attribute
	    name.

	  * added ApacheMap WSDL definition.

	* sample/{soap,wsdl}: removed.

Sun May 22 19:11:35 2005  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* ext/openssl/lib/openssl/ssl.rb (OpenSSL::SSL::SSLServer#intialize):
	  should initialize session id context. [ruby-core:4663]

	* ext/openssl/ossl_ssl.c (ossl_sslctx_setup): add session id support.

Sun May 22 12:30:58 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* intern.h, parse.y (ruby_pragma): removed.  fixed: [ruby-dev:26198]

	* parse.y (parser_pragma): pragma name was ignored.

Sun May 22 02:39:57 2005  Minero Aoki  <aamine@loveruby.net>

	* lib/fileutils.rb (rm_r): new option :secure to avoid
	  time-to-check-to-time-to-use security problem.  [ruby-dev:26100]

	* lib/fileutils.rb (remove_file, remove_dir): try chmod(700) only
	  on Windows.

	* lib/fileutils.rb: does not depend on find.rb.

	* lib/fileutils.rb: new method chmod_R.

	* lib/fileutils.rb (chown_R): did not work.

Sat May 21 10:23:21 2005  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* bcc32/Makefile.sub: tds files were not deleted when DESTDIR
	  included '\' path delimiter. [ruby-dev:26193]

Fri May 20 15:52:18 2005  Shugo Maeda  <shugo@ruby-lang.org>

	* ext/readline/readline.c (readline_attempted_completion_function):
	  return 2 items if completion_proc returns only 1 item (for libedit).

Fri May 20 01:24:33 2005  Shugo Maeda  <shugo@ruby-lang.org>

	* ext/readline/extconf.rb: check rl_vi_editing_mode() and
	  rl_emacs_editing_mode().

Thu May 19 23:33:09 2005  Shugo Maeda  <shugo@ruby-lang.org>

	* ext/readline/readline.c: supported libedit. fixed: [ruby-core:4858]

	* ext/readline/extconf.rb: added new option --enable-libedit.

	* test/readline/test_readline.rb: added assertions for
	  Readline::HISTORY.

	* lib/irb/input-method.rb: do not use Readline::HISTORY.pop.

Wed May 18 23:42:25 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* error.c (exc_exception): reverted to call Exception#initialize
	  directly.  fixed: [ruby-dev:26177]

Wed May 18 17:38:51 2005  WATANABE Hirofumi  <eban@ruby-lang.org>

	* dir.c (glob_helper): check whether path is "" before calling
	  do_opendir.  [ruby-dev:26183]

Wed May 18 13:40:48 2005  NAKAMURA Usaku  <usa@ruby-lang.org>

	* win32/win32.c (NtInitialize): fix typo.

Wed May 18 11:07:47 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* dir.c (glob_helper): get rid of using String.  [ruby-dev:26180]

	* eval.c (ruby_options), win32/win32.c (NtInitialize): move argument
	  intialization back.  [ruby-dev:26180]

Tue May 17 11:49:18 2005  NAKAMURA Usaku  <usa@ruby-lang.org>

	* win32/win32.c (unixtime_to_filetime): use localtime() instead of
	  gmtime() when using FileLocalTimeToFileTime().

Mon May 16 22:42:52 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* win32/win32.h, {bcc32,win32,wince}/Makefile.sub: moved rb_[ugp]id_t
	  to get rid of redefinition warnings on mingw.

	* class.c (rb_class_init_copy): singleton class is disallowed to copy,
	  from its definition.  fixed: [ruby-talk:142749]

	* parse.y (pragma_encoding): add prototype to suppress false warning
	  by VC.

	* process.c (proc_spawn_v): use rb_w32_aspawn on Win32.

Mon May 16 03:29:01 2005  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* win32/win32.{h,c}: define rb_[pgu]id_t.

Mon May 16 00:21:02 2005  Tanaka Akira  <akr@m17n.org>

	* lib/pathname.rb (Pathname#unlink): use SystemCallError instead of
	  Errno::EISDIR because EISDIR is not portable.
	  [ruby-core:5001]

Sun May 15 22:28:10 2005  Masatoshi SEKI  <m_seki@mva.biglobe.ne.jp>

	* lib/drb/drb.rb (DRbObject#method_missing): use raise(exception).
	  [ruby-dev:26164]

Sun May 15 18:56:35 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* configure.in, ruby.h: define rb_[pgu]id_t macros instead of typedefs
	  to get rid of types which might not be defined yet.  [ruby-dev:26165]

Sun May 15 14:35:46 2005  Tanaka Akira  <akr@m17n.org>

	* lib/pathname.rb (Pathname#unlink): unlink a symlink to a directory
	  was failed.  [ruby-core:4992]

Sun May 15 09:57:30 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* win32/win32.c (unixtime_to_filetime): deal with DST.
	  [ruby-talk:141817]

Sat May 14 23:59:11 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* error.c (exc_exception, {exit,name_err,syserr}_initialize): call
	  Execption#initialize.  fixed: [ruby-talk:142593]

Sat May 14 23:56:41 2005  Erik Huelsmann  <ehuels@gmail.com>

	* configure.in: Check for the availability of pid_t, gid_t and uid_t and
	  remove AC_TYPE_UID_T.  fixed: [ruby-core:04745]

	* defines.h: Remove pid_t typedef.

	* ruby.h: Define rb_pid_t, rb_gid_t and rb_uid_t in accordance with
	 the available system types.

	* process.c: Change instances of pid_t and gid_t to their rb_*
	 counterparts.

	* ext/pty/pty.c: Change pid_t to rb_pid_t.

	* vms/config.h: Define HAVE_{P,G,U}ID_T to 1.

	* win32/Makefile.sub: Remove #define for {g,u}id_t.

	* win32/win32.c: Change pid_t to rb_pid_t.

	* wince/Makefile.sub: Remove #define for {g,u}id_t.

	* wince/sys/types.h: Remove definitions of {p,g,u}id_t.

Sat May 14 11:47:57 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* intern.h (ruby_pragma): prototype.  [ruby-core:04881]

	* parse.y (parser_pragma): parse Emacsen hack.

	* parse.y (parser_prepare): deal with specific syntax at the top.

	* ruby.c (load_file): read the first line iff it started with shebang.

Fri May 13 23:44:22 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* ext/extmk.rb: keep srcdir unexpanded.

	* lib/mkmf.rb (create_makefile): quote topdir and hdrdir if necessary.
	  fixed: [ruby-core:04932]

	* lib/mkmf.rb (configuration), {bcc32,win32,wince}/Makefile.sub: make
	  also INSTALL_PROG and INSTALL_DATA system dependent.
	  fixed: [ruby-core:04931]

Fri May 13 23:32:55 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* eval.c (unknown_node): add volatile directive to prototype.

Fri May 13 17:50:49 2005  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* variable.c (generic_ivar_get): rb_attr_get should not warn.
	  [ruby-dev:26010]

Thu May 12 17:41:00 2005  NARUSE, Yui  <naruse@ruby-lang.org>

	* ext/nkf/nkf-utf8/nkf.c: follow nkf 2.0.5

Thu May 12 16:50:40 2005  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* lib/rdoc/parsers/parse_c.rb: more readability for mixing
	  progress "c..." and warning message.

Thu May 12 15:50:56 2005  Tilman Sauerbeck  <tilman@code-monkey.de>

	* lib/rdoc/parsers/parse_c.rb: show parsing progress for C files.
	  [ruby-core:4341]

Thu May 12 09:53:57 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* version.c (ruby_show_version): flush for non-tty stdout.

Thu May 12 01:23:55 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* eval.c (unknown_node): ignore broken NODE to get rid of accessing
	  possibly inaccessible address.  fixed: [ruby-dev:26122]
	  should emit more useful information like [ruby-dev:26126], though.

Wed May 11 15:58:39 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (break_jump): break should not cross functions.
	  [ruby-list:40818]

Wed May 11 10:41:54 2005  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* lib/tempfile.rb (Tempfile#unlink): fixed typo.

Wed May 11 01:03:36 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* eval.c (TMP_ALLOC): use macro NEW_NODE() to get rid of warnings on
	  platforms which have no alloca().  fixed: [ruby-talk:141301]

Sun May  8 23:17:47 2005  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/lib/tk/timer.rb: fix typo.

Sun May  8 21:00:50 2005  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* hash.c (Init_Hash): remove custom "hash" and "eql?".
	  (ported from 1.8) [ruby-dev:26132]

Sun May  8 16:50:25 2005  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* lib/profiler.rb: fixed "undefined method `[]' for nil:NilClass"
	  [ruby-core:4775] [ruby-talk:140401] [ruby-dev:26118]

Sat May  7 22:58:00 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* lib/mkmf.rb (have_var): no libs argument is given.

Fri May  6 08:08:37 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* hash.c:rb_hash_hash_i() should be static.  [ruby-core:04815]

	* re.c should include regint.h for declarations of oniguruma
	  functions.  [ruby-core:04815]

Sun May  1 09:15:17 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* ruby.c (process_sflag): replace '-' in variable names with '_'.
	  [ruby-dev:26107]

	* eval.c (rb_eval), parse.y (arg): reduce fixnum range literal at
	  parser.  fixed: [ruby-dev:26113]

Sat Apr 30 11:59:25 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* configure.in (RUBY_FUNC_ATTRIBUTE): check for function attribute.
	  [ruby-dev:26109]

	* eval.c, gc.c: moved noinline to configure.in.

	* rubyio.h (DEPRECATED): moved to configure.in.

	* ruby.h (DEPRECATED, NOINLINE): default definition.

	* win{32,ce}/Makefile.sub (config.h): deprecated and noinline for
	  __declspec() are available for VC++7 or later.

Sat Apr 30 06:57:39 2005  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* lib/webrick/cgi.rb: new methods WEBrick::CGI#[], WEBrick::CGI#logger
	  and WEBrick::CGI#config.  these are necessary to use an instance of
	  WEBrick::CGI as the first argument of HTTPServlet#get_instance.
	  (suggested by Tatsuki Sugiura)

	* lib/webrick/cgi.rb
	  (WEBrick::CGI#initalize): set a dummy to @config[:ServerSoftware]
	  if SERVER_SOFTWARE environment variable is not given.
	  (WEBrick::CGI#start): req.path_info must be a String.
	  (WEBrick::CGI::Socket#request_line): treat REQUEST_METHOD, PATH_INFO
	  and SCRIPT_NAME to run in console.

	* lib/webrick/httputils.rb (WEBrick::HTTPUtils.escape_path): should
	  not use String#split("/"). it removes trailing empty path component.

Thu Apr 28 08:21:51 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* ruby.c (set_arg0): use also environment variable space for setting
	  $0.  [ruby-core:04774]

Wed Apr 27 23:42:22 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* win32/Makefile.sub (OPTFLAGS): default global optimization to
	  disabled only for VC++6.

Tue Apr 26 22:58:00 2005  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/tcltklib.c (ip_invoke_core): call Tcl's "::unknown"
	  command when can't get information of target command.

Mon Apr 25 13:54:55 2005  speakillof  <speakillof@yahoo.co.jp>

	* lib/rexml/encodings/SHIFT-JIS.rb: encoding and decoding were
	  swapped. [ruby-core:4772]

Mon Apr 25 01:18:43 2005  Tanaka Akira  <akr@m17n.org>

	* oniguruma.h (OnigWarnFunc): add a variadic argument.
	  [ruby-core:4751]

Sat Apr 23 19:49:21 2005  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* ext/tk/tcltklib.c (ip_RubyExitCommand): exit with status code
	  via TclTkIp#_eval didn't work. [ruby-talk:139390]

Sat Apr 23 11:45:29 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* eval.c (rb_provided): should check also path name to be loaded.
	  fixed: [ruby-dev:26093]

Fri Apr 22 16:55:35 2005  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* ext/tk/tcltklib.c (ip_set_exc_message): fixed memory leak.

	* ext/tk/tcltklib.c: eTkCallbackReturn was not initialized.

Thu Apr 21 06:45:28 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* ruby.c (ruby_incpush_expand, proc_options): expand relative path
	  given with -I option.  [ruby-dev:26090]

	* configure.in, lib/mkmf.rb, {bcc32,win32,wince}/Makefile.sub: improve
	  C++ support.  [ruby-dev:26089]

Thu Apr 21 01:53:09 2005  Minero Aoki  <aamine@loveruby.net>

	* lib/net/http.rb: add rdoc.

Thu Apr 21 00:07:50 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* lib/mkmf.rb (create_makefile): support platforms have file separator
	  other than /.

	* {bcc32,win32,wince}/Makefile.sub (BUILD_FILE_SEPARATOR): separator
	  of building platform.

	* {bcc32,win32,wince}/Makefile.sub (CP, INSTALL): use COPY command.

Wed Apr 20 23:22:39 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* Makefile.in, common.mk: miniruby depends on MINIOBJS.

	* dmydln.c (dln_load): dummy function to raise LoadError.

	* cygwin/GNUmakefile.in, {bcc32,win32,wince}/Makefile.sub: miniruby
	  can't load extensions on Windows.

Wed Apr 20 23:01:35 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* win32/ifchange.bat: delete testing files.

Wed Apr 20 22:54:54 2005  Minero Aoki  <aamine@loveruby.net>

	* lib/net/http.rb: new method Net::HTTP.post_form.

	* lib/net/http.rb: new method Net::HTTPHeader#set_form_data and
	  its alias #form_data=.

	* lib/net/http.rb: Net::HTTPHeader#add_header -> add_field
	  (adjustted to Ruby 1.8).

Wed Apr 20 10:53:30 2005  WATANABE Hirofumi  <eban@ruby-lang.org>

	* lib/rdoc/parsers/parse_rb.rb (lex_init): use IRB module.
	  [ruby-core:04737]

Wed Apr 20 07:27:18 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* {bcc32,win32,wince}/configure.bat, {bcc32,win32,wince}/setup.mak:
	  add extout option.

	* bcc32/setup.mak: make configuration variables overridable.

Tue Apr 19 23:37:09 2005  WATANABE Hirofumi  <eban@ruby-lang.org>

	* lib/ftools.rb (File.safe_unlink): do not modify a symlinked file.

Tue Apr 19 23:02:40 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* eval.c (search_required): deal with features with path too.

	* intern.h (rb_file_expand_path): prototype.  fixed: [ruby-dev:26082]

Tue Apr 19 08:38:07 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* eval.c (search_required, rb_require_safe): expand path in
	  rb_features.  [ruby-dev:26079]

	* file.c (rb_find_file_ext): return absolute path.

	* ext/extmk.rb: expand path for ext/**/extconf.rb.

	* eval.c (search_required): handle static linked extensions.

Mon Apr 18 15:37:35 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (rb_attr): attribute name check added.

	* numeric.c (flo_plus): small typo fix.

Mon Apr 18 11:25:14 2005  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* ext/zlib/zlib.c (zstream_run): fixed SEGV. [ruby-core:4712]

Sun Apr 17 23:57:49 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* ext/extmk.rb (extmake, parse_args): do not expand destdir.

	* ext/extmk.rb (relative_from): treat mere drive letter as an absolute
	  path.

Sat Apr 16 17:01:16 2005  Kouhei Sutou  <kou@cozmixng.org>

	* sample/rss/tdiary_plugin/rss-recent.rb (rss_recent_cache_rss):
	  use the first date information of items as site date information
	  if channel doesn't have date information.

Sat Apr 16 15:27:03 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* configure.in (RUBY_PROG_INSTALL): not add -p option to INSTALL.
	  files need timestamps to be kept are only ar-archive on a few
	  platforms, and be installed by instruby.rb but not INSTALL.
	  fixed: [ruby-core:04721]

	* mkconfig.rb: purge autoconf value variables.

Sat Apr 16 10:33:48 2005  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* bcc32/Makefile.sub: quick hack... prepend DESTDIR.
	  still have restriction on DESTDIR ("", "/", "e:")

Sat Apr 16 03:59:42 2005  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* ext/openssl/extconf.rb: check for OPENSSL_cleanse.

	* ext/openssl/openssl_missing.h: ditto.

Fri Apr 15 22:40:19 2005  Masaki Suketa  <masaki.suketa@nifty.ne.jp>

	* ext/win32ole/tests/testWIN32OLE.rb: add test for WIN32OLE.codepage=

	* ext/win32ole/tests/testOLETYPELIB.rb: correct expected message.

Fri Apr 15 22:04:07 2005  Masaki Suketa  <masaki.suketa@nifty.ne.jp>

	* ext/win32ole/win32ole.c(ole_invoke): retry after converting Qnil
	  to VT_EMPTY.

Thu Apr 14 19:05:06 2005  Minero Aoki  <aamine@loveruby.net>

	* parse.y [ripper] (regexp): dispatch regexp option.
	  [ruby-Bugs:1688]

	* ext/ripper/lib/core.rb: regenerated (interface changed).

Thu Apr 14 18:59:43 2005  Minero Aoki  <aamine@loveruby.net>

	* lib/fileutils.rb (remove_file): ignore exceptions caused by
	  chmod.

	* lib/fileutils.rb (remove_dir): try to get rights to rmdir.
	  [ruby-Bugs:1502]

Thu Apr 14 18:51:02 2005  Keiju Ishitsuka  <keiju@ruby-lang.org>

	* lib/irb/ruby-lex.rb, lib/irb/slex.rb: bug fix of [ruby-Bugs-1745]

	* lib/irb/ext/loader.rb, lib/irb/ext/save-history.rb:
	  fix location of @RCS_ID

	* lib/irb/cmd/help.rb: a lost of release IRB 0.9.5.

Thu Apr 14 15:10:30 2005  Keiju Ishitsuka  <keiju@ruby-lang.org>

	* lib/irb/notifier.rb, lib/irb/output-method.rb, lib/irb/ext/history.rb
	  fixed warning of 'ruby -w'

Thu Apr 14 05:35:45 2005  Keiju Ishitsuka  <keiju@ruby-lang.org>

	* doc/irb/irb.rd.ja: a lost  of release IRB 0.9.5.

	* lib/irb/slex.rb: bug fix by [ruby-core:04707].

Thu Apr 14 00:20:31 2005  Keiju Ishitsuka  <keiju@ruby-lang.org>

	* bin/irb lib/irb.rb lib/irb/...: IRB 0.9.5.

Wed Apr 13 23:40:21 2005  Kouhei Sutou  <kou@cozmixng.org>

	* lib/rss/rss.rb (RSS::VERSION): 0.1.3 -> 0.1.4.

	* lib/rss/rss.rb (RSS::Element#converter): fixed converter
	  transmission bug.

Wed Apr 13 22:12:16 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* lib/optparse.rb (OptionParser#order!): call handlers iff matches
	  non-switch.

Wed Apr 13 21:20:35 2005  WATANABE Hirofumi  <eban@ruby-lang.org>

	* configure.in (mingw32): extract msvcr*.dll from objdump result.

Wed Apr 13 19:25:31 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* configure.in (mingw32): use actual runtime DLL name as ruby DLL
	  name and default load path.

	* win32/Makefile.sub, win32/setup.mak: ditto.

Tue Apr 12 19:30:36 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* lib/optparse.rb (OptionParser#make_switch, OptionParser#order!):
	  added non-option and end-of-args handler.  [ruby-talk:136878]
	  [EXPERIMENTAL]

Tue Apr 12 15:33:09 2005  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/tcltklib.c (ip_finalize): better modification than the
	  previous commit [ruby-dev:26029].

Tue Apr 12 12:38:06 2005  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/tcltklib.c (ip_finalize): fix SEGV when Tcl_GlobalEval()
	  modifies the argument string to eval.

Tue Apr 12 02:21:55 2005  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/tcltklib.c (ip_finalize): add existence check of
	  Tcl commands before calling Tcl_GlobalEval().

Mon Apr 11 23:36:04 2005  Masatoshi SEKI  <m_seki@mva.biglobe.ne.jp>

	* lib/drb/drb.rb: [druby-ja:123] fix: When reference of my object is
	  loaded, the object is tainted.

	* test/drb/test_drb.rb: ditto.

Mon Apr 11 22:18:23 2005  WATANABE Hirofumi  <eban@ruby-lang.org>

	* dir.c, file.c (lstat): avoid warnings for mingw.

Mon Apr 11 20:11:06 2005  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/tcltklib.c (ip_finalize): adhoc patch to avoid SEGV when exit
	  on Tcl/Tk8.3.x.

Mon Apr 11 15:24:20 2005  NAKAMURA Usaku  <usa@ruby-lang.org>

	* lib/mkmf.rb (configuration): shouldn't output hdrdir twice.

Sat Apr  9 18:20:31 2005  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/lib/tk/image.rb: support to create TkImage object without
	  creating a new image object on Tk.

	* ext/tk/lib/tk/menu.rb: use TkCommandNames on create_self()

	* ext/tk/lib/tk/root.rb: TkRoot.to_eval() returns '.'.

	* ext/tk/lib/tk/text.rb: add methods to create a TkText::IndexString
	  from (x, y) coords.

	* ext/tk/lib/tkextlib/tile/: add demo and update support status.

Sat Apr  9 14:42:29 2005  Kouhei Sutou  <kou@cozmixng.org>

	* sample/rss/tdiary_plugin/rss-recent.rb: supported configuration
	  via Web browser.

Fri Apr  8 20:17:48 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* ext/extmk.rb (extmake): hdrdir needs to be defined also in
	  Config::CONFIG.

	* lib/mkmf.rb (configuration, create_makefile): get rid of recursive
	  macro reference.

Fri Apr  8 01:55:20 2005  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/sample/demos-{en,jp}/goldberg.rb: reduced window size.
	  [ruby-dev:25992]

Thu Apr  7 23:58:40 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* ext/extmk.rb (extmake): keep directory names in Makefile as macros.

	* lib/mkmf.rb (configuration, create_makefile): ditto.

	* lib/mkmf.rb (CXX_EXT): separate C++ extensions.

Thu Apr  7 17:24:17 2005  Shugo Maeda  <shugo@ruby-lang.org>

	* eval.c (rb_call0): "return" event hook should be always executed
	  if event_hooks is set.

Thu Apr  7 14:33:09 2005  Kouhei Sutou  <kou@cozmixng.org>

	* test/rss/test_maker_dc.rb (test_date): added a test for #date=
	  and #dc_date=.

Thu Apr  7 11:49:53 2005  Kouhei Sutou  <kou@cozmixng.org>

	* lib/rss/maker/dublincore.rb: _really_ supported multiple Dublin
	  Core items.

	* test/rss/rss-assertions.rb (assert_multiple_dublin_core): added
	  an assertion for testing multiple Dublin Core items.

	* test/rss/test_maker_dc.rb (test_rss10_multiple): added a test
	  for making multiple Dublin Core items.

Wed Apr  6 16:06:30 2005  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* test/ruby/test_env.rb (test_key): should test ENV.key instead of
	  ENV.index. [ruby-dev:25994]

Tue Apr  5 16:01:12 2005  Kouhei Sutou  <kou@cozmixng.org>

	* lib/rss/*: refactored.
	  - gave a name to 'x'.
	  - undef_method -> remove_method for avoiding a warning in ruby 1.6.

Tue Apr  5 15:45:33 2005  Kouhei Sutou  <kou@cozmixng.org>

	* sample/rss/tdiary_plugin/rss-recent.rb:
	  new option: @options['rss-recent.use-image-link']:
	  use image as link instread of text if available.

	* sample/rss/tdiary_plugin/rss-recent.rb (RSS_RECENT_VERSION):
	  0.0.5 -> 0.0.6.

Tue Apr  5 15:15:26 2005  Kouhei Sutou  <kou@cozmixng.org>

	* lib/rss/dublincore.rb: supported multiple Dublin Core items.

	* lib/rss/parser.rb: added class name registry for complex model
	  elements. (ex. have childlen elements, have some attributes and
	  a child element and so on.)

	* lib/rss/maker/base.rb: added default current_element implementation.

	* lib/rss/maker/dublincore.rb: supported multiple Dublin Core
	  items.

	* lib/rss/maker/image.rb: supproted new Dublin Core API.


	* lib/rss/trackback.rb (RSS::TrackBackUtils.new_with_value_if_need):
	  moved to RSS::Utils.

	* lib/rss/utils.rb (RSS::Utils.new_with_value_if_need):
	  moved from RSS::TrackBackUtils.


	* lib/rss/maker/image.rb: fixed invalid argument of
	  add_need_initialize_variable bug.

	* lib/rss/maker/trackback.rb: ditto.


	* lib/rss/rss.rb (Hash#merge): added for ruby 1.6.

	* lib/rss/rss.rb (RSS::BaseModel.date_writer): changed to accept nil
	  for date value.


	* test/test_dublincore.rb: added tests for plural accessor and
	  multiple Dublin Core items.

	* test/test_setup_maker_1.0.rb: fixed swapped actual and expected
	  values.

Mon Apr  4 23:17:52 2005  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/lib/tk.rb (TkComm#array2tk_list): accept enc-mode argument to
	  decide whether convert encoding of each element or not.

	* ext/tk/lib/tk/variable.rb (TkVariable#value=): fail to convert the
	  encoding of array elements when assign an array to an TkVariable
	  object.

Mon Apr  4 10:26:48 2005  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* ext/tk/lib/tk/dialog.rb: fixed typo.

Sat Apr  2 23:38:54 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* configure.in (CP, INSTALL): get rid of less portable options.

	* lib/mkmf.rb (configuration, create_makefile): correct configuration
	  variable.

	* wince/configure.bat, wince/setup.mak: add prefix, extstatic and
	  rdoc options.

	* lib/mkmf.rb (create_makefile): ensure library directories get made
	  before copying libraries there.

Sat Apr  2 16:59:46 2005  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/lib/tk.rb: forgot to update RELEASE_DATE

	* ext/tk/lib/tk/variable.rb: fix namespace trouble when autoloading

	* ext/tk/lib/tk/palette.rb: define Tcl variable 'tkPalette' as global

	* ext/tk/lib/tk/dialog.rb: use array2tk_list method when calling
	  Tk.ip_eval.

	* ext/tk/lib/tk/autoload.rb: add autoload entry 'TkDialogObj' and
	  'TkWarningObj'

Sat Apr  2 13:23:17 2005  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* hash.c (env_key): ENV.index is deprecated as well as Hash#index.
	  use ENV.key instead. [ruby-dev:25974]

Sat Apr  2 02:19:11 2005  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/lib/tk.rb (TkWindow.initialize): accept 'without_creating'
	  option without 'widgetname' option to allow creating a widget object
	  which is used as an argument of Tcl/Tk's widget allocation commands.

	* ext/tk/lib/tk/image.rb (TkImage.initialize): accept 'imagename'
	  option to create a image object by the given name.

Thu Mar 31 22:23:51 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* lib/mkmf.rb (SRC_EXT): exclude just case different suffixes on case
	  insensitive file system platforms.

	* README.EXT, README.EXT.ja (Appendix C): utility functions.

Thu Mar 31 14:08:43 2005  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* ext/openssl/ossl_engine.c (ossl_engine_s_load): should return
	  value. [ruby-dev:25971]

Thu Mar 31 11:07:50 2005  Kouhei Sutou  <kou@cozmixng.org>

	* lib/rss/parser.rb: @@setter -> @@setters.

	* lib/rss/parser.rb
	  (RSS::BaseListener.register_uri)
	  (RSS::BaseListener.uri_registered?)
	  (RSS::BaseListener.install_get_text_element):
	  swapped the first argument and the second argument.

	* lib/rss/taxonomy.rb: swapped the first argument and the second
	  argument for RSS::BaseListener.install_get_text_element.
	* lib/rss/image.rb: ditto.
	* lib/rss/syndication.rb: ditto.
	* lib/rss/dublincore.rb: ditto.
	* lib/rss/parser.rb: ditto.
	* lib/rss/1.0.rb: ditto.
	* lib/rss/2.0.rb: ditto.
	* lib/rss/0.9.rb: ditto.
	* lib/rss/content.rb: ditto.

Thu Mar 31 11:00:36 2005  Kouhei Sutou  <kou@cozmixng.org>

	* lib/rss/parser.rb
	  (RSS::BaseListener.install_setter)
	  (RSS::BaseListener.register_uri): changed fallback way.

Thu Mar 31 08:25:40 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* common.mk (RUBYOPT): clear for the environment RubyGems installed.

	* common.mk (clean-local): keep $(PREP) files till distclean.

	* common.mk (check): do all tests.

Thu Mar 31 06:00:20 2005  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* ext/openssl/ossl_engine.c (ossl_engine_s_load): should not raise
	  error even if the specified engine could not be loaded. (Dynamic
	  engines don't have fixed name to load.)

Wed Mar 30 17:41:48 2005  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/tcltklib.c: add TclTkIp#_create_console() method to create
	  a Tcl/Tk's console window.

	* ext/tk/lib/multi-tk.rb: support TclTkIp#_create_console() method.

	* ext/tk/lib/remote-tk.rb: ditto.

	* ext/tk/lib/tk/console.rb: ditto.

	* ext/tk/lib/tk.rb: update RELEASE_DATE

	* ext/tk/sample/demo-*/check2.rb: use 'return' in the Proc object.

	* ext/tk/sample/tkextlib/**: ditto.

Tue Mar 29 22:20:49 2005  Masatoshi SEKI  <m_seki@mva.biglobe.ne.jp>

	* test/rinda/test_rinda.rb: use DRbObject.new_with instead of reinit.
	  [ruby-dev:25961]

Tue Mar 29 00:04:57 2005  Masatoshi SEKI  <m_seki@mva.biglobe.ne.jp>

	* lib/drb/drb.rb: move method DRbObject#reinit to DRbObject.new_with.
	  extract method DRbObject.prepare_backtrace. add DRb.regist_server,
	  remove_server, fetch_server. change server in thread variable if
	  in-proc server. [druby-ja:113]

	* lib/drb/gw.rb: ditto.

Mon Mar 28 20:53:44 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* ext/extmk.rb (extract_makefile): nothing to be removed when no file
	  was deleted.

	* ext/extmk.rb (extmake): restore srcdir.

Mon Mar 28 08:39:49 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* ext/iconv/iconv.c (iconv_create): Iconv::Failure requires 3
	  arguments.  (pointed out by NaHi)

Sun Mar 27 00:56:58 2005  Minero Aoki  <aamine@loveruby.net>

	* lib/fileutils.rb (remove_file): ignore Errno::E* if force option
	  is set. [ruby-dev:25944]

Sat Mar 26 22:51:33 2005  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/lib/tk.rb (_callback_entry_class?): add for checking whether
	  a class is available for a callback entry.

	* ext/tk/lib/tk.rb (after_cancel): add Tk.after_cancel(afterID) method.

	* ext/tk/lib/tk.rb (array2tk_list): change from private module method
	  of TkComm to public module method.

	* ext/tk/lib/tk.rb (cget): add check that slot argument is not
	  empty string.

	* ext/tk/lib/tk.rb (configinfo): ditto.

	* ext/tk/lib/tk/itemconfig.rb (itemcget): add check that slot argument
	  is not empty string.

	* ext/tk/lib/tk/itemconfig.rb (itemconfiginfo): ditto.

	* ext/tk/lib/tk/entry.rb: add TkEntry#icursor and icursor= (alias of
	  cursor and cursor= method).

	* ext/tk/lib/tk/font.rb: improve font treatment when the font name is
	  empty string.

	* ext/tk/lib/tk/variable.rb: add :variable, :window and :procedure
	  type.

	* ext/tk/lib/tk/variable.rb: improve treatment of array-type
	  tkvariable.

	* ext/tk/lib/tkextlib/blt.rb: add commands for zooming.

	* ext/tk/lib/tkextlib/blt/*: bug fix.

	* ext/tk/lib/tkextlib/treectrl/tktreectrl.rb: bug fix and add methods
	  to call TreeCtrl commands for bindings.

	* ext/tk/sample/tkextlib/blt/*: new sample scripts.

	* ext/tk/sample/tkextlib/treectrl/*: ditto.

Fri Mar 25 10:53:16 2005  WATANABE Hirofumi  <eban@ruby-lang.org>

	* configure.in (WIN32_LEAN_AND_MEAN): removed because a lot of
	  troubles.  [ruby-list:40721]

Thu Mar 24 23:10:44 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* lib/mkmf.rb (macro_defined?): try to compile for an old compiler
	  which doesn't bail out at #error directive.  [ruby-dev:25818]

	* lib/mkmf.rb (check_sizeof): refine logging messages.

Wed Mar 23 19:08:10 2005  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* lib/webrick/utils.rb (WEBrick::Utils.create_listeners):
	  - should raise ArgumentError if no port is specified.
	  - even if the specified port is 0, all TCPServers should be
	    initialized with the port given to the first one.

	* lib/webrick/server.rb (WEBrick::GenericServer#initialize): if :Port
	  parameter is 0, it should be updated with the port number which
	  ectually listened.

Wed Mar 23 16:12:40 2005  Shugo Maeda  <shugo@ruby-lang.org>

	* parse.y (primary): fix lineno of rescue and ensure.

Wed Mar 23 00:39:05 2005  Shugo Maeda  <shugo@ruby-lang.org>

	* test/ruby/test_settracefunc.rb (test_event): added tests for
	  "class" and "end" and "raise".

Sun Mar 20 22:51:19 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* lib/mkmf.rb (mkmf_failed): check if Makefile is created without
	  create_makefile.

Sat Mar 19 23:48:10 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* misc/ruby-mode.el (ruby-expr-beg): returned true always.
	  fixed: [ruby-list:40683]

Sat Mar 19 00:41:02 2005  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/lib/tk/font.rb: add some TkFont class methods to get font
	  information without creating a TkFont object.

	* ext/tk/lib/tkextlib/treectrl/tktreectrl.rb: bug fix and define some
	  classes for components of Tk::TreeCtrl

Thu Mar 17 17:42:13 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* struct.c (make_struct): allow non local-id field
	  names. [ruby-core:04575]

	* struct.c (inspect_struct): ditto.

Wed Mar 16 23:39:13 2005  Shugo Maeda  <shugo@ruby-lang.org>

	* test/ruby/test_settracefunc.rb: added test for c-return.

Wed Mar 16 22:57:43 2005  Shugo Maeda  <shugo@ruby-lang.org>

	* eval.c (rb_call0): call_cfunc() should be protected.

	* eval.c (rb_add_event_hook): use K&R style.

	* eval.c (rb_remove_event_hook): ditto.

Wed Mar 16 22:03:15 2005  Shugo Maeda  <shugo@ruby-lang.org>

	* eval.c (rb_add_event_hook): new function to add a hook function for
	  interpreter events.

Wed Mar 16 18:08:32 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (rb_call0): reorganize "return" event post.

	* eval.c (return_jump): no need to post "return" event here.

Tue Mar 15 23:49:19 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* ext/iconv/iconv.c (Init_iconv): InvalidEncoding also should include
	  Iconv::Failure.

Tue Mar 15 23:12:36 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* eval.c (recursive_check, recursive_push): more restrictive check.
	  fixed: [ruby-dev:25916]

Tue Mar 15 16:38:31 2005  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/tkutil/tkutil.c (ary2list): give wrong arguments to hash2kv()

Mon Mar 14 19:39:33 2005  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/lib/tk/timer.rb (TkTimer): forgot to clear @return_value
	  when restarting

	* ext/tk/lib/tk/sample/cd_timer.rb: new sample of TkRTTimer

Mon Mar 14 12:21:03 2005  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/lib/tk/timer.rb (TkRTTimer): forgot to reset the callback
	  time. So, 'continue' do all callbacks between 'stop' and 'continue'.

Mon Mar 14 08:14:56 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* object.c (str_to_id): raise ArgumentError for NUL containing
	  strings.

Mon Mar 14 00:13:49 2005  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/lib/tk/timer.rb (TkRTTimer): correct calculation of offset
	  value. get a little better accuracy.

	* ext/tk/sample/demos-en/widget: use a binding with no local variables
	  when eval a sample script.

	* ext/tk/sample/demos-en/bind.rb: ditto.

	* ext/tk/sample/demos-en/tcolor: ditto.

	* ext/tk/sample/demos-jp/widget: ditto.

	* ext/tk/sample/demos-jp/bind.rb: ditto.

	* ext/tk/sample/demos-jp/tcolor: ditto.

Sun Mar 13 22:19:17 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* eval.c (recursive_pop): raise TypeError instead of fatal error.
	  fixed: [ruby-dev:25843]

Sun Mar 13 10:09:17 2005  Masatoshi SEKI  <m_seki@mva.biglobe.ne.jp>

	* test/rinda/test_rinda.rb: remove test_gc. [ruby-dev:25871]

Sun Mar 13 02:32:54 2005  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* ext/openssl/ossl_ssl.c (ossl_tmp_dh_callback): should get DH
	  parameter from the current SSL object.

Sun Mar 13 02:09:03 2005  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* ext/openssl/ossl_pkey_dh.c (ossl_create_dh): fix typo.
	  patch from IWATSUKI Hiroyuki. [ruby-dev:25867]

	* ext/openssl/ossl_ssl.c (ossl_tmp_dh_callback): ditto.
	  (ossl_call_tmp_dh_callback): ditto

Fri Mar 11 03:24:59 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* parse.y (primary): wrong var node was set for NODE_LAMBDA.
	  [ruby-core:04555]

Thu Mar 10 19:10:29 2005  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/tcltklib.c (lib_eventloop_ensure): mis-delete a timer handler
	  when exit from a recursive called eventloop

	* ext/tk/lib/tk/timer.rb: new TkRTTimer class, which can works for a
	  realtime operation

	* ext/tk/sample/tkrttimer.rb: sample of TkRTTimer class

	* ext/tk/lib/tk/textmark.rb: move  TkTextMark#+ and TkTextMark#- to
	  TkText::IndexModMethods

	* ext/tk/lib/tk/text.rb: improve TkTextMark#+ and TkTextMark#-, and
	  add them to TkText::IndexModMethods module

	* ext/tk/sample/tktextio.rb: add test part of "seek by text index
	  modifiers"

Thu Mar 10 08:10:11 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* re.c (make_regexp): need to free internal regexp structure when
	  compilation fails.  [ruby-talk:133228]

Thu Mar 10 01:08:20 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* parse.y (bv_decl): remove initialize rule from block local
	  variable declaration.

Wed Mar  9 23:55:34 2005  Tanaka Akira  <akr@m17n.org>

	* lib/pp.rb (PP::PPMethods#guard_inspect_key): support
	  __recursive_key__.  [ruby-dev:25821]

Wed Mar  9 19:42:21 2005  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* ext/openssl/ossl_ssl.c: OpenSSL::SSL::SSLContexts suports callbacks:
	  - SSLContext#client_cert_cb is a Proc. it is called when a client
	    certificate is requested by a server and no certificate was yet
	    set for the SSLContext. it must return an Array which includes
	    OpenSSL::X509::Certificate and OpenSSL::PKey::RSA/DSA objects.
	  - SSLContext#tmp_dh_callback is called in key exchange with DH
	    algorithm. it must return an OpenSSL::PKey::DH object.

	* ext/openssl/ossl_ssl.c:
	  (ossl_sslctx_set_ciphers): ignore the argument if it's nil.
	  (ossl_start_ssl, ossl_ssl_write): call rb_sys_fail if errno isn't 0.
	  [ruby-dev:25831]

	* ext/openssl/ossl_pkey.c
	  (GetPrivPKeyPtr, ossl_pkey_sign): should call rb_funcall first.
	  (DupPrivPKeyPtr): new function.

	* ext/openssl/ossl_pkey_dh.c: add default DH parameters.

	* ext/openssl/ossl_pkey.h: ditto.

	* ext/openssl/lib/openssl/cipher.rb: fix typo. [ruby-dev:24285]

Wed Mar  9 18:09:51 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* parse.y (gettable_gen): warns if VCALL name is used as
	  out-of-scope block local variable.  [EXPERIMENTAL]

	* parse.y (opt_bv_decl): add explicit block local variable
	  declaration.  raises error for name conflicts.  [EXPERIMENTAL]

Wed Mar  9 13:37:57 2005  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/sample/tktextio.rb: fix bug of handling 'end' position.
	  support initial text, overwrite setting and pos_gravity control.

Tue Mar  8 18:16:55 2005  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/sample/tktextio.rb: New sample script. TkTextIO class in this
	  sample supports to use a text widget as if it is a I/O stream (such
	  like as StringIO class).

Tue Mar  8 13:39:25 2005  NAKAMURA Usaku  <usa@ruby-lang.org>

	* ext/socket/mkconstants.rb: workaround for some of 4.4BSD-Lite
	  derived OSs.

Tue Mar  8 12:36:17 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* ext/socket/socket.c: document from Sam Roberts
	  <sroberts@uniserve.com> for getsockopt and setsockopt is merged.
	  [ruby-doc:824]

Tue Mar  8 10:48:53 2005  NAKAMURA Usaku  <usa@ruby-lang.org>

	* eval.c (rb_exec_recursive): declaration should precede statements
	  before C99.

Tue Mar  8 10:05:40 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* error.c (errno_missing): Errno.const_missing to allow references
	  to SyscallError exceptions not defined on the platform.
	  [ruby-core:04522]

	* error.c (Init_syserr): Errno::NOERROR(0) for fallback exception.

Tue Mar  8 01:19:00 2005  NARUSE, Yui  <naruse@ruby-lang.org>

	* ext/nkf/nkf-utf8/nkf.c: follow nkf 1.66
	  fixed: [ruby-dev:25828]

Mon Mar  7 21:29:40 2005  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* lib/webrick/server.rb (WEBrick::GenericServer#start): should
	  restore @token if accept failure. suggested by Dominique Brezinski.
	  [ruby-core:04518]

	* sample/webrick/httpsd.rb: fix typo in comment. suggested by
	  Kazuhiko Shiozaki.

Mon Mar  7 21:01:37 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* eval.c (rb_require_safe): get actual path string under safe level
	  when requested.  fixed: [ruby-dev:25815]

Mon Mar  7 16:46:02 2005  NAKAMURA Usaku  <usa@ruby-lang.org>

	* ext/openssl/ossl_ssl.c (ossl_start_ssl, ossl_ssl_read,
	  ossl_ssl_write): need to set errno on Win32 platform.

Mon Mar  7 14:55:43 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (block_pass): should not push unique number if a block is
	  not an orphan.  [ruby-dev:25808]

Mon Mar  7 14:13:23 2005  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* ext/openssl/lib/openssl/buffering.rb (Buffering#initialize):
	  should set @eof and @rbuffer.

Mon Mar  7 10:28:00 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* object.c (inspect_obj): unintended space removal.
	  [ruby-dev:25810]

	* eval.c (rb_exec_recursive): should not use NODE in disclosed
	  context.  [ruby-dev:25812]

	* io.c (rb_f_open): need not to check if to_open value is a
	  T_FILE.  [ruby-dev:25812]

Mon Mar  7 01:21:01 2005  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/tkutil/tkutil.c: follow the change of st.c (committed
	  at Fri, 4 Mar 2005 15:47:47 +0900 by matz)

Mon Mar  7 00:01:55 2005  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/tcltklib.c: fail to call TclTkLib.mainloop when $SAFE==4

Sun Mar  6 13:04:10 2005  Dee Zsombor  <zsombor@ruby-lang.org>

	* misc/ruby-electric.el: added.
	* misc/Readme: updated.

Sun Mar  6 11:47:10 2005  Sam Roberts  <sroberts@uniserve.com>

	* lib/pp.rb: rdoced.  [ruby-core:4490]

Sun Mar  6 11:36:37 2005  Tanaka Akira  <akr@m17n.org>

	* lib/pp.rb (File::Stat#pretty_print): Etc.getpwuid and Etc.getgrgid
	  may return nil.  [ruby-talk:129826]
	  reported by Daniel Berger.

Sun Mar  6 06:34:31 2005  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* ext/openssl/ossl_ssl.c (ossl_start_ssl): should wait for that
	  the underlying IO become readable or writable if the error was
	  SSL_ERROR_WANT_READ or SSL_ERROR_WANT_WRITE. [ruby-dev:25795]

	* ext/openssl/ossl_ssl.c (ossl_ssl_read, ossl_ssl_write): ditto.

	* ext/openssl/lib/openssl/buffering.rb
	  (Buffering#consume_rbuf): pointless eof flag resetting is deleted.
	  (Buffering#read): should return an empty string if the specified
	  size is zero.
	  (Buffering#readpartial): new method.
	  (Buffering#readline): fix typo.
	  (Buffering#getc): return the first character of string correctly.
	  (Buffering#readchar): fix typo.
	  (Buffering#eof?): should read again it the input buffer is empty.
	  (Buffering#do_write): should rescue Errno::EAGAIN.
	  (Buffering#puts): use "\n" as the output field separator.

	* ext/openssl/extconf.rb: get rid of GNUmakefile generation.

	* text/openssl/test_pair.rb: test for IO like methods.

	* test/ruby/ut_eof.rb: test about empty file.

Sat Mar  5 17:48:31 2005  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* dir.c (rb_glob): fixed mismatch of argument.

	* dir.c (fnmatch): removed unnecessary code. (by string.c 1.219)

	* win32/win32.c (NtInitialize): ditto. (by numeric.c 1.117)

Sat Mar  5 16:50:00 2005  NARUSE, Yui  <naruse@ruby-lang.org>

	* ext/nkf/nkf-utf8/nkf.c: follow nkf 1.65

Sat Mar  5 16:29:26 2005  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/lib/multi-tk.rb: freeze callback-entry objects

	* ext/tk/lib/tkextlib/tile.rb: support tile-0.6

Sat Mar  5 12:52:08 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* lib/mkmf.rb (create_makefile): allow putting spaces between target
	  and colon in depend file.

Sat Mar  5 02:41:00 2005  NAKAMURA Usaku  <usa@ruby-lang.org>

	* file.c (eaccess): workaround for VC++8 runtime.

	* win32/win32.c (ioinfo): VC++8 support.

Fri Mar  4 19:39:55 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* lib/rdoc/parsers/parse_c.rb (RDoc::C_Parser#do_includes): replace
	  also locally defined modules.

	* ext/iconv/iconv.c: rdocified.

	* ext/strscan/strscan.c: moved misplaced rdoc.

Fri Mar  4 16:11:20 2005  NAKAMURA Usaku  <usa@ruby-lang.org>

	* eval.c (rb_exec_recursive): matched the declaration to prototype.

	* ext/curses/curses.c: don't need to check HAVE_WCOLOR_SET excluding
	  window_color_set().

	* ext/tk/tcltklib.c: fixed commit mistakes.

Fri Mar  4 12:45:17 2005  Tilman Sauerbeck  <tilman@code-monkey.de>

	* lib/rdoc/parsers/parse_c.rb: allow whitespace after function names.
	  [ruby-core:4296]

	* lib/rdoc/parsers/parse_simple.rb: adds support for private comments
	  in the "simple" parser. [ruby-core:4301]

Fri Mar  4 12:45:17 2005  Charles Mills  <cmills@freeshell.org>

	* lib/rdoc/parsers/parse_c.rb: adds support for constants
	  (rb_define_const), accessors (rb_define_attr), and makes a
	  couple fixes. [ruby-core:4307]

Fri Mar  4 12:45:17 2005  Florian Gross  <florgro@gmail.com>

	* lib/rdoc/parsers/parse_rb.rb: Logic for def Builtin.method() end
	  [ruby-core:4302]

Fri Mar  4 12:45:17 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* array.c: replace rb_protect_inspect() and rb_inspecting_p() by
	  rb_exec_recursive() in eval.c.

	* eval.c (rb_exec_recursive): new function.

	* array.c (rb_ary_join): use rb_exec_recursive().

	* array.c (rb_ary_inspect, rb_ary_hash): ditto.

	* file.c (rb_file_join): ditto.

	* hash.c (rb_hash_inspect, rb_hash_to_s, rb_hash_hash): ditto.

	* io.c (rb_io_puts): ditto.

	* object.c (rb_obj_inspect): ditto

	* struct.c (rb_struct_inspect): ditto.

Fri Mar  4 10:15:30 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* lib/set.rb (SortedSet::setup): a hack to shut up warning.
	  [ruby-talk:132866]

Fri Mar  4 09:37:12 2005  NAKAMURA Usaku  <usa@ruby-lang.org>

	* common.mk (install-nodoc, pre-install-doc, post-install-doc):
	  fix some omissions.

Fri Mar  4 08:09:12 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* lib/time.rb (Time::strptime): add new function.  inspired by
	  [ruby-talk:132815].

	* lib/parsedate.rb (ParseDate::strptime): ditto.

Fri Mar  4 07:07:00 2005  NARUSE, Yui  <naruse@ruby-lang.org>

	* ext/nkf/nkf-utf8/nkf.c: follow nkf 1.63

Thu Mar  3 23:24:00 2005  NARUSE, Yui  <naruse@ruby-lang.org>

	* ext/nkf/nkf-utf8/nkf.c: follow nkf 1.62

Thu Mar  3 18:47:18 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* {bcc32,win32,wince}/Makefile.sub (config.h): check if affected
	  when makefiles are modified.

	* {bcc32,win32,wince}/Makefile.sub (config.status): add variables
	  for tests.

	* win32/ifchange.bat: try to update a file only if modified.

	* win32/resource.rb: more descriptions.

	* common.mk: add {pre,post}-install targets.

	* instruby.rb (install?): install particular part.

	* bcc32/Makefile.sub (post-install-ext): remove debug information
	  files after installation.

	* ext/tk/tcltklib.c (ip_rbUpdateCommand, ip_rb_threadUpdateCommand):
	  get rid of warnings with Tcl/Tk 8.3 or former.

Thu Mar  3 11:49:51 2005  Kouhei Sutou  <kou@cozmixng.org>

	* sample/rss/tdiary_plugin/rss-recent.rb: added site information.

Wed Mar  2 19:53:44 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* ext/extmk.rb (parse_args): return false if nothing matched.

Wed Mar  2 17:15:08 2005  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/tcltklib.c (lib_eventloop_core): fix typo

Wed Mar  2 16:59:50 2005  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* eval.c (ruby_native_thread_kill): call pthread_kill() to send a
	  signal to ruby's native thread

	* ruby.h: add definition of ruby_native_thread_kill()

	* signal.c (sigsend_to_ruby_thread): send the signal to ruby's
	  native thread ([ruby-dev:25744], [ruby-dev:25754]), and set
	  signal mask to the current native thread

Wed Mar  2 16:03:08 2005  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/tcltklib.c: enforce thread-check and exception-handling to
	  avoid SEGV trouble.

	* ext/tk/tkutil/tkutil.c; fix a bug on converting a SJIS string array
	  to a Tcl's list string.

	* ext/tk/tcltklib.c: wrap Tcl's original "namespace" command to
	  protect from namespace crash.

	* ext/tk/lib/multi-tk.rb: enforce exception-handling.

	* ext/tk/lib/multi-tk.rb: catch IRB_EXIT to work on irb.

	* ext/tk/lib/tk.rb: ditto.

	* ext/tk/tcltklib.c: add TclTkLib.mainloop_thread?

	* ext/tk/lib/multi-tk.rb: (bug fix) callback returns a value.

	* ext/tk/lib/tk/canvas.rb (delete): bug fix when multiple arguments.

	* ext/tk/lib/clock.rb: fix 'no method error'.

	* ext/tk/lib/clock.rb (self.clicks): accept a Symbol argument.

	* ext/tk/lib/variable.rb: be able to set default_value_type; :numeric,
	  :bool, :string, :symbol, :list, :numlist or nil (default; same to
	  :string). If set a type, TkVariable#value returns a value of the
	  type.

	* ext/tk/lib/tkextlib/tclx/tclx.rb: add Tk::TclX.signal to warn the
	  risk of using TclX extension's 'signal' command.

	* ext/tk/sample/irbtk.rb: irb with Ruby/Tk.

	* ext/tk/sample/demos-*/anilabel.rb: bug fix on 'show code'

	* ext/tk/sample/demos-*/aniwave.rb: new Ruby/Tk animation demo.

	* ext/tk/sample/demos-*/pendulum.rb: ditto.

	* ext/tk/sample/demos-*/goldberg.rb: ditto.

	* ext/tk/sample/demos-*/widget: add entries of animation demos.

Wed Mar  2 12:21:18 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* eval.c (rb_eval): [EXPERIMENTAL] NODE_LAMBDA implemented.
	  [ruby-dev:25780]

	* node.h (NODE_LAMBDA): for literal Proc object.

	* parse.y (expr): interpret mere do...end block as proc object.

	* parse.y (primary): ditto, for brace block.

Tue Mar  1 21:16:54 2005  K.Kosako  <sndgk393 AT ybb.ne.jp>

	* regcomp.c (optimize_node_left): uninitialized member
	  (OptEnv.backrefed_status) was used. [ruby-dev:25778]

Tue Mar  1 16:50:37 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* regparse.c: move st_*_strend() functions from st.c.  fixed some
	  potential memory leaks.

Tue Mar  1 00:40:35 2005  Masatoshi SEKI  <m_seki@mva.biglobe.ne.jp>

	* lib/rinda/tuplespace.rb (Rinda::TupleSpace): improved keeper thread.

	* test/rinda/test_rinda.rb: ditto.

Mon Feb 28 23:10:13 2005  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* ext/socket/socket.c (Init_socket): IPv6 is not supported although
	  AF_INET6 is defined on bcc32. (rev1.108 again)

	* ext/socket/mkconstants.rb: ditto.

Mon Feb 28 21:55:49 2005  K.Kosako  <sndgk393 AT ybb.ne.jp>

	* ext/strscan/strscan.c (strscan_s_allocate):
	  use onig_region_init().

	* ext/strscan/strscan.c (adjust_registers_to_matched):
	  use onig_region_set().

Mon Feb 28 15:12:06 2005  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* ext/socket/socket.c (Init_socket): ported more Socket::Constants
	  from ruby_1_8, and made it easy to add new constants.
	  [ruby-dev:25771]

	* ext/socket/depend: ditto.

	* ext/socket/mkconstants.rb: ditto. (added)

Mon Feb 28 11:42:23 2005  Ian Macdonald  <ian@caliban.org>

	* exception error messages updated.  [ruby-core:04497]

Mon Feb 28 09:03:09 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* ext/socket/socket.c (Init_socket): add bunch of Socket
	  constants.  Patch from Sam Roberts <sroberts@uniserve.com>.
	  [ruby-core:04409]

Sun Feb 27 05:55:38 2005  Minero Aoki  <aamine@loveruby.net>

	* parse.y [ripper]: fix typo. [ruby-core:04494]

Sat Feb 26 16:58:20 2005  K.Kosako  <sndgk393 AT ybb.ne.jp>

	* parse.y, re.c, regex.h, LEGAL, ext/strscan/strscan.c:
	  remove oniggnu.h (GNU regex API).

Wed Feb 23 22:08:16 2005  Kazuo Saito  <ksaito@uranus.dti.ne.jp>

	* st.c, st.h: imported additional file changes on
	  Oniguruma 3.7.0.

Wed Feb 23 21:45:29 2005  Kazuo Saito  <ksaito@uranus.dti.ne.jp>

	* ascii.c, euc_jp.c, oniggnu.h, oniguruma.h, regcomp.c,
	  regenc.c, regenc.h, regerror.c, regexec.c, regint.h,
	  regparse.c, regparse.h, sjis.c, utf8.c: imported Oni Guruma
	  3.7.0.

Wed Feb 23 15:04:32 2005  akira yamada  <akira@ruby-lang.org>

	* lib/uri/generic.rb (split_userinfo): should split ":pass" into ""
	  and "pass".  [ruby-dev:25667]

Wed Feb 23 08:00:18 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* array.c (rb_ary_s_create): no need for negative argc check.
	  [ruby-core:04463]

	* array.c (rb_ary_unshift_m): ditto.

Wed Feb 23 01:53:29 2005  Shugo Maeda  <shugo@ruby-lang.org>

	* lib/net/imap.rb (initialize): handle certs correctly. Thanks,
	  NABEYA Kenichi.

Wed Feb 23 00:37:34 2005  Kouhei Sutou  <kou@cozmixng.org>

	* lib/mkmf.rb (mkmf_failed): fixed typo.

Tue Feb 22 23:52:45 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* configure.in, lib/mkmf.rb: use simple commands if available.

	* mkconfig.rb: remove autoconf internal variables from rbconfig.rb.

	* lib/mkmf.rb (create_makefile): substitute implicit rules in depend
	  file.

	* {bcc32,win32,wince}/Makefile.sub (COMPILE_RULES, RULE_SUBST):
	  include $(topdir) and $(hdrdir) to search path.

Tue Feb 22 23:51:45 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* ext/syck/rubyext.c: get rid of warnings caused by a bug of VC.

Tue Feb 22 23:50:26 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* signal.c (ruby_signal, ruby_nativethread_signal): must be valid as
	  expressions, not only statements.

Tue Feb 22 12:54:13 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (rb_thread_start_0): update curr_thread before raising
	  TAG_THREAD.  [ruby-dev:25712]

Tue Feb 22 07:24:57 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* parse.y (parser_yylex): identifier after dot must not be a variable.

Mon Feb 21 18:31:12 2005  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* signal.c: Standard signal handlers ignore signals on non-Ruby native
	  threads. When a handler is entried with ruby_signal() (like as the
	  standard signal handlers), the handler for the signal is marked as
	  it cannot accept non-Ruby native threads. If a handler can treat all
	  signals on all native threads, please use ruby_nativethread_signal()
	  to entry it.

Sun Feb 20 00:48:48 2005  Tanaka Akira  <akr@m17n.org>

	* lib/open-uri.rb (URI::FTP#buffer_open): access mechanism
	  re-implemented according to RFC 1738.
	  reported by Guillaume Marcais.  [ruby-talk:131650]

Sat Feb 19 18:46:56 2005  Masatoshi SEKI  <m_seki@mva.biglobe.ne.jp>

	* lib/drb/drb.rb (DRbObject#respond_to?): take two arguments.
	  [ruby-dev:25722]

	* test/drb/drbtest.rb: ditto.

Sat Feb 19 13:52:02 2005  Tanaka Akira  <akr@m17n.org>

	* lib/open-uri.rb: call OpenSSL::SSL::SSLSocket#post_connection_check
	  after connection is made.

Sat Feb 19 13:31:28 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* ext/extmk.rb (extract_makefile): remove no longer existing installed
	  files.

	* lib/mkmf.rb (install_dirs): return installation directory list.

	* lib/mkmf.rb (create_makefile): reverted wrongly removed lines.

Sat Feb 19 01:28:56 2005  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* ext/bigdecimal/lib/bigdecimal/newton.rb: resolved LoadError.
	  [ruby-dev:25685]

	* ext/bigdecimal/sample/linear.rb: ditto.

	* ext/bigdecimal/sample/nlsolve.rb: ditto.

	* ext/bigdecimal/lib/bigdecimal/nlsolve.rb: removed because this file
	  is sample script and same file exists in ext/bigdecimal/sample.

Fri Feb 18 17:14:00 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* lib/xmlrpc/parser.rb (XMLRPC::FaultException): make it subclass
	  of StandardError class, not Exception class.  [ruby-core:04429]

Fri Feb 18 04:06:41 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* parse.y (fcall_gen): lvar(arg) will be evaluated as
	  lvar.call(arg) when lvar is a defined local variable. [new]

Thu Feb 17 22:15:34 2005  K.Kosako  <sndgk393 AT ybb.ne.jp>

	* ext/strscan/strscan.c: calls Oniguruma API directly.

Thu Feb 17 21:53:12 2005  K.Kosako  <sndgk393 AT ybb.ne.jp>

	* common.mk, LEGAL: remove reggnu.c.

Thu Feb 17 21:53:12 2005  Kazuo Saito  <ksaito@uranus.dti.ne.jp>

	* gc.c, re.c: now ruby calls Oniguruma API directly, bypassing
	  GNU compatible APIs.

Thu Feb 17 20:09:23 2005  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* lib/drb/drb.rb (DRbServer.default_safe_level): fix typo.

Thu Feb 17 20:09:23 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* test/digest/test_digest.rb: separate test case for each algorithms.
	  [ruby-dev:25412]

Thu Feb 17 14:31:52 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* object.c (rb_class_initialize): call inherited method before
	  calling initializing block.

	* eval.c (rb_thread_start_1): initialize newly pushed frame.
	  fixed: [ruby-dev:25707]

Thu Feb 17 13:46:00 2005  Nathaniel Talbott  <ntalbott@ruby-lang.org>

	* lib/test/unit/collector.rb (collect_file): now deletes paths added
	  to $LOAD_PATH instead of restoring it verbatim.

	* lib/test/unit/autorunner.rb (AutoRunner.run): fixed so that
	  'ruby -rtest/unit -rtest1 -rtest2 -e0' will use the objectspace
	  collector again. Also tried to simplify the calling convention.

	* test/runner.rb: adjusted for new AutoRunner semantics.

	* lib/test/unit.rb: ditto.

Thu Feb 17 04:21:47 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* lib/open3.rb (Open3::popen3): $? should not be EXIT_FAILURE.
	  fixed: [ruby-core:04444]

Thu Feb 17 00:31:21 2005  Masatoshi SEKI  <m_seki@mva.biglobe.ne.jp>

	* test/drb/test_drb.rb, ut_safe1.rb: port from 1.8

Thu Feb 17 00:02:27 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (is_defined): NODE_IASGN is an assignment.

Wed Feb 16 23:54:14 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* eval.c (rb_thread_start_1): outer block variables wasn't linked to
	  threads.  fixed: [ruby-dev:25700]

Wed Feb 16 15:11:43 2005  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* ext/openssl/lib/openssl/ssl.rb (OpenSSL::Nonblock#initialize):
	  native win32 platform doesn't have F_GETFL.

Wed Feb 16 02:47:45 2005  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* ext/openssl/ossl_ssl.c (ossl_ssl_read, ossl_ssl_write): should
	  call rb_sys_fail instead of raising SSLError if SSL_ERROR_SYSCALL
	  occurred.

	* ext/openssl/lib/openssl/buffering.rb (Buffering#fill_rbuff):
	  should rescue Errno::EAGAIN.

	* ext/openssl/lib/openssl/buffering.rb (Buffering#each): fix typo.
	  suggested by Brian Ollenberger.

	* ext/openssl/lib/openssl/ssl.rb: set non-blocking flag to the
	  underlying IO.

Tue Feb 15 22:14:34 2005  sheepman  <sheepman@tcn.zaq.ne.jp>

	* ext/readline/readline.c (Readline.readline): use rl_outstream
	  and rl_instream.  [ruby-dev:25699]

Mon Feb 14 23:58:17 2005  Kouhei Sutou  <kou@cozmixng.org>

	* lib/rss/parser.rb (RSS::ListenerMixin::tag_end):
	  fixed invalid namespace handling bug.

Mon Feb 14 13:12:38 2005  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* ext/openssl/lib/openssl/ssl.rb
	  (OpenSSL::SSL::SSLSocket#post_connection_check): new method.

Mon Feb 14 00:10:17 2005  Masatoshi SEKI  <m_seki@mva.biglobe.ne.jp>

	* lib/drb/drb.rb (DRbServer): add default_safe_level, safe_level,
	  config[:safe_level] ([druby-ja:120])

	* test/drb/test_drb.rb, ut_eval.rb, ut_safe1.rb: ditto.

Sun Feb 13 23:13:46 2005  Kouhei Sutou  <kou@cozmixng.org>

	* lib/rss/dublincore.rb (RSS::DublicCoreModel#date{,=}): added
	  convenient methods.

	* lib/rss/0.9.rb (RSS::Rss::Channel#date{,=}): ditto.

	* lib/rss/2.0.rb (RSS::Rss::Channel::Item#date{,=}): ditto.

	* test/rss/: added tests for the convenient methods.

Sun Feb 13 23:12:47 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* eval.c (rb_thread_start_0): restore prot_tag before rewinding.

Sun Feb 13 16:56:52 2005  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* lib/webrick/cgi.rb (WEBrick::CGI.start): should set reason-phrase
	  to the value of status header field. ([ruby-dev:40617])

Sun Feb 13 11:38:40 2005  Kazuo Saito  <ksaito@uranus.dti.ne.jp>

	* regparse.c (type_cclass_hash): (Thanks Nobu) fixed
	  overrun. ([ruby-dev:25676]).

Sun Feb 13 10:53:08 2005  Kazuo Saito  <ksaito@uranus.dti.ne.jp>

	* oniggnu.h, oniguruma.h, regcomp.c, st.c: imported
	  Oni Guruma 3.6.0.

Sun Feb 13 01:33:19 2005  Masatoshi SEKI  <m_seki@mva.biglobe.ne.jp>

	* lib/erb.rb (ERB::Util.h, u): make it module_function.

Sat Feb 12 22:17:11 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* eval.c (TAG_THREAD): to start a new thread.

	* eval.c (ruby_init, ruby_options, ruby_cleanup, rb_protect,
	  rb_load_protect, rb_thread_start_0): make thread anchor.

	* eval.c (proc_alloc): clone proc object if klass is not Proc or
	  created in different thread.

	* eval.c (rb_block_pass): call a function with a block.  [new]

	* eval.c (rb_f_throw): raise NameError in main thread.

Sat Feb 12 17:29:19 2005  Tanaka Akira  <akr@m17n.org>

	* lib/open-uri.rb (OpenURI.open_loop): send authentication only for
	  the URI directly specified.

Sat Feb 12 15:07:23 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* random.c (rand_init): suppress warning.

Sat Feb 12 14:10:24 2005  Tanaka Akira  <akr@m17n.org>

	* lib/open-uri.rb (OpenURI.open_http): reject userinfo explicitly.

Sat Feb 12 13:54:03 2005  Tanaka Akira  <akr@m17n.org>

	* lib/open-uri.rb: support https if the platform provides CA
	  certificates.

Sat Feb 12 06:18:28 2005  URABE Shyouhei  <shyouhei@ice.uec.ac.jp>

	* ext/etc/etc.c (Init_etc): sGroup needs HAVE_ST_GR_PASSWD check
	  [ruby-dev:25675]

Fri Feb 11 17:37:50 2005  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* ext/openssl/ossl_x509store.c (ossl_x509store_set_default_paths):
	  new method OpenSSL::X509::Store#set_default_paths.

Fri Feb 11 11:33:53 2005  Tanaka Akira  <akr@m17n.org>

	* lib/open-uri.rb (URI::HTTP#proxy_open): new option supported:
	  :http_basic_authentication.
	  suggested by Kent Sibilev.  [ruby-core:4392]

Fri Feb 11 06:30:07 2005  George Ogata  <g_ogata@optushome.com.au>

	* misc/ruby-mode.el: ignore parenthesis inside heredoc.
	  [ruby-core:04415]

Fri Feb 11 04:54:13 2005  Tilman Sauerbeck  <tilman@code-monkey.de>

	* lib/rdoc/generators/html_generator.rb: [ruby-core:04412]

	* lib/rdoc/generators/ri_generator.rb: ditto.

Thu Feb 10 13:52:42 2005  NAKAMURA Usaku  <usa@ruby-lang.org>

	* configure.in, win32/Makefile.sub (LIBS, COMMON_HEADERS): use
	  winsock2 on mswin32/mingw.

	* ext/socket/extconf.rb: ditto.

	* win32/win32.c (StartSockets): ditto.

	* win32/win32.h: ditto.

Thu Feb 10 12:09:16 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* ext/extmk.rb (extract_makefile): default to true if not compiled
	  previously.

	* ext/extmk.rb (extmake): create dummy makefile if extconf failed.

Thu Feb 10 12:07:10 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* win32/win32.c (init_stdhandle): assign standard file handles.

	* bcc32/Makefile.sub (COMMON_LIBS): add libraries included in
	  import32.lib.

	* lib/mkmf.rb (create_makefile): restrict prefixing with srcdir to
	  rule lines, add search path to implicit rules, and set Borland make
	  special macros for search path.

	* win32/win32.c, win32/win32.h (read): avoid a BCC runtime bug.

Thu Feb 10 00:47:25 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* struct.c (make_struct): fixed: [ruby-core:04402]

Wed Feb  9 16:33:05 2005  NAKAMURA Usaku  <usa@ruby-lang.org>

	* ext/socket/socket.c (wait_connectable): fixed wrong condition.

Wed Feb  9 14:42:28 2005  URABE Shyouhei  <shyouhei@ice.uec.ac.jp>

	* eval.c (scope_dup): add volatile not to optimize tbl.

Wed Feb  9 10:02:02 2005  NAKAMURA Usaku  <usa@ruby-lang.org>

	* ext/tk/make-tkutil, ext/tk/tkutil/subconf.rb: no longer used.

	* ext/tk/tkutil/extconf.rb: need to compile tkutil. [ruby-dev:25607]

Wed Feb  9 08:07:08 2005  Paul Duncan  <pabs@pablotron.org>

	* ext/curses/curses.c (window_color_set): [ruby-core:04393]

Tue Feb  8 23:48:36 2005  Masatoshi SEKI  <m_seki@mva.biglobe.ne.jp>

	* lib/drb/drb.rb: reject :instance_eval, :class_eval, :module_eval
	  [druby-ja:117]

Tue Feb  8 22:38:28 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* keywords, parse.y: separate EXPR_VALUE from EXPR_BEG.
	  fixed: [ruby-core:04310], [ruby-core:04368]

Tue Feb  8 13:06:12 2005  Sam Roberts  <sroberts@uniserve.com>

	* ext/socket/socket.c (Init_socket): SO_REUSEPORT added.
	  [ruby-talk:130092]

Tue Feb  8 00:19:02 2005  Tanaka Akira  <akr@m17n.org>

	* lib/resolv.rb (Resolv::DNS::Name#subdomain_of?): new method.
	  (Resolv::DNS::Name#inspect): ditto.
	  Suggested by Sam Roberts.  [ruby-talk:129086]

Mon Feb  7 23:14:11 2005  Tanaka Akira  <akr@m17n.org>

	* io.c (io_getc): flush rb_stdout before read from stdin, which is
	  connected to a tty.  [ruby-core:4378]

	* rubyio.h (FMODE_TTY): renamed from FMODE_LINEBUF.

Mon Feb  7 10:06:30 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* object.c: [ruby-doc:818]

Mon Feb  7 02:13:05 2005  NAKAMURA Usaku  <usa@ruby-lang.org>

	* ext/socket/extconf.rb (sockaddr_storage): winsock2.h have the
	  definition of struct sockaddr_storage, but socket.c doesn't
	  include it because this version of ruby still has binary level
	  compatibility with winsock1.

Mon Feb  7 01:22:50 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* ext/extmk.rb (extract_makefile): extract previously collected
	  informations from existing Makefile.

	* ext/socket/extconf.rb: check if getaddrinfo() works fine only when
	  wide-getaddrinfo option is not given.  fixed: [ruby-dev:25422]

	* ext/tk/extconf.rb: separate tkutil configuration.

	* lib/mkmf.rb ($extmk): check if under ext directory.

	* lib/mkmf.rb (Logging.postpone): allow recursive operation.

	* lib/mkmf.rb (try_constant): make sure if really a constant, reduce
	  the number of times of compile.

	* lib/mkmf.rb (have_macro, have_var, byte_order): new functions.

	* lib/mkmf.rb (find_library): allow directory list with separators.

	* lib/mkmf.rb (arg_config): manage provided configuration options.

	* lib/mkmf.rb (dir_config): accept arrays of directory names as
	  default values.

	* lib/mkmf.rb (with_cppflags, with_cflags, with_ldflags): keep flags
	  modified if the block returned true.

Sun Feb  6 19:20:05 2005  NAKAMURA Usaku  <usa@ruby-lang.org>

	* eval.c (stack_extend): add prototype because VC++8 doesn't
	  accept __declspec(noinline) with K&R style function definitions.

Sun Feb  6 13:56:19 2005  Tadayoshi Funaba  <tadf@dotrb.org>

	* lib/date.rb (new_with_hash): changed messages of exception.

	* lib/date/format.rb (str[fp]time): undocumented conversion
	  specifications %[1-3] are now deprecated.

Sun Feb  6 11:27:37 2005  Tanaka Akira  <akr@m17n.org>

	* ext/dl/dl.c (Init_dl): function declaration should precede
	  statements before C99.

Sun Feb  6 03:24:20 2005  Tanaka Akira  <akr@m17n.org>

	* lib/resolv.rb (Resolv::DNS::Resource::TXT): multiple strings was not
	  handled.
	  (Resolv::DNS::Resource::TXT#strings): new method to return all
	  strings.
	  (Resolv::DNS::Message::MessageEncoder#put_string_list): new method.
	  (Resolv::DNS::Message::MessageDecoder#get_string_list): ditto.
	  based on [ruby-talk:129732] by Sam Roberts.

Sat Feb  5 02:24:06 2005  Minero Aoki  <aamine@loveruby.net>

	* test/ripper/test_scanner_events.rb: fix test.

Fri Feb  4 18:44:35 2005  Minero Aoki  <aamine@loveruby.net>

	* ext/ripper/lib/ripper/lexer.rb: last Lexer fix was incomplete;
	  test all green.

Fri Feb  4 15:57:06 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* parse.y (open_args): fix too verbose warnings for the space
	  before argument parentheses.  [ruby-dev:25492]

	* parse.y (parser_yylex): ditto.

Fri Feb  4 14:33:25 2005  Minero Aoki  <aamine@loveruby.net>

	* ext/ripper/lib/ripper/filter.rb: ripper/tokenizer ->
	  ripper/lexer. [ruby-dev:25632]

Fri Feb  4 00:24:15 2005  Kouhei Sutou  <kou@cozmixng.org>

	* lib/rss: supported Image module.
	  http://web.resource.org/rss/1.0/modules/image/

Thu Feb  3 23:42:36 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* ext/stringio/stringio.c (strio_close, strio_close_read, strio_close_write):
	  should return nil instead of self as well as IO.  [ruby-dev:25623]

	* ext/stringio/stringio.c (strio_extend, strio_putc): fill with zero
	  extended portion.  [ruby-dev:25626]

Thu Feb  3 16:12:57 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* parse.y (parser_yylex): the first expression in the parentheses
	  should not be a command.  [ruby-dev:25492]

Thu Feb  3 03:31:20 2005  NARUSE, Yui  <naruse@ruby-lang.org>

	* ext/nkf/nkf-utf8/nkf.c: follow original v 1.57

	* ext/nkf/nkf-utf8/utf8tbl.c: follow original v 1.8

	* ext/nkf/nkf-utf8/config.h: follow original v 1.7

Wed Feb  2 23:52:53 2005  sheepman  <sheepman@tcn.zaq.ne.jp>

	* ext/stringio/stringio.c (strio_truncate): should MEMZERO an extended
	  part.  [ruby-dev:25618]

Wed Feb  2 21:56:01 2005  Kouhei Sutou  <kou@cozmixng.org>

	* lib/rss/rss.rb (RSS::Element#convert): added.

	* lib/rss/rss.rb: convert -> need_convert.

	* lib/rss/1.0.rb: ditto.

	* lib/rss/0.9.rb: ditto.

	* lib/rss/2.0.rb: ditto.

	* lib/rss/trackback.rb: ditto.

Wed Feb  2 03:30:58 2005  Minero Aoki  <aamine@loveruby.net>

	* ext/ripper/lib/ripper/tokenizer.rb -> lexer.rb.

	* ext/ripper/lib/ripper/lexer.rb: new method Ripper.slice.
	  [experimental]

	* ext/ripper/lib/ripper/sexp.rb: new file. [experimental]

	* ext/ripper/lib/ripper.rb: require ripper/lexer and ripper/sexp.

Tue Feb  1 21:49:24 2005  Masatoshi SEKI  <m_seki@mva.biglobe.ne.jp>

	* lib/drb/drb.rb (DRb::DRbObject#respond_to?): check marshal_dump and
	  _dump.

Tue Feb  1 00:20:23 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* Makefile.in, configure.in: made EXTOUT configurable.

	* ext/extmk.rb (extmake), lib/mkmf.rb: keep topdir as relative style.

	* lib/mkmf.rb: make extensions in depth order.  [ruby-dev:25522]

	* configure.in (aix): fix linker flags on AIX.  [ruby-talk:125460]

Mon Jan 31 13:16:39 2005  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/extconf.rb: add tkutil configuration step (remove old schema)

	* ext/tk/depend: remove the information of tkutil

	* ext/tk/make-tkutil: sub-part of Makefile to compile tkutil

	* ext/tk/tkutil/tkutil.c: move tkutil.c to subdirectory

	* ext/tk/tkutil/subconf.rb: configuration file for tkutil.c

	* ext/tk/tkutil/depend: ditto

Mon Jan 31 13:13:35 2005  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/tcltklib.c: add invalid namespace check

	* ext/tk/lib/multi-tk.rb: add invalid_namespace? method

	* ext/tk/lib/remote-tk.rb: ditto

Mon Jan 31 10:29:18 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* lib/irb/context.rb (IRB::Context::initialize): [ruby-core:04330]

Mon Jan 31 09:44:03 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* object.c (Init_Object): remove Object#type.  [ruby-core:04335]

Sat Jan 29 09:42:12 2005  Sam Roberts  <sroberts@uniserve.com>

	* lib/resolv.rb (Resolv::DNS::Resource::IN::SRV): Added RFC2782 SRV
	  resource record for specifying location of services.

Sat Jan 29 00:10:33 2005  Kazuo Saito  <ksaito@uranus.dti.ne.jp>

	* ascii.c, euc_jp.c, hash.c, oniggnu.h, oniguruma.h, regcomp.c,
	  regenc.c, regenc.h, regerror.c, regexec.c, reggnu.c, regint.h,
	  regparse.c, regparse.h, sjis.c, st.c, st.h, utf8.c: imported
	  Oni Guruma 3.5.4.

Fri Jan 28 17:16:55 2005  Tanaka Akira  <akr@m17n.org>

	* lib/resolv.rb (Resolv::DNS::Config.parse_resolv_conf):
	  parse options line for ndots option.
	  (Resolv::Hosts#lazy_initialize): return self.
	  (Resolv::DNS#lazy_initialize): ditto.
	  (Resolv::DNS::Config#lazy_initialize): ditto.
	  Suggested by Sam Roberts.

Thu Jan 27 17:15:03 2005  NAKAMURA Usaku  <usa@ruby-lang.org>

	* ext/tk/extconf.rb: support new tk scheme on bccwin32.
	  fixed: [ruby-dev:25546]

Thu Jan 27 13:18:03 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* st.c (st_foreach): report success/failure by return value.
	  [ruby-Bugs-1396]

Thu Jan 27 00:12:19 2005  Minero Aoki  <aamine@loveruby.net>

	* test/fileutils/test_fileutils.rb (setup): support BSD style
	  directory group inheritance (again).

Thu Jan 27 00:02:40 2005  Minero Aoki  <aamine@loveruby.net>

	* test/fileutils/test_fileutils.rb (setup): support BSD style
	  directory group inheritance. [ruby-dev:25440]

	* test/fileutils/fileasserts.rb (assert_same_entry): show entry
	  difference.

Wed Jan 26 17:12:50 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* parse.y: forgot to initialize parser struct.  [ruby-dev:25492]

	* parse.y (parser_yylex): no tLABEL on EXPR_BEG.
	  [ruby-talk:127711]

Wed Jan 26 14:12:58 2005  NAKAMURA Usaku  <usa@ruby-lang.org>

	* ext/Setup*: remove tcltklib.

Wed Jan 26 12:45:16 2005  NAKAMURA Usaku  <usa@ruby-lang.org>

	* ext/tk/extconf.rb: support new tk scheme on mswin32.
	 fixed: [ruby-dev:25535]

Wed Jan 26 10:45:19 2005  NAKAMURA Usaku  <usa@ruby-lang.org>

	* win32/win32.c (flock_winnt, flock_win95): unlock file even if
	  LOCK_NB is specified.

Tue Jan 25 23:10:48 2005  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk: merge tcltklib for Ruby/Tk installation control

	* ext/tcltklib: remove

Tue Jan 25 17:05:15 2005  NAKAMURA Usaku  <usa@ruby-lang.org>

	* ruby.c (proc_options): correct -T option in RUBYOPT.
	  fixed: [ruby-dev:25512]

Tue Jan 25 14:05:52 2005  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tcltklib/tcltklib.c: fix SEGV bug; trouble on canceling remained
	  after scripts [ruby-dev:25479]: NULL current namespace when deleting
	    Tk interpreter [ruby-talk:126225]

	* ext/tcltklib/extconf.rb: bug fix; TCL_ENABLE_THREAD flag is inverted
	  [ruby-talk:126360]

	* ext/tcltklib/extconf.rb: add yet another native-thread check

	* ext/tk/tkutil.c: fix SEGV bug; NULL string pointer when finalize
	  Ruby interpreter

	* ext/tk/lib/multi-tk.rb: avoid warning for deleted safeTk ip frame

	* ext/tk/lib/tk/bindtag.rb: bug fix; new method of named bindtag
	  doesn't return the created object [ruby-dev:25479]

	* ext/tk/lib/tk/menu.rb: bug on treating arguments [ruby-dev:25479]

	* ext/tk/lib/tk.rb: bug fix; cannot accept a callback ID string for
	  a command argument [ruby-dev:25479]

	* ext/tk/lib/multi-tk.rb: ditto

	* ext/tk/lib/tk/*.rb: ditto

	* ext/tk/lib/tkextlib/*.rb: ditto

	* ext/tk/sample/demos-jp/anilabel.rb: new demo script

	* ext/tk/sample/demos-en/anilabel.rb: ditto

	* ext/tk/sample/tkHTML/ss.rb: local variable scope bug fix
	  [ruby-dev:25479]

Mon Jan 24 16:00:53 2005  NARUSE, Yui  <naruse@ruby-lang.org>

	* ext/nkf/lib/kconv.rb (guess_old): not use NKF.guess_old
	  but NKF.guess1. fixed: [ruby-dev:25491]

Mon Jan 24 15:44:25 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* document updates - [ruby-core:04296], [ruby-core:04301],
	  [ruby-core:04302], [ruby-core:04307]

Sun Jan 23 12:38:01 2005  NAKAMURA, Hiroshi  <nahi@ruby-lang.org>

	* lib/soap/wsdlDriver.rb: from 1.5.3-ruby1.8.2, operation which has
	  capitalized name (such as KeywordSearchRequest in AWS) is defined as
	  a method having uncapitalized name. (converted with
	  GenSupport.safemethodname to handle operation name 'foo-bar').  it
	  introduced serious incompatibility; in the past, it was defined as a
	  capitalized.

	  define capitalized method as well under that circumstance.

Sun Jan 23 05:24:42 2005  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* ext/openssl/ossl_ocsp.c (ossl_ocspreq_to_der): should call
	  GetOCSPReq at first.

Sat Jan 22 22:59:08 2005  Masatoshi SEKI  <m_seki@mva.biglobe.ne.jp>

	* lib/drb/ssl.rb (accept): rescue SSLError. [druby-ja:110]

Sat Jan 22 22:27:28 2005  Masatoshi SEKI  <m_seki@mva.biglobe.ne.jp>

	* lib/drb/unix.rb: fail if UNIXFileOwner is set. [druby-ja:111]

Fri Jan 21 20:07:02 2005  Tanaka Akira  <akr@m17n.org>

	* lib/resolv.rb (Resolv::DNS::Config.resolv): don't raise ResolvError.
	  reported by Sam Roberts.  [ruby-talk:127133]

Fri Jan 21 17:09:44 2005  Shugo Maeda  <shugo@ruby-lang.org>

	* lib/net/imap.rb (decode_utf7): use pack("U*") to encode UTF-8.

	* lib/net/imap.rb (encode_utf7): use unpack("U*") to decode UTF-8.

	* test/net/imap/test_imap.rb: added tests for Net::IMAP.

Fri Jan 21 16:58:10 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* dir.c (rb_push_glob): should work for NUL delimited patterns.

	* dir.c (rb_glob2): should aware of offset in the pattern.

Fri Jan 21 13:58:37 2005  Shugo Maeda  <shugo@ruby-lang.org>

	* lib/net/imap.rb (u8tou16): fixed typo. fixed: [ruby-list:40546]

Fri Jan 21 00:37:09 2005  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* ext/syck/rubyext.c (syck_parser_bufsize_set): avoid VC++ warning
	  "local variable 'size' used without having been initialized".

Thu Jan 20 11:42:02 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* string.c (rb_str_new4): should propagate taintedness.

	* env.h: rename member names in struct FRAME; last_func -> callee,
	  orig_func -> this_func, last_class -> this_class.

	* struct.c (rb_struct_set): use original method name, not callee
	  name, to retrieve member slot.  [ruby-core:04268]

	* time.c (time_strftime): protect from format modification from GC
	  finalizers.

Thu Jan 20 02:01:10 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* object.c (Init_Object): remove rb_obj_id_obsolete()

Wed Jan 19 18:02:19 2005  NAKAMURA Usaku  <usa@ruby-lang.org>

	* lib/ipaddr.rb (to_s, test_to_s): too many colons with some cases.

Wed Jan 19 01:16:30 2005  Tanaka Akira  <akr@m17n.org>

	* lib/resolv.rb (Resolv::DNS::Config.parse_resolv_conf): ignore
	  domain and search directive without an argument.
	  reported by Sam Roberts.  [ruby-talk:126781]

Mon Jan 17 23:33:46 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* configure.in (aix): fix typo.  [ruby-talk:126401]

Mon Jan 17 07:08:51 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* ext/readline/readline.c: suppress warnings.

	* lib/irb/extend-command.rb (IRB::ContextExtender.def_extend_command):
	  ditto.

	* lib/irb/ext/history.rb (IRB::Context::set_last_value): ditto.

	* lib/irb/ext/history.rb (IRB::Context::eval_history): ditto.

	* lib/irb/locale.rb (IRB::Locale::real_load): ditto.

	* lib/irb/slex.rb (SLex::Node::create_subnode): remove garbage.

Mon Jan 17 00:09:42 2005  WATANABE Hirofumi  <eban@ruby-lang.org>

	* lib/uri/common.rb (PORT): typo fix. fixed: [ruby-core:04256]

Sat Jan 15 14:57:22 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* ruby.c (proc_options): ignore trailing CRs at the end of short
	  options as well as long options.  fixed: [ruby-core:04232]

Sat Jan 15 13:44:22 2005  Kouhei Sutou  <kou@cozmixng.org>

	* lib/rss/rss.rb (RSS::VERSION): 0.1.2 -> 0.1.3.

	* lib/rss/rss.rb: accept inheritance. [ruby-talk:126104]

Wed Jan 12 12:29:28 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (rb_mod_define_method): incomplete subclass check.
	  [ruby-dev:25464]

	* class.c (rb_make_metaclass): class of metaclasses should be
	  plain Class.  [ruby-list:40524]

Tue Jan 11 20:58:52 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* io.c (remain_size): use buffered data instead of unreading to avoid
	  inconsistency of text mode.  fixed: [ruby-dev:25446]

Tue Jan 11 09:37:53 2005  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* numeric.c (Init_Numeric): turn off floating point exceptions
	  on bcc32. "1e300".to_f had crashed by overflow.

Mon Jan 10 15:28:51 2005  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* lib/webrick/cgi.rb (WEBrick::CGI::Socket#request_line): should
	  escape SCRIPT_NAME and PATH_INFO before being parsed as a URI.

	* lib/webrick/httputils.rb (WEBrick::HTTPUtils#escape_path): add
	  new method to escape URI path component.

	* lib/webrick/ssl.rb (WEBrick::Config::SSL): the default value
	  of :SSLEnable is false.

	* test/webrick/{test_cgi.rb,webrick.cgi}: new file.

	* test/webrick/utils.rb: require "webrick/https.h".

Mon Jan 10 01:22:55 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* gc.c (rb_data_object_alloc): klass may be NULL.
	  [ruby-list:40498]

Sun Jan  9 14:12:17 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* io.c (rb_f_select): IO list could be altered.  [ruby-dev:25312]

Sun Jan  9 04:08:40 2005  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* test/webrick/test_server.rb (test_daemon): delete an assertion
	  which has possibility to fail by race condition.

Sun Jan  9 03:22:46 2005  Minero Aoki  <aamine@loveruby.net>

	* test/fileutils/test_fileutils.rb (test_copy_entry): copy_entry
	  copies only file type, not mtime. [ruby-dev:25383]

Sat Jan  8 04:38:47 2005  why the lucky stiff  <why@ruby-lang.org>

	* lib/yaml.rb: Kernel#y requires an argument.

Fri Jan  7 21:12:29 2005  TAMURA Takashi  <sheepman@tcn.zaq.ne.jp>

	* random.c (rand_init): use ALLOC_N instead of ALLOCA_N
	  [ruby-dev:25426]

Fri Jan  7 20:01:31 2005  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* lib/webrick/httpproxy.rb (WEBrick::HTTPProxyServer#proxy_service):
	  should delete trailing LF from the result of pack("m*").

	* lib/webrick/httpproxy.rb (WEBrick::HTTPProxyServer#proxy_connect):
	  - should delete trailing LF from the result of pack("m*").
	  - clear Request-Line not to send the response by HTTPServer#run.

	* lib/webrick/httputils (WEBrick::HTTPUtils.parse_qvalues):
	  refine regexp (and change the name of a local variable).

	* lib/webrick/server.rb (WEBrick::Daemon.start): prepared stdio
	  don't allow changing its mode.

	* test/webrick/*, sample/webrick/httpproxy.rb: add new files.

Fri Jan  7 18:03:35 2005  Tanaka Akira  <akr@m17n.org>

	* gc.c (mark_locations_array): avoid core dump with -O3.
	  [ruby-dev:25424]

Thu Jan  6 20:29:18 2005  NAKAMURA Usaku  <usa@ruby-lang.org>

	* ext/zlib/zlib.c (zstream_end): should return value.

Thu Jan  6 19:59:03 2005  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* win32/win32.c (rb_w32_close): didn't close socket handle.
	  [ruby-dev:25414]

	* win32/win32.c (rb_w32_open_osfhandle): bcc32's _open_osfhandle
	  never set EMFILE.

Thu Jan  6 17:22:41 2005  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* random.c (random_seed): O_NONBLOCK isn't defined on some
	  platforms. [ruby-dev:25417]

Thu Jan  6 13:45:35 2005  Tanaka Akira  <akr@m17n.org>

	* lib/time.rb: recognize +00:00 and GMT as a localtime.

Thu Jan  6 07:58:28 2005  Dave Thomas  <dave@pragprog.com>

	* lib/rdoc/usage.rb (RDoc::RDoc.usage_no_exit): Allow for colons
	  in path names on DOS machines. (thanks to Johan Nilsson)

Thu Jan  6 00:02:35 2005  Masatoshi SEKI  <m_seki@mva.biglobe.ne.jp>

	* test/rinda/test_rinda.rb: use MockClock.sleep instead of Kernel.sleep
	  [ruby-dev:25387]

Wed Jan  5 20:16:32 2005  Tanaka Akira  <akr@m17n.org>

	* random.c (limited_big_rand): didn't work if SIZEOF_BDIGITS == 2.
	  [ruby-dev:25408]

	* random.c (random_seed): refined.

Wed Jan  5 16:39:54 2005  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* parse.y (BITSTACK_POP): workaround for bcc32 compiler's bug.
	  shift assignment operator '>>=' for __int64 in struct may
	  generate collapsed code. [ruby-dev:25342]

	* win32/win32.[ch]: failed to compile on bcc32 (and probably wince)
	  [ruby-dev:25306]

Wed Jan  5 12:49:39 2005  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* eval.c (rb_thread_initialize): Thread objects cannot be initialized
	  again.  fixed: [ruby-core:04067]

Wed Jan  5 02:30:11 2005  Tanaka Akira  <akr@m17n.org>

	* random.c (init_by_array): imported from mt19937ar-cok.tgz.
	  (genrand_int32): ditto.
	  (genrand_real): replaced with genrand_res53 in mt19937ar-cok.
	  (rand_init): support bignum for longer seed.
	  (random_seed): generate longer seed.
	  (make_mask): new function.
	  (limited_rand): ditto.
	  (limited_big_rand): ditto.
	  (rb_f_rand): call limited_rand and limited_big_rand.
	  [ruby-dev:25403]

Tue Jan  4 23:25:29 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* bignum.c (rb_big_rand): should return positive random number.
	  [ruby-dev:25401]

Tue Jan  4 21:25:43 2005  Masatoshi SEKI  <m_seki@mva.biglobe.ne.jp>

	* test/drb/{test_drbssl.rb,test_drbunix.rb,ut_drb.rb}: use
	  DRbService.ext_service. reduce sleep.

Mon Jan  3 14:01:54 2005  Tanaka Akira  <akr@m17n.org>

	* random.c (random_seed): don't use /dev/urandom if it is not
	  character device.

Mon Jan  3 11:37:42 2005  Tanaka Akira  <akr@m17n.org>

	* random.c (random_seed): use /dev/urandom if available.
	  [ruby-dev:25392]

Tue Jan  4 11:15:29 2005  TAMURA Takashi  <sheepman@tcn.zaq.ne.jp>

	* bignum.c (rb_big_rand): do not use rb_big_modulo to generate
	  random bignums.  [ruby-dev:25396]

Mon Jan  3 11:03:37 2005  Masatoshi SEKI  <m_seki@mva.biglobe.ne.jp>

	* test/drb/test_drb.rb: move TestDRbReusePort to new file.
	  [ruby-dev:25238]

	* test/drb/drbtest.rb: change timeout.

	* test/drb/ignore_test_drb.rb: new file.

Mon Jan  3 07:27:46 2005  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* lib/webrick/httpauth/htpasswd.rb (WEBrick::Htpasswd#reload):
	  raise NotImplementedError if password is encrypted by digest
	  algorithms. This patch is contributed by sheepman. [ruby-list:40467]

	* lib/webrick/httpauth/digestauth.rb
	  (WEBrick::HTTPAuth::DigestAuth#_authenticate): fix digest calculation.
	  This patch is contributed by sheepman. [ruby-list:40482]

	* lib/webrick/{httpauth.rb,httpauth/basicauth.rb,httpproxy.rb}: use
	  pack/unpack-template char "m" instead of lib/base64.rb to do base64
	  encoding/decoding. fixed: [ruby-dev:25336]

	* test/webrick/test_httpauth.rb: new file.

Sun Jan  2 15:42:10 2005  Masatoshi SEKI  <m_seki@mva.biglobe.ne.jp>

	* lib/drb/drb.rb: add lazy stop_service.

	* lib/drb/extserv.rb: ditto.

Sun Jan  2 01:17:17 2005  Masatoshi SEKI  <m_seki@mva.biglobe.ne.jp>

	* test/drb/drbtest.rb: add method DRbService.ext_service.

	* test/drb/test_drb.rb: ditto.

	* test/drb/test_drbssl.rb: ditto.

Sat Jan  1 20:23:02 2005  Tanaka Akira  <akr@m17n.org>

	* io.c (argf_readpartial): new method ARGF.readpartial.
	  (io_getpartial): extracted from io_readpartial.
	  (io_readpartial): call io_getpartial.

Sat Jan  1 17:44:54 2005  Minero Aoki  <aamine@loveruby.net>

	* lib/net/http.rb (each_capitalized): should join header field
	  value.  This patch is contributed sheepman [ruby-list:40478]

	* test/net/http/test_httpheader.rb: test it.

Sat Jan  1 16:21:29 2005  Minero Aoki  <aamine@loveruby.net>

	* lib/fileutils.rb (copy_stream): use read/write instead of
	  sysread/syswrite, which allows duck typing. [ruby-dev:25369]

	* lib/fileutils.rb (copy_stream): does NOT support nonblocking IO.
	  [ruby-dev:25370]

	* lib/fileutils.rb (copy_entry): could not copy symlink.

	* test/fileutils/test_fileutils.rb: test copy_entry, copy_file,
	  copy_stream.

Sat Jan  1 04:20:23 2005  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* ext/openssl/ossl_ns_spki.c (ossl_spki_set_challenge): should call
	  StringValue before GetSPKI. fixed: [ruby-dev:25359].

Sat Jan  1 01:13:28 2005  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* variable.c (rb_autoload): [ruby-dev:25373]

Fri Dec 31 14:10:43 2004  Dave Thomas  <dave@pragprog.com>

	* lib/rdoc/ri/ri_formatter.rb (RI::TextFormatter::display_flow_item):
	  Fix problem if heading contains formatting.

Fri Dec 31 00:08:02 2004  Tanaka Akira  <akr@m17n.org>

	* configure.in (HAVE_RLIM_T): removed because not used.

Thu Dec 30 22:45:39 2004  Tanaka Akira  <akr@m17n.org>

	* rubyio.h: don't deprecate rb_read_check.

	* io.c (STDIO_READ_DATA_PENDING): reverted from old READ_DATA_PENDING
	  to check stdio read buffer.
	  (rb_read_check): use STDIO_READ_DATA_PENDING.
	  (rb_read_pending): ditto.
	  (rb_getc): ditto.

Thu Dec 30 05:39:35 2004  Minero Aoki  <aamine@loveruby.net>

	* parse.y: eliminate unused members in struct parser_params.
	  [ruby-dev:25258] (again)

	* parse.y: make parser_new() static.

Thu Dec 30 00:41:42 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (svalue_to_avalue): [ruby-dev:25366]

	* string.c (rb_str_justify): [ruby-dev:25367]

Wed Dec 29 11:07:07 2004  Dave Thomas  <dave@pragprog.com>

	* lib/rdoc/generators/template/html/kilmer.rb: Update to use new
	  sections.

Tue Dec 28 22:31:46 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* string.c (rb_str_justify): create buffer string after argument type
	  conversion.  fixed: [ruby-dev:25341]

Tue Dec 28 17:18:17 2004  NAKAMURA Usaku  <usa@ruby-lang.org>

	* lib/net/telnet.rb (preprocess): remove NULL unless binmode.
	  fixed: [ruby-list:40320]

Tue Dec 28 15:41:48 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* ext/nkf/nkf-utf8/nkf.c (reinit): should initialize all static
	  variables.  fixed: [ruby-list:40445]

Tue Dec 28 15:25:20 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* ext/nkf/lib/kconv.rb (Kconv::RegexpEucjp): second byte is up to
	  0xfe.

	* ext/nkf/lib/kconv.rb (Kconv#kconv): should handle UTF8 and UTF16
	  properly.

Tue Dec 28 13:35:20 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* ext/zlib/zlib.c (rb_deflate_s_deflate, rb_inflate_s_inflate): ensure
	  freeing internal zstreams.  fixed: [ruby-dev:25309]

	* ext/zlib/zlib.c (rb_deflate_init_copy): replace rb_deflate_clone.

Mon Dec 27 20:02:14 2004  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tcltklib/tcltklib.c: fix SEGV bug when deleting Tk interp

	* ext/tk/lib/multi-tk.rb: ditto

Mon Dec 27 16:54:05 2004  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* ext/openssl/ossl_x509name.c (Init_ossl_x509name): should use
	  rb_hash_new to get exactly a Hash. fix [ruby-dev:25325].

Mon Dec 27 15:29:12 2004  Minero Aoki  <aamine@loveruby.net>

	* test/fileutils/test_fileutils.rb (cp_r): tested wrong file name.
	  [ruby-dev:25339]

Mon Dec 27 15:15:18 2004  Minero Aoki  <aamine@loveruby.net>

	* lib/fileutils.rb (mv): should raise error when moving a
	  directory to the (empty) directory. [ruby-talk:124368]

	* lib/fileutils.rb (mv): wrongly did not overwrite file on Win32
	  platforms.

Mon Dec 27 14:36:20 2004  NAKAMURA Usaku  <usa@ruby-lang.org>

	* process.c (NUM2RLIM, RLIM2NUM): Without SIZEOF_RLIM_T is not error.
	  fixed: [ruby-dev:25346]

Sun Dec 26 16:21:39 2004  Shugo Maeda  <shugo@ruby-lang.org>

	* lib/net/imap.rb (Net::IMAP::PlainAuthenticator): added a new class
	  to support the PLAIN authentication mechanism. Thanks, Benjamin
	  Stiglitz.

Sat Dec 25 01:28:23 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* io.c (rb_f_select): [ruby-dev:25312]

Fri Dec 24 23:27:18 2004  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/lib/tk/image.rb: TkPhotoImage#cget bug fix

Fri Dec 24 03:06:13 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* io.c (io_reopen, rb_io_reopen): prohibit to change access mode for
	  special IO ports.  [ruby-dev:25225]

	* io.c (next_argv): reduce use of stdio.

Fri Dec 24 02:22:53 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* ext/syck/rubyext.c (syck_loader_transfer): check type conversion.

	* ext/syck/rubyext.c (syck_parser_assign_io, rb_new_syck_node): duck
	  typing.

	* ext/syck/rubyext.c (syck_parser_s_alloc, syck_parser_initialize):
	  allocation framework.

	* ext/syck/rubyext.c (syck_emitter_s_alloc, syck_emitter_initialize):
	  ditto.

Fri Dec 24 01:21:00 2004  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/lib/tkextlib/blt.rb: add BLT extension support

	* ext/tk/lib/tkextlib/blt/*.rb: ditto

	* ext/tk/lib/tkextlib/blt/tile/*.rb: ditto

Thu Dec 23 23:43:24 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* process.c (proc_setgroups): check if the argument length is
	  modified.  fixed: [ruby-dev:25285]

	* process.c (SIZEOF_RLIM_T): err if size of rlim_t is not set.

Thu Dec 23 19:08:41 2004  Tanaka Akira  <akr@m17n.org>

	* rubyio.h: rename FMODE_UNSEEKABLE to FMODE_DUPLEX.

	* io.c (io_check_tty): extracted function to set FMODE_LINEBUF and
	  FMODE_DUPLEX.

Thu Dec 23 13:13:33 2004  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tcltklib/tcltklib.c: define TclTkLib::COMPILE_INFO and
	  RELEASE_DATE

	* ext/tcltklib/extconf.rb: ditto

	* ext/tk/tkutil.c: define TkUtil::RELEASE_DATE

	* ext/tk/lib/tk.rb: define Tk::RELEASE_DATE

Thu Dec 23 00:16:32 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* configure.in (bsdi): use $(CC) for LDSHARED.  fixed [ruby-dev:25270]

Wed Dec 22 11:14:55 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* io.c (rb_io_mode_modenum): replace O_ACCMODE with O_RDWR.
	  fixed: [ruby-dev:25273]

Wed Dec 22 08:34:32 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* ext/dl/sym.c (rb_dlsym_initialize): extract internal pointers after
	  all argument conversion.  fixed: [ruby-dev:25271]

Tue Dec 21 16:15:21 2004  Michael Neumann  <mneumann@ruby-lang.org>

	* lib/xmlrpc/client.rb: use "" instead of "." if prefix argument is
	  nil in proxy methods. nil is default value.

	* test/xmlrpc/test_webrick_server.rb, test/xmlrpc/webrick_testing.rb:
	  use threads instead of forking. this should fix issue #1208
	  (http://rubyforge.org/tracker/?func=detail&atid=1698&aid=1208&group_id=426).
	  removed testing of SSL enabled servlet as this hangs.

Wed Dec 22 00:05:10 2004  NAKAMURA, Hiroshi  <nahi@ruby-lang.org>

	* lib/soap/*, test/soap/*, sample/soap/authheader/*: eval cleanup.

Tue Dec 21 22:07:41 2004  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* ext/openssl/ossl_asn1.c (ossl_asn1_decode_all): use rb_str_new4
	  to avoid SEGV.

	* ext/openssl/ossl_asn1.c (ossl_asn1_traverse, ossl_asn1_decode,
	  ossl_asn1_decode_all): temporary value should be marked volatile.

Tue Dec 21 12:42:34 2004  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* ext/openssl/ossl_asn1.c (ossl_asn1_traverse, ossl_asn1_decode):
	  use rb_str_new4 to avoid SEGV. fix [ruby-dev:25261]

	* test/openssl/test_asn1.rb: add tests for OpenSSL::ASN1.

Tue Dec 21 12:10:04 2004  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/lib/tk/grid.rb: rescue bug of 'grid configure' on Tcl/Tk8.3-

Mon Dec 20 22:52:29 2004  NAKAMURA, Hiroshi  <nahi@ruby-lang.org>

	* added samples for the previous soap4r's commit.

Mon Dec 20 22:56:39 2004  Tanaka Akira  <akr@m17n.org>

	* gc.c (set_stack_end): gcc noinline attribute is available since
	  gcc-3.1.

Mon Dec 20 22:40:31 2004  NAKAMURA, Hiroshi  <nahi@ruby-lang.org>

	* added files:
	  * lib/soap/mapping/wsdl*.rb
	  * lib/wsdl/soap/element.rb
	  * lib/wsdl/xmlSchema/simpleContent.rb

	* modified files:
	  * lib/soap/*
	  * lib/wsdl/*
	  * lib/xsd/*
	  * test/soap/*
	  * test/wsdl/*
	  * test/xsd/*

	* summary
	  * imported from the soap4r repository.  Version: 1.5.3-ruby1.8.2

	  * added several XSD basetype support: nonPositiveInteger,
	    negativeInteger, nonNegativeInteger, unsignedLong, unsignedInt,
	    unsignedShort, unsignedByte, positiveInteger

	  * HTTP client connection/send/receive timeout support.

	  * HTTP client/server gzipped content encoding support.

	  * improved WSDL schema definition support; still is far from
	    complete, but is making step by step improvement.

Mon Dec 20 14:45:19 2004  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* lib/net/https.rb: delete descriptions about key_file and cert_file.
	  fixed: [ruby-dev:25243]

	* ext/openssl/lib/net/telnets.rb: ditto.

Mon Dec 20 14:07:02 2004  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/lib/multi-tk.rb: supports new features of Tcl/Tk8.5a2

	* ext/tk/lib/tk/clock.rb: ditto

	* ext/tk/lib/tk/text.rb: ditto

	* ext/tk/lib/tk/panedwindow.rb: ditto

Mon Dec 20 13:51:40 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* ext/socket/socket.c (sock_s_getservbyport): [ruby-talk:124072]

Mon Dec 20 10:51:58 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* parse.y (special_local_set): prevent the parser object from GC.
	  fixed: [ruby-dev:25252]

Mon Dec 20 03:30:40 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* lib/cgi/session.rb (CGI::Session#initialize): empty session id was
	  used if request had no session key.  fixed: [ruby-core:03981]

Mon Dec 20 01:51:01 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* struct.c (make_struct): [ruby-dev:25249]

Mon Dec 20 00:16:54 2004  Kouhei Sutou  <kou@cozmixng.org>

	* lib/rexml/encodings/SHIFT_JIS.rb: fixed LoadError bug.
	  [ruby-core:3958]

Sun Dec 19 17:24:59 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* configure.in (enable_rpath): use rpath flag to embed the library
	  path into extensions on ELF environment.  [ruby-dev:25035]

Sun Dec 19 11:01:25 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* lib/test/unit.rb: use standalone runner for -e.

	* lib/test/unit/autorunner.rb (Test::Unit::AutoRunner#options): accept
	  multiple -p and -x options.

	* lib/test/unit/collector/dir.rb (Test::Unit::Collector::Dir#recursive_collect):
	  ditto.

Sat Dec 18 16:36:23 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* ext/zlib/zlib.c (rb_deflate_s_deflate, rb_inflate_s_inflate):
	  disallow interrupt by type conversion.  fixed: [ruby-dev:25226]

Sat Dec 18 15:09:02 2004  NAKAMURA, Hiroshi  <nahi@ruby-lang.org>

	* lib/webrick/httpauth.rb,
	  lib/webrick/httpauth/{basicauth.rb,digestauth.rb}: use
	  pack/unpack-template char "m" instead of lib/base64.rb to do base64
	  encoding/decoding.

Sat Dec 18 10:51:01 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* dir.c (dir_open_dir): new function.  [ruby-dev:25242]

	* io.c (rb_f_open): add type check for return value from to_open.

Fri Dec 17 16:44:26 2004  Tanaka Akira  <akr@m17n.org>

	* configure.in (ac_cv_sizeof_rlim_t): set 8 for BSD/OS.
	  Reported by OHARA Shigeki.  [ruby-dev:25236]

Fri Dec 17 16:28:12 2004  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/lib/tk.rb: fix bug on setting up system encoding

	* ext/tk/lib/tk/event.rb: fix error on require process

	* ext/tk/lib/tk/font.rb: fix abnormal termination error on Windows

	* ext/tk/lib/tk/virtevent.rb: TkVirtualEvent::PreDefVirtEvent.new()
	  accepts event-sequence arguments

	* ext/tk/lib/tk/text.rb: fail to dump embedded images

	* ext/tk/lib/tk/text.rb: tag_nextrange and tag_prevrange returns wrong
	  types of values

	* ext/tk/lib/tk/texttag.rb: nextrange and prevrange returns wrong
	  types of values

	* ext/tk/lib/tk/text.rb: add TkText::IndexModMethods module and
	  TkText::IndexString class to treat text index modifiers

	* ext/tk/lib/tk/texttag.rb: use TkText::IndexModMethods module

	* ext/tk/lib/tk/textmark.rb: ditto

	* ext/tk/lib/tk/textimage.rb: ditto

	* ext/tk/lib/tk/textwindow.rb: ditto

	* ext/tk/lib/tk/textimage.rb: wrong gravity of text mark for embedded
	  image

	* ext/tk/lib/tk/textwindow.rb: wrong gravity of text mark for
	  embedded window

Fri Dec 17 13:33:58 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* lib/cgi/session.rb (CGI::Session#initialize): control adding
	  session_id hidden fields.  fixed: [ruby-talk:123850]

Fri Dec 17 00:01:48 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* eval.c (rb_proc_arity, rb_node_arity, rb_mod_method_arity,
	  rb_obj_method_arity): new functions to obtain method arity.
	  [ruby-dev:25143]

Thu Dec 16 23:31:13 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* lib/mkmf.rb (create_makefile): create RUBYARCHDIR also when no extension
	  is installed.  fixed: [ruby-dev:25215]

Thu Dec 16 22:36:57 2004  Masatoshi SEKI  <m_seki@mva.biglobe.ne.jp>

	* test/drb/test_drb.rb: adjust and reduce sleep.

Thu Dec 16 18:37:08 2004  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* ext/openssl/ossl.c (ossl_raise): refine message format.

Thu Dec 16 16:29:44 2004  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/sample/demos-en/widget: modify version check for
	  supporting features

Thu Dec 16 16:03:50 2004  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/lib/tk/bindtag.rb: bug fix [ruby-talk: 123667]

	* ext/tk/lib/tk/timer.rb: accept :idle for the interval argument

	* ext/tk/lib/tk.rb: add TkComm._callback_entry?()

	* ext/tk/lib/multi-tk.rb: add MultiTkIp.cb_entry_class

	* ext/tk/lib/tk/canvas.rb: use TkComm._callback_entry?()

	* ext/tk/lib/tk/canvastag.rb: ditto

	* ext/tk/lib/tk/dialog.rb: ditto

	* ext/tk/lib/tk/optiondb.rb: ditto

	* ext/tk/lib/tk/text.rb: ditto

	* ext/tk/lib/tk/texttag.rb: ditto

	* ext/tk/lib/tk/textwindow.rb: ditto

	* ext/tk/lib/tk/timer.rb: ditto

	* ext/tk/lib/tk/validation.rb: ditto

	* ext/tk/lib/tkextlib/*: ditto

Thu Dec 16 04:02:28 2004  Minero Aoki  <aamine@loveruby.net>

	* ext/ripper/extconf.rb: bison is not needed if ripper.c exists.
	  [ruby-dev:25191]

Thu Dec 16 03:27:10 2004  Minero Aoki  <aamine@loveruby.net>

	* lib/net/http.rb: remove junk.

Thu Dec 16 00:57:30 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* ext/syck/rubyext.c (rb_syck_io_str_read): [ruby-core:03973]

Thu Dec 16 00:43:29 2004  Masatoshi SEKI  <m_seki@mva.biglobe.ne.jp>

	* lib/drb/drb.rb: changed default binded address family to use an
	  available address family of host name. [druby-ja:101]

	* lib/drb/ssl.rb: ditto

Wed Dec 15 17:47:17 2004  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* lib/webrick/server.rb (WEBrick::GenericServer#start_thread):
	  should log about all accepted socket. [ruby-core:03962]

	* lib/webrick/accesslog.rb (WEBrick::AccessLog#setup_params):
	  "%%" and "%u" are supported. [webricken:135]

	* lib/webrick/httpservlet/filehandler.rb
	  (WEBrick::HTTPServlet::FileHandler#check_filename):
	  :NondisclosureName is acceptable if it is Enumerable.

	* lib/webrick/config.rb (WEBrick::Config::FileHandler):
	  default value of :NondisclosureName is [".ht*", "*~"].

Wed Dec 15 16:10:23 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* object.c (rb_obj_id_obsolete): warn always.

Wed Dec 15 15:31:02 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* lib/set.rb (Set#==): [ruby-dev:25206]

Wed Dec 15 14:32:18 2004  NAKAMURA Usaku  <usa@ruby-lang.org>

	* win32/win32.c (rb_w32_fdisset): check whether the handle is valid.

Wed Dec 15 10:30:37 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* ext/openssl/ossl_digest.c (ossl_digest_initialize): [ruby-dev:25198]

Tue Dec 14 19:17:15 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* utf8.c (utf8_is_mbc_ambiguous): [ruby-talk:123561]

	* utf8.c (utf8_mbc_to_normalize): ditto.

Tue Dec 14 17:08:15 2004  NAKAMURA Usaku  <usa@ruby-lang.org>

	* win32/win32.c (rb_w32_close): need to reset osfhnd().

Tue Dec 14 14:03:57 2004  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* ext/openssl/ossl.c (ossl_raise): avoid buffer overrun.
	  [ruby-dev:25187]

Tue Dec 14 12:36:04 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* lib/cgi/session.rb (CGI::Session::initialize): generate new
	  session if given session_id does not exist.  [ruby-list:40368]

Tue Dec 14 08:47:45 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (Init_eval): should mark ruby_eval_tree.  [ruby-dev:25189]

Mon Dec 13 18:13:52 2004  Tanaka Akira  <akr@m17n.org>

	* gc.c (set_stack_end): new function to obtain stack end address.
	  set_stack_end obtains a stack end address by an address of local
	  variable in the function.
	  (SET_STACK_END, STACK_END): use set_stack_end.  don't use alloca.
	  This makes the conservative garbage collector to scan a stack frame
	  of the garbage_collect function itself.  This is required because
	  callee-save registers may be stored in the frame.
	  [ruby-dev:25158]

Mon Dec 13 02:45:51 2004  Shugo Maeda  <shugo@ruby-lang.org>

	* ext/curses/curses.c (window_subwin): call NUM2INT() before
	  GetWINDOW(). fixed: [ruby-dev:25161]

Mon Dec 13 00:58:02 2004  Tanaka Akira  <akr@m17n.org>

	* lib/pathname.rb (cleanpath_aggressive): make it private.
	  (cleanpath_conservative): ditto.
	  Suggested by Daniel Berger.  [ruby-core:3914]

Sun Dec 12 21:32:14 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* test/ruby/test_super.rb (TestSuper#test_define_method): now methods
	  from procs can call super.

Sun Dec 12 10:35:10 2004  Dave Thomas  <dave@pragprog.com>

	* lib/rdoc/generators/template/html/html.rb (RDoc::Page): Don't
	  show an accessor's r/w flag if none was specified

Sun Dec 12 10:14:03 2004  Dave Thomas  <dave@pragprog.com>

	* lib/rdoc/rdoc.rb (RDoc::RDoc::parse_files): Never exclude files
	  explicitly given on the command line.

Sat Dec 11 21:10:16 2004  Masatoshi SEKI  <m_seki@mva.biglobe.ne.jp>

	* lib/drb/drb.rb: add DRbRemoteError. [ruby-list:40348],
	  [ruby-list:40390]

	* test/drb/drbtest.rb: ditto.

	* test/drb/ut_drb.rb: ditto.

Sat Dec 11 13:08:28 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* sample/optparse/subcommand.rb: a sample for sub commands like
	  cvs.  contributed by Minero Aoki.

Fri Dec 10 08:39:48 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* ext/socket/socket.c (sock_listen): get OpenFile just before calling
	  listen(2).

Thu Dec  9 16:28:35 2004  NAKAMURA Usaku  <usa@ruby-lang.org>

	* ext/sdbm/init.c (GetDBM): typo.

Thu Dec  9 16:21:51 2004  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* lib/webrick/cgi.rb (WEBrick::CGI#setup_header): avoid
	  SecurityError. [ruby-dev:24970]

	* lib/webrick/httpserver.rb (WEBrick::HTTPServer#run): should wait
	  for reading request till data arrive. [ruby-talk:121068]

Thu Dec  9 14:38:35 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* string.c (rb_str_inspect): escape # which starts an expression
	  substitution.  fixed: [ruby-core:03922]

	* string.c (rb_str_dump): not escape # which isn't a substitution.

Thu Dec  9 12:31:53 2004  WATANABE Hirofumi  <eban@ruby-lang.org>

	* io.c (pipe_open): should set prog if argc != 0.

Thu Dec  9 10:54:36 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* ext/dbm/dbm.c (fdbm_select): [ruby-dev:25132]

	* ext/sdbm/init.c: ditto.

	* ext/gdbm/gdbm.c: ditto.

Thu Dec  9 10:19:18 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* test/socket/test_socket.rb (test_setsockopt): use SO_LINGER instead
	  of SO_BINDTODEVICE.  fixed: [ruby-dev:25133]

Thu Dec  9 03:08:36 2004  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tcltklib/tcltklib.c (ip_init): set root-win title to "ruby" when
	  the running script is '-e one-liner' or '-' (stdin).

	* ext/tcltklib/extconf.rb: add find_library("#{lib}#{ver}",..) for
	  stub libs

	* ext/tk/lib/tk/textmark.rb: TkTextMarkCurrent and TkTextMarkAnchor
	  have a wrong parent class.

	* ext/tk/lib/tk/dialog.rb: rename TkDialog2 --> TkDialogObj and
	  TkWarning2 --> TkWarningObj (old names are changed to alias names)

	* ext/tk/lib/tk/dialog.rb: bug fix of treatment of 'prev_command'
	  option and hashes for configuration

	* ext/tk/lib/tk/dialog.rb: add TkDialogObj#name to return the
	  button name

	* ext/tk/lib/tk/radiobutton.rb: rename enbugged method value() ==>
	  get_value() and value=(val) ==> set_value(val).

	* ext/tk/lib/tk/menu.rb: add TkMenu.new_menuspec

	* ext/tk/lib/tk/menu.rb: add alias (TkMenuButton = TkMenubutton,
	  TkOptionMenuButton = TkOptionMenubutton)

	* ext/tk/lib/tk/event.rb: new method aliases (same as option keys of
	  event_generate) for Event object

	* ext/tk/lib/tk/font.rb: configinfo returns proper types of values

	* ext/tk/lib/tk.rb: bind methods accept subst_args + block

	* ext/tk/lib/tk/canvas.rb: ditto

	* ext/tk/lib/tk/canvastag.rb: ditto

	* ext/tk/lib/tk/frame.rb: ditto

	* ext/tk/lib/tk/text.rb: ditto

	* ext/tk/lib/tk/texttag.rb: ditto

	* ext/tk/lib/tk/toplevel.rb: ditto

	* ext/tk/lib/tkextlib/*: ditto and bug fix

Wed Dec  8 23:54:29 2004  Dave Thomas  <dave@pragprog.com>

	* lib/rdoc/generators/template/html/html.rb (RDoc::Page): Typo
	  meant that h2 tag was invisible.

Wed Dec  8 22:10:02 2004  Tanaka Akira  <akr@m17n.org>

	* rubyio.h, io.c, ext/dl/dl.c, ext/pty/pty.c, ext/socket/socket.c:
	  create FILE object only when required: popen(3) and DL's IO#to_ptr.
	  [ruby-dev:25122]

	* io.c (rb_io_binmode): use setmode for Human68k.  [ruby-dev:25121]

Wed Dec  8 20:13:06 2004  WATANABE Hirofumi  <eban@ruby-lang.org>

	* process.c (rb_spawn): support for DJGPP.

	* lib/mkmf.rb (VPATH): specify the implicit path separator for DJGPP.

Wed Dec  8 17:48:22 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (proc_invoke): merge Guy Decoux's argument preserve
	  patch in [ruby-core:03874].

Wed Dec  8 17:37:33 2004  NAKAMURA Usaku  <usa@ruby-lang.org>

	* win32/win32.c (rb_w32_pipe_exec): need to close original socket
	  handle.

Wed Dec  8 14:31:36 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* sprintf.c (rb_f_sprintf): [ruby-dev:25104]

Wed Dec  8 13:49:46 2004  NAKAMURA Usaku  <usa@ruby-lang.org>

	* win32/win32.c (rb_w32_pipe_exec): must close original handle
	  before exec. fixed: [ruby-dev:25112]

Wed Dec  8 11:46:26 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* parse.y (string_content): get rid of segfault at empty evstr.
	  fixed: [ruby-dev:25113]

Wed Dec  8 03:26:51 2004  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* ext/openssl/ossl_bio.c (ossl_obj2bio): should not use fptr->f.
	  [ruby-dev:25101]

Wed Dec  8 03:26:41 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* runruby.rb: prepend LIBRUBY_SO to LD_PRELOAD as well as rubytest.rb.

Wed Dec  8 01:35:44 2004  NAKAMURA Usaku  <usa@ruby-lang.org>

	* win32/win32.c (is_socket): reorder of function definitions.

Wed Dec  8 00:44:31 2004  NAKAMURA Usaku  <usa@ruby-lang.org>

	* io.c (pipe_open): win32 bidirectional pipe support.

	* win32/win32.[ch] (rb_w32_pipe_exec): ditto.

	* win32/win32.[ch] (socketpair): new function. POSIX socketpair
	  emulation.

	* win32/win32.c (socketpair_internal): ditto.

Wed Dec  8 00:25:07 2004  Kouhei Sutou  <kou@cozmixng.org>

	* test/rss/test_version.rb: added version check test.
	  [ruby-dev:25053]

Tue Dec  7 15:40:38 2004  Tanaka Akira  <akr@m17n.org>

	* io.c (io_fwrite): avoid context switch before writing to stderr.
	  [ruby-dev:25080]

	* rubyio.h: refine deprecated declaration.

	* configure.in, file.c, io.c: remove useless check: fseeko, etc.

Tue Dec  7 13:42:07 2004  NAKAMURA Usaku  <usa@ruby-lang.org>

	* dir.c (dir_s_mkdir): win32 special processing doesn't need any
	  longer.

	* win32/win32.[ch] (rb_w32_mkdir): new function. POSIX.1 compatible
	  interface.

	* win32/win32.[ch] (rb_w32_rmdir): new function.

Tue Dec  7 00:27:37 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* process.c (proc_setgroups): [ruby-dev:25081]

Mon Dec  6 23:07:57 2004  Tanaka Akira  <akr@m17n.org>

	* configure.in: check -lsocket for socketpair and shutdown.
	  reported by Ville Mattila.  [ruby-core:03903]

Mon Dec  6 23:00:45 2004  WATANABE Hirofumi  <eban@ruby-lang.org>

	* configure.in (ac_cv_sizeof_rlim_t): setup for DJGPP.

	* io.c (is_socket, shutdown): define dummy macros for DJGPP.

	* process.c: use SIZEOF_RLIM_T instead of HAVE_RLIM_T for DJGPP.

Mon Dec  6 21:19:40 2004  NAKAMURA Usaku  <usa@ruby-lang.org>

	* io.c (is_socket): fix typos. [ruby-core:03900]

Mon Dec  6 20:13:28 2004  NAKAMURA Usaku  <usa@ruby-lang.org>

	* io.c (is_socket): new function.

	* io.c (rb_io_close_read, rb_io_close_write): use is_socket().

	* io.c (rb_io_fptr_finalize): need to check fptr->f before calling
	  rb_io_fptr_cleanup().

	* io.c (pipe_open): win32 pipe support (experimental).

	* win32/win32.[ch] (rb_w32_pipe_exec): return file descriptors
	  instead of FILE structure objects.

	* win32/win32.[ch] (rb_w32_is_socket): new function.

Mon Dec  6 19:40:40 2004  WATANABE Hirofumi  <eban@ruby-lang.org>

	* Makefile.in (.y.c): simplify the rule.

Mon Dec  6 18:08:10 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* re.c (rb_reg_eqq): document fix.  [ruby-talk:122541]

Mon Dec  6 17:49:30 2004  NAKAMURA Usaku  <usa@ruby-lang.org>

	* eval.c (run_trap_eval): add prototype for Microsoft compiler.

Mon Dec  6 17:32:38 2004  Tanaka Akira  <akr@m17n.org>

	* rubyio.h, intern.h, io.c, file.c, process.c, ext/socket/socket.c,
	  ext/pty/pty.c, ext/io/wait/wait.c, ext/openssl/ossl_ssl.c:
	  Use own buffering mechanism instead of stdio.  [ruby-dev:25056]

	* io.c, ext/stringio/stringio.c, test/ruby/ut_eof.rb:
	  EOF flag removed.

Mon Dec  6 17:15:17 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* test/socket/test_socket.rb (TestBasicSocket#test_setsockopt):
	  BasicSocket#setsockopt dumps core.  [ruby-dev:25039]

	* test/socket/test_tcp.rb (TestTCPSocket#test_recvfrom):
	  TCPSocket#recvfrom dumps core.  [ruby-dev:24705]

	* test/socket/test_udp.rb (TestUDPSocket#test_connect):
	  UDPSocket#connect dumps core.  [ruby-dev:25045]

	* test/socket/test_udp.rb (TestUDPSocket#test_bind):
	  UDPSocket#bind dumps core.  [ruby-dev:25057]

Mon Dec  6 09:59:23 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* io.c (io_fread): take VALUE argument.

	* ext/socket/socket.c (sock_connect): use rb_str_new4().
	  [ruby-dev:25052]

	* eval.c (rb_yield_0): [ruby-dev:25051]

Mon Dec  6 01:32:31 2004  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* ext/openssl/ossl_pkey_rsa.c (ossl_rsa_public_encrypt,
	  ossl_rsa_public_decrypt, ossl_rsa_private_encrypt,
	  ossl_rsa_private_decrypt): should take an optional argument
	  to specify padding mode. [ruby-talk:122539]

	* ext/openssl/ossl_pkey_rsa.c (Init_ossl_rsa): add new constants
	  PKCS1_PADDING, SSLV23_PADDING, NO_PADDING and PKCS1_OAEP_PADDING
	  under OpenSSL::PKey::RSA.

	* test/openssl/test_pkey_rsa.rb: new file.

Sun Dec  5 19:39:17 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* lib/optparse.rb (OptionParser::Completion#complete): new parameter
	  to direct case insensitiveness.

	* lib/optparse.rb (OptionParser#order!): ignore case only for long
	  option.  [ruby-dev:25048]

Sun Dec  5 00:54:32 2004  WATANABE Hirofumi  <eban@ruby-lang.org>

	* mkconfig.rb: setup library paths before requiring library.
	  [ruby-core:03892]

Sat Dec  4 22:54:15 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* io.c (io_write): remove rb_str_locktmp().  [ruby-dev:25050]

	* io.c (io_fwrite): takes VALUE string as an argument.
	  [ruby-dev:25050]

	* ext/socket/socket.c (sock_connect): remove rb_str_locktmp().
	  [ruby-dev:25050]

	* ext/socket/socket.c (udp_connect): [ruby-dev:25045]

	* ext/socket/socket.c (udp_bind): ditto.

	* ext/socket/socket.c (udp_send): ditto.

	* ext/socket/socket.c (bsock_send): ditto.

	* ext/socket/socket.c (s_recvfrom): ditto.

	* hash.c (rb_hash_hash): should provide "hash" method where "eql?"
	  is redefined.  [ruby-talk:122482]

Sat Dec  4 21:29:05 2004  Minero Aoki  <aamine@loveruby.net>

	* lib/fileutils.rb: (In previous commit) new method chown.

	* lib/fileutils.rb: (In previous commit) new method chown_R.

	* lib/fileutils.rb: (In previous commit) new method chmod_R
	  wrongly added.  Removed now.

Sat Dec  4 20:45:52 2004  Minero Aoki  <aamine@loveruby.net>

	* lib/fileutils.rb (mkdir, mkdir_p): should chmod explicitly.
	  [ruby-core:03881]

Sat Dec  4 18:54:09 2004  Kouhei Sutou  <kou@cozmixng.org>

	* lib/rss/rss.rb: removed empty lines from output.

Sat Dec  4 18:49:09 2004  Kouhei Sutou  <kou@cozmixng.org>

	* lib/rss/rss.rb (RSS::VERSION): 0.1.1 -> 0.1.2

	* lib/rss/rss.rb: #item=/#set_item and so on are obsolete.

Sat Dec  4 14:28:56 2004  Dave Thomas  <dave@pragprog.com>

	* lib/rdoc/code_objects.rb (RDoc::Context::Section::set_comment):
	  Section comments may now be bracketed by lines which are
	  ignored. You can now write
	      # -----------
	      # :section: Dave's Section
	      # comment material
	      # -----------
	   The lines before :section: are removed, and identical lines at the end are
	   also removed if present.

Sat Dec  4 00:35:08 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* ext/socket/socket.c (bsock_setsockopt): [ruby-dev:25039]

Fri Dec  3 12:25:21 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* st.h: fix prototype for C++.

Fri Dec  3 01:55:24 2004  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/lib/tk.rb: widget configuration by TkWindow#method_missing
	  returns proper object. "widget.option = val" returns val, and
	  "widget.option(val)" returns self.

	* ext/tk/lib/tk/font.rb: TkFont#replace accepts only one font argument.

	* ext/tk/lib/tk/radiobutton.rb: add TkRadiobutton#value and
	  TkRadiobutton#value=(val).

	* ext/tk/lib/tk/spinbox.rb: callback substitution support on
	  command option.

	* ext/tk/sample/demos-en/widget: bug fix (wrong image height)

	* ext/tk/sample/demos-jp/widget: ditto.

Fri Dec  3 00:21:05 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (proc_invoke): prepare to pass a block from "call" method
	  to a Proc generated by Method#to_proc.  [ruby-dev:25031]

	* eval.c (rb_yield_0): actually passes a block given to "call".

	* object.c (convert_type): use rb_respond_to() again.  this fix is
	  based on [ruby-dev:25021]

	* eval.c (rb_respond_to): funcall respond_to? if it's redefined.
	  [ruby-dev:25021]

Thu Dec  2 15:13:53 2004  Michael Neumann  <mneumann@ruby-lang.org>

	* test/xmlrpc/test_parser.rb, test/xmlrpc/data/*.expected: Expected
	  values are now stored in YAML instead of using #inspect. This fixes
	  false hash order.

Fri Dec  3 00:11:48 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* io.c (rb_file_initialize): [ruby-dev:25032]

Thu Dec  2 16:41:03 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* eval.c (rb_protect): prevent continuations created inside from being
	  called from the outside.  [ruby-dev:25003]

	* eval.c (rb_callcc, rb_cont_call): prohibit calling from different
	  signal contexts.  [ruby-dev:25022]

Thu Dec  2 10:45:02 2004  Shugo Maeda  <shugo@ruby-lang.org>

	* test/readline/test_readline.rb: fix for NetBSD.

Thu Dec  2 09:57:24 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* lib/ostruct.rb (OpenStruct::Marshaler): OpenStruct can be
	  marshaled again.  [ruby-core:03862]

Thu Dec  2 09:30:58 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* eval.c (thread_mark): mark thread group.  [ruby-dev:25020]

	* eval.c (thgroup_add): check whether the argument is really a Thread.

Thu Dec  2 07:57:16 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* io.c (rb_io_ctl): [ruby-dev:25019]

Wed Dec  1 06:13:00 2004  NARUSE, Yui  <naruse@ruby-lang.org>

	* ext/nkf/nkf.c: add constant NKF::VERSION

	* ext/nkf/nkf.c(guess): this becomes an alias of guess2

	* ext/nkf/test.rb: add --no-cp932

	* ext/nkf/nkf-utf8/nkf.c: original nkf2 revision 1.47

Wed Dec  1 02:21:02 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* signal.c (sighandler): call handler immediately only for default
	  handlers.  [ruby-dev:25003]

Tue Nov 30 23:49:12 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* io.c (pipe_open): errno should be preserved for rb_sys_fail() when
	  fork failed.

Tue Nov 30 16:18:50 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* io.c (io_fread): need not to null terminate.  [ruby-dev:24998]

	* eval.c (rb_eval): should check previous frame for ZSUPER.

	* io.c (read_all): remove unnecessary rb_str_resize().
	  [ruby-dev:24996]

	* io.c (io_readpartial): ditto.

	* io.c (io_read): ditto.

Tue Nov 30 14:58:33 2004  WATANABE Hirofumi  <eban@ruby-lang.org>

	* instruby.rb (install): add arguments explicitly to "super".

Tue Nov 30 00:49:08 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (PUSH_FRAME): flags should have been initialized.

	* eval.c (rb_eval): [ruby-core:03856]

	* io.c (rb_io_sysread): use temporary lock.  [ruby-dev:24992]

Tue Nov 30 00:12:57 2004  Kazuo Saito  <ksaito@uranus.dti.ne.jp>

	* regparse.c: now handles many alternatives (over 500000)
	  in regexp. [ruby-dev:24773]

Mon Nov 29 16:06:04 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* ext/stringio/stringio.c (strio_write): insufficiently filled string
	  being extended when overwriting.  [ruby-core:03836]

Mon Nov 29 15:59:05 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* lib/ostruct.rb (OpenStruct::method_missing): check method
	  duplication for -d.

	* lib/ostruct.rb (OpenStruct::initialize): ditto.

Mon Nov 29 15:22:28 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* test/io/nonblock/test_flush.rb: abandon tests when io/nonblock is
	  not supported.

Mon Nov 29 13:37:54 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* io.c (fptr_finalize): must not use FILE after fclose().
	  [ruby-dev:24985]

Mon Nov 29 13:13:13 2004  NAKAMURA Usaku  <usa@ruby-lang.org>

	* win32/win32.c (CreateChild): push back the last space before next
	  loop because CharNext() eats it.

Mon Nov 29 03:08:30 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* object.c (convert_type): [ruby-core:03845]

	* eval.c (rb_funcall_rescue): new function.

	* object.c (rb_Array): avoid using rb_respond_to().

	* object.c (rb_Integer): ditto.

	* eval.c (get_backtrace): no conversion for nil.

	* parse.y (reduce_nodes): empty body should return nil.

Mon Nov 29 01:18:18 2004  Tanaka Akira  <akr@m17n.org>

	* io.c (rb_io_check_writable): call io_seek regardless of
	  NEED_IO_SEEK_BETWEEN_RW.  [ruby-dev:24986]

Sun Nov 28 15:57:58 2004  Kouhei Sutou  <kou@cozmixng.org>

	* lib/rss/rss.rb (RSS::Element#tag): not use block_given? for
	  working with ruby 1.6 again.

	* lib/rss/{0.9,2.0,trackback}.rb, lib/rss/maker/base.rb:
	  undef -> remove_method for working with ruby 1.6 again.

Sun Nov 28 15:51:40 2004  Kouhei Sutou  <kou@cozmixng.org>

	* lib/rss/rss.rb (RSS::NotSetError): added.

	* lib/rss/maker/{1.0,0.9,2.0}.rb: changed RSS Maker to raise
	  RSS::NotSetError if required values of maker.channel are not
	  set. [ruby-talk:120061]

	* test/rss/test_maker_{1.0,0.9,2.0}.rb: changed tests to check RSS
	  Maker raises or not.

Sun Nov 28 12:14:47 2004  Kazuo Saito  <ksaito@uranus.dti.ne.jp>

	* regparse.c (fetch_token): fixed test failure on HP-UX ia64
	  ([ruby-dev:24859]).

Sun Nov 28 12:08:15 2004  Kazuo Saito  <ksaito@uranus.dti.ne.jp>

	* regparse.c, test/ruby/test_regexp.rb: fixed problem with UTF-8
	  characters that have U+00FE or invalid characters.

Sun Nov 28 12:07:04 2004  Kazuo Saito  <ksaito@uranus.dti.ne.jp>

	* regexec.c, test/ruby/test_regexp.rb: fixed segmentation fault
	  ([ruby-dev:24887]).

Sun Nov 28 12:05:48 2004  Kazuo Saito  <ksaito@uranus.dti.ne.jp>

	* regcomp.c, regint.h: fixed PLATFORM_UNALIGNED_WORD_ACCESS
	  problem ([ruby-dev:24802] and [ruby-core:3733])

Sat Nov 27 23:43:39 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* io.c (rb_io_initialize): [ruby-dev:24972]

Sat Nov 27 21:43:39 2004  Tanaka Akira  <akr@m17n.org>

	* io.c: avoid data lost with nonblocking fd and
	  stdio buffering in sync mode.  [ruby-dev:24966]
	  based on matz's patch [ruby-dev:24967]
	  (io_fwrite): new primitive writing function which writes
	  directly if sync mode.
	  (rb_io_fwrite): wrapper for io_fwrite now.
	  (io_write): call io_fwrite instead of rb_io_fwrite.

Sat Nov 27 17:43:21 2004  Kouhei Sutou  <kou@cozmixng.org>

	* lib/rss/{0.9,1.0,2.0,trackback,xml-stylesheet}.rb: added
	  #setup_maker.

	* test/rss/test_setup_maker_*.rb: added tests for #setup_maker.

	* lib/rss/maker/base.rb(RSS::Maker::Items#max_size=): supported
	  output item size limitation.

	* sample/rss/blend.rb: added sample for RSS Maker.

Sat Nov 27 17:41:35 2004  Kouhei Sutou  <kou@cozmixng.org>

	* lib/rss/maker/0.9.rb: supported RSS::Maker.make("0.91"). Now,
	  "0.9" is just alias of "0.91."

	* test/rss/test_maker_0.9.rb: make("0.9") -> maker("0.91").

	* test/rss/test_to_s.rb: ditto.

Sat Nov 27 17:21:30 2004  Kouhei Sutou  <kou@cozmixng.org>

	* sample/rss/list_description.rb: untabified.

	* sample/rss/rss_recent.rb: ditto.

Sat Nov 27 14:44:15 2004  Kent Sibilev  <ksibilev@bellsouth.net>

	* lib/cgi/session.rb (CGI::Session::initialize): [ruby-core:03832]

Sat Nov 27 09:41:21 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* io.c (io_fread): old rb_io_fread with file closing checking.
	  (rb_io_fread): wrapper for io_fread now.
	  [ruby-dev:24964]

Fri Nov 26 18:02:44 2004  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/lib/tk.rb: Tk.destroy uses TkWindow#epath

	* ext/tk/lib/tk/image.rb: bug fix

	* ext/tk/lib/tk/wm.rb: add 'iconphoto' method(Windows only)

	* ext/tk/lib/tkextlib/*: some methods uses TkWindow#epath

Fri Nov 26 14:29:39 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* io.c (rb_io_initialize): uninitialized fd was checked to see open
	  mode.  [ruby-dev:24963]

	* io.c (rb_io_initialize): uninitialized fd was used.  [ruby-dev:24962]

Fri Nov 26 13:49:06 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* io.c (rb_io_initialize): should retrieve flags from copying file
	  descriptor. [ruby-dev:24961]

	* eval.c (method_missing): raise TypeError for classes do not
	  have allocators.  [ruby-core:03752]

	* lib/erb.rb: add RDoc by James Edward Gray II.  [ruby-core:03786]

Fri Nov 26 13:29:02 2004  Dave Thomas  <dave@pragprog.com>

	* lib/rdoc/parsers/parse_rb.rb (RDoc::RubyParser::look_for_directives_in): Break
	  out of preprocessing when we find a :section: directive (previously cleared out the
	  comment, but this apparently now generates an error in gsub!)

Fri Nov 26 00:17:40 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* io.c (io_read): move StringValue() check before GetOpenFile().
	  [ruby-dev:24959]

Thu Nov 25 20:14:57 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* lib/thwait.rb (ThreadsWait#join_nowait): abnormally terminated
	  threads should be also processed.  [ruby-talk:121320]

Thu Nov 25 18:06:37 2004  Tanaka Akira  <akr@m17n.org>

	* configure.in: AC_CHECK_SIZEOF(rlim_t) to include stdio.h to fix
	  problem with autoconf 2.52 or earlier.
	  revert AC_PREREQ to 2.50.
	  [ruby-core:3809]

Thu Nov 25 07:59:41 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* configure.in: AC_PREREQ(2.53) [ruby-core:03800]

	* io.c (read_all): stringify non-nil buffer argument, and always
	  taint the result.  [ruby-dev:24955]

Wed Nov 24 01:01:31 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* io.c (io_read): integer conversion should be prior to
	  GetOpenFile().  [ruby-dev:24952]

	* configure.in, io.c: cancel [ ruby-Patches-1074 ].

Tue Nov 23 08:09:50 2004  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/lib/tk/menu.rb: improve usability of TkOptionMenubutton

Tue Nov 23 02:00:21 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* file.c (rb_file_chown): integer conversion should be prior to
	  GetOpenFile().  [ruby-dev:24949]

Tue Nov 23 00:10:48 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* file.c (rb_file_chown): integer conversion should be prior to
	  GetOpenFile().  [ruby-dev:24947]

	* file.c (rb_file_truncate): ditto.

	* file.c (rb_file_s_truncate): ditto.

	* dir.c (dir_seek): use NUM2OFFT().

	* misc/ruby-mode.el (ruby-non-block-do-re): [ruby-core:03719]

Mon Nov 22 22:33:02 2004  Dave Thomas  <dave@pragprog.com>

	* lib/rdoc/parsers/parse_rb.rb (RDoc::parse_require): Don't use names
	  of variables or constants when parsing 'require'

Mon Nov 22 00:13:35 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* dir.c (dir_seek): should retrieve dir_data after NUM2INT().
	  [ruby-dev:24941]

Sat Nov 20 23:57:33 2004  Dave Thomas  <dave@pragprog.com>

	* lib/rdoc/README (et al): Add a new directive, :section:, and
	  change the output format to accommodate. :section: allows to to
	  group together methods, attributes, constants, etc under
	  headings in the output. If used, a table of contents is
	  generated.

Sat Nov 20 23:56:54 2004  Dave Thomas  <dave@pragprog.com>

	* lib/rdoc/options.rb (Options::parse): Force --inline-source if
	  --one-file option given

Sat Nov 20 23:55:19 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* string.c (rb_str_splice): should place index wrapping after
	  possible modification.  [ruby-dev:24940]

Sat Nov 20 23:25:12 2004  Minero Aoki  <aamine@loveruby.net>

	* io.c (rb_io_getline): f.gets("") did not work. [ruby-core:03771]

	* test/ruby/test_io.rb (test_gets_rs): test it.

Sat Nov 20 22:55:09 2004  WATANABE Hirofumi  <eban@ruby-lang.org>

	* test/runner.rb (CROSS_COMPILING): need to require rbconfig.rb before
	  using CROSS_COMPILNG.

Sat Nov 20 20:42:42 2004  Minero Aoki  <aamine@loveruby.net>

	* ext/ripper/depend: fix ripper.o dependency.

Sat Nov 20 17:48:29 2004  WATANABE Hirofumi  <eban@ruby-lang.org>

	* io.c (io_reopen): work around problem with Cygwin fseeko
	  returning ESPIPE.

Sat Nov 20 05:34:24 2004  NARUSE, Yui  <naruse@ruby-lang.org>

	* ext/nkf/nkf-utf8/nkf.c: original nkf.c rev:1.40

	* ext/nkf/test.rb: add test for mime encode/decode

Sat Nov 20 01:45:04 2004  WATANABE Hirofumi  <eban@ruby-lang.org>

	* test/xmlrpc/test_webrick_server.rb: move `requrie "webrick/https"'
	  into #setup_http_server method to avoid soap test errors.

Sat Nov 20 01:37:34 2004  Johan Holmberg  <holmberg@iar.se>

	* eval.c (error_print): nicer traceback at interrupt.
	  [ruby-core:03774]

Sat Nov 20 00:07:16 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* string.c (str_gsub): internal buffer should not be listed by
	  ObjectSpace.each_object() by String#gsub.  [ruby-dev:24931]

Fri Nov 19 22:44:43 2004  WATANABE Hirofumi  <eban@ruby-lang.org>

	* lib/test/unit/collector/dir.rb: better support for -p/-x option.

Fri Nov 19 17:46:56 2004  Kouhei Sutou  <kou@cozmixng.org>

	* lib/rss/maker/0.9.rb (RSS::Maker::RSS09::Image#have_required_values):
	  changed /rss/channel/image to be optional. [ruby-Bugs:1047]

	* test/rss/test_maker_0.9.rb: added tests for the above.

Fri Nov 19 17:18:17 2004  Kouhei Sutou  <kou@cozmixng.org>

	* lib/rss/rss.rb (RSS::VERSION): 0.1.0 -> 0.1.1.

	* lib/rss: #to_s used #tag.

	* test/rss/test_to_s.rb: added.

	* lib/rss/maker.rb (RSS::Maker.make): changed API. It's not
	  received modules which is used as the second argument.

	* lib/rss/xml-stylesheet.rb (RSS::XMLStyleSheet#alternate):
	  changed return value type which is not String but Boolean.

	* lib/rss/2.0.rb (RSS::Rss::Channel#ttl): changed return value
	  type which is not String but Integer.

	* lib/rss/0.9.rb (RSS::Rss::Channel): <skipDays> has <day>s and
	  <skipHours> has <hour>s.

	* lib/rss/maker/0.9.rb (RSS::Maker::RSS09::Channel): ditto.

	* lib/rss/0.9.rb (RSS::Rss::Channel::Item): <item> has <category>s.

	* lib/rss/maker/2.0.rb (RSS::Maker::Rss20::Channel::Item): ditto.

	* lib/rss/2.0.rb (RSS::Rss::Channel): <channel> has <category>s.

	* lib/rss/maker/2.0.rb (RSS::Maker::RSS20::Channel): ditto.

	* lib/rss/trackback.rb: parent element has <trackback:about>s.

	* lib/rss/maker/trackback.rb: ditto.

Fri Nov 19 11:10:16 2004  WATANABE Hirofumi  <eban@ruby-lang.org>

	* lib/test/unit/collector/dir.rb: add support for directory name
	  with -p/-x options.

	* test/testunit/collector/test_dir.rb: ditto.

	* lib/xmlrpc/datetime.rb (XMLRPC::DateTime#==): should use Array()
	  instead of to_a.

Fri Nov 19 10:32:36 2004  Shugo Maeda  <shugo@ruby-lang.org>

	* ext/readline/readline.c (readline_s_set_completion_append_character):
	  accept nil.  [ruby-core:03765]

Fri Nov 19 01:20:22 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* lib/cgi/session.rb (CGI::Session::FileStore::initialize): raise
	  exception if data corresponding to session specified from the
	  client does not exist.

Fri Nov 19 00:59:31 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* string.c (str_gsub): internal buffer should not be listed by
	  ObjectSpace.each_object().  [ruby-dev:24919]

Thu Nov 18 23:42:36 2004  Minero Aoki  <aamine@loveruby.net>

	* ext/ripper/depend: Never regenerate lib/ripper/core.rb
	  automatically. [ruby-dev:24911]

Thu Nov 18 20:47:24 2004  NAKAMURA Usaku  <usa@ruby-lang.org>

	* win32/win32.[ch] (rb_w32_isatty): new function to replace MSVCRT's
	  isatty because it never sets errno.

Thu Nov 18 18:41:08 2004  Kazuhiro NISHIYAMA  <zn@mbf.nifty.com>

	* test/ruby/test_stringchar.rb (test_bang): added.

	* string.c (rb_str_upcase_bang, rb_str_capitalize_bang)
	  (rb_str_swapcase_bang): missing rb_str_modify().

Thu Nov 18 17:05:01 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* parse.y (f_rest_arg): store rest args into invisible local variable
	  in order to get rid of SEGV at ZSUPER.  [ruby-dev:24913]

Thu Nov 18 15:39:52 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* hash.c (rb_f_getenv): prohibit for $SAFE=4. [ruby-dev:24908]

Thu Nov 18 14:58:42 2004  Shugo Maeda  <shugo@ruby-lang.org>

	* ext/readline/readline.c: check $SAFE.

	* test/readline/test_readline.rb: added tests for readline.

Thu Nov 18 00:21:15 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* process.c (proc_getpgrp): prohibit for $SAFE=2.
	  [ruby-dev:24899]

	* process.c (get_pid): ditto.  [ruby-dev:24904]

	* process.c (get_ppid): ditto.

	* array.c (rb_ary_delete): defer rb_ary_modify() until actual
	  modification.  [ruby-dev:24901]

Thu Nov 18 10:10:14 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* io.c, rubyio.h (rb_io_modenum_flags): exported.

	* ext/stringio/stringio.c (strio_initialize): allow Fixnum as mode as
	  well as IO.new does.  [ruby-dev:24896]

Wed Nov 17 23:47:30 2004  NAKAMURA, Hiroshi  <nahi@ruby-lang.org>

	* test/ruby/test_settracefunc.rb: added.  [ruby-dev:24884]

Wed Nov 17 18:59:16 2004  Kazuhiro NISHIYAMA  <zn@mbf.nifty.com>

	* process.c (proc_getrlimit, proc_setrlimit): add rb_secure(2) to
	  methods of Process.{getrlimit,setrlimit}

Wed Nov 17 13:56:57 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* parse.y (newline_node): should not use FL_SET. [ruby-dev:24874]

	* parse.y (string_content): should not use FL_UNSET.

	* node.h (NODE_NEWLINE): remove unused bit to utilize flag field
	  in nodes.

Wed Nov 17 13:05:10 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* dir.c (rb_push_glob): fix overrun.  [ruby-dev:24886]

Wed Nov 17 11:48:17 2004  Michael Neumann  <mneumann@ruby-lang.org>

	* lib/xmlrpc/parser.rb, test/xmlrpc/test_features.rb: fixed "assigning
	  to constants" warnings

Wed Nov 17 09:38:18 2004  Johan Holmberg  <holmberg@iar.se>

	* re.c (rb_reg_initialize_m): should raise exception instead of
	  compile error.  [ruby-core:03755]

Wed Nov 17 03:42:45 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* string.c (rb_str_splice): move rb_str_modify() after
	  StringValue(), which may alter the receiver.  [ruby-dev:24878]

	* error.c (rb_error_frozen): now raise RuntimeError instead of
	  TypeError.

Tue Nov 16 21:22:47 2004  Michael Neumann  <mneumann@ruby-lang.org>

	* lib/xmlrpc/server.rb (CGIServer): fixed bug when client sends
	  "Content-typ: text/xml; ..."

Tue Nov 16 23:45:07 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* numeric.c (flo_divmod): protect float values from GC by
	  assignment to local variables.  [ruby-dev:24873]

Tue Nov 16 14:31:54 2004  Michael Neumann  <mneumann@ruby-lang.org>

	* test/xmlrpc/*: imported and refactored original test cases.

	* test/xmlrpc/test_webrick_server.rb, test/xmlrpc/webrick_testing.rb:
	  added test case that starts up a WEBrick XML-RPC server and performs
	  some tests on it (both http and https servers are started).

	* lib/xmlrpc/create.rb (XMLWriter::each_installed_writer),
	  lib/xmlrpc/parser.rb (XMLParser::each_installed_parser):
	  added methods to simply original test cases

	* lib/xmlrpc/parser.rb, lib/xmlrpc/datetime.rb: applied patch by
	  MoonWolf <moonwolf@moonwolf.com> to allow parsing datetime.iso8601
	  (e.g. 20041105T01:15:23Z).

	* lib/xmlrpc/server.rb: fixed issue #998
	  (http://rubyforge.org/tracker/?func=detail&atid=1700&aid=998&group_id=426)

	* lib/xmlrpc/create.rb, lib/xmlrpc/utils.rb: when marshalling/loading
	  user-defined data structures, use Class#allocate instead of defining
	  an empty #initialize method. module XMLRPC::Marshallable is now only
	  used for tagging.

	* lib/xmlrpc/.document, lib/xmlrpc/README.rdoc: added howto

Tue Nov 16 16:26:12 2004  NAKAMURA Usaku  <usa@ruby-lang.org>

	* {bcc32,win32,wince}/setup.mak (-epilogue-): remove config.h and
	  config.status to force updating them.

Tue Nov 16 16:20:45 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* ext/stringio/stringio.c (strio_read): position was ignored when a
	  buffer was passed.  http://www.yo.rim.or.jp/~nov/d/?date=20041116#p03

Tue Nov 16 13:35:54 2004  NAKAMURA Usaku  <usa@ruby-lang.org>

	* lib/test/unit/autorunner.rb (Test::Unit::AutoRunner::options): add
	  new option --exclude (-x) to skip some tests. [ruby-core:3363],
	  [ruby-dev:24865]

	* lib/test/unit/collector/dir.rb (Test::Unit::Collector::Dir.exclude):
	  ditto.

Tue Nov 16 11:19:07 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* lib/test/unit/autorunner.rb (Test::Unit::AutoRunner::options): use
	  Regexp conversion.

Tue Nov 16 01:41:31 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* string.c (str_mod_check): frozen check should be separated.
	  [ruby-core:3742]

	* array.c (rb_ary_update): pedantic check to detect
	  rb_ary_to_ary() to modify the receiver.  [ruby-dev:24861]

Mon Nov 15 18:58:05 2004  Tanaka Akira  <akr@m17n.org>

	* configure.in: check rlim_t more portably. [ruby-core:3735]

Mon Nov 15 11:50:32 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* misc/ruby-mode.el (ruby-special-char-p, ruby-parse-partial): handle
	  operator symbols.  [ruby-talk:120177]

Mon Nov 15 08:58:55 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (Init_Proc): make proc as an alias to Proc.new.
	  [ruby-dev:24848]

Mon Nov 15 00:46:03 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (rb_yield_0): lambda{}.call(1) should raise exception.
	  [ruby-talk:120253]

Mon Nov 15 00:33:40 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* string.c (rb_str_clear): avoid revealing NULL pointer.
	  [ruby-dev:24766]

	* string.c (str_gsub): add paranoid check. [ruby-dev:24827]

	* string.c (str_mod_check): check frozen status as well.
	  [ruby-dev:24801]

Sun Nov 14 18:59:03 2004  Tanaka Akira  <akr@m17n.org>

	* process.c (proc_getrlimit): new function for Process.getrlimit.
	  (proc_setrlimit): new function for Process.setrlimit.
	  [ruby-dev:24834]

	* configure.in: check rlim_t and its size.  check setrlimit.

	* ruby.h (NUM2ULL): new macro.

Sun Nov 14 13:27:03 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* lib/pp.rb (PP#object_address_group): remove odd number of 'f'
	  prefixed to negative address.

Sun Nov 14 10:48:21 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* lib/mathn.rb (Integer::gcd2): faster implementation by
	  <erlercw@siu.edu>. [ruby-talk:120232]

Sun Nov 14 08:46:33 2004  NAKAMURA, Hiroshi  <nahi@ruby-lang.org>

	* test/logger/test_logger.rb: Logger just expects
	  Logger#datetime_format to be used for Time#strftime independently of
	  locale. [ruby-dev:24828]

Fri Nov 12 17:32:07 2004  NAKAMURA Usaku  <usa@ruby-lang.org>

	* bcc32/README.bcc32, win32/README.win32: need bison instead of
	  byacc.

Fri Nov 12 15:15:06 2004  NAKAMURA Usaku  <usa@ruby-lang.org>

	* eval.c (ruby_options): now we cannot call rb_glob() before
	  ruby_init(), so call rb_w32_cmdvector() at ruby_options().

	* win32/win32.{c,h} (rb_w32_cmdvector): rename make_cmdvector() and
	  export it.

Fri Nov 12 14:08:01 2004  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/lib/tk/event.rb: remove $LOADED_FEATURES trick

	* ext/tk/lib/tk.rb: ditto

Fri Nov 12 00:31:05 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* ext/gdbm/gdbm.c (fgdbm_store): StringValue() may alter string
	  pointer.  [ruby-dev:24783]

Thu Nov 11 17:58:19 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* dir.c (rb_glob): should have called rb_glob_caller().
	  [ruby-dev:24773]

Thu Nov 11 16:56:10 2004  NAKAMURA Usaku  <usa@ruby-lang.org>

	* test/ruby/test_file.rb (test_truncate_wbuf): we want to test
	  only File#truncate, not behavior of seek(2).

Thu Nov 11 01:52:52 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* error.c (syserr_initialize): use stringified object.
	  [ruby-dev:24768]

Wed Nov 10 22:49:01 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* lib/delegate.rb (SimpleDelegator::dup): wrong number of
	  arguments.

	* lib/delegate.rb (DelegateClass::dup): ditto.

Wed Nov 10 19:47:55 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* dir.c (glob_helper): path is a string object now.

Wed Nov 10 12:31:21 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* README.EXT (Example): extconf.rb is indispensable now.

Wed Nov 10 03:33:36 2004  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tcltklib/tcltklib.c: fix SEGV when compiled with Tcl/Tk8.3.x
	  or older

	* ext/tk/lib/tkextlib/tile/style.rb: bug fix

Tue Nov  9 22:24:07 2004  NARUSE, Yui  <naruse@ruby-lang.org>

	* ext/nkf: original nkf.c rev:1.38

	* ext/nkf/nkf.c: fix bug: can't parse long-name options

	* ext/nkf/test.rb: fix bug: mime tests fail

Tue Nov  9 14:27:18 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* lib/optparse.rb (OptionParser::Officious): moved from DefaultList.

Tue Nov  9 00:50:06 2004  Dave Thomas  <dave@pragprog.com>

	* lib/rdoc/rdoc.rb: Change version numbering of RDoc and ri

Tue Nov  9 01:05:04 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* dir.c (rb_glob2): do not allocate buffer from heap to avoid
	  memory leaks.  use string object for buffering instead.
	  [ruby-dev:24738]

	* dir.c (join_path): ditto.

	* io.c (io_read): external input buffer may be modified even after
	  rb_str_locktmp().  [ruby-dev:24735]

	* dir.c (fnmatch): p or s may be NULL.  [ruby-dev:24749]

Tue Nov  9 00:36:26 2004  Masatoshi SEKI  <m_seki@mva.biglobe.ne.jp>

	* lib/drb/extservm.rb: add DRb::ExtServManager#uri=.
	  [ruby-dev:24743]

Mon Nov  8 22:20:19 2004  Dave Thomas  <dave@pragprog.com>

	* lib/rdoc/parsers/parse_rb.rb (RDoc::RubyParser::parse_class):
	  Fix bug where parent class wasn't being detected if the
	  child class was defined using the A::B notation.

Mon Nov  8 00:14:13 2004  WATANABE Hirofumi  <eban@ruby-lang.org>

	* configure.in: add setup for mignw32 cross compiling.
	  [ruby-talk:119413]

Sun Nov  7 23:49:26 2004  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/lib/tk.rb: bind-event methods accept multi substitution
	  arguments.

	* ext/tk/lib/tk/canvas.rb: ditto.

	* ext/tk/lib/tk/canvastag.rb: ditto.

	* ext/tk/lib/tk/text.rb: ditto.

	* ext/tk/lib/tk/texttag.rb: ditto.

	* ext/tk/lib/tkextlib: ditto.

Sat Nov  6 20:40:16 2004  Masaki Suketa  <masaki.suketa@nifty.ne.jp>

	* ext/win32ole/win32ole.c: rename WIN32OLE#ole_obj_help to
	  WIN32OLE#ole_type. alias ole_obj_help to ole_type.

	* ext/win32ole/tests/testWIN32OLE.rb: ditto.

Sat Nov  6 11:18:59 2004  Tadayoshi Funaba  <tadf@dotrb.org>

	* lib/date.rb (_parse): checks whether zone was given.

Sat Nov  6 00:46:27 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* string.c (rb_str_locktmp): check STR_TMPLOCK flag before
	  locking.  [ruby-dev:24727]

Fri Nov  5 19:07:16 2004  NARUSE, Yui  <naruse@ruby-lang.org>

	* ext/nkf: follow CVS Head of original nkf.

Fri Nov  5 18:12:42 2004  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/lib/tk/scrollable.rb: divide Scrollable module into
	  X_Scrollable and Y_Scrollable

	* ext/tk/lib/tk/entry.rb: include X_Scrollable instead of Scrollable

	* ext/tk/lib/tk/autoload.rb: define autoload for X_Scrollable and
	  Y_Scrollable

Fri Nov  5 16:05:32 2004  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/lib/tk.rb: TkComm._at() supprts both of "@x,y" and "@x"

Fri Nov  5 13:22:58 2004  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/lib/tk/text.rb: sorry. bug fix again.

Fri Nov  5 13:17:54 2004  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/lib/tk/text.rb: bug fix

Fri Nov  5 08:52:48 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* gc.c (gc_mark): stricter GC stack check.

Fri Nov  5 08:34:43 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* string.c (str_gsub): should have removed rb_str_unlocktmp(str).
	  [ruby-dev:24708]

	* ext/socket/socket.c (s_recvfrom): buffer modification check.
	  [ruby-dev:24708]

Thu Nov  4 23:54:21 2004  Kazuo Saito  <ksaito@uranus.dti.ne.jp>

	* regexec.c, regparse.c, regint.h: fixed conflicts between
	  vendor branch.

Thu Nov  4 23:41:55 2004  Kazuo Saito  <ksaito@uranus.dti.ne.jp>

	* ascii.c, euc_jp.c, oniggnu.h, oniguruma.h, regcomp.c,
	  regenc.c, regenc.h, regerror.c, regexec.c, reggnu.c,
	  regint.h, regparse.c, regparse.h, sjis.c, utf8.c:
	  imported Oni Guruma 3.4.0.

	* parse.y, re.c: Now mbclen() takes unsigned char as
	  its argument.

Thu Nov  4 21:25:38 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* string.c (str_gsub): string modify check no longer based on
	  tmplock.  [ruby-dev:24706]

Thu Nov  4 21:13:48 2004  Masaki Suketa  <masaki.suketa@nifty.ne.jp>

	* ext/win32ole/win32ole.c(typelib_file_from_typelib): search "win16"
	  entry to get library path.

	* ext/win32ole/win32ole.c(oletypelib_path): ditto.

	* ext/win32ole/win32ole.c(ole_typedesc2val): add VT_LPWSTR, VT_LPSTR,
	  VT_ERROR case.

Thu Nov  4 15:02:14 2004  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/lib/tk/variable.rb: forget to initialize instance_variables
	  of TkVarAccess objects

Thu Nov  4 09:11:35 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* gc.c (gc_mark): enable GC stack checking.

Thu Nov  4 03:11:33 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* string.c (str_gsub): lock strings temporarily.  [ruby-dev:24687]

	* ext/socket/socket.c (s_recvfrom): tmplock input buffer.
	  [ruby-dev:24705]

Wed Nov  3 22:24:17 2004  Daigo Moriwaki  <techml@sgtpepper.net>

	* lib/webrick/httpauth/digestauth.rb: use Base64.encode64 to
	  avoid warnings.

Wed Nov  3 17:19:59 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* array.c (rb_ary_uniq_bang): do not push frozen string from hash
	  table.  [ruby-dev:24695]

	* array.c (rb_ary_and): ditto.

	* array.c (rb_ary_or): ditto.

Wed Nov  3 17:02:48 2004  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/lib/tk.rb: support to use different Tcl commands between
	  configure and configinfo

	* ext/tk/lib/font.rb: ditto.

	* ext/tk/lib/itemconfig.rb: support to use different Tcl commands
	  between item_configure and item_configinfo

	* ext/tk/lib/itemfont.rb: ditto.

	* ext/tk/extconf.rb: install SUPPORT_STATUS

	* ext/tk/lib/tkextlib: some bug fixes (see ext/tk/ChangeLog.tkextlib)

Wed Nov  3 15:38:28 2004  Kouhei Sutou  <kou@cozmixng.org>

	* test/rss/*.rb: removed tab width configuration headers.

	* test/rss/test_maker_{0.9,1.0}.rb: sort -> do_sort.

	* lib/rss/maker/*.rb: changed API to RSS version independence.

	* lib/rss/maker/base.rb
	  (RSS::Maker::XMLStyleSheets::XMLStyleSheet): checked required
	  (pseudo) attributes.

	* lib/rss/maker/base.rb (RSS::Maker::Items): sort -> do_sort.

	* lib/rss/rss.rb (RSS::BaseModel.install_date_element): avoided
	  warning.

	* lib/rss/0.9.rb (RSS::Rss#textinput): added convenience method.

Tue Nov  2 16:35:57 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* ext/enumerator/enumerator.c (each_cons_i): pass copy of an
	  internal consequent array.  [ruby-talk:118691]

Tue Nov  2 14:54:02 2004  NAKAMURA Usaku  <usa@ruby-lang.org>

	* io.c (pipe_open): need to set cmd if argc == 0 (win32).

Tue Nov  2 01:20:09 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* io.c (pipe_open): IO.popen should take array as 1st argument for
	  a command line.  [ruby-dev:24678]

	* eval.c (proc_invoke): nail down dyna_var node when Proc object
	  or continuation is created.  [ruby-dev:24671]

	* io.c (rb_io_s_popen): do not expand argv array.  [ruby-dev:24670]

Mon Nov  1 22:25:56 2004  Kouhei Sutou  <kou@cozmixng.org>

	* lib/rss/maker/base.rb: changed xml-stylesheet's API of RSS Maker
	  like to item's one.

	* lib/rss/xml-stylesheet.rb (RSS::XMLStyleSheet#guess_type): fixed
	  regular expression bug.

	* test/rss/test_maker_xml-stylesheet.rb: updated tests for
	  xml-stylesheet.

Mon Nov  1 13:59:28 2004  WATANABE Hirofumi  <eban@ruby-lang.org>

	* ext/extmk.rb (MANIFEST): do not use anymore, use extconf.rb instead.

	* ext/enumerator/extconf.rb, ext/fcntl/extconf.rb,
	  ext/stringio/extconf.rb: added.

	* MANIFEST, ext/**/MANIFEST: removed.

	* README.EXT, README.EXT.ja: remove MANIFEST stuff.

Mon Nov  1 11:52:18 2004  NAKAMURA Usaku  <usa@ruby-lang.org>

	* io.c (pipe_open): avoid conflict of variable name. [ruby-dev:24662]

Mon Nov  1 11:46:19 2004  WATANABE Hirofumi  <eban@ruby-lang.org>

	* process.c (rb_f_exec): should check whether prog is NULL.

Mon Nov  1 09:37:19 2004  Kouhei Sutou  <kou@cozmixng.org>

	* lib/rss/maker.rb: added entry point of RSS Maker.

Mon Nov  1 03:14:14 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (rb_get_method_body): store ICLASS in the cache.
	  [ruby-core:03672]

	* eval.c (rb_provided): should return true for loading library
	  too for autoloading.  [ruby-core:03655]

Mon Nov  1 01:14:52 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* io.c (rb_f_open): create copy of popen specifier.  [ruby-dev:24656]

	* string.c (rb_str_locktmp): lock string temporarily.

	* string.c (str_independent): add tmplock check.

	* io.c (io_write): lock output string temporarily.
	  [ruby-dev:24649]

	* io.c (io_write): use rb_str_locktmp().

	* io.c (read_all): ditto.

Sun Oct 31 23:37:00 2004  NARUSE, Yui  <naruse@ruby-lang.org>

	* process.c: on NetBSD don't use setruid() and setrgid().

Sun Oct 31 23:12:10 2004  Kouhei Sutou  <kou@cozmixng.org>

	* lib/rss/maker/*.rb: added RSS Maker.

	* test/rss/test_maker_*.rb: added tests for RSS Maker.

Sun Oct 31 16:58:12 2004  Masaki Suketa  <masaki.suketa@nifty.ne.jp>

	* ext/win32ole/win32ole.c: add WIN32OLE.codepage, WIN32OLE.codepage=.

	* ext/win32ole/tests/testWIN32OLE.rb: ditto.

Sun Oct 31 14:35:26 2004  WATANABE Hirofumi  <eban@ruby-lang.org>

	* ext/nkf/nkf-utf8/nkf.c: add "\075?UTF-8?Q?" for Gmail.

Sun Oct 31 14:18:56 2004  Minero Aoki  <aamine@loveruby.net>

	* parse.y [ripper]: emit lexer-event values to the parser
	  (still incomplete).

Sat Oct 30 15:24:41 2004  Masaki Suketa  <masaki.suketa@nifty.ne.jp>

	* ext/win32ole/win32ole.c: add WIN32OLE_TYPELIB class. add
	  WIN32OLE#ole_typelib method.

	* ext/win32ole/tests/testOLETYPELIB.rb: add WIN32OLE_TYPELIB class.

Sat Oct 30 06:53:24 2004  Peter Vanbroekhoven  <peter.vanbroekhoven@cs.kuleuven.ac.be>

	* eval.c (rb_eval): NODE_XSTR should pass copy of literal string.

Sat Oct 30 00:19:40 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* array.c (rb_ary_update): a[n,m]=nil no longer works as element
	  deletion.

	* enum.c (enum_sort_by): protect continuation jump in.
	  [ruby-dev:24642]

	* eval.c (rb_eval), gc.c (gc_mark_children), node.h (NEW_ALIAS,
	  NEW_VALIAS), parse.y (fitem): allow dynamic symbols to
	  NODE_UNDEF and NODE_ALIAS.

Fri Oct 29 21:27:51 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* io.c (rb_io_check_initialized): new function to check uninitialized
	  object.  [ruby-talk:118234]

	* file.c (rb_file_path), io.c (rb_io_closed): check if initialized.

Fri Oct 29 19:05:33 2004  NARUSE, Yui  <naruse@ruby-lang.org>

	* ext/nkf: follow nkf2.0.

Fri Oct 29 17:18:22 2004  NAKAMURA Usaku  <usa@ruby-lang.org>

	* parse.y (ripper_s_allocate): add prototype for Microsoft compiler.

	* range.c (range_step, range_each): need cast.

Fri Oct 29 16:34:19 2004  Daiki Ueno  <ueno@unixuser.org>

	* misc/ruby-mode.el (ruby-parse-partial): Parse the rest of the
	  line after opening heredoc identifier.  [ruby-dev:24635]

Fri Oct 29 11:35:04 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* parse.y (rb_parser_append_print, rb_parser_while_loop): body node
	  can be empty.  [ruby-dev:24628]

Fri Oct 29 10:00:30 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (rb_thread_start_0): forget to free some memory chunks.
	  [ruby-core:03611]

	* eval.c (ruby_cleanup): ruby_finalize_1 may cause exception,
	  should be wrapped by PUSH_TAG/POP_TAG().  [ruby-dev:24627]

Thu Oct 28 08:42:02 2004  Tanaka Akira  <akr@m17n.org>

	* io.c (argf_forward): use ANSI style.
	  (argf_read): call argf_forward with argv argument.
	  [ruby-dev:24624]

Wed Oct 27 09:17:30 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* string.c (str_gsub): use a string object for exception safeness.
	  [ruby-dev:24601]

Wed Oct 27 07:38:55 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* node.h (NODE_TYPESHIFT): allow 4 more bits for line numbers.
	  [ruby-talk:117841]

	* ruby.h (FL_ABLE): nodes are not subject for flag operations.

	* io.c (ARGF_FORWARD): should have specified argv explicitly,
	  since we no longer have frame->argv saved.  [ruby-dev:24602]

Tue Oct 26 23:30:39 2004  Dave Thomas  <dave@pragprog.com>

	* lib/rdoc/code_objects.rb (RDoc::Context::add_class_or_module):
	  Restore correct :nopdoc: behavior with nested classes and modules.

Tue Oct 26 18:21:29 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* string.c (RESIZE_CAPA): check string attribute before modifying
	  capacity member of string structure.  [ruby-dev:24594]

Tue Oct 26 11:33:26 2004  David G. Andersen  <dga@lcs.mit.edu>

	* ext/zlib/zlib.c (gzreader_gets): use memchr() to to gain
	  performance.  [ruby-talk:117701]

Tue Oct 26 10:56:55 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* sprintf.c (rb_f_sprintf): raise ArgumentError for extra
	  arguments, unless (digit)$ style used.

Mon Oct 25 18:35:39 2004  WATANABE Hirofumi  <eban@ruby-lang.org>

	* win32/win32.c (isUNCRoot): should check NUL after '.'.
	  [ruby-dev:24590]

	* win32/win32.c (isUNCRoot): fixed buffer overrun.

Mon Oct 25 08:03:26 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* eval.c (get_backtrace): ignore illegal backtrace.  [ruby-dev:24587]

Sun Oct 24 00:40:50 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* eval.c (rb_load, search_required, rb_require_safe, rb_require): use
	  frozen shared string to avoid outside modification.  [ruby-dev:24580]

Sat Oct 23 23:40:34 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* io.c (rb_io_fptr_finalize): leave stdin/stdout/stderr open in
	  interpreter termination.  [ruby-dev:24579]

Sat Oct 23 22:18:32 2004  Guy Decoux  <ts@moulon.inra.fr>

	* eval.c (frame_free): Guy Decoux solved the leak problem.
	  Thanks.  [ruby-core:03549]

Sat Oct 23 00:20:55 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* ext/zlib/zlib.c (zstream_append_input): clear klass for z->input
	  to avoid potential vulnerability.

	* ext/zlib/zlib.c (zstream_run): always use zstream_append_input()
	  to avoid SEGV.  [ruby-dev:24568]

Fri Oct 22 12:02:28 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (rb_alias): was warning for wrong condition.
	  [ruby-dev:24565]

Fri Oct 22 10:36:37 2004  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* lib/webrick/httprequest.rb (WEBrick::HTTPRequest#meta_vars):
	  should check if path_info is not nil.

Fri Oct 22 00:22:31 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* ext/zlib/zlib.c (zstream_shift_buffer): should restore class
	  field of a buffer.  [ruby-dev:24562]

Fri Oct 22 00:20:33 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* string.c (rb_str_include): should not treat char as negative value.
	  [ruby-dev:24558]

Thu Oct 21 21:32:30 2004  IWATSUKI Hiroyuki  <don@na.rim.or.jp>

	* lib/pstore.rb (PStore#transaction): Use the empty content when a
	  file is not found.  [ruby-dev:24561]

Thu Oct 21 19:06:15 2004  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* lib/webrick/httpresponse.rb (WEBrick::HTTPResponse#send_body_io):
	  ensure to close @body. (http://bugs.debian.org/277520)

Thu Oct 21 13:11:31 2004  WATANABE Hirofumi  <eban@ruby-lang.org>

	* io.c (pipe_open): variable name "fpw" is conflicted.

Thu Oct 21 00:36:41 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (rb_alias): should warn on method discarding.
	  [ruby-dev:24546]

	* ext/zlib/zlib.c (zstream_expand_buffer_into): hide internal
	  string buffer by clearing klass.  [ruby-dev:24548]

	* parse.y (lex_getline): should not touch ruby_debug_lines if
	  RIPPER is defined.  [ruby-dev:24547]

Wed Oct 20 19:45:13 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* string.c (str_gsub): 	reentrant check.  [ruby-dev:24432]

Wed Oct 20 12:42:53 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* io.c (rb_io_getline): rs modification check should not interfere
	  in the loop.

Wed Oct 20 10:31:33 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* parse.y (lex_getline): should update ruby_debug_lines.

Wed Oct 20 04:17:55 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* ext/dbm/dbm.c (fdbm_delete_if): should check if deleting element
	  is a string.  [ruby-dev:24490]

	* ext/sdbm/init.c (fsdbm_delete_if): ditto.

Wed Oct 20 01:37:18 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* array.c (rb_ary_times): Array#* should return an instance of
	  the class of right operand.  [ruby-dev:24526]

	* ext/zlib/zlib.c (zstream_detach_buffer): should not expose
	  class-less object to Ruby world. [ruby-dev:24530]

	* eval.c (proc_dup): provide Proc#dup as well.  [ruby-talk:116915]

	* eval.c (ruby_exec): stack marking position may be higher than
	  expected.  thanks to Guy Decoux.  [ruby-core:03527]

Wed Oct 20 00:25:41 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* eval.c (search_required): required name must not be changed before
	  loading.  [ruby-dev:24492]

Tue Oct 19 23:59:46 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* eval.c (rb_require_safe): provide the feature after loaded.
	  [ruby-list:40085]

Tue Oct 19 22:43:12 2004  Dave Thomas  <dave@pragprog.com>

	* lib/rdoc/parsers/parse_rb.rb (RDoc::RubyParser::parse_attr): If
	  we come across 'attr' in a context where it isn't
	  followed by a symbol, just issue a warning.

Tue Oct 19 20:32:50 2004  Masaki Suketa  <masaki.suketa@nifty.ne.jp>

	* ext/win32ole.c(ole_invoke): retrieve the result value when
	  retrying the IDispatch::invoke.

Tue Oct 19 17:24:11 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* io.c (read_all): block string buffer modification during
	  rb_io_fread() by freezing it temporarily. [ruby-dev:24479]

	* dir.c (rb_push_glob): block call at once the end of method.
	  [ruby-dev:24487]

	* ext/enumerator/enumerator.c (enum_each_slice): remove
	  rb_gc_force_recycle() to prevent potential SEGV.
	  [ruby-dev:24499]

	* ext/zlib/zlib.c (zstream_expand_buffer): hide internal string
	  buffer by clearing klass.  [ruby-dev:24510]

Tue Oct 19 08:47:21 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* string.c (rb_str_upto): method result must be checked.  [ruby-dev:24504]

	* eval.c (error_print): ditto.  [ruby-dev:24519]

Mon Oct 18 23:37:05 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* marshal.c (r_object0): check inheritance by the internal function.
	  [ruby-dev:24515]

Mon Oct 18 11:29:32 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* io.c (rb_io_flags_mode, rb_io_mode_flags): distinguish whether file
	  not existing is created.  [ruby-dev:24505]

Mon Oct 18 07:26:21 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* file.c (rb_file_truncate): discard read buffer before truncation.
	  [ruby-dev:24197]

Mon Oct 18 01:56:03 2004  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* lib/webrick/httprequest.rb (WEBrick::HTTPRequest#initialize):
	  initial value of accpet-* should be array.

Mon Oct 18 00:42:45 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* ext/socket/socket.c (sock_s_getservbyaname): protocol string
	  might be altered.  [ruby-dev:24503]

	* string.c (rb_str_upto): check if return value from succ is a
	  string.  [ruby-dev:24504]

Sun Oct 17 23:03:48 2004  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/lib/tk/timer.rb: TkTimer#start and restart accept a block

Sun Oct 17 12:53:46 2004  Masaki Suketa  <masaki.suketa@nifty.ne.jp>

	* ext/win32ole/win32ole.c (fole_func_methods): correct argument mismatch.
	* ext/win32ole/win32ole.c (fole_get_methods): ditto.
	* ext/win32ole/win32ole.c (fole_put_methods): ditto.
	* ext/win32ole/tests/testWIN32OLE.rb: add test for WIN32OLE#ole_func_methods
	  WIN32OLE#ole_get_methods, WIN32OLE#ole_put_methods

Sat Oct 16 14:45:28 2004  Kouhei Sutou  <kou@cozmixng.org>

	* lib/rss/0.9.rb (RSS::Rss#to_s): removed garbage.

Sat Oct 16 13:42:49 2004  Kouhei Sutou  <kou@cozmixng.org>

	* lib/rss/: untabified.
	* test/rss/: untabified.
	* lib/rss/0.9.rb (RSS::Rss#to_s): inent -> indent.

Sat Oct 16 13:34:56 2004  Kouhei Sutou  <kou@cozmixng.org>

	* lib/rss: supported prety print.
	* test/rss/test_1.0.rb: added test for calculating default indent size.

Sat Oct 16 10:56:36 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* lib/mkmf.rb (create_makefile): install-rb is needed for statically
	  linked extensions.  [ruby-dev:24491]

Fri Oct 15 18:07:08 2004  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* ext/openssl/ossl_x509store.c
	  (ossl_x509stctx_initialize): setup OpenSSL::X509::StoreContext with
	  ossl_x509stctx_* functions instead of X509_STORE_CTX_*.
	  (ossl_x509store_set_time): add OpenSSL::X509::Store#time=.
	  (ossl_x509stctx_set_time): add OpenSSL::X509::StoreContext#time=.

	* test/openssl/ossl_x509store.rb: test certificate validity times.

Fri Oct 15 18:04:35 2004  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/lib/tk/timer.rb: TkTimer.new(interval, loop){ ... } is
	  acceptable. Add TkTimer.start ( == new + start ).

Fri Oct 15 12:43:09 2004  Tanaka Akira  <akr@m17n.org>

	* eval.c (Init_stack): make prototype declaration consistent with
	  the definition in gc.c.

Thu Oct 14 13:33:59 2004  Kouhei Sutou  <kou@cozmixng.org>

	* lib/rss/rss.rb: added link to Tutorial.

Tue Oct 12 21:22:50 2004  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* lib/webrick/config.rb:
	  add WEBrick::Config::FileHandler[:AcceptableLanguages].

	* lib/webrick/httpservlet/filehandler.rb
	  (WEBrick::HTTPServlet::FileHandler#set_filename): search files
	  having suffix of language-name which Accept-Language header field
	  includes if :AcceptableLanguages options is present.

	* lib/webrick/httpservlet/filehandler.rb
	  (WEBrick::HTTPServlet::FileHandler#get_servlet): new method to
	  search servlet correspond to the suffix of filename.

	* lib/webrick/httprequest.rb: add attributes access methods: accept,
	  accept_charset, accept_encoding, accept_language, content_length
	  and content_type.

	* lib/webrick/httpresponse.rb: add attribute access methods:
	  content_length, content_length=, content_type and content_type=.

	* lib/webrick/httputils.rb (WEBrick::HTTPUtils.mime_types):
	  use the second suffix to detect media type. (the first suffix
	  may be a language name.)

	* lib/webrick/httputils.rb (WEBrick::HTTPUtils.parse_qvalues):
	  add method to parse Accept header field. it returns an Array of
	  values sorted by the qvalues.

Tue Oct 12 15:05:32 2004  WATANABE Hirofumi  <eban@ruby-lang.org>

	* io.c (MODE_BINMODE, MODE_BINARY): fixed reversed condition.

Mon Oct 11 17:51:34 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* io.c (rb_io_popen): get mode string via rb_io_flags_mode() to
	  avoid mode string modification.  [ruby-dev:24454]

	* io.c (rb_io_getline_fast): should take delim as unsigned char to
	  distinguish EOF and '\377'.  [ruby-dev:24460]

	* io.c (rb_io_getline): add check for RS modification.
	  [ruby-dev:24461]

	* enum.c (enum_sort_by): use qsort() directly instead using
	  rb_iterate().  [ruby-dev:24462]

	* enum.c (enum_each_with_index): remove rb_gc_force_recycle() to
	  prevent access to recycled object (via continuation for
	  example).  [ruby-dev:24463]

Mon Oct 11 13:48:20 2004  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/lib/tk/*: untabify

Sun Oct 10 12:32:08 2004  Dave Thomas  <dave@pragprog.com>

	* lib/rdoc/parsers/parse_rb.rb (RDoc::parse_require): Allow 'require'
	  to be used as a variable name

Sun Oct 10 02:49:14 2004  Minero Aoki  <aamine@loveruby.net>

	* ext/ripper/lib/ripper/filter.rb: require ripper/tokenizer.

	* ext/ripper/lib/ripper/filter.rb (parse): argument is optional.

Sun Oct 10 02:43:13 2004  Minero Aoki  <aamine@loveruby.net>

	* parse.y [ripper]: \n between two comments disappeared.

Sat Oct  9 21:23:37 2004  Kouhei Sutou  <kou@cozmixng.org>

	* lib/rss/converter.rb: changed to try to use Iconv for default
	  conversion.

	* lib/rss/rss.rb: 0.0.9 -> 0.1.0.

Sat Oct  9 19:50:36 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* io.c (rb_io_getline): should not treat char as negative value.
	  [ruby-dev:24460]

Sat Oct  9 00:25:39 2004  Tanaka Akira  <akr@m17n.org>

	* io.c (rb_io_fread): rb_thread_wait_fd() was lost.
	  [ruby-dev:24457]

Fri Oct  8 21:36:56 2004  Minero Aoki  <aamine@loveruby.net>

	* lib/fileutils.rb (fu_traverse): return value of Dir.entries is
	  reliable. (pass $SAFE=1)

	* lib/fileutils.rb (remove_dir): return value of Dir.foreach is
	  reliable. (pass $SAFE=1)

Fri Oct  8 09:49:32 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* pack.c (pack_pack): pointer modification check before each
	  iteration.  [ruby-dev:24445]

Fri Oct  8 01:13:05 2004  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/lib/tk/optiondb.rb: make it more secure

Thu Oct  7 23:47:57 2004  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/lib/tk/scrollbar.rb: When 'set' operation, a scrollbar
	  cannot propagate view port information from the source widget
	  (that calls 'set') to other assigned widgets.

Thu Oct  7 17:36:25 2004  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/lib/tk.rb: When CHILDKILLED and so on, Tk.errorCode returns
	  a Fixnum for 2nd element (it's pid) of the return value.

Thu Oct  7 12:55:04 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* io.c (io_read): should freeze buffer before thread context
	  switch. [ruby-dev:24442]

	* pack.c (pack_unpack): string conversion should at the top of the
	  method.  [ruby-dev:24439]

	* io.c (io_read): buffer should be frozen only after the length
	  check.  [ruby-dev:24440]

Thu Oct  7 02:56:43 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* ext/stringio/stringio.c: use FMODE_APPEND.

Thu Oct  7 01:05:33 2004  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/lib/tk.rb: add Tk.errorInfo and Tk.errorCode

Thu Oct  7 00:08:37 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* io.c (rb_io_s_sysopen): preserve path in the buffer allocated by
	  ALLOCA_N() to prevent modification.  [ruby-dev:24438]

Wed Oct  6 09:21:00 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* io.c (rb_io_mode_flags): preserve append mode flag.
	  [ruby-dev:24436]

	* io.c (rb_io_modenum_mode): do not use external output buffer.

	* string.c (rb_str_justify): differ pointer retrieval to prevent
	  padding string modification.  [ruby-dev:24434]

	* range.c (range_each_func): allow func to terminate loop by
	  returning RANGE_EACH_BREAK.

	* range.c (member_i): use RANGE_EACH_BREAK. [ruby-talk:114959]

Tue Oct  5 09:53:22 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* io.c (rb_fopen): mode string copy at the lowest level.

	* io.c (rb_io_flags_mode): requires output buffer no more.  no
	  allocation needed.

	* array.c (rb_ary_index): takes a block to compare items in an
	  array.  [ruby-talk:113069] [Ruby2]

	* array.c (rb_ary_rindex): ditto.

Mon Oct  4 14:03:40 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* io.c (rb_file_open_internal, rb_io_reopen): fname might be altered
	  while GC.  [ruby-dev:24408]

Mon Oct  4 12:53:45 2004  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/lib/tk/optiondb.rb: support definition of command
	  resources on widgets

	* ext/tk/lib/tk/image.rb: bug fix

Sun Oct  3 21:16:05 2004  Shugo Maeda  <shugo@ruby-lang.org>

	* lib/net/imap.rb (TEXT_REGEXP): allow 8-bit characters for the german
	  version of Microsoft Exchange Server.

	* lib/net/imap.rb (RTEXT_REGEXP): ditto.

	* lib/net/imap.rb (CTEXT_REGEXP): ditto.

Sat Oct  2 20:34:05 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* parse.y (local_vars): moved to struct parser_params.
	  [ruby-dev:24391]

	* parser.y (stmts): remove suspicious NODE_BEGIN.  [ruby-dev:24390]

	* node.h (NEW_DVAR): extra semicolon.

Sat Oct  2 00:42:20 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* marshal.c (r_byte): retrieve pointer from string value for each
	  time.  [ruby-dev:24404]

	* marshal.c (r_bytes0): ditto.

	* enum.c (sort_by_i): re-entrance check added.  [ruby-dev:24399]

	* io.c (io_read): should freeze all reading buffer.
	  [ruby-dev:24400]

	* string.c (rb_str_sum): should use bignums when bits is greater
	  than or equals to sizeof(long)*CHAR_BITS. [ruby-dev:24395]

	* eval.c (specific_eval): defer pointer retrieval to prevent
	  unsafe sourcefile string modification.  [ruby-dev:24382]

	* string.c (rb_str_sum): wrong cast caused wrong result.
	  [ruby-dev:24385]

	* enum.c (enum_sort_by): hide temporary array from
	  ObjectSpace.each_object.  [ruby-dev:24386]

	* string.c (rb_str_sum): check was done with false pointer.
	  [ruby-dev:24383]

	* string.c (rb_str_sum): string may be altered.  [ruby-dev:24381]

Fri Oct  1 11:40:14 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (rb_f_eval): defer pointer retrieval to prevent unsafe
	  sourcefile string modification.  [ruby-dev:24373]

	* io.c (io_read): block string buffer modification during
	  rb_io_fread() by freezing it temporarily. [ruby-dev:24366]

	* io.c (rb_io_s_popen): mode argument may be altered.
	  [ruby-dev:24375]

	* file.c (rb_file_s_basename): ext argument may be altered.
	  [ruby-dev:24377]

	* enum.c (enum_sort_by): use NODE instead of 2 element arrays.
	  [ruby-dev:24378]

	* string.c (rb_str_chomp_bang): StringValue() may change the
	  receiver.  [ruby-dev:24371]

Fri Oct  1 11:25:20 2004  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/lib/tk/grid.rb: revive TkGrid.grid

	* ext/tk/lib/tk/pack.rb: revive TkPack.pack

	* ext/tk/lib/tk/place.rb: revive TkPlace.place

Thu Sep 30 00:50:44 2004  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tcltklib/tcltklib.c (ip_init): bug fix

	* ext/tk/tkutil.c (get_eval_string_core): accept a Regexp object

	* ext/tk/lib/multi-tk.rb: fix bug on 'exit' operation

	* ext/tk/lib/tk/text.rb: 'tksearch' accepts a Regexp object as a
	  matting pattern argument

Wed Sep 29 10:58:07 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* enum.c (sort_by_i): internally used object must not be changed
	  outside.  [ruby-dev:24368]

Mon Sep 27 21:25:12 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* eval.c (rb_call0): invoke finalizers periodically.

	* gc.c (gc_sweep): defer running finalizers.  [ruby-dev:24354]

	* gc.c (rb_gc_finalize_deferred): run deferred finalizers.

Mon Sep 27 15:01:59 2004  Minero Aoki  <aamine@loveruby.net>

	* parse.y [ripper]: missing ';'.

Mon Sep 27 13:46:45 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* intern.h, struct.c (rb_struct_s_members, rb_struct_members): public
	  accessors.  [ruby-dev:24342]

	* marshal.c (w_object, r_object0): use accessors.

Mon Sep 27 09:14:03 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* array.c (rb_ary_delete): comparison may change the capacity.
	  [ruby-dev:24348]

	* array.c (rb_ary_fill): fill should honor length argument.
	  [ruby-dev:24346]

	* array.c (rb_ary_replace): should not use ptr from shared array.
	  [ruby-dev:24345]

	* ext/socket/socket.c (s_accept): don't retry for EWOULDBLOCK.
	  [ruby-talk:113807]

Sun Sep 26 08:05:10 2004  Tadayoshi Funaba  <tadf@dotrb.org>

	* lib/date.rb: provides {Time,Date,DateTime}#to_{time,date,datetime}.

	* sample/cal.rb: uses getoptlong instead of getopts.

Sat Sep 25 18:39:22 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* array.c (flatten): element size might change during comparison.
	  [ruby-dev:24343]

Sat Sep 25 01:52:49 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* struct.c (rb_struct_s_members): wrong call of struct_members.
	  [ruby-dev:24333]

Fri Sep 24 16:09:42 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (proc_invoke): propagate DVAR_DONT_RECYCLE on termination
	  to avoid double call to rb_gc_force_recycle(). [ruby-dev:24311]

Fri Sep 24 08:29:45 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* parse.y (rb_parser_append_print): should handle prelude.
	  [llama@u01.gate0]

	* parse.y (rb_parser_while_loop): ditto.

	* array.c (rb_ary_subseq): original object might be modified after
	  sharing data creation.  [ruby-dev:24327]

	* array.c (rb_ary_replace): ditto.

	* array.c (ary_make_shared): freeze shared array. [ruby-dev:24325]

	* struct.c (struct_members): always check struct size and size of
	  members list in the class.  [ruby-dev:24320]

Thu Sep 23 19:48:14 2004  Minero Aoki  <aamine@loveruby.net>

	* ext/ripper/Makefile.dev: removed.

	* ext/ripper/ripper.rb.in: moved to lib/ripper/core.rb.in.

	* ext/ripper/lib/ripper/core.rb: new file.

	* ext/ripper/lib/ripper/core.rb.in: new file.

	* ext/ripper/tools/generate-ripper_rb.rb: change comment.

	* test/ripper/*.rb: on__scan event removed.

	* test/ripper/*.rb: event name is changed: on__XXX -> on_XXX.

Thu Sep 23 09:29:14 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* string.c (rb_str_sub_bang): check if string is not modified
	  during iteration.  [ruby-dev:24315]

	* hash.c (rb_hash_rehash): replace st_foreach() by its deep
	  checking counterpart.  [ruby-dev:24310]

Wed Sep 22 14:21:54 2004  Minero Aoki  <aamine@loveruby.net>

	* parse.y [ripper]: on__scan event removed.

	* parse.y [ripper]: event name is changed: on__XXX -> on_XXX.

	* ext/ripper/eventids2.c: ditto.

	* ext/ripper/ripper.rb.in: ditto.

	* ext/ripper/lib/ripper.rb: sync with ripper.rb.in.

	* ext/ripper/lib/ripper/tokenizer: ditto.

	* ext/ripper/lib/ripper/filter: new file.

	* sample/ripper/colorize.rb: new file.

	* sample/ripper/strip-comment.rb: new file.

Wed Sep 22 13:50:49 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* hash.c (hash_alloc): was using tbl pointer without
	  initialization.

Wed Sep 22 13:38:12 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* hash.c (rb_hash_rehash): add iteration check.  [ruby-dev:24301]

	* st.c (st_foreach): add deep check.

	* hash.c (rb_hash_fetch): returns KeyError instead of IndexError.

	* hash.c (env_fetch): ditto.

Wed Sep 22 13:02:02 2004  NAKAMURA Usaku  <usa@ruby-lang.org>

	* win32/win32.c (rb_w32_call_handler): workaround for Ctrl-C.

Wed Sep 22 09:04:41 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* parse.y: remove global variables ruby_eval_tree and
	  ruby_eval_tree_begin.

	* array.c (rb_ary_collect_bang): element size might change during
	  comparison.  [ruby-dev:24300]

	* array.c (rb_ary_reject_bang): ditto. [ruby-dev:24300]

	* array.c (rb_ary_eql): ditto. [ruby-dev:24300]

Wed Sep 22 00:11:12 2004  Dave Thomas  <dave@pragprog.com>

	* process.c: Add documentation for fork()

Tue Sep 21 18:29:49 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* array.c (rb_ary_uniq_bang): element size might change during
	  comparison.  [ruby-dev:24298]

Mon Sep 20 17:46:51 2004  Minero Aoki  <aamine@loveruby.net>

	* ext/ripper/lib/ripper/tokenizer.rb: fix typo.

Mon Sep 20 17:38:43 2004  Minero Aoki  <aamine@loveruby.net>

	* test/ripper/test_scanner_events.rb: tokens must be reordered.

	* ext/ripper/lib/ripper/tokenizer.rb: ditto.

Mon Sep 20 16:58:16 2004  Minero Aoki  <aamine@loveruby.net>

	* parse.y [ripper]: do not delay dispatching.

	* ext/ripper/lib/ripper/tokenizer.rb: sort tokens by right order.

Mon Sep 20 15:17:47 2004  Minero Aoki  <aamine@loveruby.net>

	* ext/ripper/lib/ripper/tokenizer.rb: new file.

Mon Sep 20 15:13:52 2004  Minero Aoki  <aamine@loveruby.net>

	* test/ripper/test_scanner_events.rb: test #lineno and #column.

Mon Sep 20 14:50:17 2004  Minero Aoki  <aamine@loveruby.net>

	* parse.y [ripper]: delayed heredocument events should be
	  dispatched after EOF.

Mon Sep 20 14:39:42 2004  Minero Aoki  <aamine@loveruby.net>

	* parse.y [ripper]: adjust lineno and columns for multi-line
	  strings.

	* parse.y [ripper]: delay heredocument events until seeing
	  end-of-line.

	* parse.y [ripper]: event on__heredoc_contentn ->
	  on__tstring_content.

	* ext/ripper/eventids2.c: ditto.

	* ext/ripper/lib/ripper.rb: sync with eventids2.c.

	* test/ripper/test_scanner_events.rb: test it.

	* ext/ripper/tools/generate-ripper_rb.rb: show basename of input.

	* ext/ripper/Makefile.dev: support objdir build.

Mon Sep 20 13:22:55 2004  Minero Aoki  <aamine@loveruby.net>

	* parse.y [ripper]: remove Ripper#pos.

	* parse.y [ripper]: Ripper#column should return the column of the
	  current token.

Mon Sep 20 12:02:41 2004  Minero Aoki  <aamine@loveruby.net>

	* parse.y [ripper]: unify old_lex_p and token_head.

	* test/ripper/test_scanner_events.rb: now \r\n is saved correctly.

	* parse.y: new macro lex_goto_eol() for next change.

Mon Sep 20 11:01:55 2004  Minero Aoki  <aamine@loveruby.net>

	* parse.y [ripper]: adjust line number for heredoc.  [ruby-dev:24272]

Mon Sep 20 04:49:22 2004  Minero Aoki  <aamine@loveruby.net>

	* ext/ripper/ripper.rb.in: new const Ripper::PARSER_EVENT_TABLE.

	* ext/ripper/ripper.rb.in: new const Ripper::SCANNER_EVENT_TABLE.

	* ext/ripper/lib/ripper.rb: sync with ripper.rb.in.

Mon Sep 20 04:13:00 2004  Minero Aoki  <aamine@loveruby.net>

	* test/ripper/test_scanner_events.rb: test spaces before heredoc
	  mark.

Mon Sep 20 03:46:54 2004  Minero Aoki  <aamine@loveruby.net>

	* parse.y [ripper]: spaces before heredoc marker was lost.
	  [ruby-dev:24272]

	* keywords: rb_reserved_word() should be defined only in ruby
	  core.  [ruby-dev:24272]

	* lex.c: sync with keywords.

	* ext/ripper/ripper.rb.in (parse): fix typo.

	* ext/ripper/lib/ripper.rb: sync with ripper.rb.in.

Mon Sep 20 03:37:59 2004  Tanaka Akira  <akr@m17n.org>

	* ext/zlib/zlib.c (gzfile_read_raw): call readpartial at first.
	  (Zlib::GzipReader#readpartial): new method.

Mon Sep 20 00:24:19 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* enum.c (enum_sort_by): do not use qsort directly.  use
	  rb_ary_sort_bang() instead.  [ruby-dev:24291]

	* enum.c (enum_sort_by): pedantic type check added.
	  [ruby-dev:24291]

	* hash.c (rb_hash_foreach_iter): check iter_lev after each
	  iteration.  [ruby-dev:24289]

	* array.c (rb_ary_and): element size might change during
	  comparison.  [ruby-dev:24290]

	* array.c (rb_ary_or): ditto. [ruby-dev:24292]

	* array.c (rb_ary_equal): wrong fix. [ruby-dev:24286]

Sat Sep 18 15:02:22 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* array.c (rb_ary_equal): element size might change during
	  comparison.  [ruby-dev:24254]

	* array.c (rb_ary_diff): ditto. [ruby-dev:24274]

	* array.c (rb_ary_select): ditto. [ruby-dev:24278]

	* array.c (rb_ary_delete): ditto. [ruby-dev:24283]

	* array.c (rb_ary_rindex): ditto. [ruby-dev:24275]

	* array.c (rb_ary_initialize): element size might change during
	  initializing block.  [ruby-dev:24284]

Sat Sep 18 14:10:23 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* dir.c (dir_s_chdir): avoid memory leak and unnecessary chdir to
	  the original directory when exception has caused in changing
	  direcotry or within block.  thanks to Johan Holmberg
	  <holmberg@iar.se> [ruby-core:03446]

Fri Sep 17 20:29:33 2004  NAKAMURA Usaku  <usa@ruby-lang.org>

	* parse.y: add prototypes for Microsoft compiler.

	* ext/ripper/depend (parse.obj): lex.c exists at hdrdir.

	* {bcc32,win32,wince}/Makefile.sub (YACC, YFLAGS, parse.c):
	  use bison.

Fri Sep 17 17:11:08 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* array.c (rb_ary_delete): element comparison might change array
	  size. [ruby-dev:24273]

	* parse.y: make ruby parser reentrant. merge ripper parser to the
	  real one.  this change makes ruby require bison.

	* file.c (rb_file_truncate): clear stdio buffer before truncating
	  the file.  [ruby-dev:24191]

	* ext/digest/digest.c: use rb_obj_class() instead of CLASS_OF
	  which might return singleton class.  [ruby-dev:24202]

Fri Sep 17 16:07:09 2004  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/lib/multi-tk.rb: improve exit operation

Fri Sep 17 15:01:57 2004  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tcltklib/tcltklib.c: fix SEGV when (thread_)vwait or
	  (thread_)tkwait

	* ext/tk/lib/tk.rb: add alias wait_window to wait_destroy

	* ext/tk/lib/multi-tk.rb: support calling 'mainloop' on slave
	  interpreters (however, the 'real' eventloop must be run on the
	  Default Master IP)

	* ext/tk/lib/remote-tk.rb: follow the changes of ext/tk/lib/multi-tk.rb

	* ext/tk/sample/remote-ip_sample2.rb: ditto

	* ext/tk/sample/tkoptdb-safeTk.rb: ditto

Thu Sep 16 18:12:13 2004  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* lib/webrick/cgi.rb (WEBrick::CGI#start): should set REMOTE_USER
	  to request.user attribute.

	* lib/webrick/httpservlet/filehandler.rb
	  (WEBrick::HTTPServlet::FileHandler#initialize): should expand
	  the pathname of document root directory.

Thu Sep 16 15:49:28 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* string.c (rb_str_intern): protect string argument from GC.
	  [ruby-core:03411]

Wed Sep 15 20:22:23 2004  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/sample/tkoptdb-safeTk.rb: fix a bug depend on the changes
	  of MultiTkIp

Tue Sep 14 23:54:11 2004  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/lib/multi-tk.rb: MultiTkIp#eval_string was en-bugged by
	  the previous changes.

Tue Sep 14 23:45:44 2004  Dave Thomas  <dave@pragprog.com>

	* lib/rdoc/ri/ri_formatter.rb (RI::TextFormatter::TextFormatter.for):
	  Add Eric Hodel's simpleformatter.

Tue Sep 14 22:11:08 2004  Minero Aoki  <aamine@loveruby.net>

	* parse.y [ripper]: Add rdoc.

Tue Sep 14 20:24:49 2004  Minero Aoki  <aamine@loveruby.net>

	* parse.y [ripper]: space event is on__sp, not on__lwsp.
	  [ruby-dev:24257]

	* ext/ripper/eventids2.c: ditto.

	* ext/ripper/lib/ripper.rb: ditto.

	* ext/ripper/depend (ripper.o): No action is needed.
	  [ruby-dev:24260]

	* ext/ripper/depend: Borland make does not accept pipes in
	  Makefile rules. [ruby-dev:24589]

	* ext/ripper/depend: separate rules for developpers.

	* ext/ripper/Makefile.dev: new file.

	* ext/ripper/MANIFEST: add Makefile.dev.

	* ext/ripper/tools/generate-eventids1.rb: read from file, not
	  stdin.

	* ext/ripper/extconf.rb: clean ripper.E.

	* ext/ripper/tools/generate-ripper_rb.rb: #include ids1/ids2
	  function was lost.

	* ext/ripper/tools/generate-ripper_rb.rb: SCANNER_EVENTS wrongly
	  contained parser events.

	* ext/ripper/lib/ripper.rb: ditto.

Tue Sep 14 16:59:37 2004  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tcltklib/tcltklib.c: fix SEGV

	* ext/tk/lib/multi-tk.rb: improve safe-level handling of argument proc

	* ext/tk/sample/multi-ip_sample.rb: rename of old 'safe-tk.rb'

	* ext/tk/sample/safe-tk.rb: new sample script


Mon Sep 13 21:33:40 2004  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* ext/openssl/ossl_x509name.c (ossl_x509name_to_s): add optional
	  second argument to specify the output format (see also
	   X509_NAME_print_ex).

	* ext/openssl/ossl_x509name.c (ossl_x509name_init): new constants:
	  OpenSSL::X509::Name::COMPAT, OpenSSL::X509::Name::RFC2253,
	  OpenSSL::X509::ONELINE, OpenSSL::X509::MULTILINE.

	* ext/openssl/lib/openssl/x509.rb (OpenSSL::X509::Name::RFC2253DN):
	  new module to provide the parse for RFC2253 DN format.

	* ext/openssl/lib/openssl/x509.rb (OpenSSL::X509::Name.parse_rfc2253):
	  new method to parse RFC2253 DN format.

Mon Sep 13 19:16:33 2004  WATANABE Hirofumi  <eban@ruby-lang.org>

	* eval.c (blk_copy_prev): need frame_dup().  [ruby-dev:24103]

Mon Sep 13 16:23:27 2004  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/lib/multi-tk.rb: MultiTkIp.new_master and new_slave accept
	  safe-level value argument

Mon Sep 13 10:48:37 2004  NAKAMURA Usaku  <usa@ruby-lang.org>

	* win32/win32.c (rb_w32_getpid): don't need to use _getpid() on
	  mswin32 and mingw32.

Mon Sep 13 10:22:05 2004  NAKAMURA Usaku  <usa@ruby-lang.org>

	* object.c (nil_inspect): fix typo.

Mon Sep 13 09:29:58 2004  Minero Aoki  <aamine@loveruby.net>

	* ext/ripper/depend: (nmake hack) prepend "./" to ripper.c to
	  avoid {$(srcdir)}.

Mon Sep 13 06:43:42 2004  Minero Aoki  <aamine@loveruby.net>

	* ext/ripper/tools/list-parse-event-ids.rb: does not use getopts.

	* ext/ripper/tools/list-scan-event-ids.rb: ditto.

Mon Sep 13 02:42:28 2004  Minero Aoki  <aamine@loveruby.net>

	* ext/Setup: add ripper.

	* ext/Setup.atheos: ditto.

	* ext/Setup.dj: ditto.

	* ext/Setup.emx: ditto.

	* ext/Setup.nt: ditto.

	* ext/Setup.x68: ditto.

Mon Sep 13 02:26:31 2004  Minero Aoki  <aamine@loveruby.net>

	* ext/ripper: ripper extention added.

	* ext/ripper/MANIFEST: new file.

	* ext/ripper/README: new file.

	* ext/ripper/depend: new file.

	* ext/ripper/extconf.rb: new file.

	* ext/ripper/eventids2.c: new file.

	* ext/ripper/ripper.rb.in: new file.

	* ext/ripper/lib/ripper.rb: new file.

	* ext/ripper/test/check-event-arity.rb: new file.

	* ext/ripper/test/check-event-coverage.sh: new file.

	* ext/ripper/test/check-scanner-event-coverage.rb: new file.

	* ext/ripper/test/list-called-events.rb: new file.

	* ext/ripper/test/src_rb: new file.

	* ext/ripper/test/validate.rb: new file.

	* ext/ripper/tools/generate-eventids1.rb: new file.

	* ext/ripper/tools/generate-param-macros.rb: new file.

	* ext/ripper/tools/generate-ripper_rb.rb: new file.

	* ext/ripper/tools/list-parse-event-ids.rb: new file.

	* ext/ripper/tools/list-scan-event-ids.rb: new file.

	* ext/ripper/tools/preproc.rb: new file.

	* ext/ripper/tools/strip.rb: new file.

	* test/ripper: ripper tests added.

	* test/ripper/dummyparser.rb: new file.

	* test/ripper/test_parser_events.rb: new file.

	* test/ripper/test_scanner_events.rb: new file.

Mon Sep 13 01:03:02 2004  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tcltklib/tcltklib.c: improve control of preserv/release tcltkip

	* ext/tcltklib/tcltklib.c: store original 'exit' command

	* ext/tk/tkutil.c: fix(?) SEGV

Mon Sep 13 00:22:53 2004  Minero Aoki  <aamine@loveruby.net>

	* parse.y: fix file header.

Mon Sep 13 00:20:39 2004  Minero Aoki  <aamine@loveruby.net>

	* parse.y: ripper merged.

	* lex.c: ditto.

	* keywords: ditto.

Sun Sep 12 23:53:17 2004  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* util.c (ruby_strdup): remove unnecessary code. (xmalloc never
	  returns NULL.)

	* util.c (ruby_getcwd): fix memory leak on failure.

Sun Sep 12 02:41:58 2004  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tcltklib/tcltklib.c: add TclTkIp#allow_ruby_exit? and
	  allow_ruby_exit=

	* ext/tk/lib/multi-tk.rb: ditto.

	* ext/tk/lib/remote-tk.rb: ditto.

	* ext/tcltklib/MANUAL.euc: ditto.

	* ext/tcltklib/MANUAL.eng: ditto.

	* ext/tcltklib/tcltklib.c: fix some reasons of SEGV

	* ext/tk/tkutil.c: ditto.

	* ext/tk/lib/multi-tk.rb: ditto.

	* ext/tk/lib/tk/timer.rb: ditto.

Sat Sep 11 16:09:46 2004  Dave Thomas  <dave@pragprog.com>

	* lib/rdoc/parsers/parse_rb.rb: Fix up cross-file class merging.

Fri Sep 10 20:18:05 2004  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* ext/tcltklib/tcltklib.c (lib_merge_tklist): fix suspicious
	  pointer conversion.

Fri Sep 10 19:16:24 2004  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* bcc32/Makefile.sub: bccwin32 port starts to use RTL dll.
	  (need to rebuild all) [ruby-dev:24138]

	* win32/win32.{h,c}: ditto.

Fri Sep 10 15:55:59 2004  Minero Aoki  <aamine@loveruby.net>

	* lib/fileutils.rb (mkdir_p): should pass mode argument to
	  Dir.mkdir. [ruby-dev:24242]

	* test/fileutils/test_fileutils.rb: test it.

Fri Sep 10 02:43:54 2004  Dave Thomas  <dave@pragprog.com>

	* lib/rdoc/generators/template/kilmer.rb: James Buck's
	  patch for call-seq.

Thu Sep  9 13:58:56 2004  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tcltklib/tcltklib.c (ip_init): change flag value for setting
	  'argv' and 'argv0' variable

	* ext/tk/lib/remote-tk.rb: follow changes of multi-tk.rb

Thu Sep  9 11:46:18 2004  Dave Thomas  <dave@pragprog.com>

	* lib/rdoc/parsers/parse_c.rb (RDoc::C_Parser::do_classes): Allow
	  spaces aroun parameter to define_method_under (James Buck)

Wed Sep  8 18:44:03 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* ext/stringio/stringio.c (strio_write): zero fill a gap if exsts.
	  [ruby-dev:24190]

Wed Sep  8 15:19:49 2004  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tcltklib/tcltklib.c (ip_init): cannot create a IP at level 4

	* ext/tk/lib/multi-tk.rb: improve 'exit' operation, security check,
	  and error treatment

	* ext/tk/lib/multi-tk.rb: allow a trusted slave IP to create slave IPs

	* ext/tk/lib/tk/listbox.rb: add TkListbox#value, value=, clear,	and
	  erase

	* ext/tk/lib/tk/text.rb: add TkText#clear and erase

Tue Sep  7 15:17:49 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* ext/socket/socket.c (ruby_connect): break immediately if a
	  socket is non-blocking.  [ruby-talk:111654]

Tue Sep  7 12:48:22 2004  NAKAMURA Usaku  <usa@ruby-lang.org>

	* {bcc32,win32,wince}/Makefile.sub (config.h): add fcntl.

	* win32/win32.[ch] (fcntl): ditto.

	* win32/win32.c (rb_w32_connect): support nonblocking mode.

	* ext/socket/socket.c (wait_connectable, ruby_connect): support
	  nonblocking connect on various platforms.

Mon Sep  6 11:00:47 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* dir.c (dir_s_chdir): the patch to shut up false warning when
	  exception occurred within a block.  a patch was given from Johan
	  Holmberg <holmberg at iar.se>.  [ruby-core:03292]

Mon Sep  6 10:57:40 2004  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* ext/tk/lib/tk/menu.rb(TkOptionMenubutton#insert): call correct method

Mon Sep  6 07:51:42 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (cvar_cbase): singletons should refer outer cvar scope.
	  [ruby-dev:24223]

	* eval.c (rb_load): should preserve previous ruby_wrapper value.
	  [ruby-dev:24226]

Sat Sep  4 01:14:57 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (cvar_cbase): class variables cause SEGV in
	  instance_eval() for fixnums and symbols. [ruby-dev:24213]

Fri Sep  3 17:47:58 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* struct.c (make_struct): remove redefining constant when
	  conflict.  [ruby-dev:24210]

Fri Sep  3 11:31:44 2004  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/lib/tk.rb: Tk.after makes TkCore::INTERP.tk_cmd_tbl grow
	  [ruby-dev:24207]

Fri Sep  3 02:12:48 2004  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tcltklib/tcltklib.c: fix typo [ruby-talk:111266]

	* ext/tk/lib/tk/text.rb: fix typo

	* ext/tk/lib/multi-tk.rb: improve safe-level treatment on slave IPs

Fri Sep  3 01:54:20 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* ext/extmk.rb (extmake): extact target prefix from Makefiles.

	* ext/extmk.rb: already built-in libraries satisfy dependencies.
	  [ruby-dev:24028]

Wed Sep  1 21:16:50 2004  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* ext/tk/lib/tk/spinbox.rb: fix typo

Wed Sep  1 19:28:37 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* process.c (rb_proc_exec): label cannot precede variable declarations.

Tue Aug 31 18:20:49 2004  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* ext/tk/tkutil.c (cbsubst_init): fix memory leak

	* ext/tk/tkutil.c (cbsubst_get_all_subst_keys): fix SEGV

Tue Aug 31 16:04:22 2004  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tcltklib/tcltklib.c (ip_delete): when a tcltkip is deleted,
	  destroy its root widget

Tue Aug 31 12:30:36 2004  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tcltklib/tcltklib.c (del_root): fix SEGV

Mon Aug 30 21:50:14 2004  Dave Thomas  <dave@pragprog.com>

	* object.c: Add RDoc for Module.included.

Mon Aug 30 23:11:06 2004  Dave Thomas  <dave@pragprog.com>

	* lib/rdoc/ri/ri_driver.rb (and others): ri now merges documentation
	  if it finds the same class in multiple places.

Mon Aug 30 22:40:30 2004  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/lib/multi-tk.rb: 'restart' method accepts arguments

Mon Aug 30 15:10:46 2004  WATANABE Hirofumi  <eban@ruby-lang.org>

	* configure.in (GNU/k*BSD): fixed FTBFS on GNU/k*BSD. [ruby-dev:24051]

Sun Aug 29 14:08:56 2004  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tcltklib/tcltklib.c: compile error on bcc32 [ruby-dev:24081]

	* ext/tk/lib/multi-tk.rb: MultiTkIp#eval_string does not work

Sat Aug 28 23:04:41 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* bignum.c (rb_big_and): protect parameters from GC.
	  [ruby-talk:110664]

Fri Aug 27 12:13:50 2004  Tanaka Akira  <akr@m17n.org>

	* ext/stringio/stringio.c (Init_stringio): add StringIO#readpartial as
	  an alias for StringIO#sysread.

Fri Aug 27 10:14:21 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* process.c (rb_proc_exec): strip trailing spaces.  [ruby-dev:24143]

	* win32/win32.c (CreateChild): ditto.

Thu Aug 26 04:38:29 2004  Dave Thomas  <dave@pragprog.com>

	* eval.c (return_jump): Minor typo in error message. Now reads
	  "return can't jump across threads".

Wed Aug 25 15:18:52 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* eval.c (rb_longjmp): Exception#to_str is no longer defined.

Wed Aug 25 11:39:10 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* error.c (exc_equal): exceptions are equal if they share same
	  class, message and backtrace. [ruby-talk:110354]

	* error.c (name_err_mesg_equal): ditto.

Tue Aug 24 16:41:48 2004  Shugo Maeda  <shugo@ruby-lang.org>

	* lib/cgi/session.rb (CGI::Session::FileStore#initialize): do not
	  use a session id as a filename.

	* lib/cgi/session/pstore.rb (CGI::Session::PStore#initialize): ditto.

	* lib/cgi/session/pstore.rb (CGI::Session::PStore#initialize): use
	  Dir::tmpdir.

Tue Aug 24 14:32:17 2004  Shugo Maeda  <shugo@ruby-lang.org>

	* lib/cgi/session.rb (CGI::Session::FileStore#initialize): untaint
	  session id after check.

Tue Aug 24 08:57:51 2004  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* ext/openssl/ossl_x509attr.c (ossl_x509attr_initialize): d2i
	  functions may replace the pointer indicated by the first argument.

	* ext/openssl/ossl_x509ext.c (ossl_x509ext_initialize): ditto.

	* ext/openssl/ossl_x509name.c (ossl_x509name_initialize): ditto.

Mon Aug 23 12:43:32 2004  NAKAMURA Usaku  <usa@ruby-lang.org>

	* lib/resolv.rb (Config.default_config_hash): when multiple domains
	  are set, Win32::Resolv.get_resolv_info returns Array.

Sun Aug 22 16:27:38 2004  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* ext/openssl/ossl_ssl.c (ossl_ssl_read):
	  - should return an empty string if specified length to read is 0.
	  - should check for pending data and wait for fd before reading.
	  - call underlying IO's sysread if SSL session is not started.
	  [ruby-dev:24072], [ruby-dev:24075]

	* ext/openssl/ossl_ssl.c (ossl_ssl_write):
	  - call underlying IO's syswrite if SSL session is not started.

	* ext/openssl/ossl_ssl.c (ossl_ssl_pending): new method
	  OpenSSL::SSL#pending.

	* ext/openssl/lib/openssl/buffering.rb: should not use select.

Sun Aug 22 01:10:36 2004  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* lib/webrick/httpproxy.rb (WEBrick::HTTPProxyServer#proxy_connect):
	  should call :ProxyContentHandler before finishing CONNECT.

Sat Aug 21 06:41:16 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* ext/tcltklib/extconf.rb (find_tcl, find_tk): find stub library.

	* lib/mkmf.rb (arg_config, with_config): deal with '-' and '_'
	  uniformly.  [ruby-dev:24118]

Fri Aug 20 14:49:42 2004  NAKAMURA Usaku  <usa@ruby-lang.org>

	* io.c (rb_io_check_writable): no need to check read buffer if
	  already changed to write mode.

Fri Aug 20 11:46:43 2004  UENO Katsuhiro  <katsu@blue.sky.or.jp>

	* ext/zlib/zlib.c: GzipReader#ungetc caused crc error.

Thu Aug 19 16:29:45 2004  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/lib/tk.rb: Fail to treat a hash value of 'font' option.

	* ext/tk/lib/tk.rb: bindinfo cannot return '%' substiturion infomation.

	* ext/tk/lib/menu.rb: typo bug.

Thu Aug 19 15:15:24 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* dir.c (free_dir): fix memory leak.  reported by yamamoto
	  madoka.

Thu Aug 19 09:19:27 2004  NAKAMURA Usaku  <usa@ruby-lang.org>

	* configure.in, win32/Makefile.sub (LIBS): need to link shell32
	  library for SH* functions on mswin32 and mingw32.

	* wince/Makefile.sub (LIBS): need to link ceshell library for SH*
	  functions on mswince.

Thu Aug 19 03:07:00 2004  why the lucky stiff  <why@ruby-lang.org>

	* lib/yaml/baseemitter.rb: folding now handles double-quoted strings,
	  fixed problem with extra line feeds at end of folding, whitespace
	  opening scalar blocks.

	* lib/yaml/rubytypes.rb: subtelties in handling strings with
	  non-printable characters and odd whitespace patterns.

Wed Aug 18 23:44:20 2004  Minero Aoki  <aamine@loveruby.net>

	* lib/net/protocol.rb (rbuf_fill): OpenSSL::SSLSocket has its own
	  buffer, select(2) might not work. [ruby-dev:24072]

Wed Aug 18 17:10:12 2004  WATANABE Hirofumi  <eban@ruby-lang.org>

	* ext/tcltklib/stubs.c (ruby_tcltk_stubs): need to call
	  Tcl_FindExecutable() for Tcl/Tk 8.4.

Wed Aug 18 12:52:55 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* eval.c (rb_obj_instance_eval): evaluates under special singleton
	  classes as for special constants.

Wed Aug 18 11:22:52 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* win32/win32.c (init_env): initialize HOME and USER environment
	  variables unless set.

Wed Aug 18 10:17:21 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (bind_eval): new method. [RCR 251]

	* string.c (rb_str_clear): new method. [ruby-dev:24104]

Tue Aug 17 17:20:59 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* io.c (rb_io_reopen): should clear allocated OpenFile.  pointed
	  out by Guy Decoux. [ruby-core:03288]

Tue Aug 17 01:36:32 2004  Dave Thomas  <dave@pragprog.com>

	* lib/rdoc/usage.rb: Remove extra indent. Tidy 'ri' option
	  parsing so RDoc::usage plays better with OptionParser.

Sat Aug 14 02:48:16 2004  Dave Thomas  <dave@pragprog.com>

	* lib/rdoc/usage.rb: Added. Allows command line programs
	  to report usage using their initial RDoc comment.

Sat Aug 14 01:25:48 2004  why the lucky stiff  <why@ruby-lang.org>

	* ext/syck/token.c: re2c no longer compiled with bit vectors.  caused
	  problems for non-ascii characters. [ruby-core:03280]
	* ext/syck/implicit.c: ditto.
	* ext/syck/bytecode.c: ditto.

Fri Aug 13 12:55:20 2004  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* lib/webrick/httputils.rb (WEBrick::HTTPUtils.parse_range_header):
	  fix regex for range-spec.

	* lib/webrick/httpservlet/filehandler.rb
	  (WEBrick::HTTPServlet::DefaultFileHandler#make_partial_content):
	  multipart/byteranges response was broken.

	* lib/xmlrpc/server.rb: refine example code.

Thu Aug 12 10:54:17 2004  NAKAMURA Usaku  <usa@ruby-lang.org>

	* rubyio.h (rb_eof_error): should mark as NORETURN.

	* win32/win32.c (make_cmdvector): adjust escaped successive
	  double-quote handling.

Thu Aug 12 01:53:10 2004  Tanaka Akira  <akr@m17n.org>

	* io.c (read_buffered_data): extracted from rb_io_fread.
	  (io_readpartial): new method IO#readpartial.
	  [ruby-dev:24055]

Wed Aug 11 17:17:50 2004  WATANABE Hirofumi  <eban@ruby-lang.org>

	* configure.in (RPATHFLAG): stop setting RPATHFLAG on Interix.

Mon Aug  9 15:03:20 2004  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* lib/webrick/httpservlet/erbhandler.rb
	  (WEBrick::HTTPServlet::ERBHandler#do_GET): should select media type
	  by suffix of script filename.

Mon Aug  9 12:51:43 2004  Dave Thomas  <dave@pragprog.com>

	* dir.c (dir_s_glob): Roll in Austin Ziegler's Dir.glob and
	  fnmatch updates.

Mon Aug  9 06:33:06 2004  Minero Aoki  <aamine@loveruby.net>

	* lib/fileutils.rb (cp_r): copies symlink to symlink, except
	  root entries of cp_r.

	* lib/fileutils.rb: new method FileUtils.copy_entry.

	* test/fileutils/test_fileutils.rb: more cp_r tests.

Sun Aug  8 00:43:31 2004  why the lucky stiff  <why@ruby-lang.org>

	* lib/implicit.c: added sexagecimal float#base60.

	* ext/syck/rubyext.c (yaml_org_handler): ditto.

	* lib/token.c: indentation absolutely ignored when processing flow
	  collections.  plain scalars are trimmed if indentation follows in
	  an ambiguous flow collection.

Sat Aug  7 03:08:21 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* process.c (proc_daemon): new method.  should be modified for
	  platforms without /dev/null.

Sat Aug  7 00:50:01 2004  Tanaka Akira  <akr@m17n.org>

	* ext/zlib/zlib.c: Zlib::GzipReader#read(0) returns "" instead of nil.

Wed Aug  4 13:26:00 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* marshal.c (r_bytes0): optimize out read(0). [ruby-talk:108276]

Tue Aug  3 13:49:12 2004  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/lib/tk/namespace.rb: bug fix

	* ext/tk/lib/tkextlib/treectrl/tktreectrl.rb: add Tk::TreeCtrl.loupe

Mon Aug  2 23:33:48 2004  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* test/ruby/test_file.rb (test_fnmatch): added more tests.

Mon Aug  2 18:04:21 2004  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/lib/tk/msgcat.rb (set_translation): bug fix (fail to set
	  trans_str to the same as src_str when trans_str is not given.)

Mon Aug  2 17:40:44 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (blk_free): fixed serious memory leak. [ruby-dev:24013]

Mon Aug  2 11:53:06 2004  Dave Thomas  <dave@pragprog.com>

	* lib/rdoc/code_objects.rb (RDoc::Context::find_symbol): Fix infinite recursion
	  looking up some top level symbols (batsman)

Mon Aug  2 11:48:29 2004  Dave Thomas  <dave@pragprog.com>

	* lib/rdoc/parsers/parse_c.rb (RDoc::C_Parser::do_methods): Allow '.'s in
	  variable names to support SWIG generated files (Hans Fugal)

Sat Jul 31 23:08:00 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (is_defined): stupid mistakes fixed. [ruby-dev:24006]

Sat Jul 31 17:39:47 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* misc/ruby-mode.el (ruby-expr-beg, ruby-parse-partial,
	  ruby-calculate-indent, ruby-move-to-block, ruby-forward-sexp,
	  ruby-backward-sexp): keywords must match word-wise.

Sat Jul 31 13:37:51 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (is_defined): avoid unnecessary method invocations.

Sat Jul 31 05:35:37 2004  why the lucky stiff  <why@ruby-lang.org>

	* lib/yaml/rubytypes.rb: exceptions were using an older
	  YAML.object_maker. [ruby-core:03080]

	* ext/syck/token.c (sycklex_yaml_utf8): using newline_len to
	  handline CR-LFs.  "\000" was showing up on folded blocks which
	  stopped at EOF.

Sat Jul 31 01:25:11 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (is_defined): call is_defined() before invoking
	  rb_eval().  [ruby-talk:107867]

Fri Jul 30 16:10:54 2004  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tcltklib/tcltklib.c (lib_fromUTF8_core): raise ArgumentError when
	  the unknown encoding name is given.

	* ext/tcltklib/tcltklib.c (lib_toUTF8_core): ditto.

	* ext/tk/lib/tk.rb (Tk::Encoding.encoding_convertfrom): bug fix.

	* ext/tk/lib/tk.rb (Tk::Encoding.encoding_convertto): ditto.

Wed Jul 28 18:59:17 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* lib/cgi.rb (CGI::initialize): remove at_exit code for CGI_PARAMS
	  and CGI_COOKIES.  they will no longer be used.

Wed Jul 28 15:44:08 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (rb_call0): should call rb_call_super() directly for
	  visibility overriding.  [ruby-dev:23989]

Wed Jul 28 01:04:44 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* env.h: remove argv from ruby_frame.

	* eval.c (rb_eval): no more copy on write.

	* eval.c (assign): ditto.

	* eval.c (rb_call0): can receive *rest by specifying negative
	  argc.  (-1 means 0 arg and *rest, -2 means 1 arg and *rest...)

	* eval.c (rb_call0): properly set frame's argc counter.

	* gc.c (rb_gc_mark_frame): need not to mark frame's argv

	* gc.c (run_final): wrong order of data. [ruby-dev:23984]

Tue Jul 27 07:05:04 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (rb_eval): copy on write for argument local variable
	  assignment.

	* eval.c (assign): ditto.

	* eval.c (rb_call0): update ruby_frame->argv with the default
	  value used for the optional arguments.

	* object.c (Init_Object): "===" calls rb_obj_equal() directly.
	  [ruby-list:39937]

Mon Jul 26 11:22:55 2004  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* lib/webrick/httputils.rb (WEBrick::HTTPUtils.escape): should
	  escape space.

Sun Jul 25 10:56:28 2004  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* win32/win32.{h,c} (rb_w32_{f,fd,fs}open): workaround for bcc32's
	  {f,fd,fs}open bug. set errno EMFILE and EBADF. [ruby-dev:23963]

	* test/drb/drbtest.rb: fix method duplication.

Sat Jul 24 13:32:47 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* range.c (rb_range_beg_len): returns Qnil only when "beg" points
	  outside of a range.  No boundary check for "end".

Fri Jul 23 16:40:25 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* gc.c (define_final): should not disclose NODE* to Ruby world.
	  [ruby-dev:23957]

Fri Jul 23 08:52:22 2004  Shugo Maeda  <shugo@ruby-lang.org>

	* lib/net/imap.rb (disconnected?): new method.

Thu Jul 22 16:41:54 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* lib/cgi/session.rb (CGI::Session::FileStore#update): sets the
	  permission of the session data file to 0600.

	* lib/cgi/session/pstore.rb (CGI::Session::Pstore#initialize):
	  ditto.

Mon Jul 19 00:53:46 2004  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* lib/webrick/httpservlet/cgihandler.rb
	  (WEBrick::HTTPServlet::CGIhandler#do_GET): set SystemRoot environment
	  variable to CGI process on Windows native platforms. [ruby-dev:23936]

Sun Jul 18 16:14:29 2004  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/lib/tk/msgcat.rb (TkMsgCatalog.callback): bug fix
	  ( wrong number of argument )

Sun Jul 18 08:13:58 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* sprintf.c (rb_f_sprintf): remove extra sign digit.

Sun Jul 18 03:19:14 2004  Akinori MUSHA  <knu@iDaemons.org>

	* dir.c (bracket): use NULL instead of 0.

Sun Jul 18 02:35:30 2004  Shugo Maeda  <shugo@ruby-lang.org>

	* lib/net/imap.rb (receive_responses): return if a LOGOUT response
	  received.

Sat Jul 17 23:59:01 2004  Shugo Maeda  <shugo@ruby-lang.org>

	* lib/net/imap.rb (send_string_data): wait command continuation
	  requests before sending octet data of literals.

Sat Jul 17 23:54:59 2004  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/lib/tk/variable.rb: TkVariable#ref returns a TkVariable object

Sat Jul 17 22:04:44 2004  akira yamada  <akira@ruby-lang.org>

	* lib/uri/ldap.rb: method hierarchical? should be in URI::LDAP.

Sat Jul 17 18:29:07 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* parse.y (stmt): not to show same error messages twice.

Sat Jul 17 14:18:11 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* string.c (rb_str_match_m): String#match should also take
	  optional argument.  [ruby-core:03205]

	* re.c (rb_reg_match_m): add optional second argugment "pos" to
	  specify match start point.  [ruby-core:03203]

Sat Jul 17 13:13:32 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* lib/irb/ruby-lex.rb (RubyLex::identify_string): %s string do not
	  process expression interpolation.  [ruby-talk:106691]

Sat Jul 17 05:26:27 2004  Dave Thomas  <dave@pragprog.com>

	* lib/rdoc/diagram.rb: Incorporate Micheal Neumann's
	  client-side imagemao patch

Sat Jul 17 01:57:03 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (THREAD_ALLOC): th->thread should be initialized to NULL.
	  [ruby-talk:106657]  The solution was found by Guy Decoux.

Fri Jul 16 22:30:28 2004  Michael Neumann  <mneumann@ntecs.de>

	* file.c (rb_stat_dev_major): new methods File::Stat#dev_major and
	  #dev_minor. [ruby-core:03195]

Fri Jul 16 11:17:38 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* error.c (exit_initialize): use EXIT_SUCCESS instead of 0.
	  [ruby-dev:23913]

	* error.c (exit_success_p): new method SystemExit#success?.
	  [ruby-dev:23912]

	* error.c (syserr_initialize): initialization for subclasses.
	  [ruby-dev:23912]

Thu Jul 15 23:53:38 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* lib/optparse.rb (OptionParser#warn, OptionParser#abort): Exception
	  no longer has to_str method.

Thu Jul 15 22:59:48 2004  Shugo Maeda  <shugo@ruby-lang.org>

	* ext/readline/extconf.rb: added dir_config for curses, ncurses,
	  termcap.

Thu Jul 15 20:44:46 2004  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* class.c: rdoc patch

Thu Jul 15 14:12:34 2004  why the lucky stiff  <why@ruby-lang.org>

	* lib/yaml.rb (YAML::load_file, YAML::parse_file): added.

	* ext/syck/token.c: re2c compiled with bit vectors now.
	* ext/syck/implicit.c: ditto.
	* ext/syck/bytecode.c: ditto.

Thu Jul 15 10:15:04 2004  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/, ext/tcltklib/: bug fix

	* ext/tk/lib/tk.rb: better operation for SIGINT when processing
	  callbacks.
	* ext/tk/lib/tk/msgcat.rb: ditto.
	* ext/tk/lib/tk/variable.rb: ditto.
	* ext/tk/lib/tk/timer.rb: ditto.

	* ext/tk/lib/tk/validation.rb: add Tk::ValidateConfigure.__def_validcmd
	  to define validatecommand methods easier

	* ext/tk/lib/tk.rb (_genobj_for_tkwidget): support autoload Tk ext
	  classes

	* ext/tk/lib/tk/canvas.rb and so on: remove the parent widget type
	  check for items (e.g. canvas items; depends on the class) to
	  avoid some troubles on Tk extension widget class definition.

	* ext/tk/lib/tkextlib/: add Iwidget and TkTable extension support

	* ext/tk/sample/tkextlib/: add samples of Iwidget and TkTable


Wed Jul 14 23:49:30 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* enum.c (enum_min_by): new method Enum#min_by.  added Enum#max_by
	  as well.

Wed Jul 14 18:05:21 2004  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* ext/openssl/ossl_asn1.c (ossl_asn1cons_to_der): fix type of
	  argument. [ruby-dev:23891]

	* test/openssl/test_x509store.rb: prune tests for CRL checking
	  unless X509::V_FLAG_CRL_CHECK is defined.

Wed Jul 14 12:20:05 2004  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* util.c (ruby_strtod): should not convert string in the form of
	  "-I.FE-X" which both "I" and "F" are ommitted. [ruby-dev:23883]

	* test/ruby/test_float.rb (test_strtod): add test for bug fix.

Wed Jul 14 00:33:48 2004  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* array.c: rdoc patch. merged patch from Johan Holmberg
	  <holmberg@iar.se> [ruby-core:3170]

Tue Jul 13 19:39:12 2004  akira yamada  <akira@ruby-lang.org>

	* lib/uri/generic.rb (URI::Generic#merge_path):
	  "URI('http://www.example.com/foo/..') + './'" should return
	  "URI('http://www.example.com/')".  [ruby-list:39838]
	  "URI('http://www.example.com/') + './foo/bar/..'" should return
	  "URI('http://www.example.com/foo/')".  [ruby-list:39844]

	* test/uri/test_generic.rb (TestGeneric#test_merge): added tests.

Tue Jul 13 15:48:56 2004  Akinori MUSHA  <knu@iDaemons.org>

	* lib/mkmf.rb (init_mkmf): Do not add $(libdir) to $LIBPATH in
	   extmk mode.

	* lib/mkmf.rb (dir_config): Prepend a new library path instead of
	  appending so it is tried first.

Tue Jul 13 00:50:48 2004  Dave Thomas  <dave@pragprog.com>

	* lib/rdoc/parsers/parse_rb.rb: Support call-seq: for Ruby files.

Mon Jul 12 21:20:51 2004  Dave Thomas  <dave@pragprog.com>

	* html_generator.rb: Support hyperlinks of the form {any text}[xxx]
	  as well as stuff[xxx]

Sat Jul 10 09:30:24 2004  NAKAMURA, Hiroshi  <nahi@ruby-lang.org>

	* test/soap/marshal/test_struct.rb: use qualified built-in class name
	  (::Struct) to avoid name crash.

Sat Jul 10 04:21:56 2004  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/lib/tk.rb: better operation for SIGINT when processing
	  callbacks.
	* ext/tk/lib/tk/msgcat.rb: ditto.
	* ext/tk/lib/tk/variable.rb: ditto.
	* ext/tk/lib/tk/timer.rb: ditto.

	* ext/tk/lib/tk/validation.rb (__def_validcmd):  add a module
	  function of Tk::ValidateConfigure to define validatecommand
	  methods easier

Fri Jul  9 22:18:59 2004  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* array.c, enum.c, pack.c: rdoc patch from Johan Holmberg
	  <holmberg@iar.se> [ruby-core:3132] [ruby-core:3136]

	* numeric.c: rdoc patch.

Fri Jul  9 19:26:39 2004  Tanaka Akira  <akr@m17n.org>

	* lib/open-uri.rb (URI::HTTPS#proxy_open): raise ArgumentError to
	  notice https is not supported.

Fri Jul  9 14:28:54 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* eval.c (rb_thread_raise): accept third argument as well as
	  Kernel#raise, and evaluate the arguments to create an exception in
	  the caller's context.  [ruby-talk:105507]

Fri Jul  9 01:47:08 2004  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/lib: bug fix
	* ext/tk/lib/tkextlib/itcl: add [incr Tcl] support
	* ext/tk/lib/tkextlib/itk: add [incr Tk] support
	* ext/tk/lib/tkextlib/iwidgets: midway point of [incr Widgets] support
	* ext/tk/sample/tkextlib/iwidgets: very simple examples of
	  [incr Widgets]

Thu Jul  8 19:27:16 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* configure.in (rb_cv_stack_end_address): detect stack end address
	  variable supplied by system.  [ruby-core:03115]

	* gc.c (Init_stack): use system provided address if possible.

Thu Jul  8 00:05:23 2004  akira yamada  <akira@ruby-lang.org>

	* lib/tempfile.rb (Tempfile::initialize): got out code of
	  generating tmpname.  [ruby-dev:23832][ruby-dev:23837]

Wed Jul  7 02:31:41 2004  Kouhei Sutou  <kou@cozmixng.org>

	* lib/rss/{rss,parser,0.9,1.0,2.0}.rb: supported RSS 0.9x/2.0
	  validation and validation which disregard order of elements.
	* test/rss/test_parser.rb: added tests for RSS 0.9x/2.0
	  validation.
	* test/rss/{test_trackback,rss-testcase}.rb: fixed no good method
	  name.

Wed Jul  7 00:48:34 2004  WATANABE Hirofumi  <eban@ruby-lang.org>

	* ext/tk/lib/tkextlib/tktrans.rb,
	  ext/tk/lib/tkextlib/treectrl.rb: fix syntax errors.

Tue Jul  6 18:38:45 2004  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/lib: improve framework of developping Tcl/Tk extension
	  wrappers

Mon Jul  5 23:56:42 2004  Kouhei Sutou  <kou@cozmixng.org>

	* lib/rss/{trackback,syndication,dublincore,content}.rb: worked
	  with ruby 1.6 again.

	* test/rss/rss-assertions.rb: ditto.

Mon Jul  5 22:54:39 2004  Tanaka Akira  <akr@m17n.org>

	* lib/uri/common.rb (Kernel#URI): new global method for parsing URIs.

Mon Jul  5 09:02:52 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* eval.c (rb_thread_yield, rb_f_catch): 4th argument to rb_yield_0()
	  is a set of bit flags.  [ruby-dev:23859]

Mon Jul  5 01:20:17 2004  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* lib/drb/drb.rb(DRbConn self.open): If socket pool is full, close
	  the socket whose last-access-time is oldest. (and add new one)
	  [ruby-dev:23860]

Sun Jul  4 12:24:50 2004  Kouhei Sutou  <kou@cozmixng.org>

	* lib/rss/rss.rb: added copyright header.

Sat Jul  3 22:25:27 2004  NAKAMURA, Hiroshi  <nahi@ruby-lang.org>

	* added files:
	  * lib/soap/header/*
	  * lib/soap/rpc/httpserver.rb
	  * lib/wsdl/soap/cgiStubCreator.rb
	  * lib/wsdl/soap/classDefCreator.rb
	  * lib/wsdl/soap/classDefCreatorSupport.rb
	  * lib/wsdl/soap/clientSkeltonCreator.rb
	  * lib/wsdl/soap/driverCreator.rb
	  * lib/wsdl/soap/mappingRegistryCreator.rb
	  * lib/wsdl/soap/methodDefCreator.rb
	  * lib/wsdl/soap/servantSkeltonCreator.rb
	  * lib/wsdl/soap/standaloneServerStubCreator.rb
	  * lib/wsdl/xmlSchema/enumeration.rb
	  * lib/wsdl/xmlSchema/simpleRestriction.rb
	  * lib/wsdl/xmlSchema/simpleType.rb
	  * lib/xsd/codegen/*
	  * lib/xsd/codegen.rb
	  * sample/soap/authheader/*
	  * sample/soap/raa2.4/*
	  * sample/soap/ssl/*
	  * sample/soap/swa/*
	  * sample/soap/whois.rb
	  * sample/wsdl/raa2.4/*
	  * test/soap/header/*
	  * test/soap/ssl/*
	  * test/soap/struct/*
	  * test/soap/swa/*
	  * test/soap/wsdlDriver/*
	  * test/wsdl/multiplefault.wsdl
	  * test/wsdl/simpletype/*
	  * test/wsdl/test_multiplefault.rb

	* modified files:
	  * lib/soap/baseData.rb
	  * lib/soap/element.rb
	  * lib/soap/generator.rb
	  * lib/soap/netHttpClient.rb
	  * lib/soap/parser.rb
	  * lib/soap/property.rb
	  * lib/soap/soap.rb
	  * lib/soap/streamHandler.rb
	  * lib/soap/wsdlDriver.rb
	  * lib/soap/encodingstyle/handler.rb
	  * lib/soap/encodingstyle/literalHandler.rb
	  * lib/soap/encodingstyle/soapHandler.rb
	  * lib/soap/mapping/factory.rb
	  * lib/soap/mapping/mapping.rb
	  * lib/soap/mapping/registry.rb
	  * lib/soap/mapping/rubytypeFactory.rb
	  * lib/soap/mapping/wsdlRegistry.rb
	  * lib/soap/rpc/cgistub.rb
	  * lib/soap/rpc/driver.rb
	  * lib/soap/rpc/proxy.rb
	  * lib/soap/rpc/router.rb
	  * lib/soap/rpc/soaplet.rb
	  * lib/soap/rpc/standaloneServer.rb
	  * lib/wsdl/data.rb
	  * lib/wsdl/definitions.rb
	  * lib/wsdl/operation.rb
	  * lib/wsdl/parser.rb
	  * lib/wsdl/soap/definitions.rb
	  * lib/wsdl/xmlSchema/complexContent.rb
	  * lib/wsdl/xmlSchema/complexType.rb
	  * lib/wsdl/xmlSchema/data.rb
	  * lib/wsdl/xmlSchema/parser.rb
	  * lib/wsdl/xmlSchema/schema.rb
	  * lib/xsd/datatypes.rb
	  * lib/xsd/qname.rb
	  * sample/soap/sampleStruct/server.rb
	  * sample/wsdl/amazon/AmazonSearch.rb
	  * sample/wsdl/amazon/AmazonSearchDriver.rb
	  * test/soap/test_property.rb
	  * test/soap/calc/test_calc_cgi.rb
	  * test/wsdl/test_emptycomplextype.rb

	* summary
	  * add SOAP Header mustUnderstand support.

	  * add HTTP client SSL configuration and Cookies support (works
	    completely with http-access2).

	  * add header handler for handling sending/receiving SOAP Header.

	  * map Ruby's anonymous Struct to common SOAP Struct in SOAP Object
	    Model.  it caused error.

	  * add WSDL simpleType support to restrict lexical value space.

Sat Jul  3 17:19:44 2004  WATANABE Hirofumi  <eban@ruby-lang.org>

	* ext/tk/lib/tkextlib/tkDND.rb: fix syntax error.

Thu Jul  1 18:36:08 2004  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/lib/tcltklib: bug fix

	* ext/tk/lib/tk: bug fix and add Tcl/Tk extension support libraries

Thu Jul  1 18:31:31 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* lib/pstore.rb (PStore#transaction): get rid of opening in write mode
	  when read only transaction.  [ruby-dev:23842]

Thu Jul  1 00:44:42 2004  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* ext/openssl/ossl_cipher.c (ossl_cipher_encrypt, ossl_cipher_decrypt):
	  re-implemnt (the arguments for this method is ).

	* ext/openssl/ossl_cipher.c (ossl_cipher_pkcs5_keyivgen): new method
	  OpenSSL::Cipher::Cipher#pkcs5_keyivgen. it calls EVP_BytesToKey().

	* ext/openssl/ossl_cipher.c (ossl_cipher_set_key_length): new method
	  OpenSSL::Cipher::Cipher#key_len=.

Wed Jun 30 19:48:09 2004  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* ext/openssl/extconf.rb: check for EVP_CIPHER_CTX_copy, ENGINE_add,
	  EVP_CIPHER_CTX_set_padding, EVP_CipherFinal_ex, EVP_CipherInit_ex,
	  EVP_DigestFinal_ex and EVP_DigestInit_ex.

	* ext/openssl/openssl_missing.c (EVP_CIPHER_CTX_copy): new function.

	* ext/openssl/openssl_missing.h (EVP_DigestInit_ex, EVP_DigestFinal_ex,
	  EVP_CipherInit_ex, EVP_CipherFinal_ex, HMAC_Init_ex): new macro for
	  OpenSSL 0.9.6.

	* ext/openssl/ossl_cipher.c (ossl_cipher_alloc, ossl_cipher_initialize,
	  ossl_cipher_copy, ossl_cipher_reset, ossl_cipher_encrypt,
	  ossl_cipher_decrypt, ossl_cipher_final, ossl_cipher_set_key,
	  ossl_cipher_set_iv): replace all EVP_CipherInit and
	  EVP_CipherFinal into EVP_CipherInit_ex and EVP_CipherFinal_ex.
	  and EVP_CIPHER_CTX_init should only be called once.

	* ext/openssl/ossl_cipher.c (ossl_cipher_set_padding): check for
	  EVP_CIPHER_CTX_set_padding.

	* ext/openssl/ossl_cipher.c (Init_ossl_cipher): Cipher#<< is deprecated.

	* ext/openssl/ossl_digest.c: replace all EVP_DigestInit and
	  EVP_DigestFinal into EVP_DigestInit_ex and EVP_DigestFinal_ex.
	  and EVP_MD_CTX_init should only be called once.

	* ext/openssl/ossl_digest.c (digest_final): should call
	  EVP_MD_CTX_cleanup to avoid memory leak.

	* ext/openssl/ossl_hmac.c (ossl_hmac_initialize): repalce HMAC_init
	  into HMAC_init_ex. and HMAC_CTX_init is moved to ossl_hmac_alloc.

	* ext/openssl/ossl_hmac.c (hmac_final): should call
	  HMAC_CTX_cleanup to avoid memory leak.

	* test/openssl/test_cipher.rb, test/openssl/test_digest.rb,
	  test/openssl/test_hmac.rb: new file.

Wed Jun 30 16:59:39 2004  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* test/ruby/test_file.rb (test_fnmatch): some tests for File.fnmatch
	  are added.

Wed Jun 30 11:38:51 2004  Mikael Brockman  <phubuh@phubuh.org>

	* parse.y (primary): should not be NULL.  [ruby-core:03098]

Wed Jun 30 02:41:10 2004  why the lucky stiff  <why@ruby-lang.org>

	* ext/syck/rubyext.c (syck_emitter_new): set buffer after
	  Data_Wrap_Struct to avoid possible GC. [ruby-talk:104835]

Tue Jun 29 10:31:19 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* eval.c (rb_eval_cmd, rb_thread_trap_eval): restore safe level.

	* gc.c (define_final, run_final): preserve and restore safe level for
	  finalizers.  [ruby-core:03058]

	* signal.c (signal_exec, rb_trap_exit, trap): preserve and restore
	  safe level for signal handlers.  [ruby-dev:23829]

Mon Jun 28 14:57:56 2004  Jeff Mitchell  <quixoticsycophant@yahoo.com>

	* configure.in, lib/mkmf.rb (LIBPATHFLAG): use double quotes due to
	  DOSISH compilers.  [ruby-core:03107]

Mon Jun 28 00:35:29 2004  Masatoshi SEKI  <m_seki@mva.biglobe.ne.jp>

	* sample/drb/*.rb: using 'DRb.thread.join' instead of 'gets'

Sun Jun 27 22:36:47 2004  Kouhei Sutou  <kou@cozmixng.org>

	* sample/rss/tdiary_plugin/rss-recent.rb: supported Hiki.

Sat Jun 26 15:17:11 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* variable.c (rb_mod_class_variables): class variables are no longer
	  inherited.  [ruby-dev:23808]

Sat Jun 26 11:07:20 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* configure.in (aix): -b must come at the start of the command line,
	  and -e must not appear while testing libraries.  [ruby-talk:104501]

	* lib/mkmf.rb (find_header, dir_config): quote directory names if
	  necessary.  [ruby-talk:104505]

Sat Jun 26 00:13:08 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* io.c (rb_fopen, rb_fdopen, rb_io_reopen): setvbuf() may return
	  positive value on failure.  [ruby-dev:23792]

Fri Jun 25 18:07:15 2004  Michal Rokos  <michal@ruby-lang.org>

	* gc.c: bring back _stklen for DJGPP [ruby-core:3084]

Fri Jun 25 15:33:01 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* ext/iconv/extconf.rb: check stricter.  [ruby-talk:104501]

Fri Jun 25 01:58:01 2004  NAKAMURA Usaku  <usa@ruby-lang.org>

	* {bcc32,win32,wince}/setup.mak: remove RUBY_EXTERN lines when
	  including version.h. [ruby-talk:104456]

Thu Jun 24 14:23:29 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* io.c (rb_io_fread): return already read data when system call is
	  interrupted.  [ruby-talk:97206]

Thu Jun 24 01:25:21 2004  Shugo Maeda  <shugo@ruby-lang.org>

	* version.h: added declarations of ruby_version,
	  ruby_release_date, ruby_platform.

Thu Jun 24 01:07:15 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* ext/socket/socket.c (sock_sockaddr): Socket#gethostbyname()
	  should give us packed address, not struct sockaddr.
	  [ruby-core:03053]

Wed Jun 23 22:19:10 2004  Dave Thomas  <dave@pragprog.com>

	* ext/socket/socket.c (sock_s_gethostbyaddr): Work around problem
	  with OS X not returning 'from' parameter to recvfrom for
	  connection-oriented sockets.

Wed Jun 23 22:16:16 2004  Michal Rokos  <michal@ruby-lang.org>

	* io.c: io_seek()'s retval should be checked [ruby-core:03045]

Wed Jun 23 21:48:27 2004  Michal Rokos  <michal@ruby-lang.org>

	* time.c: Fix indentation.

	* main.c: Remove _stklen, and _CRT_glob. Move _stacksize for
	  __human68k__ to gc.c where the others are.

	* gc.c: put _stacksize in place and clean the #ifdefs macros.

Wed Jun 23 17:37:54 2004  Shugo Maeda  <shugo@ruby-lang.org>

	* lib/net/imap.rb: added new option --ssl.

Wed Jun 23 01:45:27 2004  Dave Thomas  <dave@pragprog.com>

	* lib/rdoc/parsers/parse_rb.rb (RubyLex::identify_quotation):
	  Fix problem with the 'r' being dropped from %r{xxx}

Wed Jun 23 00:10:17 2004  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* ext/win32ole/win32ole.c (ole_hresult2msg): remove trailing
	  CRs and LFs. (doesn't depend on CR+LF) [ruby-dev:23749]

Wed Jun 23 00:00:25 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* eval.c (return_jump, break_jump): raise unexpected local jump
	  exception directly.  [ruby-dev:23740]

	* io.c (rb_io_initialize): should check fcntl result.  [ruby-dev:23742]

Tue Jun 22 23:35:43 2004  NAKAMURA Usaku  <usa@ruby-lang.org>

	* sprintf.c (rb_f_sprintf): support FZERO and FSPACE with NaN/Inf.

	* test/ruby/test_sprintf.rb (test_nan, test_inf): add tests.

Tue Jun 22 21:11:36 2004  Masaki Suketa  <masaki.suketa@nifty.ne.jp>

	* ext/win32ole/win32ole.c (OLE_FREE): should not call CoFreeUnuse-
	  dLibraries().

	* ext/win32ole/win32ole.c (ole_event_free): ditto.

	* ext/win32ole/win32ole.c (ole_hresult2msg): truncate error message
	  before CR.

Tue Jun 22 19:24:59 2004  NAKAMURA Usaku  <usa@ruby-lang.org>

	* sprintf.c (rb_f_sprintf): unify output of NaN, Inf and -Inf with
	  "%f" or etc on all platform. [ruby-dev:23704], [ruby-dev:23747]

Tue Jun 22 15:28:12 2004  Michal Rokos  <michal@ruby-lang.org>

	* compar.c: Remove explicit NIL_P() checks since rb_cmpint() does it
	  again in the exactly same manner.

Tue Jun 22 01:32:40 2004  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* ext/openssl/ossl_pkey_dh.c (ossl_dh_initialize): should create
	  empty pkey object if no argument is passed. [ruby-talk:103328]

	* ext/openssl/ossl_pkey_dsa.c (ossl_dsa_initialize): ditto.

	* ext/openssl/ossl_pkey_rsa.c (ossl_rsa_initialize): ditto.

	* ext/openssl/ossl_pkey_dh.c: add new methods: OpenSSL::PKey::DH#p,
	  OpenSSL::PKey::DH#p=, OpenSSL::PKey::DH#g, OpenSSL::PKey::DH#g=,
	  OpenSSL::PKey::DH#pub_key, OpenSSL::PKey::DH#pub_key=,
	  OpenSSL::PKey::DH#priv_key and OpenSSL::PKey::DH#priv_key=.

	* ext/openssl/ossl_pkey_dsa.c: add new methods: OpenSSL::PKey::DSA#p,
	  OpenSSL::PKey::DSA#p=, OpenSSL::PKey::DSA#q, OpenSSL::PKey::DSA#q=,
	  OpenSSL::PKey::DSA#g, OpenSSL::PKey::DSA#g=,
	  OpenSSL::PKey::DSA#pub_key, OpenSSL::PKey::DSA#pub_key=,
	  OpenSSL::PKey::DSA#priv_key and OpenSSL::PKey::DSA#priv_key=.

Mon Jun 21 09:24:51 2004  NAKAMURA Usaku  <usa@ruby-lang.org>

	* win32/win32.c (rb_w32_opendir): should set errno if error occurs
	  when calling OS API.

Sun Jun 20 21:12:54 2004  Shugo Maeda  <shugo@ruby-lang.org>

	* lib/net/ftp.rb (binary=): send TYPE commands only once.

Sat Jun 19 13:27:01 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* eval.c (method_call): allow changing $SAFE.  [ruby-dev:23713]

	* eval.c (proc_set_safe_level, proc_invoke, rb_mod_define_method): not
	  set $SAFE for methods defined from Proc.  [ruby-dev:23697]

Sat Jun 19 01:10:12 2004  Kouhei Sutou  <kou@cozmixng.org>

	* sample/rss/tdiary_plugin/rss-recent.rb: added more information.

Fri Jun 18 23:12:22 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* eval.c (proc_save_safe_level, rb_set_safe_level, safe_setter): limit
	  safe level.

Wed Jun 16 23:05:57 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* object.c (rb_mod_freeze): prepare string representation before
	  freezing. [ruby-talk:103646]

Wed Jun 16 19:57:24 2004  Michal Rokos  <michal@ruby-lang.org>

	* test/ruby/test_array.rb: extend testcase to check #first, #last,
	  #shift, #unshift, #pop, #push

Wed Jun 16 16:05:17 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* array.c (ary_new): move alloc behind checks.  [ruby-core:02982]

	* array.c (rb_ary_pop_m, rb_ary_shift_m): take arg to behave as push
	  and unshift.

	* array.c (rb_ary_first, rb_ary_last): make shared array for result
	  array, and correct doc for Array#first(n) and Array#last(n)

	* array.c (rb_ary_select): not accept any arg.

Wed Jun 16 16:03:59 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* object.c (rb_class_inherited_p): singleton class inherits Class
	  rather than its object's class.  [ruby-dev:23690]

Wed Jun 16 16:01:17 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* gc.c (stack_grow_direction): memoize the direction.

	* gc.c (Init_stack): should always move to end of VALUE.

Tue Jun 15 12:10:04 2004  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/lib/tk.rb: bug fix (TkWindow#grab)

Mon Jun 14 18:23:27 2004  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/lib/remote-tk.rb: bug fix

Sun Jun 13 00:23:04 2004  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tcltklib/extconf.rb: [EXPERIMENTAL] MacOS X (darwin) support

	* ext/tcltklib/tcltklib.c: fix thread trouble on callback proc, and
	  eliminate warning about instance variable access

	* ext/tk/lib/tk/menubar.rb: improve supported menu_spec

	* ext/tk/lib/tk/menuspec.rb: [add] menu_spec support library

	* ext/tk/lib/tk/root.rb: add menu_spec support

	* ext/tk/lib/tk/text.rb: bug fix

	* ext/tk/lib/tk/toplevel.rb: add menu_spec support

	* ext/tk/sample/menubar?.rb: [add] sample of menu_spec usage

Sat Jun 12 14:15:20 2004  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* dir.c: RDOC for File::FNM_CASEFOLD was missed.

Sat Jun 12 11:15:53 2004  WATANABE Hirofumi  <eban@ruby-lang.org>

	* configure.in (target_os): strip -gnu suffix on Linux.

Fri Jun 11 22:08:50 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* array.c: remove #indexes, #indices.

	* hash.c: ditto.

	* ext/dbm/dbm.c: remove #indexes, #indices, "values_at" warning
	  from #select.

	* ext/gdbm/gdbm.c: ditto.

	* ext/sdbm/init.c: ditto.

	* ext/dbm/dbm.c (Init_dbm): set VERSION constant as "unknown" when
	  DB_VERSION_STRING is not available.

Thu Jun 10 19:19:41 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* ext/sdbm/init.c (fsdbm_store): sdbm should use StringValue().
	  [ruby-talk:103062]

Wed Jun  9 16:09:01 2004  akira yamada  <akira@ruby-lang.org>

	* lib/uri/generic.rb (URI::Generic::merge,
	  URI::Generic::route_from): accepts non-hierarchical URI.
	  [ruby-dev:23631]

	* test/uri/test_generic.rb (TestGeneric::test_route,
	  TestGeneric::test_merge): added tests for above changes.

Wed Jun  9 15:39:55 2004  Akinori MUSHA  <knu@iDaemons.org>

	* configure.in: Add support for DragonFly BSD.

Wed Jun  9 15:07:06 2004  Akinori MUSHA  <knu@iDaemons.org>

	* config.guess, config.sub: Update to a more recent version as of
	  2004-01-20.

Wed Jun  9 11:20:05 2004  NAKAMURA Usaku  <usa@ruby-lang.org>

	* win32/win32.c: remove unused functions and variables.

Wed Jun  2 20:16:03 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* string.c (str_new4): should share shared instance if it already
	  exists.  [ruby-dev:23665]

Wed Jun  2 12:41:53 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* io.c (rb_io_gets_m): set lastline ($_) even when read line is
	  nil.  [ruby-dev:23663]

Fri May 28 11:20:31 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* eval.c (rb_eval): bad influence on frame node.

	* eval.c (eval): reverted wrongly removed condition.  [ruby-dev:23638]

Thu May 27 21:37:50 2004  Tanaka Akira  <akr@m17n.org>

	* lib/pathname.rb (Pathname#initialize): fix pathname initialization
	  by pathname.

Thu May 27 20:02:09 2004  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* io.c (rb_io_fwrite): check all case errno != 0 [ruby-dev:23648]

Thu May 27 15:54:02 2004  Shugo Maeda  <shugo@ruby-lang.org>

	* lib/net/ftp.rb (MDTM_REGEXP): fix for demon's ftp server.
	  Thanks, Rutger Nijlunsing.

Thu May 27 14:53:13 2004  WATANABE Hirofumi  <eban@ruby-lang.org>

	* io.c (rb_io_fwrite): workaround for bcc32's fwrite bug.
	  add errno checking.  [ruby-dev:23627]

	* io.c (rb_io_fwrite): should check if errno == ENOENT, too.

Thu May 27 11:25:03 2004  NAKAMURA, Hiroshi  <nahi@ruby-lang.org>

	* test/csv/test_csv.rb: illegal require module name (../lib/csv.rb).

Wed May 26 23:12:13 2004  NAKAMURA, Hiroshi  <nahi@ruby-lang.org>

	* lib/csv.rb (CSV.read, CSV.readlines): added.  works as IO.read and
	  IO.readlines in CSV format.

	* lib/csv.rb (CSV.parse): [CAUTION] behavior changed.  in the past,
	  CSV.parse accepts a filename to be read-opened (it was just a
	  shortcut of CSV.open(filename, 'r')).  now CSV.parse accepts a
	  string or a stream to be parsed e.g.
	  CSV.parse("1,2\n3,r") #=> [['1', '2'], ['3', '4']]

	* test/csv/test_csv.rb: follow above changes.

Wed May 26 14:19:42 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* eval.c (rb_eval, eval): make line number consistent on eval with
	  Proc.  [ruby-talk:101253]

Wed May 26 13:59:17 2004  Dave Thomas  <dave@pragprog.com>

	* lib/rdoc/parsers/parse_rb.rb (RDoc::RubyParser::skip_for_variable): Allow for
	  'do' after for statement

Wed May 26 13:56:03 2004  Dave Thomas  <dave@pragprog.com>

	* lib/rdoc/generators/html_generator.rb (Generators::MarkUp::style_url): Fix
	  relative path to code CSS file

Wed May 26 13:14:52 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* io.c (rb_io_init_copy): copy also positions.  [ruby-talk:100910]

Wed May 26 00:00:00 2004  why the lucky stiff  <why@ruby-lang.org>

	* ext/syck/syck.c (syck_new_parser): clear parser on init.
	  thanks, ts. [ruby-core:02931]

	* ext/syck/token.c (sycklex_yaml_utf8): buffer underflow.
	  thanks, ts. [ruby-core:02929]

	* lib/yaml/baseemitter.rb (indent_text): simpler flow block code.

Tue May 25 11:54:13 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* eval.c (rb_yield_0, proc_invoke, proc_arity): allow passing a block
	  to a Proc.  [ruby-dev:23533]

	* parse.y (block_par, block_var): ditto.

Tue May 25 01:50:17 2004  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* ext/openssl/ossl_asn1.c (ossl_i2d_ASN1_TYPE, ossl_ASN1_TYPE_free):
	  workaround for the versions earlier than OpenSSL-0.9.7.

Mon May 24 10:46:26 2004  Kazuhiro NISHIYAMA  <zn@mbf.nifty.com>

	* lib/rdoc/generators/template/html/html.rb: SYSTEM identifiers
	  must be absolute URIs

Sun May 23 04:53:50 2004  Kazuhiro NISHIYAMA  <zn@mbf.nifty.com>

	* lib/pstore.rb (transaction): allow overriding dump and load.
	  [ruby-dev:23567]

	* lib/yaml/store.rb: follow lib/pstore.rb's change.

Sat May 22 11:54:10 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* MANIFEST: add test/openssl/test_x509store.rb.

	* ext/tk/MANIFEST: add recent files.

Sat May 22 05:37:11 2004  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/lib/remote-tk.rb: (NEW library) controll Tk interpreters
	  on the other processes by Tcl/Tk's 'send' command

Fri May 21 09:22:05 2004  Dave Thomas  <dave@pragprog.com>

	* lib/rdoc/parsers/parse_rb.rb (RDoc::RubyParser::parse_method_parameters):
	  Add ()'s around parameters that don't have them

Fri May 21 02:21:11 2004  NAKAMURA, Hiroshi  <nahi@ruby-lang.org>

	* lib/csv.rb: fixed a few bugs around multi char record/field separator.

	* test/csv/test_csv.rb: added boundary test for above feature.

Thu May 20 17:02:03 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* lib/mkmf.rb (check_sizeof): define result size.  [ruby-core:02911]

	* lib/mkmf.rb (create_header): macro name should not include equal
	  sign.

Thu May 20 14:35:52 2004  Tanaka Akira  <akr@m17n.org>

	* ext/socket/socket.c: check SCM_RIGHTS macro addition to
	  the msg_control field to test existence of file descriptor passing
	  by msg_control.

Thu May 20 12:38:06 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* numeric.c (flo_eq): always check if operands are NaN.
	  [ruby-list:39685]

Thu May 20 12:34:39 2004  Dave Thomas  <dave@pragprog.com>

	* lib/rdoc/parsers/parse_rb.rb (RDoc::RubyParser::parse_visibility):
	  At Ryan Davis' suggestion, honor visibility modifers if guarded by a
	  statement modifier

Thu May 20 12:22:13 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* lib/mkmf.rb (have_type): do not check pointer to incomplete type,
	  which always get compiled.
	  [ruby-list:39683]

Wed May 19 23:45:43 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* test/inlinetest.rb (InlineTest::loadtest): requiring library with
	  replaced $0 can make $0 == __FILE__ block be evaluated twice.

	* test/ruby/envutil.rb (EnvUtil::rubybin): give priority to
	  environment variable.  [ruby-dev:23538]

Wed May 19 11:08:10 2004  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/lib/tk.rb: change permition of TkObject#tk_send from
	  private to public

Wed May 19 02:29:36 2004  Minero Aoki  <aamine@loveruby.net>

	* lib/net/http.rb: support TRACE.

Wed May 19 02:21:53 2004  Minero Aoki  <aamine@loveruby.net>

	* lib/net/http.rb: do not use class variables.

Tue May 18 21:21:43 2004  NAKAMURA, Hiroshi  <nahi@ruby-lang.org>

	* lib/csv.rb: writes lines with "\n" when row separator is not given.
	  formerly it was "\r\n".

	* lib/csv.rb: [CAUTION] API change

	  * CSV::Row removed.  a row is represented as just an Array.  since
	    CSV::Row was a subclass of Array, it won't hurt almost all programs
	    except one which depended CSV::Row#match.

	  * CSV::Cell removed.  a cell is represented as just a String or
	    nil(NULL).  this change will cause widespread destruction.

	      CSV.open("foo.csv", "r") do |row|
		row.each do |cell|
		  if cell.is_null       # Cell#is_null
		    p "(NULL)"
		  else
		    p cell.data		# Cell#data
		  end
		end
	      end

	    must be just;

	      CSV.open("foo.csv", "r") do |row|
		row.each do |cell|
		  if cell.nil?
		    p "(NULL)"
		  else
		    p cell
		  end
		end
	      end

	* lib/csv.rb: [CAUTION] record separator(CR, LF, CR+LF) behavior
	  change.  CSV.open, CSV.parse, and CSV,generate now do not force
	  opened file binmode.  formerly it set binmode explicitly.

	  with CSV.open, binmode of opened file depends the given mode
	  parameter "r", "w", "rb", and "wb".  CSV.parse and CSV.generate open
	  file with "r" and "w".

	  setting mode properly is user's responsibility now.

	* lib/csv.rb: accepts String as a fs (field separator/column separator)
	  and rs (record separator/row separator)

	* lib/csv.rb: added CSV.foreach(path, rs = nil, &block).  CSV.foreach
	  now does not handle "| cmd" as a path different from IO.foreach.
	  needed?

	* test/csv/test_csv.rb: updated.

Tue May 18 14:24:20 2004  why the lucky stiff  <why@ruby-lang.org>

	* lib/yaml.rb: added rdoc to beginning of lib.

Tue May 18 14:00:46 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* node.h (NEW_DSTR): adjust list length.

	* parse.y (literal_concat): ditto.

Tue May 18 09:30:25 2004  SASADA Koichi  <ko1@atdot.net>

	* eval.c (rb_method_node): search cache entry first.

Mon May 17 16:04:06 2004  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* numeric.c (flo_to_s): it's preferable that "p 0.0" outputs "0.0"
	  instead of "0.0e+00". [ruby-dev:23480]

	* numeric.c (flo_to_s): it's preferable that "p 0.00000000000000000001"
	  outputs "1.0e-20" instead of "9.999999999999999e-21". (the precision
	  is considered, but there is assumption DBL_DIG == 15 in current
	  implementation)

Mon May 17 10:13:33 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* ext/socket/socket.c (setup_domain_and_type): honor duck typing.
	  [ruby-dev:23522]

	* ext/socket/socket.c (sock_s_getnameinfo): ditto.

Mon May 17 00:36:21 2004  why the lucky stiff  <why@ruby-lang.org>

	* lib/yaml/baseemitter.rb (indent_text): was forcing a mod value
	  of zero at times, which kept some blocks from getting indentation.

Mon May 17 00:07:00 2004  Gavin Sinclair  <gsinclair@soyabean.com.au>

	* lib/drb/drb.rb: Cosmetic documentation changes.

Sun May 16 20:55:49 2004  Tanaka Akira  <akr@m17n.org>

	* ext/dbm/dbm.c (fdbm_initialize): accept optional 3rd argument to
	  specify an open flag.
	  (Init_dbm): define open flags: DBM::READER, DBM::WRITER, DBM::WRCREAT
	  and DBM::NEWDB.

Sat May 15 17:52:24 2004  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* test/ruby/test_float.rb(test_strtod): Add test for signed 0.000...1

Sat May 15 14:20:13 2004  WATANABE Hirofumi  <eban@ruby-lang.org>

	* ext/syck/depend: add ruby's headers.

Sat May 15 13:38:33 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* ext/syck/MANIFEST, ext/syck/depend: new file.

	* lib/yaml/rubytypes.rb: range of exponential floats.  [ruby-core:02824]

	* test/yaml/test_yaml.rb: tests for strings start with colon and some
	  round trip.

Sat May 15 12:04:58 2004  why the lucky stiff  <why@ruby-lang.org>

	* lib/yaml.rb: removed fallback to pure Ruby parser.

	* lib/yaml/baseemitter.rb (node_text): rewriting folded scalars.

	* ext/syck/syck.h: reports style of scalars now, be they plain, block
	  single-, or double-quoted.

	* ext/syck/syck.c: ditto.

	* ext/syck/gram.c: ditto.

	* ext/syck/node.c: ditto.

	* ext/syck/token.c: ditto.

	* ext/syck/rubyext.c (yaml_org_handler): symbols loaded only
	  if scalar style is plain.

	* test/yaml/test_yaml.rb (test_perl_regexp): updated test to
	  match new regexp serialization.

Sat May 15 01:41:34 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (eval): forgot to restore $SAFE value before evaluating
	  compiled node.  [ruby-core:02872]

Sat May 15 01:33:12 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* range.c (range_each_func): terminates loop if generating value
	  is same to @end.  [ruby-talk:100269]

Fri May 14 22:08:38 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* string.c (rb_str_new4): should not reuse frozen shared string if
	  the original is not an instance of String. [ruby-talk:100193]

Fri May 14 21:29:26 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* time.c (time_mdump): preserve GMT bit in the marshal data.
	  [ruby-talk:100213]

Fri May 14 18:37:49 2004  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/lib/tk/canvas.rb: improve coords support for canvas
	  items. Now, supports all of the followings.
	       TkcLine.new(c, 0, 0, 100, 100, :fill=>'red')
	       TkcLine.new(c, [0, 0, 100, 100], :fill=>'red')
	       TkcLine.new(c, [0, 0], [100, 100], :fill=>'red')
	       TkcLine.new(c, [[0, 0], [100, 100]], :fill=>'red')
	       TkcLine.new(c, :coords=>[0, 0, 100, 100], :fill=>'red')
	       TkcLine.new(c, :coords=>[[0, 0], [100, 100]], :fill=>'red')

Fri May 14 13:30:39 2004  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* test/ruby/test_float.rb: Add test for util.c revision 1.42.

Fri May 14 12:13:46 2004  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* util.c (ruby_strtod): strtod("0", &end); => end should point '\0'.
	 [ruby-dev:23498]

Thu May 13 15:47:30 2004  akira yamada  <akira@ruby-lang.org>

	* lib/net/telnet.rb (Net::Telnet::login): "options" can specify
	  regexps for login prompt and/or password prompt.

Thu May 13 14:17:57 2004  why the lucky stiff  <why@ruby-lang.org>

	* ext/syck/rubyext.c (yaml_org_handler): some empty strings were
	  loaded as symbols.

Thu May 13 11:04:08 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* pack.c (pack_pack): always add with null for 'Z'.

	* pack.c (pack_unpack): terminated by null for 'Z'.  [ruby-talk:98281]

Wed May 12 19:59:43 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* lib/mkmf.rb (have_type, check_sizeof): replace unusable characters.
	  [ruby-talk:99788]

Wed May 12 17:41:42 2004  Tanaka Akira  <akr@m17n.org>

	* lib/resolv.rb (Resolv::DNS::Config): make it configurable without
	  external file such as /etc/resolv.conf.

Wed May 12 14:37:27 2004  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* ext/openssl/ossl_x509name.c: attribute value of DC (short name of
	  domainComponent) should be IA5String.

Wed May 12 13:20:19 2004  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/lib/tk/composite.rb: improve configure methods (based on
	  the proposal of [ruby-talk:99671]).

Wed May 12 11:51:08 2004  Dave Thomas  <dave@pragprog.com>

	* class.c (rb_obj_singleton_methods): fix rdoc

Tue May 11 07:09:42 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (is_defined): do not protect exception during receiver
	  evaluation.

Mon May 10 22:28:14 2004  Minero Aoki  <aamine@loveruby.net>

	* lib/net/protocol.rb (each_crlf_line): remove junk line.

Mon May 10 21:44:42 2004  Dave Thomas  <dave@pragprog.com>

	* lib/rdoc/generators/html_generator.rb: Change scheme for
	  looking up symbols in  HTML generator.

Mon May 10 16:45:21 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (eval): warning during eval should not cause deadlock.
	  [ruby-talk:98651]

	* eval.c (rb_eval): raise TypeError exception for superclass
	  mismatch.  [ruby-list:39567]

Mon May 10 12:11:37 2004  Dave Thomas  <dave@pragprog.com>

	* lib/rdoc/generators/html_generator.rb: Hack to search parents
	  for unqualified constant names.

Mon May 10 01:18:15 2004  Minero Aoki  <aamine@loveruby.net>

	* lib/net/pop.rb (logging): append "\n".

Sun May  9 23:38:00 2004  Gavin Sinclair  <gsinclair@soyabean.com.au>

	* lib/net/ftp.rb: ported documentation improvement from 1.8 branch

	* lib/net/imap.rb:   ditto

	* lib/net/pop.rb:    ditto

	* lib/net/smtp.rb:   ditto

	* lib/net/telnet.rb: ditto

Sun May  9 23:34:51 2004  NAKAMURA, Hiroshi  <nahi@ruby-lang.org>

	* test/ruby/test_float.rb: added test_strtod to test Float("0").

Sun May  9 13:24:24 2004  WATANABE Hirofumi  <eban@ruby-lang.org>

	* lib/yaml/store.rb: use FileUtils::copy.

Sun May  9 12:34:26 2004  Kazuo Saito  <ksaito@uranus.dti.ne.jp>

	* regex.c: removed unused file.

Sat May  8 10:53:30 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* io.c (rb_f_open): open should not ignore block when "to_open"
	  method is used.  [ruby-dev:23478]

Fri May  7 22:07:39 2004  Minero Aoki  <aamine@loveruby.net>

	* lib/fileutils.rb (mv): new option `force'. [ruby-talk:99457]

	* lib/fileutils.rb: new method for command option reflection:
	  FileUtils.commands, .options, .have_option?, .options_of,
	  .collect_methods.

	* lib/fileutils.rb: module Verbose, NoWrite, DryRun do not have
	  option flags @fileutils_verbose and @fileutils_noop, they make no
	  sense.

Fri May  7 21:50:21 2004  Dave Thomas  <dave@pragprog.com>

	* lib/rdoc/parsers/parse_rb.rb (RDoc::parse_include): Allow
	  multiple arguments to 'include'

Fri May  7 21:03:51 2004  Minero Aoki  <aamine@loveruby.net>

	* lib/fileutils.rb (fu_list): Array() breaks pathes including "\n".
	  [ruby-core:02843]

	* test/fileutils/test_fileutils.rb (mkdir): test "\n" in path.

Fri May  7 20:53:25 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* ext/dbm/dbm.c (fdbm_modify): typo fixed. [ruby-dev:23473]

Fri May  7 11:17:27 2004  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* util.c (ruby_strtod): "0.0000000000000000001" should be converted
	  to 1.0e-19 instead of 0.0. (leading zeros aren't significant digits)
	  [ruby-talk:99318] [ruby-dev:23465]

Thu May  6 22:27:32 2004  Masatoshi SEKI  <m_seki@mva.biglobe.ne.jp>

	* ext/socket/socket.c (ippaddr): use NUMERICHOST if can not resolve
	  hostname.

Thu May  6 22:09:29 2004  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/tkutil.c (get_eval_string_core): bug fix. [ruby-dev:23466]

Thu May  6 14:22:29 2004  why the lucky stiff  <why@ruby-lang.org>

	* lib/yaml/rubytypes.rb (to_yaml): added instance variable handling
	  for Ranges, Strings, Structs, Regexps.

	* lib/yaml/rubytypes.rb (to_yaml_fold): new method for setting a
	  String's flow style.

	* lib/yaml.rb (YAML::object_maker): now uses Object.allocate.

	* ext/syck/gram.c: fixed transfer methods on structs, broke it
	  last commit.

Thu May  6 14:38:02 2004  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* dir.c (rb_push_glob): simplified code (not change behavior)

Thu May  6 13:32:44 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* ext/extmk.rb: get rid of side effect of Config.expand, patched by
	  <tttt01@infoseek.jp>  (ruby-bugs:PR#597)

Thu May  6 11:40:28 2004  Shugo Maeda  <shugo@ruby-lang.org>

	* lib/net/imap.rb (string): accept NIL.

	* lib/net/imap.rb (body_type_basic): allow body-fields omissions.

Thu May  6 01:59:04 2004  Dave Thomas  <dave@pragprog.com>

	* lib/rdoc/generators/html_generator.rb (Generators::HtmlMethod::params):
	  Don't include the &block parameter if we have explicit
	  yield parameters.

Wed May  5 03:52:31 2004  Masatoshi SEKI  <m_seki@mva.biglobe.ne.jp>

	* lib/rinda/ring.rb: use recv instead of recvfrom.

Wed May  5 00:38:00 2004  Gavin Sinclair  <gsinclair@soyabean.com.au>

	* lib/gserver.rb: documented
	* lib/xmlrpc/README.txt: introduced for documentation purposes

Mon May  3 09:47:24 2004  Dave Thomas  <dave@pragprog.com>

	* lib/rdoc/parsers/parse_rb.rb (RDoc::RubyParser::parse_method_or_yield_parameters):
	  Fix parsing bug if yield called within 1 line block

Sun May  2 21:56:48 2004  Minero Aoki  <aamine@loveruby.net>

	* test/fileutils/test_fileutils.rb (rm_f, rm_r): test :force flag.

Sun May  2 01:04:38 2004  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tcltklib, ext/tk: renewal Ruby/Tk

Fri Apr 30 20:08:41 2004  WATANABE Hirofumi  <eban@ruby-lang.org>

	* time.c (SIZEOF_TIME_T): support SIZEOF_TIME_T == SIZEOF_INT.

Wed Apr 28 01:26:11 2004  Kazuo Saito  <ksaito@uranus.dti.ne.jp>

	* oniguruma.h, regparse.c: imported Oni Guruma 2.2.8.

Wed Apr 28 01:16:23 2004  Kazuo Saito  <ksaito@uranus.dti.ne.jp>

	* oniguruma.h, regparse.c: imported Oni Guruma 2.2.7.

Tue Apr 27 14:43:32 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* common.mk: LIBURUBY_A is needed for extconf.rb even when
	  cross-compiling.

Tue Apr 27 13:33:50 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* parse.y (string_content): turn off NODE_NEWLINE flag to avoid
	  unnecessary line trace for inlined expression.
	  (ruby-bugs PR#1320)

Tue Apr 27 08:15:13 2004  why the lucky stiff  <why@ruby-lang.org>

	* lib/yaml/rubytypes.rb: passing Range tests.

	* ext/syck/syck.h: version 0.44.

	* ext/syck/gram.c: transfers no longer open an indentation.
	  fixed transfers which precede blocks.

	* ext/syck/token.c: ditto.

	* ext/syck/syck.c: fixed segfault if an anchor has been released already.

	* ext/syck/node.c (syck_free_members): organized order of free'd nodes.

	* ext/syck/rubyext.c (syck_emitter_write_m): test for proper string with
	  StringValue.

Mon Apr 26 23:56:54 2004  Daniel Kelley  <news-1082945587@dkelley.gmp.san-jose.ca.us>

	* README.EXT, README.EXT.ja: fixed wrong function signature.
	  [ruby-talk:98349]

Mon Apr 26 21:40:09 2004  Dave Thomas  <dave@pragprog.com>

	* lib/rdoc/code_objects.rb (RDoc::Context::add_alias): Only alias
	  to instance methods.

Sun Apr 25 18:26:23 2004  WATANABE Hirofumi  <eban@ruby-lang.org>

	* configure.in (ac_cv_func_fork): set to no on DJGPP.

Sat Apr 24 14:32:03 2004  Kazuo Saito  <ksaito@uranus.dti.ne.jp>

	* re.c: applied stack error handling patch. [ruby-dev:23431]

Sat Apr 24 10:38:31 2004  Dave Thomas  <dave@pragprog.com>

	* lib/rdoc/markup/simple_markup.rb (SM::SimpleMarkup::group_lines):
	  Fix bug where consecutive headings are merged.

Fri Apr 23 23:24:47 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* lib/mkmf.rb: $hdrdir should not contain macros, for backward
	  compatibility.  [bruby-dev:28]

	* lib/mkmf.rb (create_makefile): in the case of extout, just copy
	  script files, without comparison.

Fri Apr 23 16:38:46 2004  Tanaka Akira  <akr@m17n.org>

	* lib/pathname.rb: sync taint/freeze flag between
	  a pathname object and its internal string object.

Fri Apr 23 14:52:14 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* parse.y (stmt, arg, aref_args): should not make sole splat into
	  array, in aref_args other than aref with op_asgn.

Fri Apr 23 14:14:38 2004  Tanaka Akira  <akr@m17n.org>

	* lib/resolv.rb: don't use Regexp#source to embed regexps.
	  [ruby-dev:23432]

Thu Apr 22 18:25:10 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* common.mk, ext/extmk.rb: make ext and .ext get removed by distclean.

Thu Apr 22 10:07:01 2004  NAKAMURA Usaku  <usa@ruby-lang.org>

	* */Makefile.sub (distclean-local): should remove $(RBCONFIG).

Thu Apr 22 04:17:57 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* eval.c (rb_mod_define_method): allow binding methods to modules.
	  [ruby-dev:23410]

	* parse.y (aref_args): should pass expanded list.  [ruby-core:02793]

Thu Apr 22 01:12:57 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* numeric.c (flo_to_s): tweak output string based to preserve
	  decimal point and to remove trailing zeros.  [ruby-talk:97891]

	* string.c (rb_str_index_m): use unsigned comparison for T_FIXNUM
	  search.  [ruby-talk:97342]

Wed Apr 21 23:04:42 2004  Masatoshi SEKI  <m_seki@mva.biglobe.ne.jp>

	* lib/rinda/rinda.rb, test/rinda/test_rinda.rb: check Hash tuple size.

Wed Apr 21 20:05:00 2004  Tanaka Akira  <akr@m17n.org>

	* lib/open-uri.rb (URI::HTTP#proxy_open): set Host: field explicitly.
	  [ruby-list:39542]

Wed Apr 21 18:39:46 2004  Minero Aoki  <aamine@loveruby.net>

	* lib/net/smtp.rb: merge SMTP-TLS patch.  This patch is
	  contributed by Daniel Hob. [ruby-core:02789]

Wed Apr 21 18:23:45 2004  Minero Aoki  <aamine@loveruby.net>

	* lib/net/smtp.rb: change coding style: def m( a ) -> def m(a).

Wed Apr 21 18:01:47 2004  Minero Aoki  <aamine@loveruby.net>

	* lib/net/pop.rb: do not use class variables.

	* lib/net/pop.rb (do_start): ensure to clean up connection when
	  authentication failed.

Wed Apr 21 17:23:59 2004  Minero Aoki  <aamine@loveruby.net>

	* lib/net/http.rb (HTTP#connect): CONNECT must precede SSL connect.
	  [ruby-dev:23379]

	* lib/net/http.rb (HTTP.new): class variables are not inherited
	  now.

Wed Apr 21 15:56:43 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* lib/test/unit/ui/console/testrunner.rb (test_started): restore $0
	  after changing process title.  [ruby-talk:97426]

Wed Apr 21 10:18:06 2004  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* process.c(rb_spawn): fix SEGV at "p system('command line here')"
	 (may happen only in bccwin32) [ruby-dev:23380]

Mon Apr 19 20:58:44 2004  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* dir.c: Updated RDocs.

Mon Apr 19 18:11:15 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* hash.c (rb_hash_equal): returns true if two hashes have same set
	  of key-value set.  [ruby-talk:97559]

	* hash.c (rb_hash_eql): returns true if two hashes are equal and
	  have same default values.

Mon Apr 19 08:19:11 2004  Doug Kearns  <djkea2@mugca.its.monash.edu.au>

	* dln.c, io.c, pack.c, lib/benchmark.rb, lib/cgi.rb, lib/csv.rb,
	  lib/date.rb, lib/ftools.rb, lib/getoptlong.rb, lib/logger.rb,
	  lib/matrix.rb, lib/monitor.rb, lib/set.rb, lib/thwait.rb,
	  lib/timeout.rb, lib/yaml.rb, lib/drb/drb.rb, lib/irb/workspace.rb,
	  lib/net/ftp.rb, lib/net/http.rb, lib/net/imap.rb, lib/net/pop.rb,
	  lib/net/telnet.rb, lib/racc/parser.rb, lib/rinda/rinda.rb,
	  lib/rinda/tuplespace.rb, lib/shell/command-processor.rb,
	  lib/soap/rpc/soaplet.rb, lib/test/unit/testcase.rb,
	  lib/test/unit/testsuite.rb: typo fix.

Mon Apr 19 08:14:18 2004  Dave Thomas  <dave@pragprog.com>

	* lib/rdoc/parsers/parse_c.rb (RDoc::C_Parser::find_body): Allow for
	  #ifdef HAVE_PROTOTYPES

Fri Apr 16 17:04:07 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* string.c (rb_str_equal): always returns true or false, never
	  returns nil. [ruby-dev:23404]

Fri Apr 16 12:38:48 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* lib/drb/drb.rb (DRb::DRbUnknown::initialize): Exception#to_str is
	  deprecated.

	* lib/drb/drb.rb (DRb::DRbServer::InvokeMethod::perform): multiple
	  value class changed.

	* lib/drb/invokemethod.rb (DRb::DRbServer::InvokeMethod18Mixin::block_yield):
	  ditto.

Fri Apr 16 08:27:08 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* ext/extmk.rb: skip linking when libraries to be preloaded not
	  compiled.  [ruby-list:39561]

Thu Apr 15 19:57:11 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* process.c (pst_success_p): new method Process::Status#success?.
	  [ruby-dev:23385]

	* rubytest.rb: do nothing while cross-compiling, return status in
	  system independent style.

Thu Apr 15 19:26:54 2004  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* dir.c (rb_push_glob): Dir.glob() should return nil if block is given.
	  (http://www.ruby-lang.org/ja/man/index.cgi?cmd=view;name=Dir)

	* dir.c (push_braces): Dir.glob() should handle '{ }' nested more than
	  3 times.

	* dir.c (push_braces, rb_push_glob): Dir.glob() should handle escaped
	  '{' and '}' and ','.

	  [ruby-dev:23376]

Thu Apr 15 17:12:13 2004  Tanaka Akira  <akr@m17n.org>

	* ext/gdbm/gdbm.c (Init_gdbm): define GDBM::READER, GDBM::WRITER,
	  GDBM::WRCREAT and GDBM::NEWDB.
	  (fgdbm_initialize): use specified read/write flag.

Wed Apr 14 13:06:09 2004  Doug Kearns  <djkea2@mugca.its.monash.edu.au>

	* array.c, enum.c, eval.c, file.c, io.c, numeric.c, object.c, prec.c,
	  process.c, re.c, string.c: typos in RDoc comments.  [ruby-core:02783]

Wed Apr 14 11:29:56 2004  WATANABE Hirofumi  <eban@ruby-lang.org>

	* numeric.c (flo_eq): workaround for bcc32's bug.
	  (ruby-bugs-ja:PR#594)

Wed Apr 14 11:06:38 2004  Dave Thomas  <dave@pragprog.com>

	* lib/rdoc/parsers/parse_rb.rb (RDoc::RubyParser::scan): Changed
	  behavior of :enddoc: -- it now unconditionally terminates
	  processing of the current file.

Wed Apr 14 10:57:40 2004  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* defines.h: include <net/socket.h> to get fd_set definition in BeOS.

Tue Apr 13 23:00:55 2004  Masatoshi SEKI  <m_seki@mva.biglobe.ne.jp>

	* lib/rinda/rinda.rb: change pattern matching.
	  a === b -> a == b || a === b. [druby-ja:98]

	* test/rinda/test_rinda.rb: ditto.

Tue Apr 13 21:50:57 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* bcc32/Makefile.sub (PHONY): Borland make disallows empty command
	  rules.

Tue Apr 13 17:55:16 2004  Minero Aoki  <aamine@loveruby.net>

	* lib/net/http.rb (begin_transport): should not overwrite HTTP
	  request header. [ruby-list:39543]

Tue Apr 13 16:48:00 2004  Minero Aoki  <aamine@loveruby.net>

	* lib/net/pop.rb: merge POP3S patch.  This patch is contributed by
	  Daniel Hobe.

Tue Apr 13 02:56:29 2004  Kazuo Saito  <ksaito@uranus.dti.ne.jp>

	* common.mk: changed the order of ascii.c alphabetically.

Mon Apr 12 19:11:21 2004  Eric Hodel  <drbrain@segment7.net>

	* gc.c (rb_gc_copy_finalizer): typo.  [ruby-core:02774]

Mon Apr 12 18:45:58 2004  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* ext/openssl/ossl_x509name.c (ossl_x509name_init_i): should return
	  a value.

Mon Apr 12 10:39:50 2004  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* dir.c (rb_glob2, rb_glob, push_globs, push_braces, rb_push_glob):
	  fix memory leak. (leaked when block was interrupted)

Sun Apr 11 19:10:13 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* ruby.c (require_libraries): restore source file/line after
	  statically linked extensions initialized.  [ruby-dev:23357]

Sun Apr 11 10:47:04 2004  Dave Thomas  <dave@pragprog.com>

	* lib/rdoc/code_objects.rb (RDoc::TopLevel::add_class_or_module): Toplevel
	  classes and modules are a special case too... (handle extending existing
	  classes with or without :enddoc:)

Sat Apr 10 23:51:13 2004  Dave Thomas  <dave@pragprog.com>

	* lib/rdoc/code_objects.rb (RDoc::Context::add_to): Implementation of :enddoc:
	  made one too many assumptions...

Sat Apr 10 00:00:19 2004  Dave Thomas  <dave@pragprog.com>

	* lib/rdoc/markup/simple_markup/inline.rb: Fix problem
	  with \_cat_<b>dog</b>

Fri Apr  9 17:05:21 2004  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* dir.c (has_magic, find_dirsep): incomplete '[' matches no character
	  in Dir.glob. (follows File.fnmatch's behavior)

	* dir.c (fnmatch_helper): incomplete escape is ignored in File.fnmatch.
	  (follows Dir.glob's behavior)

	* dir.c (find_dirsep): '/' between '[' and ']' is ignored in Dir.glob.
	  (follows File.fnmatch with File::FNM_PATHNAME 's behavior)

	* dir.c (find_dirsep): escaped slash '\/' loses its meaning as
	  directory separator in Dir.glob.

	  [ruby-dev:23291]

Thu Apr  8 20:25:19 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* ext/extmk.rb (extmake): skip uncompiled extensions.

	* lib/mkmf.rb (create_makefile): emit no rules for static library if
	  $static is nil, e.g., outside of ext/.

	* lib/test/unit/ui/console/testrunner.rb (test_started): show test
	  name via $0.

	* runruby.rb: set environments to use the compiled binary.

	* test/runner.rb: do nothing while cross-compiling.

	* test/drb/drbtest.rb, test/soap/calc/test_calc_cgi.rb: use envutil to
	  know ruby binary, and restore $: after require.

	* test/ruby/envutil.rb: give priority to RUBY environment variable to
	  use just compiled binary and libraries.

Thu Apr  8 19:03:33 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* io.c (rb_io_binmode): inverted condition.  [ruby-dev:23349]

Thu Apr  8 18:22:00 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* ext/iconv/iconv.c (iconv_s_list): return encoding list if no block
	  is given.  [ruby-dev:23063]

Wed Apr  7 15:29:24 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* pack.c (pack_pack): use NUM2INT() instead of num2i32().

Wed Apr  7 12:32:02 2004  Kouhei Sutou  <kou@cozmixng.org>

	* lib/rss/parser.rb, lib/rss/1.0.rb: accepted rdf:resource or
	  resource attribute in rdf:li.
	* test/rss/test_parser.rb: added test for above change.

	* lib/rss/dublincore.rb: reverted style.

	* lib/rss/xmlparser.rb: normalized XMLParser class hierarchy.

Wed Apr  7 10:43:17 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* Makefile.in, common.mk, */Makefile.sub (ext/extinit.o): OUTFLAG
	  doesn't work for object files on VC.

	* */Makefile.sub (config.h): need SIZEOF_TIME_T now.

Wed Apr  7 00:24:34 2004  Masatoshi SEKI  <m_seki@mva.biglobe.ne.jp>

	* lib/rinda/rinda.rb: fix hash tuple bug.

	* lib/rinda/tuplespace.rb: ditto.

	* test/rinda/test_rinda.rb

Tue Apr  6 18:24:18 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* file.c (rb_get_path): get path string via "to_path" method if
	  path object is not a string. [Ruby2]

	* gc.c (rb_gc_call_finalizer_at_exit): do not free threads in the
	  exit finalizers.

	* io.c (rb_io_reopen): should use rb_io_check_io().

Tue Apr  6 16:46:09 2004  Tanaka Akira  <akr@m17n.org>

	* configure.in: check the size of time_t.

	* time.c (time_add): new function.
	  (time_plus): use time_add.
	  (time_minus): use time_add.

Tue Apr  6 13:11:48 2004  NAKAMURA Usaku  <usa@ruby-lang.org>

	* ext/socket/socket.c (raise_socket_error): never return.

	* ext/socket/socket.c (make_hostent): must return value.

Tue Apr  6 00:14:43 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* error.c (Init_Exception): remove Exception#to_str. [Ruby2]

	* eval.c (error_print): should no call "to_str" anymore use
	  "message" method instead.

	* io.c (rb_f_open): Kernel#open() calls "to_open" if the first
	  argument responds to it. [Ruby2]

Tue Apr  6 00:13:43 2004  Masatoshi SEKI  <m_seki@mva.biglobe.ne.jp>

	* lib/rinda/rinda.rb: add require 'drb/drb'

Mon Apr  5 22:25:32 2004  Tanaka Akira  <akr@m17n.org>

	* test/zlib/test_zlib.rb: new file.
	  (TestZlibGzipWriter#test_new_nil): test for [ruby-dev:23228].

Mon Apr  5 22:16:23 2004  Minero Aoki  <aamine@loveruby.net>

	* parse.y (assoc_list): {a: 1, b: 2} should be allowed.
	  [ruby-dev:23328]

Mon Apr  5 19:43:40 2004  Kazuo Saito  <ksaito@uranus.dti.ne.jp>

	* regexec.c: imported Oni Guruma 2.2.6.

Mon Apr  5 19:39:10 2004  Kazuo Saito  <ksaito@uranus.dti.ne.jp>

	* regparse.c, oniguruma.h: imported Oni Guruma 2.2.6.

Mon Apr  5 12:12:09 2004  NAKAMURA Usaku  <usa@ruby-lang.org>

	* ext/socket/socket.c (raise_socket_error): some platforms don't have
	  EAI_SYSTEM.

Mon Apr  5 08:18:23 2004  Dave Thomas  <dave@pragprog.com>

	* lib/rdoc/rdoc.rb: Remove leading ./ from file names so that cross
	  references work properly.

Sun Apr  4 14:01:20 2004  Dave Thomas  <dave@pragprog.com>

	* lib/rdoc/options.rb (Options::parse): Allow multiple -x options to
	  RDoc. Fix bug where files weren't being excluded properly

Sat Apr  3 09:36:38 2004  why the lucky stiff  <why@ruby-lang.org>

	* ext/syck/syck.h: version 0.43.

Sat Apr  3 08:28:47 2004  why the lucky stiff  <why@ruby-lang.org>

	* ext/syck/lib/gram.c: allow root-level inline collections.
	  [ruby-talk:94922]

	* lib/yaml/rubytypes.rb (Symbol#to_yaml): emit symbols as implicits.
	  [ruby-talk:94930]

Fri Apr  2 19:28:48 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* bcc32/Makefile.sub (OUTFLAG): needed for static-linked-ext.

Fri Apr  2 18:00:05 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* ext/extmk.rb (extmake): extract necessary variables for static link
	  from Makefile.

	* lib/mkmf.rb (create_makefile): save preload and libpath for next
	  compile.

Fri Apr  2 17:27:17 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (top_include): include in the wrapped load is done for
	  the wrapper, not for a singleton class for wrapped main.
	  [ruby-dev:23305]

Fri Apr  2 15:13:44 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* bignum.c (rb_big_eq): use temporary double variable to save the
	  result (internal float register may be bigger than 64 bits, for
	  example, 80 bits on x86).  [ruby-dev:23311]

Fri Apr  2 14:35:26 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (block_pass): should generate unique identifier of the
	  pushing block.  [ruby-talk:96363]

Fri Apr  2 11:36:20 2004  Minero Aoki  <aamine@loveruby.net>

	* eval.c (Init_load): make $LOADED_FEATURES built-in.
	  [ruby-dev:23299]

	* ruby.c (ruby_prog_init): make $PROGRAM_NAME built-in.

	* lib/English.rb: remove $LOADED_FEATURES and $PROGRAM_NAME.

Fri Apr  2 07:31:38 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* ext/socket/socket.c: mistakingly removed do_not_reverse_lookup.
	  [ruby-list:39475]

	* ext/socket/socket.c (make_hostent): fix memory leak, based on
	  the patch from HORIKAWA Hisashi <vzw00011@nifty.ne.jp>.

Thu Apr  1 22:55:33 2004  Dave Thomas  <dave@pragprog.com>

	* lib/rdoc/parsers/parse_rb.rb: Allow rdoc comments in
	  =begin rdoc/=end

	* lib/rdoc/parsers/parse_rb.rb: Fix problem with comment in
	  top-level method being taken as file comment.

Thu Apr  1 22:55:04 2004  Dave Thomas  <dave@pragprog.com>

	* lib/rdoc/ri/ri_options.rb: Fix undefined variable warning.

Thu Apr  1 19:58:37 2004  NAKAMURA, Hiroshi  <nahi@ruby-lang.org>

	* lib/soap/mapping/{factory.rb,registry.rb}: fixed illegal mapped URI
	  object with soap/marshal.
	  added URIFactory class for URI mapping.  BasetypeFactory checks
	  instance_variables when original mapping is not allowed (ivar must
	  be empty).  Instance of URI have instance_variables but it must be
	  llowed whenever original mapping is allowed or not.

Wed Mar 31 19:06:23 2004  Tanaka Akira  <akr@m17n.org>

	* time.c (year_leap_p): new function.
	  (timegm_noleapsecond): ditto.
	  (search_time_t): use timegm_noleapsecond instead of
	  mktime for first guess.

Wed Mar 31 12:05:17 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* lib/delegate.rb (DelegateClass): define internal methods of the
	  result class, but not metaclass of the caller.  [ruby-talk:96156]

	* intern.h: provide proper prototypes.  [ruby-core:02724]

	* ruby.h: missing.h is now prerequisite to intern.h.

Wed Mar 31 11:17:16 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* pack.c (pack_pack): raises RangeError if uv is out of UTF8 value
	  range.  [ruby-dev:23281]

	* io.c (rb_io_binmode): stdio buffer should be empty when calling
	  IO#binmode.  [ruby-talk:96155]

Tue Mar 30 20:25:34 2004  Tanaka Akira  <akr@m17n.org>

	* time.c (search_time_t): limit guess range by mktime if it is
	  available.  [ruby-dev:23274]

Tue Mar 30 18:19:00 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* eval.c (rb_eval): fix SEGV at retry in iterator's receiver.
	  [ruby-dev:23227]

Mon Mar 29 20:17:16 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* process.c (rb_exec): follow older behavior if close-on-exec is not
	  available.

	* process.c (rb_fork): protect from exceptions while waiting failed
	  process, if status is given.

Sun Mar 28 16:25:37 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* cygwin/GNUmakefile.in (clean-local, distclean-local): remove
	  work files.

	* win32/Makefile.sub (clean-local): ditto.

Sun Mar 28 14:23:02 2004  Minero Aoki  <aamine@loveruby.net>

	* lib/net/pop.rb: def m( arg ) -> def m(arg).

Sun Mar 28 14:09:13 2004  Minero Aoki  <aamine@loveruby.net>

	* lib/net/pop.rb (auth): failed when account/password include "%".
	  [ruby-talk:95933]

Sat Mar 27 21:40:41 2004  Tanaka Akira  <akr@m17n.org>

	* lib/open-uri.rb: permit extra semicolon in content-type field.

Sat Mar 27 10:40:48 2004  Tanaka Akira  <akr@m17n.org>

	* (lib/pp.rb, lib/prettyprint.rb): define seplist in PP::PPMethods
	  instead of PrettyPrint.

Sat Mar 27 01:47:09 2004  NAKAMURA, Hiroshi  <nahi@ruby-lang.org>

	* lib/logger.rb: trim tail space of each line.  no user visible change.

	* lib/rss/dublincore.rb: fixed class definition mismatch.

	* sample/openssl/gen_csr.rb: fixed wrong usage text.

Thu Mar 25 23:15:24 2004  Dave Thomas  <dave@pragprog.com>

	* lib/rdoc/ri/ri_options.rb (RI::Options::show_version):
	  Add --version option

Thu Mar 25 21:45:00 2004  Shigeo Kobayashi  <shigek@ruby-lang.org>

	* ext/bigdecimal/bigdecimal.c: Bug in + and - reported by Bret Jolly
	  fixed.

Thu Mar 25 21:01:32 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* version.c (ruby_show_copyright): obtain copyright year from
	  RUBY_RELEASE_YEAR.

	* win32/resource.rb: ditto.

Thu Mar 25 19:37:35 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* win32/resource.rb: default rubyw icon to ruby.ico, and let DLL also
	  include them.

	* win32/resource.rb: include winver.h for older WindowsCE.

Thu Mar 25 14:01:03 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* common.mk, */Makefile.sub (lib, dll): phony targets.

	* configure.in (ruby, miniruby): ditto.

	* cygwin/GNUmakefile.in (rubyw): ditto.

Thu Mar 25 04:16:18 2004  Dave Thomas  <dave@pragprog.com>

	* lib/rdoc/ri/ri_options.rb (RI::Options): Add the --list-names option,
	  which dumps our all known names

Thu Mar 25 03:57:47 2004  Dave Thomas  <dave@pragprog.com>

	* lib/rdoc/ri/ri_util.rb (NameDescriptor::initialize): No longer
	  allow nested classes to be designated using "."--you must
	  now use "::"

Thu Mar 25 02:00:18 2004  Dave Thomas  <dave@pragprog.com>

	* lib/rdoc/generators/template/html/one_page_html.rb (Page):
	  Fix to work with C modules.

Wed Mar 24 20:49:00 2004  Gavin Sinclair  <gsinclair@soyabean.com.au>

	* lib/uri.rb: Documented (thanks Dmitry V. Sabanin).
	* lib/uri/common.rb: Ditto.
	* lib/uri/ftp.rb: Ditto.
	* lib/uri/generic.rb: Ditto.
	* lib/uri/http.rb: Ditto.
	* lib/uri/https.rb: Ditto.
	* lib/uri/ldap.rb: Ditto.
	* lib/uri/mailto.rb: Ditto.

Wed Mar 24 18:48:05 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* lib/mkmf.rb ($ruby, $topdir, $hdrdir): should not be affected by
	  DESTDIR after installed.

	* lib/mkmf.rb (dummy_makefile): default file lists to be cleaned.

Wed Mar 24 12:32:56 2004  Dave Thomas  <dave@pragprog.com>

	* lib/rdoc/parsers/parse_c.rb (RDoc::C_Parser::handle_class_module):
	  Don't document methods if we don't know for sure the
	  class or module.

	* lib/rdoc/parsers/parse_rb.rb (RDoc::RubyParser::parse_class):
	  Don't store documentation for singleton classes if we
	  don't know the real class.

Wed Mar 24 11:11:26 2004  Dave Thomas  <dave@pragprog.com>

	* lib/rdoc/generators/html_generator.rb (Generators::HTMLGenerator::load_html_template):
	  Allow non-RDoc templates by putting a slash in the template name

Wed Mar 24 10:05:22 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* lib/tempfile.rb (Tempfile::_close): should not clear @tmpname
	  until the file is really removed. [ruby-core:02684]

Wed Mar 24 04:12:44 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* object.c (rb_mod_cvar_get): new method Module#class_variable_get.

	* object.c (rb_mod_cvar_set): ditto (Module#class_variable_set).

Tue Mar 23 17:45:22 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (rb_thread_atfork): 1.9 warns no more for thread
	  termination.  [ruby-dev:23212]

Tue Mar 23 14:46:10 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* Makefile.in, */Makefile.sub, common.mk (clean-local, distclean-local):
	  separate files under directories due to directory separator.

	* */Makefile.sub (MKFILES): common.mk and */Makefile.sub should not be
	  removed.

	* win32/Makefile.sub, wince/Makefile.sub: $* cannot appear in explicit
	  rules.

	* cygwin/GNUmakefile.in: some mingw stuffs were missed.

	* lib/mkmf.rb (create_makefile): Borland make wrongly removes braces
	  from command lines.

	* bcc32/Makefile.sub: needs bcc32/mkexports.rb.

Mon Mar 22 08:21:17 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* Makefile.in, */Makefile.sub, common.mk: extract common portions.

	* Makefile.in, cygwin/GNUmakefile.in, */Makefile.sub (RBCONFIG):
	  separated time stamp file for rbconfig.rb.

	* configure.in: append common.mk to Makefile.

	* mkconfig.rb: keep mtime of rbconfig.rb if unchanged.

	* win32/rm.bat: remove multiple files.

	* wince/mkconfig_wce.rb: use fake.rb instead.

Sun Mar 21 22:17:35 2004  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* lib/webrick/httpserver.rb (WEBrick::HTTPServer#virtual_host):
	  sort @virtual_hosts in address, port, host order.

	* lib/webrick/httpserver.rb (WEBrick::HTTPServer#lookup_server):
	  hostname should not be match if :ServerAlias is not given.

Sun Mar 21 21:11:16 2004  Keiju Ishitsuka  <keiju@ishitsuka.com>

	* lib/shell/*: bug fix for Shell#system(command_line_string).

Sun Mar 21 21:04:42 2004  WATANABE Hirofumi  <eban@ruby-lang.org>

	* ruby.1: add -width option to .Bl for old groff.

Sun Mar 21 18:57:37 2004  Kouhei Sutou  <kou@cozmixng.org>

	* test/rss/*: Test::Unit::TestCase -> RSS::TestCase and
	  Test::Unit::Assertions -> RSS::Assertions.

Sun Mar 21 18:48:20 2004  Kouhei Sutou  <kou@cozmixng.org>

	* lib/rss/{rss,dublincore,syndication}.rb: handled W3CDTF correctly.

Sun Mar 21 18:15:29 2004  Kouhei Sutou  <kou@cozmixng.org>

	* test/rss/test_xml-stylesheet.rb: added tests for xml-stylesheet.

	* lib/rss/xml-stylesheet.rb: added xml-stylesheet parsing
	  function.

Sat Mar 20 23:51:03 2004  WATANABE Hirofumi  <eban@ruby-lang.org>

	* eval.c (rb_require_safe): preserve old ruby_errinfo.
	  [ruby-talk:95409]

	* eval.c (rb_f_raise): should not clear backtrace information if
	  exception object already have one.

Sat Mar 20 21:21:03 2004  WATANABE Hirofumi  <eban@ruby-lang.org>

	* ext/extmk.rb: rm -rf $extout, not extout.

Sat Mar 20 15:25:36 2004  Dave Thomas  <dave@pragprog.com>

	* lib/rdoc/generators/template/html/html.rb (RDoc::Page): Force
	  page background to white.

Sat Mar 20 09:33:36 2004  Tadayoshi Funaba  <tadf@dotrb.org>

	* lib/date.rb, lib/date/format.rb: _parse() now accepts fractional
	  part of second minute that follows a comma or a full stop.

Fri Mar 19 21:06:21 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* parse.y (assoc_list): allow {sym: val} style Hash. [Ruby2]
	  this change is done by Nobuyoshi Nakada <nobu@ruby-lang.org>.

Fri Mar 19 15:15:15 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* variable.c (rb_cvar_set): class variables become private to the
	  particular class/module. [Ruby2]

	* variable.c (rb_cvar_get): ditto.

	* variable.c (rb_cvar_defined): ditto.

Fri Mar 19 11:31:32 2004  NAKAMURA Usaku  <usa@ruby-lang.org>

	* lib/mkmf.rb ($beos, $solaris): add OS flags.

	* lib/mkmf.rb (RUBY): / is not recognized as path separator on
	   nmake/bmake. [ruby-list:39388]

	* lib/mkmf.rb (CLEANLIBS, CLEANOBJS): should remove *.exp with *.so.

Fri Mar 19 01:55:57 2004  Mauricio Fernandez  <batsman.geo@yahoo.com>

	* io.c (rb_io_sync): need not to check writable. [ruby-core:02674]

Thu Mar 18 19:47:44 2004  WATANABE Hirofumi  <eban@ruby-lang.org>

	* instruby.rb, rubytest.rb: do not depend on srcdir.

Thu Mar 18 18:50:06 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* mkconfig.rb: no longer embed srcdir and compile_dir into
	  rbconfig.rb.

	* ext/extmk.rb, lib/mkmf.rb: obtain top_srcdir and topdir from library
	  paths.

Thu Mar 18 17:46:35 2004  Masatoshi SEKI  <m_seki@mva.biglobe.ne.jp>

	* lib/drb/drb.rb: do not undef :to_a.

Thu Mar 18 16:22:38 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (proc_eq): avoid false positive by using scope and
	  dyna_vars.  no longer use frame.uniq.

	* eval.c (proc_arity): arity is now defined as number of
	  parameters that would not be ignored. i.e. Proc.new{}.arity
	  returns zero.  update test suites too.

Thu Mar 18 15:27:25 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c: remove specialized version of rb_Array().  use simple
	  one defined in object.c.

	* object.c (Init_Object): remove Kernel#to_a.

	* enum.c (enum_zip): use "to_a" instead of "to_ary".

Wed Mar 17 00:22:03 2004  Kazuo Saito  <ksaito@uranus.dti.ne.jp>

	* oniguruma.h: imported Oniguruma 2.2.5.
	* regparse.c: ditto.

Tue Mar 16 11:14:17 2004  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* dir.c (fnmatch_helper): File.fnmatch('\.', '.') should return true.
	  (Rev1.112 lost compatiblity)

	* dir.c (fnmatch_helper): File.fnmatch('\/', '/', File::FNM_PATHNAME)
	  should return true. (Rev1.112 lost compatiblity)

	* dir.c (fnmatch): File.fnmatch('**/.boo', '.foo/.boo',
	  File::FNM_PATHNAME) should return false because of leading period.

Mon Mar 15 17:01:07 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* error.c (exc_initialize): calling 'to_str' each time just for
	  type checking is too heavy.  [ruby-core:02661]

Mon Mar 15 10:14:51 2004  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* ext/openssl/lib/openssl/ssl.rb (OpenSSL::SSL::SocketForwarder):
	  add do_not_reverse_lookup.

Mon Mar 15 07:39:13 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (rb_yield_0): should not re-submit TAG_BREAK if this
	  yield is not break destination. [ruby-dev:23197]

Sun Mar 14 22:07:38 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* eval.c (rb_thread_raise): err at unstarted thread.  (PR#1302)

Sat Mar 13 14:56:32 2004  Masatoshi SEKI  <m_seki@mva.biglobe.ne.jp>

	* test/drb/ut_drb.rb: use 'druby://localhost:0'. [ruby-dev:23078]

	* test/drb/ut_eval.rb: ditto.

	* test/drb/ut_large.rb: ditto.

	* test/drb/ut_safe1.rb: ditto.

	* test/drb/ut_drb_drbssl.rb: use 'drbssl://localhost:0'.

Fri Mar 12 23:52:56 2004  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* dir.c (fnmatch): directory recursion '**/' can be used with
	  File::FNM_PATHNAME. [ruby-dev:22901]

	* dir.c (fnmatch, fnmatch_helper): only '/' is accepted as path
	  separator even in DOSISH environment. [ruby-dev:22974]
	  [ruby-list:39337]

	* dir.c (fnmatch_helper): faster '*' matching.

Fri Mar 12 20:19:16 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* configure.in (rb_cv_noreturn): default for platforms not support
	  prototypes.

	* ruby.c (ruby_init_loadpath): buffer for path name should have
	  MAXPATHLEN.

	* lib/mkmf.rb (configuration): include topdir and hdrdir in VPATH.

	* lib/mkmf.rb (create_makefile): default dependency rule.

Fri Mar 12 07:35:36 2004  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* lib/webrick/config.rb (WEBrick::Config::General): add
	  :DoNotReverseLookup.

	* lib/webrick/server.rb (WEBrick::GenericServer#accept): call
	  do_not_reverse_lookup for each socket if :DoNotReverseLookup
	  is set.  [ruby-code:02357]

Wed Mar 10 22:26:25 2004  Minero Aoki  <aamine@loveruby.net>

	* lib/fileutils.rb (remove_dir): should handle symlink correctly.
	  This patch is contributed by Christian Loew.  [ruby-talk:94635]

Wed Mar 10 16:28:42 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (return_jump): set return value to the return
	  destination.  separated from localjump_destination().

	* eval.c (break_jump): break innermost loop (or thread or proc).

	* eval.c (rb_yield_0): set exit_value for block break.

Wed Mar 10 16:00:14 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* struct.c (rb_struct_s_def): Struct::new executes block with
	  generated struct class. [ruby-talk:02606]

Wed Mar 10 15:58:43 2004  Ryan Davis  <ryand@zenspider.com>

	* eval.c (eval): Only print backtrace if generating the backtrace
	  doesn't generate an exception.  [ruby-core:02621]

Wed Mar 10 10:15:16 2004  NAKAMURA Usaku  <usa@ruby-lang.org>

	* ruby.c (opt_W_getter): get rid of warning.

	* bcc32/Makefile.sub, win32/Makefile.sub, wince/Makefile.sub:
	  fixed dependency.

Tue Mar  9 13:04:26 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* io.c (rb_io_ungetc): raise IOError instead of calling
	  rb_sys_fail().  [ruby-talk:23181]

Tue Mar  9 10:03:40 2004  NAKAMURA Usaku  <usa@ruby-lang.org>

	* bcc32/Makefile.sub, win32/Makefile.sub, wince/Makefile.sub:
	  replaced regex.c entry with Oniguruma files.

Tue Mar  9 01:09:46 2004  Kazuo Saito  <ksaito@uranus.dti.ne.jp>

	* Makefile.in: replaced regex.c entry with Oniguruma files.

Mon Mar  8 23:16:07 2004  Minero Aoki  <aamine@loveruby.net>

	* lib/net/http.rb: HTTPHeader did not initialized correctly.

	* lib/net/http.rb (connect): does same debug output.

Mon Mar  8 21:38:18 2004  Minero Aoki  <aamine@loveruby.net>

	* lib/net/http.rb (add_header): remove warning. [ruby-dev:23170]

Mon Mar  8 21:09:39 2004  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* dir.c (range): Cancel change for incomplete '['. More discussion
	  is needed.

Mon Mar  8 19:35:13 2004  akira yamada  <akira@arika.org>

	* lib/uri/common.rb (URI::REGEXP::PATTERN::HOSTPORT): (?:#{PORT})
	  -> (?::#{PORT}).  [ruby-dev:23170]

Mon Mar  8 15:03:24 2004  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* dir.c (range): treat incomplete '[' as ordinary character (like
	  has_magic does). fix buffer overrun at incomplete escape like '[\'.

Mon Mar  8 13:35:32 2004  WATANABE Hirofumi  <eban@ruby-lang.org>

	* regparse.c (parse_exp): need to separate initialization for bcc32.
	  [ruby-dev:23169]

	* oniguruma.h (ONIG_EXTERN): check __GNUC__ instead of __CYGWIN__.

Mon Mar  8 01:05:55 2004  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* lib/webrick/config.rb (WEBrick::Config::HTTP): rename :RequestHander
	  to :RequestCallback and add new option :ServerAlias.

	* lib/webrick/httpserver.rb (WEBrick::HTTPServer#run): use
	  :RequestCallback and warn if :RequestHandler is in server's option.

	* lib/webrick/httpserver.rb (WEBrick::HTTPServer#run): should print
	  error message for WEBrick::HTTPSataus::Error.

	* lib/webrick/httpserver.rb (WEBrick::HTTPServer#lookup_server):
	  lookup for hostname from :ServerAlias if the req.host is not match
	  to :ServerName.

	* lib/webrick/httpservlet.rb (WEBrick::HTTPServlet::CGIHandler#do_GET):
	  use $?.exitstatus and refine log message.

Sun Mar  7 16:22:26 2004  WATANABE Hirofumi  <eban@ruby-lang.org>

	* Makefile.in (lex.c): use $? instead of $<.

	* lib/pstore.rb (commit_new): use FileUtils.copy_stream for Cygwin.
	  [ruby-dev:23157]

Sun Mar  7 05:34:42 2004  Minero Aoki  <aamine@loveruby.net>

	* lib/net/http.rb: HTTPHeader keeps its header fields as an array.

	* lib/net/http.rb: new method HTTPHeader#add_header, get_fields.

	* lib/net/http.rb: new method HTTPHeader#content_length=.

	* lib/net/http.rb: new method HTTPHeader#content_type, main_type,
	  sub_type, type_params, content_type=, set_content_type.

	* lib/net/http.rb (HTTPHeader#basic_encode): result of pack(m) may
	  contain multiple LFs.

Sun Mar  7 03:11:00 2004  Minero Aoki  <aamine@loveruby.net>

	* lib/net/http.rb: new method Net::HTTPRequest#body(=).

	* lib/net/http.rb: new method Net::HTTPRequest#body_stream(=).

Sun Mar  7 02:06:07 2004  Minero Aoki  <aamine@loveruby.net>

	* lib/net/http.rb: spin off https code again.

	* lib/net/https.rb: new file.

	* ext/openssl/lib/net/https.rb: removed.  moved to net/https with
	  slight modifications.

	* ext/openssl/lib/net/protocols.rb: removed.  merged with net/http.

	* lib/net/protocol.rb: new class BufferedIO.

	* lib/net/protocol.rb: InternetMessageIO < BufferedIO.

	* lib/net/protocol.rb: BufferedIO.new takes an IO.

	* lib/net/smtp.rb: follow InternetMessageIO's change.

	* lib/net/pop.rb: ditto.

Sun Mar  7 00:55:03 2004  Minero Aoki  <aamine@loveruby.net>

	* lib/net/protocol.rb: remove method: InternetMessageIO#address,
	  port, ip_address, read_timeout(=), socket.

	* lib/net/protocol.rb: simplify code.

	* lib/net/protocol.rb: apply latest coding style.

Sat Mar  6 15:15:05 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* ext/strscan/depend: depends on re.h and regex.h.

	* ext/strscan/strscan.c: no version check needed.

	* ext/strscan/strscan.c (strscan_init_copy): struct re_registers must
	  not be bitwise copied.

Sat Mar  6 11:14:33 2004  David Black  <dblack@wobblini.net>

	* lib/scanf.rb: refixed the previous fix in IO#block_scanf

Sat Mar  6 10:49:40 2004  David Black  <dblack@wobblini.net>

	* lib/scanf.rb: fixed a logic glitch in IO#block_scanf

Sat Mar  6 02:00:19 2004  Minero Aoki  <aamine@loveruby.net>

	* lib/net/http.rb: net/https is merged.

	* ext/openssl/lib/net/https.rb: ditto.

Sat Mar  6 00:39:21 2004  Kazuo Saito  <ksaito@uranus.dti.ne.jp>

	* oniggnu.h: imported from Oniguruma library.
	* oniguruma.h: ditto.
	* regcomp.c: ditto.
	* regenc.c: ditto.
	* regenc.h: ditto.
	* regerror.c: ditto.
	* regex.c: ditto.
	* regexec.c: ditto.
	* reggnu.c: ditto.
	* regint.h: ditto.
	* regparse.c: ditto.
	* regparse.h: ditto.
	* ascii.c: ditto.
	* euc_jp.c: ditto.
	* sjis.c: ditto.
	* utf8.c: ditto.

	* MANIFEST: added Oniguruma files listed above.

	* LEGAL: added Oniguruma license.

	* regex.h: now includes oniggnu.h.

	* re.c: applied Oniguruma patch.

Fri Mar  5 23:13:08 2004  Minero Aoki  <aamine@loveruby.net>

	* lib/net/http.rb: support WebDAV methods, PROPPATCH, LOCK,
	  UNLOCK, OPTIONS, PROPFIND, DELETE, MOVE, COPY, MKCOL.
	  This patch is contributed by Tatsuki Sugiura.

Fri Mar  5 20:58:37 2004  Minero Aoki  <aamine@loveruby.net>

	* lib/net/http.rb: Net::HTTPResponse#response is obsolete.
	  [ruby-core:02592]

	* lib/net/http.rb: Net::HTTPResponse#header is obsolete.

	* lib/net/http.rb: Net::HTTPResponse#read_header is obsolete.

Fri Mar  5 20:10:57 2004  Minero Aoki  <aamine@loveruby.net>

	* ext/strscan/strscan.c: new method StringScanner#initialize_copy
	  to allow #dup and #clone.

	* test/strscan/test_strscan.rb: test StringScanner#dup.

Fri Mar  5 19:42:09 2004  Minero Aoki  <aamine@loveruby.net>

	* lib/net/http.rb (HTTPResponse#to_ary): should return an object
	  which does not respond to #to_ary.  It causes infinite loop in
	  puts. [ruby-core:02578]

Fri Mar  5 00:51:35 2004  Dave Thomas  <dave@pragprog.com>

	* lib/test/unit.rb: Move RDoc documentation so that you can
	  now say 'ri Test::Unit'

Thu Mar  4 22:31:40 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* Makefile.in: miniruby is not needed for cross compile.

	* configure.in (PREP): miniruby for native compile.

Thu Mar  4 11:46:32 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* lib/drb/extservm.rb (DRb::ExtServManager#invoke_service_command):
	  detach server processes to get rid of zombies.

Thu Mar  4 10:41:25 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* ruby.h (T_MASK): save 1 bit in flags bits by shifting T_xxx
	  values.

Thu Mar  4 08:08:36 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* ext/syck/rubyext.c: get rid of warnings.

	* lib/rss/taxonomy.rb: ditto.

	* lib/rdoc/ri/ri_formatter.rb: ditto.

	* test/ruby/test_assignment.rb: ditto.

Thu Mar  4 01:17:28 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* lib/rdoc/ri/ri_display.rb (DefaultDisplay::page): wait until the
	  pager terminates.

Wed Mar  3 13:10:56 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (method_hash): new method. [ruby-talk:93968]

	* eval.c (proc_eq): do not compare dyna_vars.

	* eval.c (proc_hash): new method.

	* eval.c (rb_yield_0): protect break/return from within orphan (or
	  lambda) Proc object.

Wed Mar  3 09:52:05 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* lib/mkmf.rb ($topdir): use compile_dir only when not installed yet.
	  [ruby-talk:94098]

Wed Mar  3 01:18:52 2004  Kouhei Sutou  <kou@cozmixng.org>

	* lib/rss/converter.rb: handled Uconv::Error.

	* lib/rss/dublincore.rb: DublincoreModel -> DublinCoreModel

Wed Mar  3 00:59:30 2004  David Black  <dblack@wobblini.net>

	* lib/scanf.rb: soak_up_spaces only ungetc's non-space last
	  character

	* lib/scanf.rb: IO#block_scanf now returns partial last iteration
	  array if format string matches partly

Tue Mar  2 16:30:21 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* io.c (pipe_open): erred program name should be reported by
	  exceptions, instead of the first argument.

	* process.c (rb_spawn): ditto.

	* process.c (proc_spawn_v): use first argument as program name.

	* win32/win32.c (rb_w32_aspawn): ditto.

	* win32/win32.c (CreateChild): search executable file if no program
	  name given.

	* lib/drb/extservm.rb (invoke_service_command): use Process.spawn.
	  [ruby-dev:23103]

	* lib/rdoc/ri/ri_display.rb (setup_pager): use IO.popen.
	  [ruby-dev:23086], [ruby-dev:23103]

	* lib/rdoc/diagram.rb (convert_to_png): ditto.

	* lib/rdoc/generators/chm_generator.rb (compile_project): ditto.

Tue Mar  2 12:24:03 2004  NAKAMURA Usaku  <usa@ruby-lang.org>

	* win32/Makefile.sub, wince/Makefile.sub (config.h): shouldn't check
	  defined? NORETURN. [ruby-dev:23100]

Tue Mar  2 11:28:40 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* test/ruby/test_iterator.rb (test_ljump): cannot use
	  assert_nothing_raised due to passing block.

Tue Mar  2 06:23:14 2004  David Black  <dblack@wobblini.net>

	* lib/scanf.rb: fixed Kernel#scanf to propagate code block

Mon Mar  1 23:25:40 2004  David Black  <dblack@wobblini.net>

	* lib/scanf.rb: Partial fix so STDIN#scanf works with new
	 STDIN#pos behavior

Mon Mar  1 19:42:05 2004  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* bcc32/setup.mak: configure's default is "--enable-install-doc"

	* win32/setup.mak: ditto.

Mon Mar  1 12:24:10 2004  Dave Thomas  <dave@pragprog.com>

	* lib/rdoc/parsers/parse_rb.rb (RDoc::RubyParser::parse_alias):
	  Allow aliases to have parentheses

Sun Feb 29 23:14:53 2004  Dave Thomas  <dave@pragprog.com>

	* lib/rdoc/parsers/parse_rb.rb (RDoc::RubyParser::parse_class):
	  Handle :nodoc: on singleton classes.

Sat Feb 28 21:50:20 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* bcc32/Makefile.sub, bcc32/README.bcc32, bcc32/configure.bat,
	  bcc32/setup.mak: new configure scheme. use ``configure --prefix=dir''
	  instead of ``make DESTDIR=dir install''.
	  --with-static-linked-ext support on bccwin32. [ruby-dev:23034]

Sat Feb 28 21:50:20 2004  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* bcc32/setup.mak: "configure --disable-install-doc" is now working.

	* win32/setup.mak: ditto.

Sat Feb 28 15:09:49 2004  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* bcc32/configure.bat: append missing label ":exit".

	* bcc32/configure.bat: fix typo.

Sat Feb 28 10:31:03 2004  Masatoshi SEKI  <m_seki@mva.biglobe.ne.jp>

	* MANIFEST: add test_erb.rb

	* lib/erb.rb, test/erb/test_erb.rb: don't forget filename,
	  if both filename and safe_level given. [ruby-dev:23050]

Sat Feb 28 01:08:40 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* parse.y (yylex): should not allow symbol for invalid global
	  variable (e.g. `:$-)`). [ruby-core:02518]

Fri Feb 27 20:37:09 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (proc_invoke): no orphan block check is needed when pcall
	  is true.

	* eval.c (localjump_destination): update localjump condition.

Fri Feb 27 02:10:49 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (localjump_destination): lambda should not interfere
	  return from the yielded block.

Fri Feb 27 00:53:49 2004  Masatoshi SEKI  <m_seki@mva.biglobe.ne.jp>

	* lib/drb/drb.rb, test/drb/drbtest.rb: require drb/eq.rb by default

Thu Feb 26 12:15:02 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* win32/win32.c (make_cmdvector): adjust successive double-quote
	  handling.

Thu Feb 26 09:42:56 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* hash.c (delete_if_i): use st_delete_safe() (via
	  rb_hash_delete()) instead of returning ST_DELETE.

Thu Feb 26 02:35:10 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* process.c (rb_f_exec): get rid of SEGV when exec failed for command
	  in single string.

Wed Feb 25 21:17:33 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* gc.c (obj_free), io.c (rb_io_fptr_finalize), rubyio.h (OpenFile):
	  sharing OpenFile.

	* io.c (rb_io_initialize): accept IO instance.  [ruby-dev:22195]

Wed Feb 25 21:16:10 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* instruby.rb (with_destdir): should return the given argument if no
	  DESTDIR is given.

	* instruby.rb: use path name expansion of cmd.exe.

Wed Feb 25 20:44:45 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* lib/cgi-lib.rb, lib/getopts.rb, lib/importenv.rb, lib/parsearg.rb:
	  warn with caller position.

	* test/rss/test_content.rb, test/rss/test_dublincore.rb,
	  test/rss/test_syndication.rb, test/rss/test_trackback.rb: use cgi
	  instead of cgi-lib.

Tue Feb 24 18:42:03 2004  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* dir.c (glob_helper): '**/' should not match leading period
	  unless File::FNM_DOTMATCH is set. (like '*/') [ruby-dev:23014]

Tue Feb 24 18:03:14 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* test/ruby/test_file.rb (test_fnmatch): test for dir.c:1.108.

Tue Feb 24 17:07:17 2004  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* dir.c (fnmatch): File.fnmatch with File::FNM_PATHNAME was broken
	  for the pattern including '*' followed by '/'.

Tue Feb 24 13:22:21 2004  Dave Thomas  <dave@pragprog.com>

	* lib/rdoc/rdoc.rb (RDoc::RDoc::normalized_file_list): Attempt to get better
	  heuristics on which files to include and exclude. Now only include
	  non-standard files if they are explicitly named in ARGV.

Tue Feb 24 07:23:30 2004  Dave Thomas  <dave@pragprog.com>

	* lib/rdoc/generators/html_generator.rb: Deal with :stopdoc: when
	  choosing a default main page to display (ie. don't select a page
	  if we don't have documentation for it).

Tue Feb 24 06:40:14 2004  Dave Thomas  <dave@pragprog.com>

	* lib/rdoc/parsers/parse_rb.rb (RubyLex::identify_identifier): Handle
	  class variables in code listings

Tue Feb 24 06:32:27 2004  Dave Thomas  <dave@pragprog.com>

	* lib/rdoc/parsers/parse_c.rb (RDoc::C_Parser::do_aliases): Handle
	  aliases in C files.

Tue Feb 24 06:16:22 2004  Dave Thomas  <dave@pragprog.com>

	* lib/rdoc/rdoc.rb (RDoc::RDoc::document): Now create op dir _before_
	  parsing files.

Tue Feb 24 06:08:47 2004  Dave Thomas  <dave@pragprog.com>

	* lib/rdoc/parsers/parse_rb.rb (RDoc::RubyParser::parse_constant):
	  Start collecting text of constant values earlier: was missing
	  values in output if there was no space after '='

Tue Feb 24 06:08:25 2004  Dave Thomas  <dave@pragprog.com>

	* lib/rdoc/generators/html_generator.rb: Escape contant values.

Tue Feb 24 03:45:06 2004  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* ext/openssl/ossl_config.c (ossl_config_each): add new method
	  OpenSSL::Config#each. it iterates with section name, field name
	  and value.

	* ext/openssl/ossl_config.c (Init_ossl_config): include Enumerable.

Mon Feb 23 09:09:44 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* instruby.rb (parse_args): use optparse instead of getopts.

	* instruby.rb (DOSISH): embedded path in batch files should not be
	  prefixed by DESTDIR.  [ruby-core:02186]

Sun Feb 22 14:58:04 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* ext/extmk.rb: $extstatic is Array or nil now.  [ruby-talk:93383]

	* Makefile.in, bcc32/Makefile.sub, win32/Makefile.sub: terminate options.

	* lib/mkmf.rb (init_mkmf): $INCFLAGS also should be lazy-evaluated.

Sun Feb 22 13:05:37 2004  akira yamada  <akira@ruby-lang.org>

	* lib/uri/mailto.rb (URI::MailTo::to_s): should include fragment.

Sun Feb 22 12:58:35 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* ext/extmk.rb: use optparse instead of getopts.

	* Makefile.in, bcc32/Makefile.sub, win32/Makefile.sub: ditto.

Sun Feb 22 09:51:00 2004  Gavin Sinclair  <gsinclair@soyabean.com.au>

	* re.c: corrected documentation format (rb_reg_initialize_m)

Sat Feb 21 22:41:00 2004  Gavin Sinclair  <gsinclair@soyabean.com.au>

	* ext/zlib/zlib.c: documented, but needs more effort.

Sat Feb 21 14:33:20 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* ext/extmk.rb: prefer relative path.  [ruby-talk:93037]

Sat Feb 21 11:12:08 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* missing/os2.c, missing/x68.c: typo fix.  pointed out by greentea.

Fri Feb 20 19:11:20 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* lib/ostruct.rb (OpenStruct#initialize_copy): should not share
	  members.  [ruby-dev:22966]

Fri Feb 20 18:59:47 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* lib/irb/init.rb (IRB::IRB.parse_opts): add -I option to
	  irb. [ruby-dev:39243]

Fri Feb 20 12:55:27 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* io.c (pipe_open): fix typo.

	* win32/win32.c (CreateChild): first argument to CreateProcess() must
	  have path, not just basename.

Thu Feb 19 23:24:16 2004  Dave Thomas  <dave@pragprog.com>

	* lib/rdoc/generators/html_generator.rb (Generators::HtmlClass::build_attribute_list):
	  Support visibility modifiers for attributes

Thu Feb 19 22:39:00 2004  Gavin Sinclair  <gsinclair@soyabean.com.au>

	* lib/ostruct.rb: documented

Thu Feb 19 22:39:04 2004  NAKAMURA, Hiroshi  <nahi@ruby-lang.org>

	* test/rinda/test_rinda.rb: DRb.start_service only once in testsuites.
	  DRb.start_service could handle this.

Thu Feb 19 22:24:04 2004  NAKAMURA, Hiroshi  <nahi@ruby-lang.org>

	* lib/soap/mapping/rubytypeFactory.rb: should not dump singleton class.
	  [ruby-dev:22588]
	  c = class << Object.new; class C; self; end; end; SOAPMarshal.dump(c)

Thu Feb 19 18:08:18 2004  Gavin Sinclair  <gsinclair@soyabean.com.au>

	* ext/strscan/strscan.c: improved documentation

Thu Feb 19 18:08:18 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* win32/win32.c, win32/win32.h: fixed prototypes.

	* win32/win32.c (wait): same as waitpid() with -1.

Thu Feb 19 02:34:28 2004  Dave Thomas  <dave@pragprog.com>

	* lib/rdoc/markup/simple_markup/preprocess.rb (SM::PreProcess::include_file):
	  Only strip comment markers if all lines start with comments.

Thu Feb 19 03:05:49 2004  Minero Aoki  <aamine@loveruby.net>

	* ext/strscan/strscan.c: StringScanner#restsize is obsolete;
	  use #rest_size instead.

	* ext/strscan/strscan.c: StringScanner#matchedsize is obsolete;
	  use #matched_size instead.

Thu Feb 19 02:42:19 2004  Minero Aoki  <aamine@loveruby.net>

	* ext/strscan/strscan.c: don't use rb_eval_string, it defines
	  classes under the module when required in module clauses.
	  [ruby-dev:22951]

Thu Feb 19 02:37:28 2004  Minero Aoki  <aamine@loveruby.net>

	* ext/strscan/strscan.c: merge documentation from 1.8 branch.
	  Thanks Gavin Sinclair.

Thu Feb 19 00:20:00 2004  Gavin Sinclair  <gsinclair@soyabean.com.au>

	* lib/cgi-lib.rb:   deprecated after 1.8.1

	* lib/getopts.rb:   ditto

	* lib/importenv.rb: ditto

	* lib/parsearg.rb:  ditto

Thu Feb 19 00:11:05 2004  Dave Thomas  <dave@pragprog.com>

	* lib/rdoc/markup/simple_markup/preprocess.rb (SM::PreProcess::handle):
	  Strip extraneous space from filenames in :include:

Wed Feb 18 22:53:41 2004  Masatoshi SEKI  <m_seki@mva.biglobe.ne.jp>

	* lib/drb/unix.rb: remove O_NONBLOCk, thanks \ay

Wed Feb 18 22:42:19 2004  Masatoshi SEKI  <m_seki@mva.biglobe.ne.jp>

	* test/rinda/test_rinda.rb: improt test_rinda.rb

Wed Feb 18 22:03:11 2004  NAKAMURA, Hiroshi  <nahi@ruby-lang.org>

	* test/*: should not depend on $KCODE.

Wed Feb 18 18:07:09 2004  NAKAMURA Usaku  <usa@ruby-lang.org>

	* test/ruby/test_sprintf.rb: added tests.

Wed Feb 18 17:18:01 2004  WATANABE Hirofumi  <eban@ruby-lang.org>

	* ext/win32ole/win32ole.c: need to include <olectl.h> on Cygwin.

Wed Feb 18 10:40:38 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* sprintf.c (rb_f_sprintf): sign bit extension should not be done
	  if FPLUS flag is specified.  [ruby-list:39224]

	* sprintf.c (rb_f_sprintf): do not prepend dots for negative
	  numbers if FZERO is specified.  [ruby-dev:39218]

Wed Feb 18 10:23:34 2004  NAKAMURA Usaku  <usa@ruby-lang.org>

	* sprintf.c (rb_f_sprintf): clean up.

Tue Feb 17 23:40:34 2004  Guy Decoux  <ts@moulon.inra.fr>

	* sprintf.c (rb_f_sprintf): preserve original val for
	  format_integer. [ruby-talk:92975]

Tue Feb 17 23:28:45 2004  NAKAMURA, Hiroshi  <nahi@ruby-lang.org>

	* test/soap/marshal/test_marshal.rb, test/ruby/test_marshal.rb: do $:
	  trick to share the testcase test/ruby/marshaltestlib.rb.

Tue Feb 17 23:13:23 2004  NAKAMURA, Hiroshi  <nahi@ruby-lang.org>

	* test/ruby/marshaltestlib.rb: common marshal testcase added.

	* test/ruby/test_marshal.rb: use above testsuite.

	* test/soap/marshal/test_marshal.rb: ditto.

	* test/soap/marshal/cmarshal.rb: removed (not used).

Tue Feb 17 19:34:26 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* ext/extmk.rb (extmake): $extout_prefix doesn't vary for libraries.

	* ext/extmk.rb (extmake): remove compile directory if empty.

	* ext/extmk.rb (parse_args) lib/mkmf.rb (create_makefile): move
	  initialization of $extout_prefix from lib/mkmf.rb.  [ruby-dev:22928]

	* ext/extmk.rb: clear ext and extout directory when cleaning.

	* lib/mkmf.rb (CLEANLIBS): should be under $(arch) directory.

Tue Feb 17 18:02:10 2004  Minero Aoki  <aamine@loveruby.net>

	* ext/strscan/strscan.c: ScanError may be (wrongly) garbage
	  collected. (thanks Gavin Sinclair)

	* ext/strscan/strscan.c: move ::ScanError to StringScanner::Error.
	  ::ScanError is also defined for backward compatibility.

	* ext/strscan/strscan.c: #peep is obsolete, use #peek.

	* ext/strscan/strscan.c: #empty? is obsolete, use #eos?.

	* ext/strscan/strscan.c: #clear is obsolete, use #terminate.

	* ext/strscan/strscan.c: #getbyte is obsolete, use #get_byte.

Tue Feb 17 12:12:47 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* ext/extmk.rb (parse_args): delay expanding $(extout) until invoking
	  make.

	* lib/mkmf.rb (CLEANLIBS): should remove files have specific
	  extensions.

Tue Feb 17 11:33:30 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* lib/rss/rexmlparser.rb: REXML version may be 4 digits.

Tue Feb 17 10:45:59 2004  NAKAMURA Usaku  <usa@ruby-lang.org>

	* ext/syck/rubyext.c (syck_emitter_end_object): takes only one arg.

Tue Feb 17 07:48:21 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* lib/rexml/encodings/SHIFT_JIS: wrong library name.

Tue Feb 17 01:35:28 2004  Tanaka Akira  <akr@m17n.org>

	* eval.c (rb_eval): care that another thread replace NODE_DREGX_ONCE
	  to NODE_LIT.  [ruby-dev:22920]

Tue Feb 17 01:20:57 2004  Minero Aoki  <aamine@loveruby.net>

	* lib/fileutils.rb: new module FileUtils::DryRun.

Mon Feb 16 23:28:14 2004  NAKAMURA, Hiroshi  <nahi@ruby-lang.org>

	* lib/csv.rb: document reduction.  [ruby-core:02429]

	* test/yaml/test_yaml.rb: added 0..1 test with "0".."1" on display.
	  it should be defined that the specification about what kind of Range
	  is supported in ruby's custom type in YAML.

Mon Feb 16 22:22:00 2004  Gavin Sinclair  <gsinclair@soyabean.com.au>

	* lib/generator.rb: corrected doc format

	* lib/rinda/rinda.rb: added documentation (from Hugh Sasse)

	* lib/rinda/tuplespace.rb: ditto

	  [Note: rinda files actually committed Wed Feb 18 07:27:00 2004]

Mon Feb 16 20:28:52 2004  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* bcc32/Makefile.sub: show more warnings. (refering to mingw)

	* bcc32/setup.mak: ditto.

Mon Feb 16 18:35:58 2004  NAKAMURA Usaku  <usa@ruby-lang.org>

	* win32/Makefile.sub (config.status): should create *.pdb on ext/,
	  not .ext/.

	* win32/Makefile.sub (config.status): convert the name of import
	  library.

	* lib/mkmf.rb (create_makefile): now don't need to remove
	  $(TARGET).lib.

Mon Feb 16 15:45:22 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* configure.in: check functions, fork spawnv.

	* io.c (rb_io_s_popen): accept argv not only single command line.

	* process.c (rb_proc_exec_n): export.

	* process.c (rb_check_argv): check if arguments are safe to invoke.

	* process.c (rb_fork): retry to fork.

	* process.c (rb_spawn): spawn child process asynchronously.

	* process.c (rb_f_system): raise an exception if the command could not
	  execute.

	* win32/win32.c (rb_w32_argv_size): count necessary size for joined
	  arguments.

	* win32/win32.c (rb_w32_join_argv): join arguments with quoting.

	* win32/win32.c (rb_w32_pipe_exec, rb_w32_spawn, rb_w32_aspawn):
	  accept program name adding to command line.

Mon Feb 16 15:18:33 2004  Minero Aoki  <aamine@loveruby.net>

	* lib/racc/parser.rb: add note for Racc full package.

Mon Feb 16 15:13:01 2004  Minero Aoki  <aamine@loveruby.net>

	* ext/racc/cparse/README: new file.

	* ext/racc/cparse/MANIFEST: add README.

Mon Feb 16 12:29:10 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* ext/iconv/iconv.c (iconv_s_list): new method Iconv.list
	  (libiconv only).

Mon Feb 16 10:29:52 2004  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* dir.c (CompareImpl): File.fnmatch and Dir.glob get better performance
	  in Win32. This is achived by calling downcase() for single-byte
	  characters. (CharLower() is slower than downcase())

Mon Feb 16 02:14:29 2004  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* bcc32/Makefile.sub: should warn suspicious pointer conversion.

	* bcc32/setup.mak: ditto.

Sun Feb 15 20:56:22 2004  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* dir.c (push_braces): remove wrong const. [ruby-dev:22891]

Sun Feb 15 20:41:15 2004  NAKAMURA, Hiroshi  <nahi@ruby-lang.org>

	* sample/soap/calc/httpd.rb, sample/soap/exchange/httpd.rb,
	  sample/soap/sampleStruct/httpd.rb, sample/wsdl/googleSearch/httpd.rb:
	  use soap/property instead of getopts for configuring DocumentRoot
	  and port# of httpd.  see samplehttpd.conf below.

	* sample/soap/calc/samplehttpd.conf,
	  sample/soap/exchange/samplehttpd.conf,
	  sample/soap/sampleStruct/samplehttpd.conf,
	  sample/wsdl/googleSearch/samplehttpd.conf: added.

Sun Feb 15 19:13:33 2004  Masatoshi SEKI  <m_seki@mva.biglobe.ne.jp>

	* lib/rinda/tuplespace.rb: read(tpl,0), raise RequestExpiredError
	  if not found.

Sun Feb 15 15:48:57 2004  Masaki Suketa  <masaki.suketa@nifty.ne.jp>

	* ext/win32ole/win32ole.c: add IDispatch wrapper in val2variant.
	  Thanks, arton.

Sun Feb 15 15:23:29 2004  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* ruby.h, dir.c (rb_glob): add const.

Sun Feb 15 01:46:05 2004  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* lib/mkmf.rb: absolute path of ruby is assigned to $(RUBY).
	  [ruby-dev:22870]

Sat Feb 14 23:59:11 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* mkconfig.rb: use fileutils.rb instead of ftools.rb.

	* bcc32/Makefile.sub, win32/Makefile.sub (config.h): define
	  STACK_GROW_DIRECTION.

	* bcc32/Makefile.sub (config.h): add newer checks.

	* wince/Makefile.sub (config.h): define NEED_IO_SEEK_BETWEEN_RW.

Sat Feb 14 23:26:27 2004  WATANABE Hirofumi  <eban@ruby-lang.org>

	* lib/un.rb: use OptionParser instead of getopts.

Sat Feb 14 11:28:14 2004  Masatoshi SEKI  <m_seki@mva.biglobe.ne.jp>

	* sample/drb/*: import lib/drb/sample

Sat Feb 14 11:14:12 2004  Masatoshi SEKI  <m_seki@mva.biglobe.ne.jp>

	* lib/drb/drb.rb: add pretty_print, thanks gotoken.

Fri Feb 13 21:51:00 2004  Gavin Sinclair  <gsinclair@soyabean.com.au>

	* lib/fileutils.rb: slighly improved documentation (sync with 1.8)

Fri Feb 13 19:57:01 2004  Kouhei Sutou  <kou@cozmixng.org>

	* test/rss/test_trackback.rb: added tests for TrackBack with RSS
	  2.0.

	* test/rss/common.rb: added methods make RSS 2.0.

	* lib/rss/trackback.rb: TrackBack API is decided.

	* lib/rss/rss.rb: RSS::VERSION 0.0.7 -> 0.0.8.

	* lib/rss/parser.rb, lib/rss/rss.rb: replaced $DEBUG by RSS::DEBUG.

	* lib/rss/2.0.rb: removed RSS 2.0 URI. Because RSS 2.0 doesn't
	  have URI.

Fri Feb 13 14:41:00 2004  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/lib/tk.rb: en-bugged at last commit (Feb 11 23:24:22 2004)

Fri Feb 13 12:26:37 2004  Minero Aoki  <aamine@loveruby.net>

	* test/fileutils/test_fileutils.rb: rescue SystemCallError instead
	  of EINVAL.  File.link may raise EACCES on network file systems.

Fri Feb 13 05:18:58 2004  Minero Aoki  <aamine@loveruby.net>

	* test/fileutils/test_fileutils.rb: File.link raises EINVAL on
	  Win9x. [ruby-dev:22713]

Thu Feb 12 21:49:00 2004  Gavin Sinclair  <gsinclair@soyabean.com.au>

	* lib/ftools.rb: documented

Thu Feb 12 21:19:00 2004  Gavin Sinclair  <gsinclair@soyabean.com.au>

	* lib/base64.rb: added and tidied documentation

Thu Feb 12 20:45:01 2004  Minero Aoki  <aamine@loveruby.net>

	* lib/net/protocol.rb (WriteAdapater#puts): must append "\n" to
	  the string, don't prepend. (ruby-bugs:PR#1280)

Thu Feb 12 20:31:43 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* lib/mkmf.rb (create_tmpsrc): cpp32 of Borland C++ ignores #error
	  directives in DOS line-ending files at all.

Thu Feb 12 15:23:20 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* parse.y (rparen): ignore preceding newlines to right parentheses.
	  (ruby-bugs:PR#1221) [ruby-dev:22858]

Thu Feb 12 14:17:43 2004  WATANABE Hirofumi  <eban@ruby-lang.org>

	* configure.in: set ac_cv_func_link to yes to enable link() on MinGW.
	  [ruby-dev:22241]

Thu Feb 12 13:32:49 2004  NAKAMURA Usaku  <usa@ruby-lang.org>

	* win32/win32.c (link): raise NotImplementedError on Win9X.
	  contributed by Tietew. [ruby-dev:22713]

	* win32/win32.c, win32/win32.h (link): add const.

Thu Feb 12 09:56:19 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* ext/tk/lib/tk.rb (TkComm::tk_split_list): suppress a warning.

Thu Feb 12 02:23:56 2004  Tanaka Akira  <akr@m17n.org>

	* lib/pathname.rb: use assert_raise instead of assert_raises.

	* lib/pp.rb: ditto.

	* lib/time.rb: ditto.

	* lib/tsort.rb: ditto.
	  use TSortHash and TSortArray instead of Hash and Array in test.

Wed Feb 11 23:24:22 2004  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/lib/tk.rb: properly treat a Tcl/Tk's string with escaping
	  special characters.

Tue Feb 10 20:49:07 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* eval.c (method_proc): return bound Proc object.  [ruby-dev:22854]

	* eval.c (rb_mod_define_method): bind method body itself for Method
	  object.

	* node.h (NODE_DMETHOD): deprecated.

	* object.c (rb_class_inherited_p): export.

Tue Feb 10 16:43:50 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* eval.c (umethod_bind): purge unused check.  [ruby-dev:22850]

Tue Feb 10 14:33:08 2004  NAKAMURA Usaku  <usa@ruby-lang.org>

	* string.c (rb_str_match): raise TypeError when both arguments are
	  strings. [ruby-dev:22851]

	* string.c (rb_str_match2): removed.

	* Makefile.in, bcc32/Makefile.sub, win32/Makefile.sub,
	  wince/Makefile.sub (string.c): now not depend on version.h.

Mon Feb  9 17:46:07 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* Makefile.in, bcc32/Makefile.sub, win32/Makefile.sub, configure.in,
	  runruby.rb: run rdoc, test and so on with compiled extension
	  libraries.  [ruby-dev:22688]

	* ext/extmk.rb, lib/mkmf.rb: make extension libraries in separated
	  directory, similar to the actual directory structure.

	* lib/fileutils.rb (FileUtils.copy_file): use the mode of the original
	  file to create new file.

	* lib/rdoc/ri/ri_paths.rb (RI::Paths::SYSDIR): get rid of unexpected
	  influence by envirionment variable.

	* bcc32/configure.bat, win32/configure.bat: add install-doc options.

	* win32/win32.c, win32/win32.h (rb_w32_fstat): fix Borland C runtime
	  bug which returns wrong mode.  [ruby-dev:22846]

Mon Feb  9 16:30:12 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* process.c (detach_process_watcher): return the last status.
	  [ruby-dev:22841]

Sun Feb  8 16:46:08 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* lib/pp.rb (PP::PPMethods::object_address_group): suppress negative
	  sign for higher heap areas.

Sun Feb  8 16:18:27 2004  akira yamada  <akira@ruby-lang.org>

	* test/yaml/test_yaml.rb (YAML_Unit_Tests::test_range_cycle):
	  added tests.

Sun Feb  8 15:51:57 2004  akira yamada  <akira@ruby-lang.org>

	* test/ruby/test_file.rb (TestFile::test_fnmatch): added tests for
	  File.fnmatch. [ruby-dev:22815][ruby-dev:22819]

Sun Feb  8 15:41:45 2004  akira yamada  <akira@ruby-lang.org>

	* test/yaml/test_yaml.rb (YAML_Unit_Tests::test_range_cycle):
	  added tests. [ruby-core:02306] [ruby-core:02311]

Sun Feb  8 14:24:35 2004  Minero Aoki  <aamine@loveruby.net>

	* lib/net/http.rb (HTTP#request): should not overwrite Connection
	  header. (ruby-bugs:PR#1274)

Sun Feb  8 10:11:21 2004  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* dir.c (glob_helper): Dir.glob('**/') did not work. [ruby-dev:22832]

Sun Feb  8 00:29:26 2004  Hirokazu Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* dir.c (fnmatch): File.fnmatch('*?', 'a') should return true.
	  [ruby-dev:22815]

	* dir.c (fnmatch): File.fnmatch('\[1\]' , '[1]') should return true.
	  [ruby-dev:22819]

	* dir.c: Did some styles (no change to behavior)

Sat Feb  7 19:56:11 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* lib/irb/init.rb (IRB.rc_files): yield possible rc file names.

	* lib/irb/input-method.rb (IRB::ReadlineInputMethod::initialize):
	  load and save history automatically.  [ruby-core:02352]

Fri Feb  6 22:48:16 2004  Dave Thomas  <dave@pragprog.com>

	* lib/rdoc/generators/html_generator.rb (gen_url): Support
	  https in RDoc hyperlinks

Fri Feb  6 22:41:22 2004  NAKAMURA, Hiroshi  <nahi@ruby-lang.org>

	* lib/pp.rb (PPInspectTest#test_to_s_with_iv): rollback the previous
	  commit.  [ruby-dev:22813]

Fri Feb  6 22:22:50 2004  NAKAMURA, Hiroshi  <nahi@ruby-lang.org>

	* lib/pp.rb (PPInspectTest#test_to_s_with_iv): remove instance
	  variable which is defined in the test.

Fri Feb  6 18:54:18 2004  akira yamada  <akira@ruby-lang.org>

	* test/ruby/test_proc.rb (TestProc::test_eq): added a
	  test.  [ruby-dev:22599]

Fri Feb  6 18:26:00 2004  akira yamada  <akira@ruby-lang.org>

	* test/ruby/test_proc.rb (TestProc::test_eq): added tests for
	  Proc#==.  [ruby-dev:22592], [ruby-dev:22601]

Fri Feb  6 10:12:06 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* ext/socket/socket.c (bsock_do_not_reverse_lookup): control reverse
	  lookup for every instance.  [ruby-core:02346]

Fri Feb  6 09:15:11 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* lib/irb/extend-command.rb: add irb_help command.  [ruby-talk:91610]

	* lib/irb/cmd/help.rb (IRB::ExtendCommand::Help): show RDoc.

Fri Feb  6 00:48:37 2004  Tanaka Akira  <akr@m17n.org>

	* lib/prettyprint.rb (PrettyPrint#first?): obsoleted.

Thu Feb  5 23:56:55 2004  Tanaka Akira  <akr@m17n.org>

	* lib/prettyprint.rb (PrettyPrint#seplist): added.

	* lib/pp.rb (PPMethods#pp_object): use seplist.
	  (PPMethods#pp_hash): ditto.
	  (Array#pretty_print): ditto.
	  (Struct#pretty_print): ditto.
	  (MatchData#pretty_print): ditto.

	* lib/set.rb (Set#pretty_print): use seplist.

Wed Feb  4 22:39:46 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* file.c (rb_stat_mode): should not sign-expand, so backout.

Wed Feb  4 02:12:06 2004  Tanaka Akira  <akr@m17n.org>

	* file.c (test_l): fix wrong method name in document.
	  (test_S): ditto.
	  (test_b): ditto.
	  (test_c): ditto.
	  (test_suid): ditto.
	  (test_sgid): ditto.
	  (test_sticky): ditto.

Tue Feb  3 22:36:25 2004  Kouhei Sutou  <kou@cozmixng.org>

	* lib/rss/2.0.rb, lib/rss/content.rb, lib/rss/dublincore.rb,
	  lib/rss/rss.rb, lib/rss/syndication.rb: removed warnings.

	* lib/rss/converter.rb: removed handling load error of nkf.

	* test/rss/test_syndication.rb, test/rss/test_trackback.rb,
	  test/rss/test_dublincore.rb, test/rss/test_content.rb: replaced
	  'require "rss/parser"' by 'require "rss/1.0"'.

	* test/rss/test_parser.rb, test/rss/test_accessor.rb: removed
	  'require "rss/parser"'.

Tue Feb  3 11:23:17 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* parse.y (reduce_nodes): remove tail returns.  [ruby-talk:90934]

Tue Feb  3 08:04:57 2004  Tanaka Akira  <akr@m17n.org>

	* lib/pp.rb (Struct#pretty_print_cycle): follow 1.8 style.

Mon Feb  2 22:06:31 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* parse.y (block_append, new_evstr, void_expr0): remove no longer used
	  labels.

Mon Feb  2 18:45:50 2004  WATANABE Hirofumi  <eban@ruby-lang.org>

	* dln.c (dln_load): don't specify RTLD_GLOBAL on Interix,
	  because it caused SEGV when running runner.rb.

Mon Feb  2 01:54:00 2004  Tanaka Akira  <akr@m17n.org>

	* lib/pp.rb (Struct#pretty_print): make it 1.8 style.
	  (Numeric#pretty_print, FalseClass#pretty_print)
	  (TrueClass#pretty_print, Module#pretty_print): fix pp for objects
	  with instance variables.  [ruby-talk:91157]

	* lib/open-uri.rb (URI::Generic#find_proxy): return nil on loopback
	  address.

	* lib/resolv-replace.rb (BasicSocket#send): don't replace because
	  it has no hostname argument.
	  (IPSocket.getaddress): raise SocketError instead of
	  Resolv::ResolvError for errors.
	  (TCPSocket#initialize, UDPSocket#bind, UDPSocket#connect)
	  (SOCKSSocket#initialize): use IPSocket.getaddress instead of
	  Resolv.getaddress.
	  (UDPSocket#send): recognize 3 arguments form.  try all addresses on
	  4 arguments form.

Sun Feb  1 23:00:00 2004  Shigeo Kobayashi  <shigek@ruby-lang.org>

	* ext/bigdecimal.c: Bug in BigDecimal("1e#{n}").add BigDecimal('.5'),n)
	  reported and fixed by Javier Goizueta.

Sun Feb  1 18:21:00 2004  Gavin Sinclair  <gsinclair@soyabean.com.au>

	  From ruby_1_8 branch:
	* lib/test/unit.rb: rearranged documentation for RDoc's sake.
	* lib/matrix.rb: improved documentation.
	* lib/net/http.rb: slight documentation formatting improvement.

Sun Feb  1 05:30:06 2004  Tanaka Akira  <akr@m17n.org>

	* lib/open-uri.rb (URI::Generic#find_proxy): warn HTTP_PROXY.
	 raise an errror on non-http proxy URI.
	 (OpenURI::Buffer#<<): make a tempfile binmode.  [ruby-talk:90793]

Sun Feb  1 00:57:41 2004  Kouhei Sutou  <kou@cozmixng.org>

	* lib/rss/parser.rb (RSS::Parser): added @@default_parser. Used
	  XML parser became selectable.
	* test/rss/test_parser.rb: added tests for
	  RSS::Parser.default_parser.

Sat Jan 31 02:28:15 2004  WATANABE Hirofumi  <eban@ruby-lang.org>

	* configure.in (RPATHFLAG): set to -Wl,-R like NetBSD on Interix.

Sat Jan 31 01:09:41 2004  NAKAMURA, Hiroshi  <nahi@ruby-lang.org>

	* lib/logger.rb: leading 0 padding of timestamp usec part.

Fri Jan 30 18:53:23 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* re.c (KR_REHASH): wrong hash value on sizeof(long) > sizeof(int).

Thu Jan 29 23:11:57 2004  WATANABE Hirofumi  <eban@ruby-lang.org>

	* configure.in (DLEXT2): removed.  Ruby does not treat
	  ".dll" as a extention library anymore.

	* bcc32/Makefile.sub, win32/Makefile.sub, wince/Makefile.sub (DLEXT2):
	  ditto.

	* util.c (mblen): fix overrun.  [ruby-dev:22672]

Thu Jan 29 22:41:53 2004  Dave Thomas  <dave@pragprog.com>

	* lib/rdoc/generators/html_generator.rb: Allow 'link:' in Tidylinks.
	  THis means you can write "see f1[link:files/f1_rb.html]".

Thu Jan 29 22:24:47 2004  NAKAMURA, Hiroshi  <nahi@ruby-lang.org>

	* sample/openssl/gen_csr.rb: follow OpenSSL::X509::Name change.
	  ASN.1 type of subject DN elements were wrong.

Thu Jan 29 22:19:51 2004  NAKAMURA, Hiroshi  <nahi@ruby-lang.org>

	* test/*: remove $: trick.  [ruby-dev:22763]  use test/runner.rb to
	  run test.

Thu Jan 29 19:28:16 2004  Minero Aoki  <aamine@loveruby.net>

	* lib/net/http.rb (Request#initialize): reject only when a path is
	  empty. [ruby-dev:22771]

Thu Jan 29 18:54:08 2004  H.Yamamoto  <ocean@m2.ccsnet.ne.jp>

	* dir.c (glob_helper): infinite loop bug in win32 code.
	  [ruby-dev:22770]

Thu Jan 29 17:03:49 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* dir.c: merge tuning from H.Yamamoto <ocean@m2.ccsnet.ne.jp>.
	  [ruby-dev:22761]

Thu Jan 29 11:32:14 2004  NAKAMURA, Hiroshi  <nahi@ruby-lang.org>

	* test/rss/test_*: do $: trick while searching a module in the current
	  directory.

	* test/xsd/test_xmlschemaparser.rb, test/wsdl/test_emptycomplextype.rb,
	  test/soap/helloworld/test_helloworld.rb,
	  test/soap/calc/{test_calc.rb,test_calc2.rb}: do File.expand_path
	  before using __FILE__.

	* test/yaml/test_yaml.rb: assert_equals -> assert_equal.

Thu Jan 29 01:56:02 2004  why the lucky stiff  <why@ruby-lang.org>

	* ext/syck/rubyext.c: usec round-tripping skew. [ruby-core:2305]

	* lib/yaml/rubytypes.rb: character Range now round-trips. [ruby-core:2306]

	* test/yaml/test_yaml.rb: add Time and Range tests.

Thu Jan 29 00:00:46 2004  Kouhei Sutou  <kou@cozmixng.org>

	* lib/rss: rss/parser.rb is always required.

Wed Jan 28 15:09:14 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* test/rss/*.rb: remove "test/" prefix.

Wed Jan 28 13:07:02 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* ext/iconv/extconf.rb: include iconv.h for libiconv.  [ruby-dev:22715]

Wed Jan 28 12:43:07 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* lib/rss: rss library imported. [ruby-dev:22726]

Wed Jan 28 04:29:41 2004  Eric Schwartz  <emschwar@fc.hp.com>

	* lib/cgi/session.rb: use LOCK_SH to read, and a few other
	  improvements.  [ruby-core:02328]

Tue Jan 27 15:00:14 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* misc/ruby-mode.el: better support for general delimited
	  strings.  [ruby-dev:22695]

Tue Jan 27 11:04:40 2004  FUKUMOTO Atsushi  <fukumoto@nospam.imasy.or.jp>

	* ext/socket/socket.c (s_recvfrom): sending length should be an
	  invariant while retrying on EAGAIN.  [ruby-talk:89962]

Tue Jan 27 10:31:28 2004  NAKAMURA Usaku  <usa@ruby-lang.org>

	* ext/win32ole/win32ole.c (set_argv): fix condition.

Tue Jan 27 02:26:31 2004  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* lib/webrick/httputils.rb (WEBrick:HTTPUtils::parse_header):
	  refine regex for header-name.

Mon Jan 26 22:53:04 2004  Dave Thomas  <dave@pragprog.com>

	* io.c: Remove documentation references to $defout.

Mon Jan 26 14:41:46 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* lib/weakref.rb (WeakRef::initialize): set up @__id before
	  calling "super".

	* lib/delegate.rb (Delegator::initialize): preserve
	  singleton_method_added method [ruby-dev:22685]

	* lib/delegate.rb (Delegator::initialize): use Kernel::raise
	  instead of mere raise.  [ruby-dev:22681]

Mon Jan 26 12:45:23 2004  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tcltklib/tcltklib.c: define CONST84 when TCL_MAJOR_VERSION == 7

Mon Jan 26 11:30:58 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* ext/extmk.rb: Makefiles should depend on also rbconfig.rb.
	  (ruby-bugs:PR#1256)

	* ext/win32ole/win32ole.c (set_argv): set real arguments to
	  WIN32OLE::ARGV.  [ruby-list:39073]

Sun Jan 25 18:25:26 2004  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* ext/openssl/ossl_x509name.c (ossl_x509name_add_entry): third
	  argument become optional.

	* ext/openssl/ossl_x509name.c (ossl_x509name_initialize): ditto.

	* ext/openssl/ossl_x509name.c (Init_x509name): emailAddress and
	  domainComponent should be IA5String.

Sun Jan 25 01:45:38 2004  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* lib/webrick/httpserver.rb (WEBrick::HTTPServer#run): support
	  virtual host.

	* lib/webrick/httpserver.rb (WEBrick::HTTPServer#virtual_host): add
	  new method to register virtual hosting server.

	* lib/webrick/httpserver.rb (WEBrick::HTTPServer#lookup_server): add
	  new method to lookup virtual hosting server.

Sat Jan 24 13:06:26 2004  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* ext/openssl/ossl_x509hame.c (ossl_x509name_initialize): change
	  second argument. it expected to be a Hash not an Integer.

	* ext/openssl/ossl_x509name.c (ossl_x509name_add_entry): add new
	  function for OpenSSL::X509::Name#add_entry.

	* ext/openssl/ossl_x509name.c (Init_ossl_x509name): add constants
	  OpenSSL::X509::Name::DEFAULT_OBJECT_TYPE and OBJECT_TYPE_TEMPLATE.

	* ext/openssl/lib/openssl/x509.rb (OpenSSL::X509::Name#initialize):
	  second argument takes OBJECT_TYPE_TEMPLATE by default.

Fri Jan 23 02:26:30 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* pack.c (num2i32): pack should not raise RangeError.
	  [ruby-dev:22654]

	* pack.c (pack_pack): do not auto convert nil to zero.

Thu Jan 22 22:54:53 2004  Shugo Maeda  <shugo@ruby-lang.org>

	* lib/net/imap.rb (BEG_REGEXP): allow 8-bit characters in quoted
	  strings for Novell GroupWise Internet Agent.

	* lib/net/imap.rb (DATA_REGEXP): ditto.

Thu Jan 22 18:35:49 2004  WATANABE Hirofumi  <eban@ruby-lang.org>

	* lib/e2mmap.rb (VERSION): remove unnecessary version checking.

Thu Jan 22 16:21:02 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* parse.y (string_content): reset lexical states at the beginning of
	  string contents.  [ruby-list:39061]

Thu Jan 22 08:08:50 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* parse.y (opt_rescue): use NODE_ERRINFO() instead of
	  NODE_GVAR("$!"), to avoid confusion from variable aliasing.
	  [ruby-talk:90074]

	* version.c (Init_version): remove obsolete constants VERSION
	  etc.  [ruby-dev:22643]

Thu Jan 22 01:46:32 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* parse.y (newline_node): do not use NODE_NEWLINE node anymore,
	  use NEWLINE flag instead.

Thu Jan 22 01:12:12 2004  Siena.  <siena@faculty.chiba-u.jp>

	* missing/os2.c (chdir, getcwd):
	  use _chdir2 and _getcwd2 supporting multiple drives in OS/2 with EMX.

Thu Jan 22 00:33:52 2004  Siena.  <siena@faculty.chiba-u.jp>

	* configure.in: check availability of link(). [ruby-dev:22237]
	* file.c (rb_file_s_link): raise an exception when link() is unavailable.
	* missing/os2.c (link): removed. File#link isn't supported.
	* bcc32/Makefile.sub: define HAVE_LINK to enable link(). [ruby-dev:22241]
	* win32/Makefile.sub: ditto.

Thu Jan 22 00:26:25 2004  Siena.  <siena@faculty.chiba-u.jp>

	* ChangeLog: typo: RUBY_MBCHAR_MAX was RUBY_MBCHAR_MAXSIZE.

Thu Jan 22 00:12:51 2004  Siena.  <siena@faculty.chiba-u.jp>

	* defines.h: define RUBY_MBCHAR_MAX instead of MB_CUR_MAX.
	* dir.c (Next, emx_mblen): use RUBY_MBCHAR_MAX for mblen().
	* file.c (CharNext): ditto.
	* ruby.c (translate_char): ditto.
	* util.c (__crt0_glob_function): ditto.

Thu Jan 22 00:10:01 2004  Dave Thomas  <dave@pragprog.com>

	* lib/base64.rb: :nodoc: the Deprecated module

Wed Jan 21 23:52:39 2004  WATANABE Hirofumi  <eban@ruby-lang.org>

	* configure.in: Interix(SFU) support.

Wed Jan 21 23:03:45 2004  Masatoshi SEKI  <m_seki@mva.biglobe.ne.jp>

	* lib/drb/drb.rb: remove O_NONBLOCK, thanks \ay
	* lib/drb/extserv.rb: typo

Wed Jan 21 17:57:56 2004  Shugo Maeda  <shugo@ruby-lang.org>

	* lib/net/imap.rb (envelope): allow NIL.
	* lib/net/imap.rb (body): ditto.
	* lib/net/imap.rb (number): ditto.
	* lib/net/imap.rb (ensure_nz_number): show a detailed error
	  message.

Wed Jan 21 16:44:15 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* lib/mkmf.rb (merge_libs): squeeze successive same libraries.
	  [ruby-dev:22652]

Wed Jan 21 16:10:36 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* lib/base64.rb: enclosed in a module.  [ruby-core:02285]

Wed Jan 21 16:01:26 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* ext/digest/rmd160/extconf.rb: have_library appends found library.

Wed Jan 21 11:36:00 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* ext/socket/socket.c (sock_gethostbyname): returns host if
	  ai_canonname is NULL. (ruby-bugs PR#1243)

	* parse.y (block_append): update nd_end for "real" head node.
	  [ruby-list:39058]

Tue Jan 20 14:48:28 2004  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* ext/openssl/extconf.rb: should check <openssl/conf_api.h> instead
	  of OPENSSL_VERSION_NUMBER. [ruby-list:39056]

Tue Jan 20 14:43:17 2004  Dave Thomas  <dave@pragprog.com>

	* lib/base64.rb: Add RDoc

Tue Jan 20 14:25:51 2004  Dave Thomas  <dave@pragprog.com>

	* lib/abbrev.rb: Add RDoc

Tue Jan 20 13:22:39 2004  Dave Thomas  <dave@pragprog.com>

	* lib/rdoc/generators/html_generator.rb: Document aliases at
	  top-most level.

	* lib/English.rb: Document English.rb.

Tue Jan 20 04:41:58 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* test/ruby/test_marshal.rb (MarshalTestLib::test_exception): test
	  for [ruby-dev:22604].

	* test/ruby/test_marshal.rb (MarshalTestLibtest_singleton): test
	  for [ruby-dev:22588].

Tue Jan 20 02:38:13 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* marshal.c (w_class): should not dump singleton class.
	  [ruby-dev:22631]

Tue Jan 20 02:49:22 2004  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* ext/openssl/extconf.rb: add check for OpenSSL version.
	  [ruby-list:39054]

Mon Jan 19 23:56:20 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* error.c (name_err_mesg_to_str): inverted condition for result of
	  inspection.  [ruby-dev:22628]

Mon Jan 19 22:24:28 2004  WATANABE Hirofumi  <eban@ruby-lang.org>

	* sample/exyacc.rb: escape '}' to avoid warning.

	* lib/rdoc/parsers/parse_c.rb: escape '{' and '}' to avoid warnings.

Mon Jan 19 21:28:06 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* ext/digest/defs.h, win32/win3.c, win32/win32.h, file.c: remove
	  useless casts for Borland C.

Mon Jan 19 17:39:38 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* error.c (NameError::message): internal use only.

	* eval.c (rb_method_missing): use hidden constant.

Mon Jan 19 16:30:53 2004  akira yamada  <akira@ruby-lang.org>

	* test/ruby/test_time.rb: added tests for [ruby-dev:22614] and
	  [ruby-dev:22617].

Mon Jan 19 13:09:21 2004  NAKAMURA Usaku  <usa@ruby-lang.org>

	* ext/extmk.rb, win32/Makefile.sub, win32/configure.bat,
	  win32/setup.mak: --with-static-linked-ext support on mswin32.

Mon Jan 19 06:49:07 2004  Tadayoshi Funaba  <tadf@dotrb.org>

	* lib/date.rb: zone was wrong when it was behind UTC.
	  Thanks Mark J. Reed.

	* lib/date/format.rb: %z is now always replaced by four digits
	  with a leading plus or minus sign.

	* sample/cal.rb: added a class, anyway.

Mon Jan 19 01:08:39 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* class.c, error.c, eval.c, intern.h, object.c, variable.c:
	  do not set path if it is a singleton class.  [ruby-dev:22588]

	* lib/cgi.rb (CGI::QueryExtension): give extended string, not a
	  delegater object.

Sun Jan 18 23:59:44 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* ext/iconv/charset_alias.rb: prefer us_EN locale encodings or
	  former.  [ruby-dev:22609]

	* ext/iconv/iconv.c (iconv_create): raise InvalidEncoding
	  exception when EINVAL.

Sun Jan 18 23:16:34 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* class.c, error.c, file.c, io.c, numeric.c, object.c, re.c, struct.c,
	  time.c: marked init_copy functions nodoc.

Sun Jan 18 20:47:35 2004  WATANABE Hirofumi  <eban@ruby-lang.org>

	* ruby.c: use translate_char() on Cygwin.

Sun Jan 18 20:00:16 2004  NAKAMURA, Hiroshi  <nahi@ruby-lang.org>

	* lib/soap/wsdlDriver.rb, lib/wsdl/soap/operation.rb: add support of
	  "parts" attribute of soap:body element in WSDL.

	* lib/wsdl/xmlSchema/schema.rb: friendly warning message for
	  simpleType element which is not supported for now.

	* test/wsdl/soap/{soapbodyparts.wsdl,test_soapbodyparts.wsdl}: new
	  files.

Sun Jan 18 16:46:48 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* time.c (time_overflow_p): should return results.  [ruby-dev:22614]

Sun Jan 18 12:07:24 2004  Siena.  <siena@faculty.chiba-u.jp>

	* test/ruby/test_time.rb: new test case to test Time#[+-].

	* time.c (time_plus, time_minus): fix RangeError for a negative
	  argument in environments whose time_t is unsigned. [ruby-dev:22608]

Sun Jan 18 02:33:26 2004  WATANABE Hirofumi  <eban@ruby-lang.org>

	* defines.h (_WIN32): undef _WIN32 on Cygwin before defining DOSISH.

Sun Jan 18 00:23:55 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* marshal.c (class2path): check anonymous class/module before
	  checking referable, and allow singleton classes.

Sat Jan 17 23:58:51 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* error.c (NameError::Message): new class for lazy evaluation of
	  message to ensure replaced before marshalling.  [ruby-dev:22604]

	* eval.c (rb_method_missing): use NameError::Message.

Sat Jan 17 21:49:50 2004  NAKAMURA Usaku  <usa@ruby-lang.org>

	* lib/time.rb (test_rfc2822, test_rfc3339, test_encode_xmlschema):
	  should not expect that all platforms handle negative time_t value.

Fri Jan 16 23:53:09 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* eval.c (proc_eq): compare also arguments and environment
	  (including local variables).  [ruby-dev:22590]

Fri Jan 16 14:33:35 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* marshal.c (class2path): get class path and check referable.
	  [ruby-dev:22588]

Thu Jan 15 12:58:26 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* io.c (argf_read): do not append EOF.  (ruby-bugs-ja:PR#585)

	* io.c (rb_io_fwrite): ad-hockery hack to get rid of HP-UX stdio
	  weird behavior.  [ruby-dev:22424]

Wed Jan 14 21:13:06 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* test/inlinetest.rb (InlineTest::eval_part): eval under the top
	  level environment.

Wed Jan 14 17:54:17 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* test/inlinetest.rb (InlineTest::loadtest): require instead of
	  load, to get rid of multiple loading.

Wed Jan 14 13:30:52 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* ext/iconv/extconf.rb: wrapper iconv.rb is dependent on platform.

Wed Jan 14 09:32:02 2004  NAKAMURA Usaku  <usa@ruby-lang.org>

	* MANIFEST: add test/net/test_httpheader.rb. (commit miss?)

Wed Jan 14 00:58:35 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (Init_Proc): move SystemStackError from under
	  StandardError to Exception.  [ruby-talk:89782]

Tue Jan 13 18:03:02 2004  Ian Macdonald  <ian@caliban.org>

	* file.c (rb_stat_wr, rb_stat_ww): New functions
	  implementing new methods (File::Stat#world_readable?,
	  File::Stat#world_writable?).

Tue Jan 13 16:53:25 2004  why the lucky stiff  <why@ruby-lang.org>

	* ext/syck/rubyext.c: omission of Date library code caused
	  test suite failure. [ruby-core:2251]

Tue Jan 13 16:50:03 2004  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/lib/tk.rb: use $0 as the default application class name.

Tue Jan 13 14:48:00 2004  Ian Macdonald  <ian@caliban.org>

	* lib/pathname.rb: New methods (Pathname#world_readable?,
	  Pathname#world_writable?).

Tue Jan 13 14:48:01 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* parse.y (primary): allow no "when" case. [ruby-dev:22578]

	* ruby.h (rb_class_of): reduce branch. [ruby-dev:22577]

	* ruby.h (rb_type): ditto.

Tue Jan 13 14:26:59 2004  Kazuhiro NISHIYAMA  <zn@mbf.nifty.com>

	* lib/test/unit/ui/testrunnerutilities.rb (TestRunnerUtilities):
	  moved run method which allows output level.  [ruby-dev:22554]

Tue Jan 13 13:04:24 2004  NAKAMURA, Hiroshi  <nahi@ruby-lang.org>

	* test/test_*.rb: Pathname#parent -> Pathname#dirname.

Tue Jan 13 11:38:58 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* test/yaml/test_yaml.rb (YAML_Unit_Tests::test_spec_type_{int,float}):
	  fix syntax error.

Tue Jan 13 07:52:40 2004  why the lucky stiff  <why@ruby-lang.org>

	* ext/syck/bytecode.c: turn off default implicit typing.

	* ext/syck/implicit.c: detect base60 integers.

	* ext/syck/rubyext.c: handle base60, as well as hex and octal
	  with commas.  implicit typing of ruby symbols.

	* test/yaml/test_yaml.rb: add test.

Tue Jan 13 04:29:52 2004  Dave Thomas  <dave@pragprog.com>

	* lib/rdoc/ri/ri_driver.rb (RiDriver::report_method_stuff):
	  Show fully-qualified class names in class list.

Tue Jan 13 01:24:17 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* file.c (test_wr): Rdoc fix.  [ruby-core:02225]

Tue Jan 13 01:04:37 2004  Dave Thomas  <dave@pragprog.com>

	* lib/rdoc/ri/ri_paths.rb (RI::Paths): First attempt at
	  incorporating DESTDIR in the rdoc installation.

Mon Jan 12 23:26:21 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* parse.y (primary): fix position after FCALL.  [ruby-dev:22574]

Mon Jan 12 18:00:11 2004  Ian Macdonald  <ian@caliban.org>

	* file.c (test_wr, test_ww): New functions implementing new
	  methods (File::world_readable?, File::world_writable?).

	* file.c (S_IRUGO, S_IGUGO): New macros.

Mon Jan 12 12:07:22 2004  Dave Thomas  <dave@pragprog.com>

	* lib/rdoc/parsers/parse_c.rb (RDoc::C_Parser::do_methods):
	  Someone changed the "// in eval.c" comments to "/*...*/" style,
	  so the parsing of the source file name broke.

	* object.c: Remove spurious space in TrueClass documentation.

	* lib/rdoc/parsers/parse_c.rb (RDoc::C_Parser::find_body): Fix
	  bad regexp: if the code before a documented method contained
	  a comment that wasn't terminated by whitespace, that comment
	  and all intervening code was included in the following
	  method's documentation.

	* lib/rdoc/ri/ri_formatter.rb (RI::HtmlFormatter::break_to_newline):
	  HTML formats need explicit line breaks.

Mon Jan 12 02:24:07 2004  Dave Thomas  <dave@pragprog.com>

	* lib/rdoc/ri/ri_formatter.rb (RI::HtmlFormatter): Add HTML
	  generation support to ri (Elliot Hughes)

Sun Jan 11 23:54:41 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* env.h (ruby_frame, ruby_scope, ruby_in_eval, ruby_class,
	  ruby_dyna_vars): export.  [ruby-dev:22566]

Sun Jan 11 02:35:53 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* ext/socket/socket.c (make_hostent): a bug in brace position.

	* configure.in: install rdoc by default. if you do not want to
	  install rdoc, specify --disable-install-doc.

Sun Jan 11 02:07:47 2004  Dave Thomas  <dave@pragprog.com>

	* lib/rdoc/ri/ri_options.rb (RI::Options::OptionList::OptionList):
	  Also accept command line options via the 'RI' environment variable.

Sat Jan 10 21:27:41 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (eval): need to add message delimiter. [ruby-dev:22561]

Sat Jan 10 01:54:50 2004  Eric Sunshine  <sunshine@sunshineco.com>

	* defines.h (__NeXT__): Ensure that all standard S_IRUSR, S_IWGRP,
	  S_IRWXO, etc. macros are defined since future code might require
	  them (even though present code only requires a subset).

	* defines.h (__NeXT__): Bug fix: WORDS_BIGENDIAN was not being set
	  correctly on Rhapsody when -arch compiler flag was used (via
	  configure's --enable-fat-binary option).

Sat Jan 10 23:01:41 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* configure.in (LIBPATHFLAG, RPATHFLAG): enclose paths with single
	  quotes.  [ruby-dev:22564]

	* lib/mkmf.rb (libpathflag): do not enclose with quotes always.

	* {bcc32,win32,wince}/Makefile.sub (LIBPATHFLAG): quoted.

Sat Jan 10 22:46:18 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* dir.c (dir_inspect): new method, Dir#inspect.  [ruby-dev:22562]

Fri Jan  9 17:36:51 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* ext/socket/socket.c (make_hostent): getaddrinfo(3) on BSD do not
	  fill ai_canonname if serv is not supplied.  (ruby-bugs PR#1243)

Fri Jan  9 13:14:59 2004  NAKAMURA, Hiroshi  <nahi@ruby-lang.org>

	* lib/test/unit/collector/dir.rb: do not ignore exceptions(LoadError
	  and SystemExitError) while loading a testcase.  smell of bug.

	* test/testunit/collector/test_dir.rb: add new test of the LoadError.

	* test/drb/{test_drbssl.rb,test_drbunix.rb}: do not define testcase if
	  openssl is not installed.

	* test/testunit/collector/test_dir.rb: assert_raises -> assert_raise.

Fri Jan  9 11:52:16 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* rubysig.h: <errno.h> is needed to use errno which may be a macro.

Fri Jan  9 11:20:24 2004  Siena.  <siena@faculty.chiba-u.jp>

	* ext/extmk.rb (extmake): should not reduce necessary libraries.
	  [ruby-dev:22440]

	* lib/mkmf.rb (merge_libs): merge libraries according to
	  dependency.

Fri Jan  9 10:05:23 2004  Siena.  <siena@faculty.chiba-u.jp>

	* lib/mkmf.rb (libpathflag): use single quotes.  [ruby-dev:22440]

Thu Jan  8 23:49:21 2004  WATANABE Hirofumi  <eban@ruby-lang.org>

	* configure.in (RDOCTARGET): new macro.  if you want to install
	  rdoc documentation, you need to run configure with
	  --enable-install-doc.

Thu Jan  8 21:17:43 2004  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* ext/openssl/ossl_pkey.c (ossl_pkey_to_der): removed; it returns
	  public key only.

	* ext/openssl/ossl_pkey_dh.c (ossl_dh_to_der): new function for
	  OpenSSL::PKey::DH#to_der.

	* ext/openssl/ossl_pkey_dsa.c (ossl_dsa_to_der): new function for
	  OpenSSL::PKey::DSA#to_der.

	* ext/openssl/ossl_pkey_rsa.c (ossl_rsa_to_der): new function for
	  OpenSSL::PKey::RSA#to_der.

Thu Jan  8 18:25:29 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* dir.c (glob_helper): should not recurse in exceptional status.

Thu Jan  8 16:51:04 2004  NAKAMURA, Hiroshi  <nahi@ruby-lang.org>

	* test/wsdl/datetime/test_datetime.rb: fixed a stupid testcase which
	  dumps "E" at month-end.

Thu Jan  8 11:20:01 2004  WATANABE Hirofumi  <eban@ruby-lang.org>

	* eval.c, object.c, process.c, re.c: don't use C++ style comments.

Thu Jan  8 08:46:14 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* ext/syck/rubyext.c (yaml_org_handler): lazy-load Date for
	  static-ext.

Thu Jan  8 07:06:30 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* ext/extmk.rb: preserve order in Setup.  [ruby-dev:22503]

	* ext/extmk.rb: move dependent libraries just after depended
	  libraries.

	* ext/digest/*/extconf.rb: depend on digest.

Thu Jan  8 04:36:17 2004  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* lib/webrick/cgi.rb (WEBrick::CGI#initialize): should create
	  @config[:Logger] if it was not given.

Wed Jan  7 22:28:12 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* dir.c (glob_helper): fix memory leak.

Wed Jan  7 21:15:07 2004  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* sample/webrick/*: new files.

	* MANIFEST: add sample/webrick/*

Wed Jan  7 20:51:51 2004  Minero Aoki  <aamine@loveruby.net>

	* test/net/test_httpheader.rb: new file.

	* MANIFEST: add test/net/test_httpheader.rb.

Wed Jan  7 20:42:06 2004  Minero Aoki  <aamine@loveruby.net>

	* lib/net/http.rb (HTTPHeader#content_length): should return nil
	  unless header exists. [ruby-dev:22519]

Wed Jan  7 14:26:05 2004  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/lib/tk.rb (TkPanedWindow): use epath for embedded windows.

	* ext/tk/lib/tktext.rb: use epath for embedded windows.

	* ext/tk/lib/tkcanvas.rb: use epath for window items.

Wed Jan  7 14:24:04 2004  NAKAMURA, Hiroshi  <nahi@ruby-lang.org>

	* lib/soap/{attachment.rb,mimemessage.rb}: added from soap4r/1.5.2.

Wed Jan  7 13:00:18 2004  Dave Thomas  <dave@pragprog.com>

	* lib/rdoc/ri/ri_driver.rb: Fix problem where ri was
	  being too eager to find matches of ambiguous method
	  names (such as "ri Thread.join" would return both
	  Thread.join and ThreadsWait.join)

Wed Jan  7 12:35:41 2004  NAKAMURA, Hiroshi  <nahi@ruby-lang.org>

	* lib/debug.rb: revert command parse regexps.  [ruby-list:39014] by
	  Shirai,Kaoru.

Wed Jan  7 08:21:04 2004  Dave Thomas  <dave@pragprog.com>

	* lib/rdoc/parsers/parserfactory.rb: Check for shebang
	  line in files that would otherwise be treated as
	  plain text.

Tue Jan  6 22:13:34 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (rb_mod_modfunc): should break if m has no super class.
	  [ruby-dev:22498]

Tue Jan  6 21:51:37 2004  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* io.c (fptr_finalize): should save errno just after failure.
	  [ruby-dev:22492]

Tue Jan  6 20:51:10 2004  NAKAMURA, Hiroshi  <nahi@ruby-lang.org>

	* lib/logger.rb(Logger#msg2str): no special treatment for the object
	  which responds to :to_str.

	* lib/logger.rb(LogDevice#initialize): remove type checking if the
	  given object is a String.  Kernel.open handles it correctly.

	* test/logger/test_logger.rb: follow above change (ArgumentError ->
	  TypeError.)

Tue Jan  6 14:53:14 2004  Dave Thomas  <dave@pragprog.com>

	* bin/ri: split out the display side, making it pluggable. Added
	  new ri_driver and ri_display files in lib/rdoc/ri.

Tue Jan  6 11:29:43 2004  NAKAMURA, Hiroshi  <nahi@ruby-lang.org>

	* test/inlinetest.rb, test/{test_generator.rb,test_ipaddr.rb,
	  test_pathname.rb,test_pp.rb,test_prettyprint.rb,test_set.rb,
	  test_time.rb,test_tsort.rb: added.

Tue Jan  6 09:38:27 2004  NAKAMURA, Hiroshi  <nahi@ruby-lang.org>

	* import soap4r/1.5.2;

	* lib/soap/{attachment.rb,baseData.rb,encodingstyle/soapHandler.rb}:
	  introduce SOAPExternalReference class as a referenct to SOAPEnvelope
	  external content.

	* lib/soap/{attachment.rb,mimemessage.rb}: great SwA (SOAP messages
	  with Attachments) support code by Jamie Herre.

	* lib/soap/{element.rb,marshal.rb,parser.rb,processor.rb,
	  streamHandler.rb,wsdlDriver.rb}: SwA support.

	* lib/soap/rpc/{cgistub.rb,driver.rb,element.rb,proxy.rb,router.rb,
	  soaplet.rb}: SwA support and refactoring.

	* lib/soap/generator.rb, lib/soap/mapping/mapping.rb: follow
	  SOAPReference#initialize signature change.

	* lib/soap/mapping/factory.rb: deleted unused methods.

	* lib/soap/mapping/rubytypeFactory.rb: do no ignore case while xsi:type
	  string <-> Ruby class name matching.

	* lib/xsd/datatypes.rb: check the smallest positive non-zero
	  single-precision float exactly instead of packing with "f".
	  [ruby-talk:88822]

	* test/soap/test_basetype.rb, test/xsd/test_xsd.rb: use 1.402e-45, not
	  1.4e-45.  1.4e-45 is smaller than 2 ** -149...

	* test/soap/test_basetype.rb, test/soap/marshal/test_marshal.rb,
	  test/xsd/test_xsd.rb: use "(-1.0 / (1.0 / 0.0))" instead of "-0.0".

	* test/soap/test_streamhandler.rb: revert to the previous test that
	  warns "basic_auth unsupported under net/http".

Tue Jan  6 06:37:53 2004  Dave Thomas  <dave@pragprog.com>

	* bin/rdoc: Add --ri-system switch

	* lib/.document: Update with list of files that seem to have
	  documentation

	* lib/test/unit.rb: Reorder comment to make it RDoc friendly.

	* Makefile.in: add install-nodoc target, and make it
	  generate RDoc on default install.

	* lib/rdoc/ri/ri_options.rb (RI::Options::parse): Add
	  --doc-dir option to ri.

Tue Jan  6 00:04:40 2004  Dave Thomas  <dave@pragprog.com>

	* lib/rdoc/parsers/parse_rb.rb (RDoc::RubyParser::parse_method_or_yield_parameters):
	  fix parsing if there are braces in a method parameter list

Tue Jan  6 01:01:04 2004  NAKAMURA Usaku  <usa@ruby-lang.org>

	* win32/dir.h, win32/win32.c: fix patch miss.

	* win32/Makefile.sub: fix file dependency.

Mon Jan  5 20:32:00 2004  Gavin Sinclair  <gsinclair@soyabean.com.au>

	* lib/logger.rb: enhanced documentation.

Mon Jan  5 18:58:47 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* dir.c: merge tuning from H.Yamamoto <ocean@m2.ccsnet.ne.jp>.
	  [ruby-dev:22486]

	* pack.c (pack_unpack): unpack requires big endian offet (OFF16B
	  and OFF32B).  The patch is from Minero Aoki in [ruby-dev:22489]

	* pack.c (OFF16B): add big-endian offset again.

Mon Jan  5 03:00:53 2004  Minero Aoki  <aamine@loveruby.net>

	* test/ruby/test_pack.rb: new test test_unpack_N.

Mon Jan  5 01:47:53 2004  NAKAMURA Usaku  <usa@ruby-lang.org>

	* lib/mkmf.rb (create_makefile): remove duplicated object files
	  from $objs on DOSISH platforms.

Sat Jan  3 02:44:48 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* rubysig.h (TRAP_END): preserve errno before switching context.
	  [ruby-core:02137]

Sat Jan  3 01:18:08 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* dir.c: merge tuning from H.Yamamoto <ocean@m2.ccsnet.ne.jp>.
	  [ruby-dev:22476]

Fri Jan  2 14:54:11 2004  Dave Thomas  <dave@pragprog.com>

	* bin/ri: Add new --classes option, and arrange for
	  help messages to be paged too.

	* bin/rdoc: Add statistics.

	* process.c: (MG) Added Process documentation

	* lib/rdoc/ri/ri_formatter.rb (RI::AttributeFormatter::wrap):
	  Fix problem with labels not displaying in RI labeled
	  lists using BS and ANSI modes.

Fri Jan  2 01:50:13 2004  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* io.c (argf_eof): ARGF.eof? should not have any side effect.
	  [ruby-dev:22469]

Thu Jan  1 09:03:20 2004  Dave Thomas  <dave@pragprog.com>

	* bin/ri (report_class_stuff): Fix problem with ambiguous nested
	  classes not matching.

Wed Dec 31 17:25:17 2003  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* io.c (argf_each_byte): should return self.  [ruby-dev:22465]

Wed Dec 31 15:05:00 2003  Gavin Sinclair  <gsinclair@soyabean.com.au>

	* lib/pathname.rb: Corrected small coding error.

Wed Dec 31 15:00:00 2003  Gavin Sinclair  <gsinclair@soyabean.com.au>

	* lib/pathname.rb: Completed documentation.

Wed Dec 31 11:20:34 2003  Dave Thomas  <dave@pragprog.com>

	* lib/rdoc/parsers/parse_c.rb (RDoc::C_Parser::do_methods): Make
	  file referenced in "// in sss.c" relative to current file.

Wed Dec 31 11:17:37 2003  Dave Thomas  <dave@pragprog.com>

	* lib/rdoc/generators/html_generator.rb: Fix problem when
	  a public method was aliased, but the alias is then
	  made private, and hence doesn't appear in RDoc output.

Wed Dec 31 01:33:05 2003  Dave Thomas  <dave@pragprog.com>

	* array.c, error.c, eval.c, io.c, prec.c, range.c, re.c,
	  string.c, time.c: Add RDoc for Kernel functions, and tidy.

Tue Dec 30 19:39:14 2003  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* io.c (rb_f_readline): should raise EOFError at the end of
	  files.  [ruby-dev:22458]

	* io.c (argf_read): should concatenate input files when length
	  argument is nil. [ruby-dev:22450]

	* io.c (argf_read): should update supplied string buffer (2nd
	  argument) even when IO#read is called multiple times.

	* io.c: should initialize lineno by zero. [ruby-dev:22460]

Tue Dec 30 12:30:30 2003  Dave Thomas  <dave@pragprog.com>

	* lib/rdoc/code_objects.rb (RDoc::Context::find_symbol): If a
	  class and a method have the same name, finding Xxx.abc was trying
	  to find 'abc' in method 'Xxx', not class 'Xxx'.

Tue Dec 30 08:32:32 2003  Dave Thomas  <dave@pragprog.com>

	* lib/rdoc/parsers/parse_rb.rb (RDoc::RubyParser::parse_method):
	  Handle undoing nsting of yield parameters correctly for:

	    def each_entry(&b) Dir.foreach(@path) {|f| yield P.new(f) } end

Tue Dec 30 07:30:00 2003  Gavin Sinclair  <gsinclair@soyabean.com.au>

	* lib/pathname.rb: Added documentation.

Mon Dec 29 20:08:17 2003  Minero Aoki  <aamine@loveruby.net>

	* lib/net/http.rb (GenericRequest#initialize): check if path
	  begins with '/'.

	* lib/net/http.rb: def m( arg ) -> def m(arg)

Mon Dec 29 12:51:02 2003  Dave Thomas  <dave@pragprog.com>

	* eval.c: Add RDoc for Kernel global functions.

Mon Dec 29 11:00:16 2003  Dave Thomas  <dave@pragprog.com>

	* array.c: Tidy up RDoc loose ends.

Mon Dec 29 05:05:51 2003  Dave Thomas  <dave@pragprog.com>

	* struct.c, random: Add RDoc comments

Mon Dec 29 02:25:00 2003  Gavin Sinclair  <gsinclair@soyabean.com.au>

	* lib/optparse.rb: Improved documentation.

Mon Dec 29 02:20:54 2003  Dave Thomas  <dave@pragprog.com>

	* eval.c: Add RDoc for class Proc, Method, UnboundMethod

Mon Dec 29 02:20:26 2003  NAKAMURA Usaku  <usa@ruby-lang.org>

	* instruby.rb: fix install directory if destdir and compile_dir are
	  not in the same drive.

	* ext/extmk.rb: ditto. [ruby-list:39009]

	* win32/Makefile.sub, win32/README.win32, win32/configure.bat,
	  win32/setup.mak: new configure scheme. use ``configure --prefix=dir''
	  instead of ``nmake DESTDIR=dir install''.

Mon Dec 29 00:41:44 2003  Dave Thomas  <dave@pragprog.com>

	* math.c: Add RDoc comments

Sun Dec 28 20:19:11 2003  Tanaka Akira  <akr@m17n.org>

	* ext/stringio/stringio.c (strio_sysread): StringIO.new.sysread didn't
	  raise EOFError.

	* ext/zlib/zlib.c (gzreader_gets): don't increment lineno when
	  gzfile_read_all returns "".

Sun Dec 28 15:25:08 2003  Dave Thomas  <dave@pragprog.com>

	* class.c,object.c,parse.y,sprintf.c,variable.c: Document classes
	  Object, Module, etc...

Sun Dec 28 11:55:29 2003  NAKAMURA, Hiroshi  <nahi@ruby-lang.org>

	* test/csv/test_csv.rb: generate bom.csv and mac.csv files on the fly.
	  [ruby-talk:88852]

	* test/csv/{bom.csv,mac.csv}: removed.

Sun Dec 28 08:56:51 2003  Dave Thomas  <dave@pragprog.com>

	* eval.c: Thead[Group] RDoc (thanks to MG)

Sun Dec 28 03:50:05 2003  Dave Thomas  <dave@pragprog.com>

	* lib/rdoc/parsers/parse_c.rb (RDoc::C_Parser::find_override_comment):
	  Escape method names used in regexp

Sun Dec 28 01:46:02 2003  Dave Thomas  <dave@wireless_3.local.thomases.com>

	* lib/rdoc/ri/ri_formatter.rb (RI::TextFormatter::display_flow_item):
	  Add support for rules in 'ri' output.

Sun Dec 28 01:35:35 2003  Dave Thomas  <dave@pragprog.com>

	* lib/rdoc/parsers/parse_c.rb (RDoc::C_Parser::find_body):
	  Sometimes the Ruby source aliases two otherwise
	  unrelated methods (for example Kernel#object_id and
	  Kernel#hash are both the same C function). Provide a
	  facility to allow the methods to be documented
	  separately.

Sun Dec 28 01:05:31 2003  Dave Thomas  <dave@pragprog.com>

	* marshal.c, signal.c: RDoc collemts added by Elliott Hughes

Sun Dec 28 00:46:25 2003  Dave Thomas  <dave@pragprog.com>

	* lib/rdoc/parsers/parse_c.rb (RDoc::C_Parser::find_class_comment):
	  Some Ruby source uses lower-case class names for the
	  Init_Xxx C function name.

Sat Dec 27 23:41:46 2003  WATANABE Hirofumi  <eban@ruby-lang.org>

	* configure.in: fix "test: too many arguments" error.

Sat Dec 27 15:32:40 2003  Dave Thomas  <dave@wireless_3.local.thomases.com>

	* time.c: Add RDoc comments for Time class.

Sat Dec 27 15:07:26 2003  Dave Thomas  <dave@pragprog.com>

	* object.c: Add RDoc comments for Symbol class.

Sat Dec 27 14:39:53 2003  Dave Thomas  <dave@pragprog.com>

	* numeric.c (Init_Numeric): Add RDoc comments.

Sat Dec 27 00:44:00 2003  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* io.c (next_argv): warn always for stdin on inplace edit mode.

	* io.c (read_all): need to check string value.

	* io.c (argf_read): allow ARGF.read(nil).  [ruby-dev:22433]

Fri Dec 26 23:02:09 2003  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* io.c (rb_f_backquote): need not to check nil result.
	  [ruby-core:02078]

	* io.c (rb_io_getline): should return nil when read_all gives
	  empty string, even when nil rs is specified. [ruby-core:02077]

Fri Dec 26 18:33:54 2003  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* configure.in: check if getcontext and setcontext are available.

	* eval.c: use presence of getcontext/setcontext.

Fri Dec 26 16:40:53 2003  Tanaka Akira  <akr@m17n.org>

	* lib/pathname.rb (PathnameTest#test_plus): add 2 assertions.

Fri Dec 26 14:05:13 2003  Minero Aoki  <aamine@loveruby.net>

	* test/ruby/test_pack.rb: new test test_pack_N.

Fri Dec 26 12:53:26 2003  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* pack.c (pack_pack): add sign check for 'i', and 'l'.
	  [ruby-dev:22427]

	* bignum.c (rb_quad_pack): add range check for 'quad int'.

Fri Dec 26 10:58:58 2003  NAKAMURA Usaku  <usa@ruby-lang.org>

	* MANIFEST: add vms/config.h and remove vms/config.h_in.

Fri Dec 26 10:42:00 2003  AKIYOSHI, Masamichi  <masamichi.akiyoshi@hp.com>

	* io.c: [VMS] "rfm=stmlf" is specified for open() and fopen().

Thu Dec 25 22:29:53 2003  NAKAMURA Usaku  <usa@ruby-lang.org>

	* string.c (rb_str_update): don't return any value.

Thu Dec 25 15:30:17 2003  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* string.c (rb_str_update): call rb_str_modify().

Thu Dec 25 05:08:09 2003  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* eval.c (search_required): search actual file name once when no
	  extension specified.

Thu Dec 25 04:00:44 2003  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* stable version 1.8.1 released.

Thu Dec 25 00:17:53 2003  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* configure.in: check for nanosleep, -lrt if required.
	  [ruby-core:02059]

	* eval.c (thread_timer): use select(2) if nanosleep(2) is not
	  available.

	* eval.c: check __stub_getcontext for glibc on some platforms.
	  [ruby-list:38984]

Wed Dec 24 23:48:04 2003  NAKAMURA, Hiroshi  <nahi@ruby-lang.org>

	* test/soap/test_basetype.rb, test/soap/marshal/test_marshal.rb
	  test/xsd/test_xsd.rb: use "(-1.0 / (1.0 / 0.0))" instead of "-0.0"
	  to express -0.0.  [ruby-talk:88786]

Wed Dec 24 23:29:30 2003  Tanaka Akira  <akr@m17n.org>

	* lib/tsort.rb (test_orphaned_break): removed.

Wed Dec 24 20:53:06 2003  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/sample/tkmulticolumnlist.rb: new sample

	* ext/tk/sample/tkmultilistframe.rb: bug fix

Wed Dec 24 20:37:37 2003  Eric Sunshine  <sunshine@sunshineco.com>

	* configure.in (LDSHARED): Fixed typographical error in assignment of
	  LDSHARED for Rhapsody which caused linking of extension modules to
	  fail.

Wed Dec 24 17:51:18 2003  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* file.c (rb_thread_flock): enable thread support again.

Wed Dec 24 16:46:08 2003  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (catch_timer): do not call rb_thread_schedule() inside to
	  avoid pthread_mutex_lock() deadlock.  interrupts to system calls
	  are detected by TRAP_END via EINTR error.

	* eval.c (thread_timer): do not post signal unless it is
	  absolutely necessary.

	* rubysig.h (TRAP_END): add CHECK_INTS to switch thread.

	* regex.c (re_compile_pattern): check if nextp is smaller than
	  pend.  [ruby-dev:22372]

	* eval.c (umethod_bind): remove method overridden check.
	  [ruby-dev:22366]

Wed Dec 24 16:13:05 2003  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* ext/openssl/ossl_ssl.c (ossl_ssl_read): should check for error
	  status by SSL_get_error().

	* ext/openssl/ossl_ssl.c (ossl_ssl_write): ditto.

Wed Dec 24 14:23:27 2003  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* ext/stringio/stringio.c (strio_read): clear the buffer argument
	  when returning nil.  [ruby-dev:22363]

	* test/ruby/ut_eof.rb (TestEOF::test_eof_0, TestEOF::test_eof_1):
	  add buffer argument tests.

Wed Dec 24 14:07:55 2003  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* lib/test/unit/assertions.rb: Modules are allowed to rescue.

	* lib/test/unit/autorunner.rb: show output_level in order.

	* lib/test/unit/collector/dir.rb: get rid of successive same
	  directories in load path.

	* test/testunit/test_assertions.rb (test_assert_nothing_raised,
	  test_assert_raise): test for modules.

Wed Dec 24 13:43:34 2003  Shugo Maeda  <shugo@ruby-lang.org>

	* lib/net/imap.rb (authenticate): remove "\n" from base64 encoded
	  strings.

Wed Dec 24 11:26:41 2003  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* test/fileutils/test_fileutils.rb: should not create any
	  files or directories in current directory.  [ruby-talk:88724]

Wed Dec 24 10:29:53 2003  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* ext/stringio/stringio.c (strio_read): never return nil at
	  unlimited read.  [ruby-dev:22334]

	* ext/stringio/stringio.c (strio_read): support second
	  argument.  [ruby-dev:22350]

Wed Dec 24 09:38:49 2003  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* parse.y (arg): should return 0 after error.  [ruby-dev:22360]

Wed Dec 24 00:56:54 2003  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* io.c (read_all): do not return nil at the end of file.
	  [ruby-dev:22334]

	* io.c (argf_read): do not depend on nil at eof behavior of
	  IO#read().

	* eval.c (rb_thread_join): dup exception before re-raising it.

	* io.c (rb_io_eof): call clearerr() to prevent side effect.  this
	  patch is supplied by Masahiro Sakai <sakai@tom.sfc.keio.ac.jp>.
	  [ruby-dev:22234]

	* pack.c (OFF16): get offset for big endian machines.

	* pack.c (pack_pack): use OFF16 instead of OFF16B.
	  [ruby-dev:22344]

	* pack.c (pack_unpack): ditto.

Tue Dec 23 22:47:14 2003  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* io.c (rb_io_check_readable): set FMODE_RBUF always, even if
	  NEED_IO_SEEK_BETWEEN_RW is not defined. [ruby-dev:22340]

	* io.c (rb_io_check_writable): clear FMODE_RBUF before writing
	  something.

Tue Dec 23 22:25:00 2003  Gavin Sinclair  <gsinclair@soyabean.com.au>

	* lib/optparse.rb: incomplete RDoc documentation added in place of
	  existing RD comments.  Tabs converted to spaces.

Tue Dec 23 19:44:47 2003  NAKAMURA, Hiroshi  <nahi@ruby-lang.org>

	* test/soap/test_streamhandler.rb (test_basic_auth): removed.
	  soap4r + basic_auth is not officially supported in ruby/1.8.1 even
	  though soap4r + basic_auth + http-access2 should run fine.

Tue Dec 23 19:42:59 2003  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* io.c (rb_io_ungetc): raise an exception at unread stream to
	  avoid unspecified behavior.  [ruby-dev:22330]

	* test/ruby/test_system.rb (test_syntax): glob relatively from
	  __FILE__.

Tue Dec 23 18:09:40 2003  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* pack.c (pack_pack): remove unnecessary negative value check.
	  [ruby-dev:22329]

Tue Dec 23 17:26:55 2003  KONISHI Hiromasa  <konishih@fd6.so-net.ne.jp>

	* bcc32/Makefile.sub (config.h): bcc has finite(). [ruby-list:38940]

Tue Dec 23 16:08:16 2003  NAKAMURA, Hiroshi  <nahi@ruby-lang.org>

	* lib/rexml/encodings/US-ASCII.rb: typo.  [ruby-talk:88650]

	* test/ruby/test_system.rb: num of asserts depended on running dir.

	* test/xsd/test_noencoding.rb: rexml + without iconv/uconv cannot
	  handle euc-jp.  install iconv, uconv or xmlscan.

Tue Dec 23 14:13:51 2003  akira yamada  <akira@ruby-lang.org>

	* lib/uri/generic.rb (URI::Generic::check_userinfo,
	  URI::Generic::check_user, URI::Generic::check_password): tests
	  conflicts/depends with other components closely.

	* test/uri/test_generic.rb (TestGeneric::test_set_component):
	  added tets.

Tue Dec 23 11:08:34 2003  NAKAMURA, Hiroshi  <nahi@ruby-lang.org>

	* test/xsd/test_noencoding.rb: rescue Errno::EINVAL and do not test.
	  "euc-jp" might not be in supported encoding name list.
	  [ruby-talk:88650]

Tue Dec 23 06:10:31 2003  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* lib/webrick/cgi.rb (CGI): add support for mod_ruby.

	* lib/webrick/cgi.rb (CGI::Socket): add check for existence of
	  OpenSSL module in all HTTPS related methods.

	* lib/webrick/cgi.rb (CGI::Socket#cipher): should create similar
	  value to OpenSSL::SSLSocket#cipher.

	* lib/webrick/httpresponse.rb (HTTPResponse#setup_header): should
	  set "connection: close" if @keep_alive is false.

	* lib/webrick/https.rb (HTTPrequest#meta_vars): add supprt for
	  SSL_PROTOCOL, SSL_CIPHER_USEKEYSIZE and SSL_CIPHER_ALGKEYSIZE.

Mon Dec 22 23:00:05 2003  akira yamada  <akira@ruby-lang.org>

	* lib/uri/generic.rb (URI::Generic::check_opaque): fixed typo.

Mon Dec 22 21:59:24 2003  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* ext/iconv/iconv.c (map_charset): always ensure code is a String.

Mon Dec 22 21:15:29 2003  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* class.c (rb_mod_init_copy): always copy singleton class.
	  [ruby-dev:22325]

Mon Dec 22 20:44:36 2003  akira yamada  <akira@ruby-lang.org>

	* lib/uri/generic.rb (URI::Generic#route_from): accepts urls which
	  has no host-part.

	* test/uri/test_generic.rb (TestGeneric::test_route): added a test.

Mon Dec 22 20:38:44 2003  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* lib/cgi.rb: reduce eval.

	* lib/cgi.rb (CGI::QueryExtension::read_multipart): alias path to
	  local_path.  [ruby-list:38883]

Mon Dec 22 20:09:31 2003  NAKAMURA, Hiroshi  <nahi@ruby-lang.org>

	* test/soap/test_property.rb: remove duplicated test method.

Mon Dec 22 18:22:04 2003  NAKAMURA Usaku  <usa@ruby-lang.org>

	* bcc32/Makefile.sub, win32/Makefile.sub (config.h): remove
	  HAVE_ISINF definition to follow previous commits of missing.h
	  and win32/win32.h.

Mon Dec 22 17:23:42 2003  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* configure.in (ac_cv_func_setitimer): moved from defines.h

	* defines.h, rubysig.h, signal.c: removed macro handling which
	  should be done in configure.

	* configure.in (intrinsics.h): check if present.

	* ruby.h: include intrinsics.h if available.

	* bignum.c, marshal.c: include ieeefp.h if available.

	* missing.h (isinf): define as a macro if finite() and isnan()
	  are available.  [ruby-core:02032]

Mon Dec 22 17:07:31 2003  WATANABE Hirofumi  <eban@ruby-lang.org>

	* configure.in (mingw): set isnan, finite and isinf to yes.

Mon Dec 22 13:40:19 2003  NAKAMURA, Hiroshi  <nahi@ruby-lang.org>

	* lib/soap/property.rb: passing block by reference.

Mon Dec 22 00:32:43 2003  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (rb_with_disable_interrupt): use ENABLE_INTS instead of
	  ALLOW_INTS which may switch context.  [ruby-dev:22319]

	* ext/syck/emitter.c (syck_emitter_write): str bigger than
	  e->bufsize causes buffer overflow.  [ruby-dev:22307]

Sun Dec 21 17:29:00 2003  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* class.c (rb_check_inheritable): new function.  [ruby-dev:22316]

	* intern.h: add prototype.

	* eval.c (superclass): use rb_check_inheritable().

	* object.c (rb_class_initialize): check argument validity.

Sun Dec 21 16:25:10 2003  Tanaka Akira  <akr@m17n.org>

	* lib/pathname.rb (Pathname#+): re-implemented to resolve ".." in
	  beginning of the argument.
	  (Pathname#join): concatenate from the last argument.
	  (Pathname#parent): just use Pathname#+.

Sun Dec 21 00:12:37 2003  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/lib/tk.rb: add new methods (TkScrollbar#assign, assign_list)

	* ext/tk/sample/tkmultilistframe.rb: use TkScrollbar#assign method

Sat Dec 20 21:59:03 2003  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* lib/webrick/httprequest.rb (HTTPRequest#meta_vars): refine regexp.

	* lib/webrick/cgi.rb (CGI#start): NPH scripts return status line
	  instead of Status: header field.

	* lib/webrick/cgi.rb (CGI::Socket): refine some coditions.

Sat Dec 20 16:07:14 2003  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* lib/optparse.rb (OptionParser::Completion::complete): wrong
	  Regexp for word boundary.  pointed out by Gavin Sinclair.

	* lib/optparse.rb (OptionParser::make_switch): [no-] prefix was
	  missing.

Sat Dec 20 11:40:10 2003  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* lib/yaml.rb (YAML::YAML): adjust Marshal version.

Sat Dec 20 03:56:02 2003  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (rb_with_disable_interrupt): prohibit thread context
	  switch during proc execution.  [ruby-dev:21899]

Sat Dec 20 02:41:02 2003  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* lib/webrick/cgi.rb: add file. (yet another CGI library)

	* MANIFEST: add lib/webrick/cgi.rb.

Sat Dec 20 02:18:31 2003  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* misc/ruby-mode.el (ruby-calculate-indent): proper indentation
	  inside of parentheses.  [ruby-dev:22308]

Fri Dec 19 21:24:22 2003  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* lib/webrick/httprequest.rb (HTTPRequest#meta_vars): should not set
	  HTTP_CONTENT_TYPE and HTTP_CONTENT_LENGTH.

	* lib/webrick/https.rb (HTTPRequest#parse): should check presence
	  of cert() method to detect SSLSocket.

Fri Dec 19 22:56:46 2003  NAKAMURA, Hiroshi  <nahi@ruby-lang.org>

	* lib/soap/property.rb (SOAP::Property#load): new method for loading
	  property value into existing property tree.

	* test/soap/test_property.rb: add test.

Fri Dec 19 19:21:49 2003  akira yamada  <akira@ruby-lang.org>

	* lib/runit/cui/testrunner.rb (RUNIT::CUI::TestRunner::run):
	  should use Test::Unit::UI::{PROGRESS_ONLY,VERBOSE}.

Fri Dec 19 17:36:49 2003  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/sample/tkmultilistbox.rb: bug fix

	* ext/tk/sample/tkmultilistframe.rb: new sample script

Fri Dec 19 03:44:27 2003  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* lib/webrick/httputils.rb (parse_form_data): should return an
	  empty Hash if the body is empty.

Thu Dec 18 21:47:35 2003  NAKAMURA Usaku  <usa@ruby-lang.org>

	* lib/mkmf.rb (create_makefile): should remove deffile if it's
	  made by miniruby. based on nobu's patch.

Thu Dec 18 21:44:21 2003  NAKAMURA Usaku  <usa@ruby-lang.org>

	* eval.c (stack_extend): ignore inline optimization on VC7.

	* win32/Makefile.sub (OS, RT): can override.

	* win32/Makefile.sub (LDFLAGS): ditto. shouldn't use pdb:none
	  option. based on Tietew's patch [ruby-dev:22289]

Thu Dec 18 16:38:44 2003  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* dir.c (fnmatch): unlike find_dirsep(), rb_path_next() never
	  return NULL.

Thu Dec 18 15:27:59 2003  WATANABE Hirofumi  <eban@ruby-lang.org>

	* lib/ipaddr.rb (IPSocket::getaddress): merge usa's patch.
	  [ruby-dev:21678]

Wed Dec 17 15:15:30 2003  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* lib/cgi.rb (CGI::QueryExtension::Value::[]): should work like
	  String#[] if more than one arguments are specified.

	* lib/delegate.rb: avoid using common instance name as "@obj".

	* lib/cgi.rb (CGI::QueryExtension::Value): Value is no longer
	  subclass of String, but DelegateClass(String).

	* ext/curses/extconf.rb: restore function check for init_color.
	  [ruby-list:38905]

	* Makefile.in: need to specify $(MAINLIBS) for the miniruby
	  generation rule.

	* configure.in: better FreeBSD -lc_r support.

Wed Dec 17 00:16:14 2003  Minero Aoki  <aamine@loveruby.net>

	* ext/strscan/strscan.c: new method
	  StringScanner#beginning_of_line? (alias #bol?)

	* ext/strscan/strscan.c: new method StringScanner#concat and #<<.

	* ext/strscan/strscan.c: StringScanner#new(str) does not duplicate
	  nor freeze STR (allow destructive modification).

	* test/strscan/test_stringscanner.rb: test new methods above.

	* test/strscan/test_stringscanner.rb: test destructive string
	  modification.

Tue Dec 16 21:20:47 2003  Tanaka Akira  <akr@m17n.org>

	* lib/pp.rb: don't use local variable `pp'.

	* lib/prettyprint.rb: ditto.

Tue Dec 16 13:20:43 2003  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/lib/tk.rb: condition bug of if statement on
	  {pack,grid}_propagate methods

Tue Dec 16 03:17:29 2003  why the lucky stiff  <why@ruby-lang.org>

	* lib/yaml/rubytypes.rb: comments in strings. [ruby-talk:88012]

	* test/yaml/test_yaml.rb: add test.

Tue Dec 16 01:14:44 2003  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* eval.c (catch_timer): check rb_thread_crtical in main native
	  thread.

	* eval.c (thread_timer): just sends signals periodically, to
	  prevent main native thread from receiving them in critical
	  section.  [ruby-core:01959]

Mon Dec 15 13:32:22 2003  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* dir.c (check_dirname): check string safety and remove extraneous
	  trailing directory separators.  [ruby-dev:22279]

	* file.c: renamed and externalized rb_path_next,
	  rb_path_skip_prefix, rb_path_last_separator, rb_path_end.

	* intern.h: prototypes for rb_path_next, rb_path_skip_prefix,
	  rb_path_last_separator, rb_path_end.

Mon Dec 15 09:27:46 2003  NAKAMURA Usaku  <usa@ruby-lang.org>

	* ext/openssl/ossl_pkcs12.c (ossl_pkcs12_initialize): first argument
	  of rb_protect should take an argument of VALUE.

Sun Dec 14 18:46:48 2003  WATANABE Hirofumi  <eban@ruby-lang.org>

	* ext/socket/socket.c (Init_socket): IPv6 is not supported although
	  AF_INET6 is defined on MinGW.

	* lib/ipaddr.rb (AF_INET6): workaround in the environment which does
	  not support IPv6.

Sat Dec 13 18:55:16 2003  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* ext/iconv/charset_alias.rb: preserve original order.

	* ext/iconv/extconf.rb: remove wrapper file at clean.

Sat Dec 13 18:09:42 2003  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (thread_timer): use timer by sub-thread and nanosleep.
	  [ruby-talk:87519]

	* gc.c (Init_stack): no stack adjustment for THREAD_SAFE.

Sat Dec 13 17:17:59 2003  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* eval.c (proc_alloc): cache the created object at first time.
	  [ruby-talk:61288], [ruby-dev:22240]

Sat Dec 13 09:01:23 2003  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* configure.in: check ucontext.h.

	* eval.c: use getcontext/setcontext() instead of setjmp/longjmp()
	  on ia64 or with native thread enabled.  [ruby-core:01932]

Sat Dec 13 03:09:14 2003  why the lucky stiff  <why@ruby-lang.org>

	* lib/yaml/rubytypes.rb: anonymous struct fix. [ruby-core:01946]

	* test/yaml/test_yaml.rb: add test.

Fri Dec 12 22:36:44 2003  NAKAMURA, Hiroshi  <nahi@ruby-lang.org>

	* lib/csv.rb: add Cell#to_str and Cell#to_s for /.../ =~ aCell,
	  "#{aCell}" and so on.

	* test/csv/test_csv.rb: add tests.

Fri Dec 12 19:33:06 2003  Minero Aoki  <aamine@loveruby.net>

	* lib/fileutils.rb (mkdir): remove trailing `/' from pathes.

	* lib/fileutils.rb (rmdir): ditto. [ruby-dev:22238]

	* lib/fileutils.rb (rmdir_r): ditto.

	* lib/fileutils.rb (fu_copy_dir): check if it is a directory after
	  mkdir(2).

Fri Dec 12 06:06:09 2003  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* eval.c (proc_invoke): fix class name in warning message for
	  define_method.  [ruby-dev:22235]

Thu Dec 11 21:24:43 2003  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* ext/openssl/ossl_pkcs12.[ch]: new files. add OpenSSL::PKCS12.

	* ext/openssl/ossl.[ch]: ditto.

	* ext/openssl/MANIFEST: add ossl_pkcs12.[ch].

Thu Dec 11 20:54:28 2003  Minero Aoki  <aamine@loveruby.net>

	* lib/fileutils.rb (mkdir_p): remove trailing `/' befere mkdir(2).
	  mkdir("nonexistdir/") does not work on NetBSD/Alpha 1.6.1.

	* lib/fileutils.rb (fu_list): call to_str for all arguments.

Thu Dec 11 20:07:01 2003  WATANABE Hirofumi  <eban@ruby-lang.org>

	* lib/ftools.rb (makedirs): sync with fileutils.

Thu Dec 11 19:53:03 2003  Minero Aoki  <aamine@loveruby.net>

	* lib/fileutils.rb (mkdir_p): catch all SystemCallErrors.
	  (mkdir("C:\") causes EACCESS on Windows 2000/NTFS)

Thu Dec 11 19:08:02 2003  Minero Aoki  <aamine@loveruby.net>

	* lib/fileutils.rb (mkdir_p): check if it is a directory after
	  mkdir(2) instead of before mkdir(2), to avoid race condition.
	  [ruby-talk:87730]
	  Refer: mkinstalldirs sh script, GNU mkdir(1) (coreutils 5.0)

Thu Dec 11 18:49:30 2003  Minero Aoki  <aamine@loveruby.net>

	* lib/fileutils.rb: def m( arg ) -> def m(arg).

Thu Dec 11 11:39:43 2003  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* configure.in (ieeefp.h), numeric.c: needed for finite() on
	  Solaris.  [ruby-core:01921]

	* file.c (rb_stat_inspect): adjust format specifier.

	* parse.c (arg_prepend): nodetype() is for debug use.

	* ruby.h (ISASCII, etc): cast to int to get rid of warning.

	* ruby.h (alloca.h): include even in GCC.  [ruby-core:01925]

	* ext/bigdecimal/bigdecimal.c (GetVpValue): adjust format
	  specifier.

	* ext/bigdecimal/bigdecimal.c (BigDecimal_prec, BigDecimal_coerce,
	  BigDecimal_divmod): use rb_assoc_new() to suppress memory usage.

	* ext/bigdecimal/bigdecimal.c (BigDecimal_split): ditto.

	* ext/dl/sym.c (rb_dlsym_guardcall): guard itself should be
	  volatile.

	* ext/iconv/iconv.c (iconv_convert): ensure actual parameter with
	  format specifier.

	* ext/pty/pty.c (MasterDevice, SlaveDevice, deviceNo): do not
	  define unless used.

	* ext/pty/pty.c (getDevice): get rid of warning.

	* ext/socket/socket.c (port_str, sock_s_getaddrinfo,
	  sock_s_getnameinfo): FIX2INT() now returns long.

	* ext/socket/socket.c (init_inetsock_internal): uninitialized
	  variable.

	* ext/syck/rubyext.c (syck_parser_assign_io): add prototype.

	* ext/syck/rubyext.c (rb_syck_mktime, yaml_org_handler): use
	  ISDIGIT() instead of isdigit() to avoid warnings and for
	  platforms which don't support non-ascii charater.

Wed Dec 10 19:28:56 2003  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* ext/stringio/stringio.c (strio_read): set EOF flag at short read.
	  [ruby-dev:22223], [ruby-dev:22224]

Wed Dec 10 18:07:25 2003  Minero Aoki  <aamine@loveruby.net>

	* lib/erb.rb: new method ERB#filename(=). [ruby-dev:22208]

Wed Dec 10 17:54:51 2003  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* ext/stringio/stringio.c (strio_read): do not set EOF flag when
	  requested length is zero.  [ruby-dev:22214]

Wed Dec 10 17:17:18 2003  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* io.c (read_all): should return given string even if data read is
	  empty.  [ruby-dev:22207]

Wed Dec 10 17:16:06 2003  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* ext/stringio/stringio.c (strio_read): adjust behavior at reading
	  beyond EOF to IO.  [ruby-dev:22205]

	* test/ruby/ut_eof.rb (TestEOF::Seek): test behaviors at reading
	  beyond EOF.

	* test/ruby/test_file.rb, test/stringio/test_stringio.rb: include
	  TestEOF::Seek test case.

Wed Dec 10 15:01:19 2003  Shugo Maeda  <shugo@ruby-lang.org>

	* test/monitor/test_monitor.rb (test_cond): use Queue#deq
	  instead of sleep.

Wed Dec 10 14:45:39 2003  WATANABE Hirofumi  <eban@ruby-lang.org>

	* ext/pty/pty.c (HAVE_SYS_IOCTL_H): need to include <sys/ioctl.h>
	  for TIOCSCTTY on *BSD.  based on gotoyuzo's patch.
	  (ruby-bugs:PR#1211)

	* ext/pty/pty.c (establishShell): should close descriptors if fork
	  failed.

Wed Dec 10 12:53:05 2003  WATANABE Hirofumi  <eban@ruby-lang.org>

	* win32/win32.h: define execv() using do_aspawn().

	* process.c (proc_exec_v): remove #ifdef's which stopped needing.

Tue Dec  9 23:32:23 2003  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/lib/tk.rb, ext/tk/lib/tkcanvas.rb, ext/tk/lib/tkdialog.rb,
	  ext/tk/lib/tkentry.rb, ext/tk/lib/tkscrollbox.rb, ext/tk/lib/tktext.rb,
	  ext/tk/sample/tkalignbox.rb, ext/tk/sample/tkcombobox.rb,
	  ext/tk/sample/tkmultilistbox.rb, ext/tk/sample/tkoptdb.rb, ext/tk/sample/tktextframe.rb,
	  ext/tk/sample/demos-en/dialog1.rb, ext/tk/sample/demos-en/dialog2.rb,
	  ext/tk/sample/demos-jp/dialog1.rb, ext/tk/sample/demos-jp/dialog2.rb:
	  overrided instance methods, which are private methods on the super
	  class, are changed to 'private'

Tue Dec  9 19:53:02 2003  akira yamada  <akira@ruby-lang.org>

	* lib/uri/generic.rb (URI::Generic#route_from0): make case insensitive
	  for host-part.

	* test/uri/test_generic.rb (test_route): added tests for the above
	  change.

Tue Dec  9 14:10:48 2003  Tanaka Akira  <akr@m17n.org>

	* io.c (rb_io_check_readable): don't call io_seek if EOF flag is set,
	  to avoid clearing EOF flag.
	  (rb_io_check_writable): ditto.

Tue Dec  9 02:53:55 2003  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/sample/tkalignbox.rb: new sample script

Tue Dec  9 00:45:00 2003  Nathaniel Talbott  <ntalbott@ruby-lang.org>

	* lib/test/unit/assertions.rb: renamed #assert_raises to #assert_raise
	  and made the former call the latter. [ruby-core:01890]

	* test/testunit/test_assertions.rb: ditto.

Tue Dec  9 00:07:35 2003  NAKAMURA, Hiroshi  <nahi@ruby-lang.org>

	* lib/soap/rpc/standaloneServer.rb: add 'shutdown' and 'status'
	  methods as delegates to WEBrick.

	* test/soap/calc/{test_calc.rb,test_calc2.rb},
	  test/soap/helloworld/test_helloworld.rb,
	  test/wsdl/datetime/test_datetime.rb, test/wsdl/raa/test_raa.rb:
	  follow the change.

Mon Dec  8 22:48:03 2003  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* lib/test/unit/autorunner.rb: remove dependency to a particular
	  runner.  [ruby-core:01901], [ruby-list:38869]

	* lib/test/unit/ui/testrunnerutilities.rb: moved output level
	  constants from Console.

	* lib/test/unit/ui/console/testrunner.rb: ditto.

	* lib/test/unit/ui/{fox,gtk,gtk2,tk}/testrunner.rb (initialize):
	  accept output_level.

Mon Dec  8 15:03:30 2003  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* ext/syck/syck.c (syck_io_str_read): get rid of buffer overflow.

Mon Dec  8 13:02:11 2003  Minero Aoki  <aamine@loveruby.net>

	* lib/uri/common.rb: new method URI.regexp. [ruby-dev:22121]

	* test/uri/test_common.rb: add test for URI.regexp.

Mon Dec  8 12:44:14 2003  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* pack.c: define swap16 and swap32 only if they are not
	  defined. OpenBSD defines these macros. [ruby-dev:22181]

Sun Dec  7 20:54:17 2003  Tanaka Akira  <akr@m17n.org>

	* ext/iconv/iconv.c (map_charset): make case sensitive.
	  ext/iconv/charset_alias.rb (charset_alias): don't ignore
	  config.charset's information.  sort aliases.

Sat Dec  6 22:58:03 2003  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* ext/openssl/ossl_ssl.c (ossl_start_ssl): new function to wrap
	  SSL_connect and SSL_accept; if SSL_connect (or SSL_accept) returned
	  but not finished the handshake process, we should retry it.

	* ext/openssl/ossl_ssl.c (ossl_ssl_connect): call ossl_start_ssl.

	* ext/openssl/ossl_ssl.c (ossl_ssl_accept): ditto.

	* ext/openssl/ossl_ssl.c (ossl_ssl_read): allow signal traps.

Sat Dec  6 21:45:10 2003  WATANABE Hirofumi  <eban@ruby-lang.org>

	* io.c (flush_before_seek): flush before seek on any platform.

	* configure.in: ditto.

Sat Dec  6 17:23:00 2003  NAKAMURA, Hiroshi  <nahi@ruby-lang.org>

	* lib/soap/soap.rb(SOAP::Env.getenv): allow upcase environment variable
	  as well as downcase one.

	* lib/soap/netHttpClient.rb(SOAP::NetHttpClient#proxy=): check URI.

Fri Dec  5 23:22:30 2003  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* lib/test/unit/assertions.rb (Test::Unit::Assertions::assert_raises,
	  Test::Unit::Assertions::assert_nothing_raised): use the last
	  argument as message unless class object.

	* test/testunit/test_assertions.rb (test_assert_raises): test for
	  multiple exception list.  [ruby-core:01891]

	* test/testunit/test_assertions.rb (test_assert_nothing_raised): test
	  for non-exception classes.

Fri Dec  5 22:23:04 2003  NAKAMURA, Hiroshi  <nahi@ruby-lang.org>

	* lib/soap/netHttpClient.rb: proxy support did not work.  fixed.

	* lib/soap/property.rb: add class methods for loading property from
	  stream/file/propertyfile.  propertyfile is a file which is located at
	  somedir in $:.

	* lib/soap/soap.rb, lib/soap/wsdlDriver.rb, lib/soap/rpc/driver.rb,
	  lib/wsdl/importer.rb: load property from propertyfile 'soap/property'
	  e.g. /usr/local/lib/ruby/site_ruby/1.8/soap/property.

	* test/soap/test_property.rb, test/soap/test_streamhandler.rb: new file.

Fri Dec  5 17:26:23 2003  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* eval.c (rb_exec_end_proc): maintain tmp_end_procs.
	  [ruby-dev:22154]

Fri Dec  5 13:36:59 2003  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (rb_exec_end_proc): should not clear end_procs and
	  ephemeral_end_procs before execution. [ruby-dev:22144]

	* eval.c (rb_obj_extend): call Module#extended hook after
	  extended_object.  [ruby-list:38866]

	* object.c (Init_Object): Module#extended defined.

Fri Dec  5 13:17:30 2003  Tanaka Akira  <akr@m17n.org>

	* test/ruby/test_pipe.rb: use IO.pipe instead of IO.popen.

Fri Dec  5 11:54:45 2003  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* ext/stringio/stringio.c (strio_read): follow IO#read.

	* test/ruby/ut_eof.rb, test/ruby/test_file.rb, test/ruby/test_pipe.rb,
	  test/stringio/test_stringio.rb: add EOF test.

Fri Dec  5 02:49:35 2003  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* lib/test/unit/assertions.rb (Test::Unit::Assertions::assert_raises):
	  allow multiple exception list.  [ruby-core:01884]

	* lib/test/unit/assertions.rb (Test::Unit::Assertions::assert_nothing_raised):
	  check whether arguments are subclass of Exception.

Thu Dec  4 23:54:00 2003  Rick Ohnemus  <rick.ohnemus@systemware.com>

	* dln.c (aix_loaderror): should not use member named 'errno' which
	  might be a macro (e.g. on AIX).

Thu Dec  4 23:32:26 2003  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* io.c (read_all): do not depend on lseek position.
	  [ruby-dev:22026]

Thu Dec  4 22:37:26 2003  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* eval.c (rb_eval): preserve $! value when retry happens in the
	  rescue clause.  [ruby-talk:86697]

Thu Dec  4 21:50:07 2003  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* lib/drb/drb.rb (DRb::DRbMessage::send_request, send_reply):
	  should rescue errors and re-raise DRbConnError on write too.
	  [ruby-dev:22132]

Thu Dec  4 16:41:17 2003  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* parse.y (exc_list): allow expanding list.  [ruby-dev:22134]

Thu Dec  4 14:09:24 2003  Minero Aoki  <aamine@loveruby.net>

	* test/fileutils/test_fileutils.rb (test_cp): test if the error is
	  kind of SystemCallError.  It is needless details that which errno
	  is set on each systems.

Thu Dec  4 13:24:13 2003  Shugo Maeda  <shugo@ruby-lang.org>

	* lib/monitor.rb: use Object#__send__ instead of Object#send.

Thu Dec  4 13:17:45 2003  NAKAMURA, Hiroshi  <nahi@ruby-lang.org>

	* lib/soap/streamHandler.rb: support latest released version of
	  http-access2.

Thu Dec  4 13:04:44 2003  NAKAMURA, Hiroshi  <nahi@ruby-lang.org>

	* lib/soap/soap.rb: add SOAP::Env module for environment repository
	  such as HTTP_PROXY.

	* lib/soap/property.rb: property implementation.

	* lib/soap/streamHandler.rb, lib/soap/wsdlDriver.rb,
	  lib/soap/rpc/driver.rb: use soap/property.rb.

	* lib/wsdl/importer.rb, lib/soap/wsdlDriver.rb, lib/soap/rpc/driver.rb:
	  use SOAP::Env.

	* lib/soap/netHttpClient.rb: add basic_auth, ssl_config, and cookie
	  management interface, but ignored for now.

	* lib/xsd/charset.rb: add XSD::Charset.encoding= interface to set
	  wiredump charset explicitly.  it was fixed to 'utf-8' when iconv or
	  uconv module was found.

Thu Dec  4 10:43:58 2003  NAKAMURA Usaku  <usa@ruby-lang.org>

	* ext/dl/sym.c (rb_dlsym_guardcall): __declspec(noinline) is VC7
	  feature.

Thu Dec  4 10:27:12 2003  Minero Aoki  <aamine@loveruby.net>

	* lib/net/http.rb: update hyperlink to the Japanese document.

Thu Dec  4 09:12:43 2003  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* ext/openssl/ossl_asn1.c (asn1time_to_time): should check that
	  the underlying value of ASN1_TIME isn't NULL. [ruby-core:01881]

Thu Dec  4 08:29:43 2003  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* lib/webrick/server.rb (GenericServer#start): should rescue
	  Exception to avoid unexpected aborting. [ruby-core:01853]

	* lib/webrick/server.rb (GenericServer#start_thread): should check
	  that peeraddr isn't nil before printing.

	* lib/webrick/httpresponse.rb (HTTPResponse#start_thread): should
	  rescue Exception to avoid unexpected aborting of thread.

Thu Dec  4 03:48:59 2003  Tanaka Akira  <akr@m17n.org>

	* lib/pathname.rb (Pathname#link, Pathname#symlink): obsoleted.
	  (Pathname#make_link, Pathname#make_symlink): new method.

Thu Dec  4 01:45:24 2003  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* io.c (argf_read): should not terminate on empty string; wait
	  until real EOF.  [ruby-dev:21969]

	* io.c (argf_read): should adjust length to read, when length is
	  specified and read spans command line argument files.

Wed Dec  3 19:38:36 2003  Masatoshi SEKI  <m_seki@mva.biglobe.ne.jp>

	* lib/drb/drb.rb: correct fcntl parameter. [ruby-dev:22120]

Wed Dec  3 13:49:07 2003  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/lib/tk.rb: 'format'==>'Kernel.format' (avoid override trouble)

	* ext/tk/lib/tkafter.rb: ditto.

	* ext/tk/lib/tkcanvas.rb: ditto.

	* ext/tk/lib/tkdialog.rb: ditto.

	* ext/tk/lib/tktext.rb: ditto.

Wed Dec  3 13:28:13 2003  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* Makefile.in (lex.c): try gperf first, and copy from the source
	  directory if failed.  [ruby-dev:22123]

	* ext/extmk.rb (MTIMES): let makefiles depend to mkmf.rb.

	* lib/mkmf.rb (configuration): DLDFLAGS was duplicated.

Tue Dec  2 23:18:12 2003  Minero Aoki  <aamine@loveruby.net>

	* lib/net/http.rb: wrote the warning about HTTP_PROXY environment
	  variable.

Tue Dec  2 21:31:42 2003  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* bin/testrb: new test runner.  [ruby-core:01845]

	* lib/test/unit/autorunner.rb (Test::Unit::AutoRunner.run,
	  Test::Unit::AutoRunner#process_args): take test list to run and
	  options.

	* lib/test/unit/autorunner.rb (Test::Unit::AutoRunner::RUNNERS,
	  Test::Unit::AutoRunner#run): should not exit inside a library,
	  just return the result instead.

	* lib/test/unit.rb: ditto.

	* test/runner.rb: exit with the test result.

Tue Dec  2 20:18:48 2003  Eric Sunshine  <sunshine@sunshineco.com>

	* configure.in (AC_PROG_YACC): AC_DEFINE(OLD_YACC) if Yacc is found
	  instead of Bison or byacc.

	* parse.y: If OLD_YACC is defined, ensure that YYMAXDEPTH is at least
	  10000 (Bison's default) since some old versions of Yacc define it as
	  low as 150 by default, which is too low for Ruby to parse some files,
	  such as date/format.rb.  Among other issues, the parse problem causes
	  "make test" to fail.

Tue Dec  2 20:03:20 2003  Minero Aoki  <aamine@loveruby.net>

	* test/fileutils/test_fileutils.rb: check if Pathnames are usable
	  for arguments.

Tue Dec  2 04:22:00 2003  Nathaniel Talbott  <ntalbott@ruby-lang.org>

	* lib/test/unit/assertions.rb: fixed #assert_no_match message.

	* test/testunit/test_assertions.rb: ditto.

Tue Dec  2 00:43:00 2003  why the lucky stiff  <why@ruby-lang.org>

	* ext/syck/syck.c: string buffering bug.  decrementing by full
	  max_size now. [ruby-core:01834]

Mon Dec  1 21:33:08 2003  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* numeric.c (num_sadded): prohibit singleton method definition for
	  Numerics.  fill yet another gap between Fixnum and Bignum.

Mon Dec  1 17:33:47 2003  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* pack.c (htov16): converts endian using swap16. htov32(), hton16,
	  hton32 as well. [ruby-talk:85377]

	* pack.c (swap16): swap 2 bytes no matter how big short is on the
	  platform.  swap32() is also prepared.

	* numeric.c (rb_num2int): returns long to preserve information.
	  rb_fix2int(), rb_num2uint(), rb_fix2uint() as well.
	  [ruby-talk:85377]

	* numeric.c (rb_num2uint): should not check for value range if the
	  source value is negative.

Mon Dec  1 17:14:34 2003  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* sample/optparse/opttest.rb: added.

Mon Dec  1 16:10:52 2003  Dave Thomas  <dave@pragprog.com>

	* lib/rdoc/rdoc.rb: (etc) initial merge into main tree.

Mon Dec  1 14:17:49 2003  Minero Aoki  <aamine@loveruby.net>

	* lib/fileutils.rb (fu_each_src_dest0): call #to_str to allow
	  Pathname for arguments. [ruby-core:01795]

	* test/fileutils/test_fileutils.rb: does much strict test on
	  "same" files detecting.

Mon Dec  1 09:28:14 2003  NAKAMURA Usaku  <usa@ruby-lang.org>

	* bcc32/Makefile.sub, win32/Makefile.sub, wince/Makefile.sub
	  (XCFLAGS): re-export $(XCFLAGS).

	* bcc32/Makefile.sub, win32/Makefile.sub, wince/Makefile.sub
	  (ARCH_FLAG): export $(ARCH_FLAG) (perhaps empty value).

Mon Dec  1 01:03:27 2003  WATANABE Hirofumi  <eban@ruby-lang.org>

	* lib/mkmf.rb (TRY_LINK, link_command): added support for DLDFLAGS
	  and ARCH_FLAG.  [ruby-dev:22085]

Sun Nov 30 20:18:07 2003  WATANABE Hirofumi  <eban@ruby-lang.org>

	* configure.in: keep ARCH_FLAG separate. export ARCH_FLAG.
	  [ruby-core:01819]

	* Makefile.in: add ARCH_FLAG to CFLAGS.

	* Makefile.in: add @CPPFLAGS@ to CPPFLAGS.

	* lib/mkmf.rb (link_command, cc_command): use ARCH_FLAG.

	* lib/mkmf.rb (configuration): add ARCH_FLAG to DLDFLAGS.

	* Makefile.in: add ARCH_FLAG to DLDFLAGS.

	* configure.in: should put getcwd in AC_CHECK_FUNCS, not
	  AC_REPLACE_FUNCS.  [ruby-core:01826]

Sun Nov 30 18:22:48 2003  WATANABE Hirofumi  <eban@ruby-lang.org>

	* configure.in: do not override CCDLDFLAGS, LDFLAGS, XLDFLAGS,
	  DLDFLAGS and LDSHARED.

	* configure.in: XCFLAGS for compiling ruby itself.  ARCH_FLAG is
	  reflected in CFLAGS.

	* lib/mkmf.rb: ditto.  do not import XCFLAGS from config.status.

Sun Nov 30 17:37:36 2003  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/lib/tk.rb: bug fix [ruby-talk:86746]

Sun Nov 30 13:02:00 2003  NAKAMURA, Hiroshi  <nahi@ruby-lang.org>

	* lib/soap/encodingstyle/soapHandler.rb: refactoring - Simplifying
	  Conditional Expressions.

	* lib/wsdl/soap/definitions.rb: refactoring - Move Method.

	* test/xsd/{test_noencoding.rb,noencoding.xml}: new files.  test for
	  encoding unspecified XML file parsing.

	* test/wsdl/{test_fault.rb,map,datetime}: new files.  test of
	  SOAPFault, dateTime and Apache's Map.

Sun Nov 30 09:35:14 2003  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* string.c (rb_str_update): get rid of SEGV at just allocated String.
	  [ruby-core:01812]

Fri Nov 28 23:19:34 2003  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* gc.c (gc_mark): explicitly check mark recursion levels, instead
	  of unreliable stack length.

Fri Nov 28 22:49:56 2003  Masatoshi SEKI  <m_seki@mva.biglobe.ne.jp>

	* lib/rinda/rinda.rb: fix TupleSpaceProxy#read, read_all.

Fri Nov 28 21:44:40 2003  WATANABE Hirofumi  <eban@ruby-lang.org>

	* test/fileutils/test_fileutils.rb (test_ln_s): should be a file, not
	  a directory for FreeBSD.

Fri Nov 28 19:37:56 2003  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* hash.c (env_has_value, env_index): must match exactly.

	* test/ruby/test_env.rb (test_has_value, test_index): condition for
	  aboves.

Fri Nov 28 17:59:20 2003  NAKAMURA Usaku  <usa@ruby-lang.org>

	* test/ruby/test_env.rb: add tests for ENV.

Fri Nov 28 17:47:46 2003  Masatoshi SEKI  <m_seki@mva.biglobe.ne.jp>

	* lib/drb/drb.rb (DRbMessage#load): rescue Errno::* and raise
	  DRbConnError.

Fri Nov 28 15:41:15 2003  Tanaka Akira  <akr@m17n.org>

	* lib/pathname.rb (Pathname#realpath): obsolete the force_absolute
	  argument.

Fri Nov 28 14:41:52 2003  NAKAMURA, Hiroshi  <nahi@ruby-lang.org>

	* lib/soap/streamHandler.rb: drop unused http parameters.

	* lib/soap/encodingstyle/soapHandler.rb, lib/soap/mapping/factory.rb,
	  lib/soap/mapping/mapping.rb, lib/soap/mapping/registry.rb,
	  lib/wsdl/soap/complexType.rb: ApacheSOAP's map support was broken
	  under WSDL dynanic client environment.  fixed.

	* test/wsdl/raa/*: add tests.

	* lib/xsd/datatypes.rb: dateTime precision bug fix (at least, I hope.)
	  bug of soap4r.  XSDDateTimeImple.to_time passed a Float to
	  Time.local/Time.gm as an usec, and NUM2LONG(rb_num2long for Float)
	  causes rounding error.

	* test/soap/test_basetype.rb, test/xsd/test_xsd.rb: add tests.

Fri Nov 28 04:15:24 2003  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* eval.c (method_arity): used wrong Proc object.  [ruby-talk:86504]

Fri Nov 28 00:47:29 2003  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* eval.c (rb_f_exit), process.c (rb_f_exit_bang): treat true as
	  success, false as failure.  [ruby-dev:22067]

	* eval.c (rb_f_abort, rb_thread_switch), process.c (rb_f_system): use
	  ANSI macro instead of hard coded value.

	* eval.c (rb_f_exit), process.c (rb_f_exit_bang): use VALUEs not but
	  TYPEs.

Thu Nov 27 22:05:48 2003  Akinori MUSHA  <knu@iDaemons.org>

	* eval.c, gc.c: FreeBSD/ia64 currently does not have a way for a
	  process to get the base address for the RSE backing store, so
	  hardcode it for the moment.
	  [submitted by: Marcel Moolenaar <marcel@FreeBSD.org>]

Thu Nov 27 17:36:42 2003  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/lib/tkafter.rb: bug fix on TkTimer#cancel_on_exception=(mode).
	  TkTimer#wait recieves the exception of the callback.
	  The exception is kept on @return_value.

Thu Nov 27 16:58:48 2003  WATANABE Hirofumi  <eban@ruby-lang.org>

	* win32/win32.c (rb_w32_stat): remove _fullpath() for NUL: device.

Wed Nov 26 15:38:47 2003  WATANABE Hirofumi  <eban@ruby-lang.org>

	* test/fileutils/test_fileutils.rb (test_ln_s): should take the
	  existing symbolic link for OpenBSD.

Wed Nov 26 04:48:42 2003  why the lucky stiff  <why@ruby-lang.org>

	* ext/syck/token.c: removed YYTOKTMP references which
	  were causing buffer overflows on large block scalars,
	  comments, quoted scalars and plain scalars.

	* ext/syck/rubyext.c: dynamic changing of buffer size.

	* ext/syck/syck.h: default buffer size of 4k.

Wed Nov 26 00:55:30 2003  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* lib/webrick/httpresponse.rb: add HTTPResponse#keep_alive=.

	* lib/webrick/httpserver.rb (HTTPServer#run): should pass the
	  request's keep_alive flag to the response.

Tue Nov 25 21:41:35 2003  NAKAMURA Usaku  <usa@ruby-lang.org>

	* defines.h (ENV_IGNORECASE): should define when DOSISH without
	  human68k. [ruby-dev:22047]

	* hash.c (env_has_value, env_index): don't ignore case of value.
	  [ruby-dev:22048]

Tue Nov 25 21:39:37 2003  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* file.c (path_check_1): honor sticky bits always.
	  [ruby-talk:86273]

Tue Nov 25 20:02:14 2003  Minero Aoki  <aamine@loveruby.net>

	* test/fileutils/test_fileutils.rb: do test in more deep
	  directory.

	* test/fileutils/test_nowrite.rb: ditto.

Tue Nov 25 19:04:23 2003  Tanaka Akira  <akr@m17n.org>

	* lib/open-uri.rb (URI::Generic#find_proxy): ENV case sensitivity test
	  refined.

Tue Nov 25 18:13:30 2003  Minero Aoki  <aamine@loveruby.net>

	* test/fileutils/test_fileutils.rb: chdir Dir.tmpdir before each
	  test. [ruby-dev:22045]

	* test/fileutils/test_nowrite.rb: ditto.

Tue Nov 25 17:52:11 2003  Tanaka Akira  <akr@m17n.org>

	* lib/open-uri.rb (URI::Generic#find_proxy): use http_proxy under CGI
	  if the environment variable is case sensitive.

Tue Nov 25 16:41:33 2003  NAKAMURA, Hiroshi  <nahi@ruby-lang.org>

	* test/wsdl/multiplefault.wsdl, test/wsdl/test_multiplefault.rb:
	  removed.  this test requires extra libraries in soap4r/1.5.*.

Tue Nov 25 16:24:42 2003  NAKAMURA, Hiroshi  <nahi@ruby-lang.org>

	* lib/soap/**/*.rb, lib/wsdl/**/*.rb, lib/xsd/**/*.rb: changed license;
	  GPL2 -> Ruby's.

	* lib/soap/rpc/driver.rb, lib/soap/wsdlDriver.rb,
	  lib/soap/streamHandler.rb: add interface to streamhandler.

	* lib/soap/marshal.rb: raise error if parse fails.

	* lib/soap/netHttpClient.rb: add https support.  Patched by
	  Oliver M. Bolzer.

	* lib/soap/netHttpClient.rb: dump HTTP response message body by itself.

	* lib/soap/rpc/driver.rb, lib/soap/rpc/proxy.rb,
	  lib/soap/wsdlDriver.rb: add driver#mandatorycharset interface to foce
	  using charset for parsing response from buggy server.

	* lib/soap/encodingstyle/soapHandler.rb: support Apache Axis's half
	  typed multi-ref array.

	* lib/soap/mapping/factory.rb, lib/soap/mapping/registry.rb: map
	  SOAPStruct which has multi-accessors which name are the same, to an
	  array.

	* lib/soap/rpc/element.rb: fixed illegal parameter order.

	* lib/soap/rpc/element.rb: element name of response message could have
	  the name other than 'return'.

	* lib/wsdl/operation.rb, lib/wsdl/operationBinding.rb,
	  lib/wsdl/soap/classDefCreator.rb, lib/wsdl/soap/methodDefCreator.rb,
	  lib/wsdl/soap/methodDefCreatorSupport.rb: WSDL/1.1 allows plural
	  fault definition in a operation. [ruby-talk:84948]

	* test/wsdl/multiplefault.wsdl, test/wsdl/test_multiplefault.rb: add
	  test for above fix.

	* lib/wsdl/soap/complexType.rb: support WSDL array definition with
	  maxOccures="unbound".

	* lib/xsd/charset.rb: use cp932 under emx.  Patched by
	  Siena. / SHINAGAWA, Norihide in [ruby-dev:21972]

	* lib/xsd/xmlparser/parser.rb: set @charset nil by default.  Nil means
	  'follow encoding declaration in XML'.

	* sample/soap/digraph.rb, sample/wsdl/amazon/wsdlDriver.rb,
	  sample/wsdl/googleSearch/sampleClient.rb,
	  sample/wsdl/googleSearch/wsdlDriver.rb,
	  test/wsdl/test_emptycomplextype.rb,
	  test/wsdl/marshal/test_wsdlmarshal.rb,
	  test/xsd/test_xmlschemaparser.rb: use File.open(...) { |f| f.read }
	  instead of File.open(...).read. [ruby-dev:21964]

	* test/wsdl/emptycomplextype.wsdl, test/wsdl/test_emptycomplextype.rb:
	  simplify the test case.

	* test/wsdl/axisArray/*: add tests for axis's array encoding.

Tue Nov 25 16:15:29 2003  WATANABE Hirofumi  <eban@ruby-lang.org>

	* ruby.h: don't treat Cygwin as Windows.

Tue Nov 25 15:18:28 2003  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* configure.in: change default value of --enable-pthread (default: no)

Tue Nov 25 07:31:16 2003  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* parse.y (primary): allow newlines just before right argument
	  parenthesis.  (ruby-bugs:PR#1221)

Mon Nov 24 23:32:06 2003  Tanaka Akira  <akr@m17n.org>

	* lib/open-uri.rb (OpenURI.open_loop, URI::HTTP#proxy_open): use
	  catch/throw for redirection instead of exception.
	  (OpenURI.open_loop, OpenURI.redirectable?): restrict redirection.

Mon Nov 24 19:59:48 2003  Tanaka Akira  <akr@m17n.org>

	* lib/open-uri.rb (URI::Generic#find_proxy): use CGI_HTTP_PROXY
	  instead of HTTP_PROXY in the CGI environment.

Mon Nov 24 19:32:55 2003  WATANABE Hirofumi  <eban@ruby-lang.org>

	* ext/etc/extconf.rb: check for pw_passwd in struct passwd and
	  gr_passwd in struct group for DJGPP.

	* ext/etc/etc.c: ditto.

	* ext/Setup.dj: support for curses, etc, zlib.

Mon Nov 24 17:00:00 2003  Tanaka Akira  <akr@m17n.org>

	* lib/open-uri.rb: validate option names.
	  :content_length_proc and :progress_proc option implemented.

Mon Nov 24 14:53:10 2003  NAKAMURA Usaku  <usa@ruby-lang.org>

	* bcc32/Makefile.sub, win32/Makefile.sub, wince/Makefile.sub
	  (XCFLAGS): output empty value instead of `-DRUBY_EXPORT'.

Sat Nov 22 23:09:45 2003  WATANABE Hirofumi  <eban@ruby-lang.org>

	* configure.in: set enable_pthread to no on MinGW.

Sat Nov 22 22:56:20 2003  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* configure.in: add --enable-pthread option (default: yes)

Sat Nov 22 22:48:46 2003  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/lib/tk.rb: add Tk.grab_release and fix bug of TkComposite

	* ext/tk/lib/tkafter.rb: bug fix of TkAfter#start

	* ext/tk/sample/tkcombobox.rb: new sample script

	* ext/tcltklib/tcltklib.c: add native thread check

Sat Nov 22 18:49:47 2003  NAKAMURA Usaku  <usa@ruby-lang.org>

	* ext/curses/curses.c (window_nodelay): nodelay() of NetBSD's
	  libcruses returns no value, just like keypad().

Sat Nov 22 17:36:36 2003  NAKAMURA Usaku  <usa@ruby-lang.org>

	* bcc32/Makefile.sub, win32/Makefile.sub, wince/Makefile.sub
	  (HAVE_GETCWD): output to config.h.

	* bcc32/Makefile.sub, win32/Makefile.sub, wince/Makefile.sub
	  (XCFLAGS): output to config.status.

Sat Nov 22 13:10:10 2003  Minero Aoki  <aamine@loveruby.net>

	* lib/fileutils.rb (have_st_ino?): djgpp has valid st_ino.

Sat Nov 22 11:28:48 2003  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* gc.c (Init_stack): stack region is far smaller than usual if
	  pthread is used.

Sat Nov 22 07:30:00 2003  Nathaniel Talbott  <ntalbott@ruby-lang.org>

	* lib/test/unit/util/backtracefilter.rb: fixed a bug that occurred
	  when an exception had no backtrace.

	* test/testunit/util/test_backtracefilter.rb: ditto.

Fri Nov 21 16:44:18 2003  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/lib/tkentry.rb: fix the encoding trouble of percent
	  substitutions on validatecommand option of TkEntry widget

	* ext/tk/lib/tk.rb: fix bug on {pack|grid}_propagate() method

Fri Nov 21 16:12:11 2003  Akinori MUSHA  <knu@iDaemons.org>

	* ruby.1: Fix markups and grammar.

Fri Nov 21 14:49:42 2003  Minero Aoki  <aamine@loveruby.net>

	* ruby.1: wrote about ruby related environment variables.

Fri Nov 21 12:28:03 2003  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* marshal.c (w_extended): singleton methods should not be checked
	  when dumping via marshal_dump() or _dump(). [ruby-talk:85909]

Fri Nov 21 01:40:00 2003  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* configure.in: check <pthread.h>

	* ruby.h: include pthread.h if existence.
	  define is_ruby_native() macro when not HAVE_NATIVETHREAD

	* eval.c: undef is_ruby_native() function when not HAVE_NATIVETHREAD

Fri Nov 21 00:43:00 2003  Nathaniel Talbott  <ntalbott@ruby-lang.org>

	* lib/test/unit/assertions.rb: use #__send__ instead of #send.

	* lib/test/unit/testcase.rb: ditto.

Thu Nov 20 19:19:22 2003  WATANABE Hirofumi  <eban@ruby-lang.org>

	* configure.in: don't find the Cygwin's pthread library on MinGW.

Thu Nov 20 19:15:50 2003  Minero Aoki  <aamine@loveruby.net>

	* lib/fileutils.rb (have_st_ino?): emx (OS/2 with EMX) does not
	  have st_ino (always 0). [ruby-dev:21972]

	* lib/fileutils.rb (rename_cannot_overwrite_file?): emx does not
	  allow overwriting files by rename(2).

	* test/fileutils/test_fileutils.rb: windows? ->
	  have_drive_letter?, have_file_perm?

Thu Nov 20 17:50:58 2003  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/sample/tkballoonhelp.rb: new sample script

	* ext/tk/sample/tkmultilistbox.rb: ditto

	* ext/tk/sample/tktextframe.rb: ditto

Thu Nov 20 13:37:34 2003  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ruby.h: define is_ruby_native_thread() for no native thread
	  environment

	* eval.c: ditto

Thu Nov 20 12:42:47 2003  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* configure.in: always check existence of the pthread library

	* ruby.h: define macros for ruby's native thread check

	* eval.c: add ruby's native thread check

	* gc.c: ditto

Wed Nov 19 14:45:18 2003  Minero Aoki  <aamine@loveruby.net>

	* lib/net/http.rb (to_ary): print more friendly warning message.

Wed Nov 19 14:32:08 2003  Minero Aoki  <aamine@loveruby.net>

	* lib/fileutils.rb (fu_same?): add djgpp and wince.

	* lib/fileutils.rb (cannot_overwrite_file?): add wince.

Wed Nov 19 11:04:47 2003  NAKAMURA Usaku  <usa@ruby-lang.org>

	* lib/fileutils.rb (cannot_overwrite_file?, have_st_ino?): bccwin32
	  is same as mswin32.

Wed Nov 19 07:54:00 2003  Nathaniel Talbott  <ntalbott@ruby-lang.org>

	* lib/test/unit.rb: do not run tests if $! is set.

	* lib/test/unit/assertionfailederror.rb: extend StandardError instead
	  Exception (irb catches the former but not the latter).

Tue Nov 18 23:31:36 2003  WATANABE Hirofumi  <eban@ruby-lang.org>

	* missing/memmove.c (memmove): take void *, not char *.

	* missing.h (memmove): ditto.

	* missing.h (strchr, strrchr): return char *, not int.

Tue Nov 18 22:20:10 2003  Minero Aoki  <aamine@loveruby.net>

	* lib/fileutils.rb (fu_same?): temporal fix for windows.

Tue Nov 18 19:05:04 2003  Minero Aoki  <aamine@loveruby.net>

	* lib/fileutils.rb (fu_same?): check by inode instead of path
	  name, to detect two hard links pointing to the same content.

	* test/fileutils.rb: did not create correctly looped symlinks.

Tue Nov 18 18:23:05 2003  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* ext/stringio/stringio.c (strio_read): behave as IO at empty string.
	  [ruby-dev:21939], [ruby-dev:21941]

	* ext/stringio/stringio.c (strio_getc, strio_getline): set EOF flag.

	* ext/stringio/stringio.c (strio_rewind, strio_seek, strio_ungetc):
	  clear EOF flag.

	* test/stringio/test_stringio.rb: imported from [ruby-dev:21941].

Tue Nov 18 14:06:35 2003  Minero Aoki  <aamine@loveruby.net>

	* lib/fileutils.rb (fu_each_src_dest): raise if src==dest.
	  [ruby-talk:85344] [ruby-core:01699]

	* lib/fileutils.rb: use Object#is_a? instead of Class#=== to allow
	  e.g. remote objects for receivers.

	* lib/fileutils.rb: FileTest -> File.

	* lib/fileutils.rb: put parentheses for arguments of File.xxxx?

	* test/fileutils/test_fileutils.rb (test_cp): test "cp a a".

	* test/fileutils/test_fileutils.rb (test_mv): test "mv a a".

	* test/fileutils/test_fileutils.rb (test_ln): test "ln a a".

	* test/fileutils/test_fileutils.rb (test_ln_s): test "ln_s a a".

	* test/fileutils/test_fileutils.rb (test_install): test "install a a".

	* test/fileutils/fileasserts.rb: new method assert_symlink.

	* test/fileutils/fileasserts.rb: assert_is_directory -> assert_directory.

Mon Nov 17 19:38:49 2003  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* file.c (getcwdofdrv): avoid using getcwd() directly, use
	  my_getcwd() instead.

	* merged NeXT, OpenStep, Rhapsody ports patch from Eric Sunshine
	  <sunshine@sunshineco.com>.  [ruby-core:01596]

Mon Nov 17 10:50:27 2003  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* lib/optparse.rb (OptionParser::Completion::complete): allow least
	  common completion for three or more candidates.

Mon Nov 17 09:41:38 2003  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* lib/test/unit/ui/tk/testrunner.rb,
	  lib/test/unit/ui/gtk/testrunner.rb:
	  run GUI main loop in sub thread.

	* lib/test/unit/ui/gtk2/testrunner.rb: imported from rough.

	* lib/test/unit/autorunner.rb (keyword_display): sort keywords.

Sun Nov 16 18:10:57 2003  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* eval.c (rb_eval): iterator should return value from next inside
	  begin/rescue/end.  (ruby-bugs:PR#1218)

Sun Nov 16 13:26:07 2003  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* marshal.c (w_object): LINK check earlier than anything else,
	  i.e. do not dump TYPE_IVAR for already dumped objects.
	  (ruby-bugs:PR#1220)

	* eval.c (rb_eval): call "inherited" only when a new class is
	  generated; not on reopening.

	* eval.c (eval): prepend error position in evaluating string to
	  "mesg" attribute string only when it's available and is a
	  string.

Sun Nov 16 12:16:10 2003  Minero Aoki  <aamine@loveruby.net>

	* lib/net/protocol.rb: logging response body. [experimental]
	  [ruby-list:38800]

Sun Nov 16 10:49:38 2003  Gavin Sinclair  <gsinclair@soyabean.com.au>

	* lib/thread.rb (Thread.exclusive): wrap method definition in
	  class Thread to enable rdoc to process.

Sun Nov 16 09:45:23 2003  Minero Aoki  <aamine@loveruby.net>

	* lib/net/http.rb (set_debug_output): warn if method is called
	  after #start.  [ruby-dev:38798]

Sun Nov 16 04:41:33 2003  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (eval): do not re-raise exception to avoid unnecessary
	  exception copying, instead modify exception and internal
	  information to adjust eval().

	* eval.c (backtrace): can return the current frame information
	  only if lev < -1.

Sat Nov 15 22:16:42 2003  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* /ext/openssl/ossl_x509ext.c (ossl_x509extfactory_create_ext):
	  refine error message.

Sat Nov 15 10:05:40 2003  Tanaka Akira  <akr@m17n.org>

	* lib/open-uri.rb (OpenURI.open_loop, OpenURI::HTTP#proxy_open):
	  refactored to support options.
	  (Buffer): maintain size by this class.

Sat Nov 15 07:40:14 2003  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (rb_method_node): new API to retrieve method body.

Fri Nov 14 13:21:30 2003  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tcltklib/tcltklib.c: fix (en-bugged at 2003/11/07)

	* ext/tk/lib/tkdialog.rb: TkDialog.new accepts a parent widget
	  argument [ruby-talk:85066]

Thu Nov 13 20:53:35 2003  Tanaka Akira  <akr@m17n.org>

	* lib/open-uri.rb (Kernel[#.]open): hard coded URI schemes removed.
	  [ruby-ext:02251]

Thu Nov 13 19:17:00 2003  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* lib/test/unit/ui/tk/testrunner.rb: use grid and panedwindow
	  (if available)

Thu Nov 13 17:56:41 2003  Tanaka Akira  <akr@m17n.org>

	* lib/open-uri.rb (OpenURI.open_uri): use File::RDONLY.
	  reported by Take_tk <ggb03124@nifty.ne.jp>.
	  [ruby-ext:02245]

Thu Nov 13 16:45:53 2003  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* ext/openssl/ossl_x509req.c (ossl_x509req_to_der): add function for
	  X509::Request#to_der.

Thu Nov 13 11:31:14 2003  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* lib/optparse.rb (OptionParser::Completion#complete): prior shorter
	  name to containing longer name.

Thu Nov 13 06:08:54 2003  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/lib/tk.rb: stop freezing some classes

	* ext/tk/lib/multi-tk.rb: ditto.

Wed Nov 12 17:32:49 2003  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* lib/test/unit/assertions.rb (assert_throws, assert_nothing_thrown):
	  uncaught throw in sub thread raises ThreadError.

	* lib/test/unit/ui/tk/testrunner.rb (setup_ui): "expand" is not
	  necessary.

Wed Nov 12 14:09:43 2003  Shugo Maeda  <shugo@ruby-lang.org>

	* test/monitor/test_monitor.rb: fix the timing problem by Queue.

Wed Nov 12 12:59:44 2003  Shugo Maeda  <shugo@ruby-lang.org>

	* test/monitor/test_monitor.rb: added.

Wed Nov 12 10:14:28 2003  Shugo Maeda  <shugo@ruby-lang.org>

	* lib/monitor.rb: refactored. Thanks, Gennady Bystritsky.

Wed Nov 12 06:11:39 2003  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* ext/openssl/ossl.c (ossl_x509_sk2ary, ossl_x509crl_sk2ary):
	  add functions to convert STACK into Array.

	* ext/openssl/ossl.h: add prototypes.

	* ext/openssl/ossl_pkcs7.c (ossl_pkcs7_set_certificates,
	  ossl_pkcs7_get_certificates, ossl_pkcs7_get_crls,
	  ossl_pkcs7_set_crls): add functions for PKCS7#certificates=
	  PKCS7#certificates, PKCS7#crls= and PKCS7#crls.

Wed Nov 12 00:47:00 2003  Nathaniel Talbott  <ntalbott@ruby-lang.org>

	* lib/test/unit/ui/testrunnermediator.rb: should require 'test/unit'.

Tue Nov 11 23:54:00 2003  Nathaniel Talbott  <ntalbott@ruby-lang.org>

	* lib/test/unit/ui/gtk/testrunner.rb: added a rescue clause to handle
	  the case when the requested font is not available.

Tue Nov 11 22:44:08 2003  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* io.c (appendline): file may not end with newline.  a bug if
	  READ_DATA_PENDING_PTR is defined. [ruby-talk:84925]

Tue Nov 11 10:42:41 2003  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/lib/tk.rb: raise an exception when creating TkWindow
	  object, because TkWindow class is an abstract class.

Tue Nov 11 03:30:43 2003  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* lib/ext/openssl/ossl_conf.c (ossl_config_get_value): return nil
	  if the specified value doesn't exist.

	* lib/ext/openssl/ossl_conf.c (ossl_config_get_section): return
	  a empty hash if the specified section doesn't exist.

Mon Nov 10 11:40:29 2003  Shugo Maeda  <shugo@ruby-lang.org>

	* lib/monitor.rb (wait): return true on signal/broadcastfalse and
	  false on timeout. Thanks Gennady Bystritsky.

Mon Nov 10 00:07:10 2003  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* parse.y (primary): primary_value may be 0 when syntax error.
	  [ruby-talk:84893]

Sun Nov  9 02:05:00 2003  Nathaniel Talbott  <ntalbott@ruby-lang.org>

	* lib/test/unit/assertions.rb: un-deprecated #assert_not_nil to
	  maintain symmetry with #assert_nil. Also added better output for
	  #assert_kind_of.

	* test/testunit/tc_assertions.rb: ditto.

Sat Nov  8 18:50:20 2003  NAKAMURA, Hiroshi  <nahi@ruby-lang.org>

	* test/wsdl/raa/*: add new testcase for WSDL loading, parsing and
	  reading.

	* test/soap/marshal/*: backport from soap4r/1.5.1.  all differences are
	  for ruby/1.6.

	* lib/soap/*: backport from soap4r/1.5.1.  all differences are for
	  ruby/1.6.

	* lib/wsdl/data.rb, lib/wsdl/xmlSchema/data.rb: move definition of
	  ArrayTypeAttrName from ::WSDL::XMLSchema::* to ::WSDL::*.
	  [ruby-talk:84813]

	* lib/wsdl/soap/definitions.rb: element name typo in custom exception
	  struct definition which is needed for wsdlDriver; camelCase ->
	  underscore_name.

Sat Nov  8 13:49:50 2003  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* configure.in: improvement of pthread check

Sat Nov  8 13:28:46 2003  Takaaki Tateishi  <ttate@ttsky.net>

	* ext/dl/sym.c: Add DL.win32_last_error and DL.last_error.
	  Thanks, Kaoru Shirai.

Sat Nov  8 06:19:38 2003  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tcltklib/tcltklib.c: To fix 'pthread-enabled Tcl/Tk' problem,
	  TclTkIp#_eval calls Tcl_Eval() on the mainloop thread only
	  (queueing a handler to the EventQueue).

	* ext/tcltklib/README.1st: edit the description of '--with-pthread-ext'

Fri Nov  7 23:23:04 2003  Tanaka Akira  <akr@m17n.org>

	* lib/pathname.rb (Pathname#+): if self or the argument is `.', return
	  another.
	  (Pathname#parent): if self is `.', return `..'.
	  (Pathname#children): if self is `.', don't prepend self for a
	  pathname in a result.
	  (Pathname#join): re-implemented using Pathname#+.
	  (Pathname#find): if self is `.', remove `./' prefix of yielding
	  pathname.

Fri Nov  7 10:23:24 2003  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* ext/socket/socket.c (make_hostent): get rid of SEGV on aliases
	  lookup failure.  (ruby-bugs:PR#1215)

Fri Nov  7 04:08:05 2003  UENO Katsuhiro  <katsu@blue.sky.or.jp>

	* ext/zlib/zlib.c (Init_zlib): define Zlib::GzipReader#each_line as
	  an alias of Zlib::GzipReader#each.

Fri Nov  7 01:03:16 2003  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (rb_load): save and restore rb_prohibit_interrupt.
	  [ruby-dev:21857]

Thu Nov  6 18:05:07 2003  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* io.c (rb_io_inspect): show the path also at a closed file.
	  [ruby-dev:21851]

Thu Nov  6 11:42:07 2003  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* ext/stringio/stringio.c (strio_set_string, strio_reopen): check
	  tainted.

	* ext/stringio/stringio.c (strio_copy, strio_ungetc, strio_write,
	  strio_putc): add infection.

	* ext/stringio/stringio.c (strio_path): just nil.  [ruby-dev:21846]

	* ruby.c (proc_options): reserve searched script path in the
	  source file name table.  [ruby-list:38765]

	* lib/optparse.rb (OptionParser::Completion#complete): default not to
	  ignore case on completion.  [ruby-talk:84726]

	* win32/win32.c (make_cmdvector): process backslashes even if a quote
	  is not enclosed.

Wed Nov  5 23:49:45 2003  NAKAMURA, Hiroshi  <nahi@ruby-lang.org>

	* sample/openssl/gen_csr.rb: there (at least) is a CA which does not
	  accept DN in UTF8STRING format.  it's a sample.

Wed Nov  5 22:55:16 2003  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* configure.in, eval.c, signal.c: : add '--with-pthread-ext'
	  option to fix the pthread trouble on 'tcltklib'

	* ext/tcltklib/README.1st: add the description of '--with-pthread-ext'

	* ext/tk/lib/tktext.rb: add TkText#text_copy, text_cut, text_paste
	  to support Tcl/Tk8.4's tk_textCopy, tk_textCut, tk_textPaste

	* ext/tk/lib/tk.rb: add TkMenu#set_focus support Tcl/Tk's
	  tk_menuSetFocus

Wed Nov  5 17:33:45 2003  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (rb_load): allow interrupt during loaded program
	  evaluation.  [ruby-dev:21834]

	* hash.c (rb_hash_fetch): always warn if default argument and a
	  block are supplied at the same time. [ruby-dev:21842]

	* hash.c (env_fetch): ditto.

	* array.c (rb_ary_fetch): ditto.

Wed Nov  5 19:08:47 2003  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* lib/optparse.rb (OptionParser::Switch::PlacedArgument::parse):
	  do not remove next argument if empty value is placed.

	* test/optparse: added.

Wed Nov  5 17:05:18 2003  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* lib/test/unit/ui/gtk/testrunner.rb: typo.

Wed Nov  5 11:13:32 2003  NAKAMURA Usaku  <usa@ruby-lang.org>

	* string.c: add #include "version.h". this file still depends on it.

	* Makefile.in, bcc32/Makefile.sub, win32/Makefile.sub,
	  wince/Makefile.sub: add version.h dependency to string.c.

Wed Nov  5 09:14:23 2003  Shugo Maeda  <shugo@ruby-lang.org>

	* lib/monitor.rb: revert to the previous revision.

Wed Nov  5 08:39:51 2003  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* lib/webrick/https.rb (HTTPRequest#parse): set @client_cert_chain.

	* lib/webrick/https.rb (HTTPRequest#meta_vars): create
	  SSL_CLIENT_CERT_CHAIN_n from @client_cert_chain.

	* ext/openssl/ossl_ssl.c (ossl_ssl_get_peer_cert_chain): return nil
	  if no cert-chain was given.

Tue Nov  4 23:44:48 2003  NAKAMURA Usaku  <usa@ruby-lang.org>

	* bcc32/Makefile.sub, win32/Makefile.sub, wince/Makefile.sub:
	  remove needless version.h dependency.

Tue Nov  4 23:38:43 2003  WATANABE Hirofumi  <eban@ruby-lang.org>

	* class.c, hash.c, string.c: remove #include "version.h".

	* Makefile.in: remove needless version.h dependency.

Tue Nov  4 06:54:52 2003  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* io.c (read_all): fptr->f may be NULL, if IO is closed in the
	  signal handler.

	* io.c (io_read): ditto.

	* string.c (get_pat): remove 1.8.0 warning code.

	* string.c (rb_str_match): extend warning until 1.8.2.

	* string.c (rb_str_match2): ditto.

	* class.c (class_instance_method_list): remove 1.8.0 warnings.
	  method_list now recurs.  [ruby-dev:21816]

	* class.c (rb_obj_singleton_methods): ditto.

	* array.c (rb_ary_select): remove select with block.
	  [ruby-dev:21824]

	* hash.c (rb_hash_select): ditto.

	* hash.c (env_select): ditto.

	* re.c (match_select): ditto.

	* struct.c (rb_struct_select): ditto.

Mon Nov  3 22:53:21 2003  Minero Aoki  <aamine@loveruby.net>

	* lib/racc/parser.rb: synchronize with Racc 1.4.4.

	* ext/racc/cparse/cparse.c: ditto.

	* ext/racc/cparse/cparse.c (parse_main): should abort when
	  the length of LR state stack <=1, not ==0.

Mon Nov  3 08:50:47 2003  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* process.c (check_uid_switch): remove duplicated error messages.

	* process.c (check_gid_switch): ditto.

Sun Nov  2 02:28:33 2003  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* lib/webrick/ssl.rb: new option :SSLExtraChainCert.

Sun Nov  2 01:02:04 2003  Akinori MUSHA  <knu@iDaemons.org>

	* string.c (rb_str_hash): Update the HASH_PERL alternative hash
	  algorithm in sync with Perl 5.8.

	* st.c (strhash): Ditto.

Sat Nov  1 18:21:09 2003  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* ext/openssl/ossl_ssl.c (ossl_ssl_peer_cert_chain): add new method
	  SSLSocket#peer_cert_chain.

	* ext/openssl/ossl_x509req.c (GetX509ReqPtr): new function
	  which returns underlying X509_REQ.

	* ext/openssl/ossl_x509ext.c (ossl_x509extfactory_set_issuer_cert,
	  ossl_x509extfactory_set_subject_cert, ossl_x509extfactory_set_crl,
	  ossl_x509extfactory_set_subject_req, ossl_x509extfactory_set_config):
	  use underlying C struct without duplication not to leak momory.

Sat Nov  1 01:49:03 2003  NAKAMURA, Hiroshi  <nahi@ruby-lang.org>

	* lib/soap/mapping/factory.rb: mark marshalled basetype objects when
	  @allow_original_mapping is true.  multi-referencing basetype node is
	  prohibited in SOAP/1.1 encoding but soap4r's original ruby object
	  mapping requires basetype to be marked to detect self referencing
	  loop.  e.g. o = 1; o.instance_eval { @iv = o }  soap4r's original
	  mapping is only used through soap/marshal API.

	* test/soap/marshal/test_marshal.rb: add tests for self referencing
	  immutable objects.

	* test/soap/calc/test_calc_cgi.rb: fix test name.

Fri Oct 31 22:26:29 2003  Takaaki Uematsu  <uema2x@jcom.home.ne.jp>

	* wince/string_wce.c (strrchr): should decrement pointer.

	* wince/Makefile.sub: correct a range of isdigit().

Fri Oct 31 12:55:24 2003  WATANABE Hirofumi  <eban@ruby-lang.org>

	* configure.in, lib/mkmf.rb: add RPATHFLAG for NetBSD.
	  [ruby-dev:21791]

	* bcc32/Makefile.sub, win32/Makefile.sub, win32/Makefile.sub: ditto.

Fri Oct 31 01:38:14 2003  NAKAMURA Usaku  <usa@ruby-lang.org>

	* wince/Makefile.sub, win32/Makefile.sub (.y.c): allow white spaces
	  at the beginning of line to remove by sed. (ruby-bugs-ja:PR#580)

Fri Oct 31 01:02:24 2003  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* compar.c (cmp_equal): protect exceptions from <=> comparison
	  again.  returns nil if any exception or error happened during
	  comparison.

	* eval.c (search_required): should update *featurep when DLEXT2 is
	  defined. (ruby-bugs-ja:PR#581)

Thu Oct 30 23:41:04 2003  Masatoshi SEKI  <m_seki@mva.biglobe.ne.jp>

	* lib/drb/drb.rb: add DRbArray

	* lib/drb/invokemethod.rb: fix Hash#each problem. [ruby-dev:21773]

	* lib/drb/unix.rb: add LoadError. [ruby-dev:21743]

Thu Oct 30 23:19:11 2003  NAKAMURA, Hiroshi  <nahi@ruby-lang.org>

	* lib/soap/generator.rb: better XML pretty printing.

	* lib/soap/encodingstyle/soapHandler.rb: remove unnecessary namespace
	  assignment in the element which has "encodingStyle" attribute, and
	  add necessary namespace assignment for "arrayType" attribute.

	* test/soap/calc/test_calc_cgi.rb: take over $DEBUG to ruby process
	  through CGI.

Thu Oct 30 22:59:39 2003  why the lucky stiff  <why@ruby-lang.org>

	* ext/syck/yaml2byte.c: HASH const too long.  Thanks, matz.

Thu Oct 30 19:13:53 2003  Akinori MUSHA  <knu@iDaemons.org>

	* ext/syck/MANIFEST: Add yamlbyte.h.

Thu Oct 30 14:25:31 2003  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* io.c (READ_DATA_BUFFERED): new macro to detect whether stdio
	  buffer filled.

	* io.c (rb_io_fptr_cleanup): move path deallocation to
	  rb_io_fptr_finalize (finalizer called by GC).

Thu Oct 30 13:23:39 2003  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* parse.y (logop): left may be NULL. [ruby-talk:84539]

	* eval.c (rb_eval): NODE_CASE nd_head may be NULL.

Thu Oct 30 10:14:51 2003  NAKAMURA, Hiroshi  <nahi@ruby-lang.org>

	* lib/test/unit/autorunner.rb: make fox runner work.

Thu Oct 30 09:32:26 2003  NAKAMURA Usaku  <usa@ruby-lang.org>

	* process.c (rb_f_system): fixed lack of security check before
	  calling do_spawn() on win32. [ruby-talk:84555]

Thu Oct 30 02:46:35 2003  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (proc_invoke): single array value to normal Proc#call
	  (i.e. not via lambda call), should be treated just like yield.
	  [ruby-dev:21726]

Thu Oct 30 02:25:48 2003  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* ext/openssl/lib/openssl/buffering.rb (Buffering#initialize):
	  add new method to inherit @sync from @io.sync.

	* ext/openssl/lib/net/protocols.rb (SSLIO#ssl_connect): no need to
	  set sync flag explicitly.

	* ext/openssl/ossl_ssl.c (ossl_sslctx_initialize): call super.

	* ext/openssl/ossl_ssl.c (ossl_sslctx_setup): set extra chain
	  certificates in @extra_chain_cert.

Wed Oct 29 22:02:04 2003  NAKAMURA, Hiroshi  <nahi@ruby-lang.org>

	* test/drb/drbtest.rb: use rbconfig.rb to make the path of ruby
	  interpreter to exec, instead of test/ruby/envutil.rb,

Wed Oct 29 19:58:59 2003  NAKAMURA Usaku  <usa@ruby-lang.org>

	* ext/tcltklib/tcltklib.c (CONST84): define CONST84 when it is not
	  defined and TCL_MAJOR_VERSION >= 8.

	* ext/tcltklib/tcltklib.c (VwaitVarProc, WaitVariableProc,
	  rb_threadVwaitProc): use CONST84 instead of CONST.

	* ext/tcltklib/tcltklib.c (ip_rbTkWaitCommand,
	  ip_rb_threadTkWaitCommand): use CONST84 always.

Wed Oct 29 17:27:05 2003  Tanaka Akira  <akr@m17n.org>

	* re.c (rb_reg_s_union, Init_Regexp): new method `Regexp.union'.

	* lib/pathname.rb (realpath): examine Dir.pwd because it may have
	  symlinks.

Wed Oct 29 17:16:31 2003  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* eval.c (rb_longjmp): must not disturb original jump.
	  [ruby-dev:21733]

Wed Oct 29 15:28:34 2003  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (Init_Proc): taint preallocated exception object
	  sysstack_error. [ruby-talk:84534]

Wed Oct 29 11:27:39 2003  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* parse.y (ret_args): node may be NULL. [ruby-talk:84530]

Tue Oct 28 15:20:12 2003  NAKAMURA Usaku  <usa@ruby-lang.org>

	* ext/tcltklib/tcltklib.c (VwaitVarProc, ip_rbVwaitObjCmd,
	  WaitVariableProc, WaitVisibilityProc, WaitWindowProc,
	  ip_rbTkWaitObjCmd, ip_rbTkWaitCommand, rb_threadVwaitProc,
	  rb_threadWaitVisibilityProc, rb_threadWaitWindowProc,
	  ip_rb_threadVwaitObjCmd, ip_rb_threadTkWaitObjCmd): prototype;
	  avoid VC++ warnings.

Mon Oct 27 19:19:55 2003  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* eval.c (rb_longjmp): ignore reentering error while warning.
	  [ruby-dev:21730]

Mon Oct 27 00:23:50 2003  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tcltklib/tcltklib.c (ip_ruby): bug fix on Win : hang-up when
	  calling 'exit' in the Tk callback procedure. [ruby-list:38656]

Sat Oct 25 09:18:04 2003  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (rb_method_missing): protect exception from within
	  "inspect".  (ruby-bugs:PR#1204)

Fri Oct 24 23:26:34 2003  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* hash.c (rb_hash_each): Hash#each should yield single value.
	  [ruby-talk:84420]

	* hash.c (env_each): ditto for ENV.each.

Thu Oct 23 20:25:32 2003  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* lib/webrick/server.rb (GenericServer#start): should rescue
	  IOError from IO::accept. [ruby-dev:21692]

Thu Oct 23 17:59:36 2003  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* eval.c (ruby_cleanup): initialize stack bottom for embedding.
	  [ruby-dev:21686]

	* ext/dl/extconf.rb: move list of files to clean from DEPEND file,
	  to get rid of macro redefinitions.

Thu Oct 23 13:44:00 2003  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* parse.y: integrate operations for stack_type.  [ruby-dev:21681]

Thu Oct 23 00:41:45 2003  NAKAMURA, Hiroshi  <nahi@ruby-lang.org>

	* test/soap/calc/*, test/soap/helloworld/*: set logging threshold
	  to ERROR.

Wed Oct 22 12:53:31 2003  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* lib/test/unit/collector/dir.rb (Test::Unit::Collector::Dir#collect_file):
	  ignore tests which raised LoadError.

	* test/drb/drbtest.rb, test/ruby/test_beginendblock.rb,
	  test/ruby/test_system.rb: avoid requiring same file twice.

	* test/drb/test_drbssl.rb, test/drb/test_drbunix.rb: should not use
	  ARGV unless invoked directly.  do not create test cases unless
	  required libraries are available.

Wed Oct 22 02:31:34 2003  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (ruby_cleanup): should not ignore exit_value in END
	  execution. [ruby-dev:21670]

Tue Oct 21 23:16:26 2003  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (ruby_cleanup): call finalizers and exit procs before
	  terminating threads.

	* eval.c (ruby_cleanup): preserve ruby_errinfo before ruby_finalize_0().

Tue Oct 21 15:57:11 2003  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* lib/test/unit/collector/dir.rb (Test::Unit::Collector::Dir#collect_file):
	  prepend the directory of target file to the load path.

Tue Oct 21 15:08:53 2003  NAKAMURA Usaku  <usa@ruby-lang.org>

	* win32/win32.c (do_spawn, do_aspawn): should wait child process even
	  if callded with P_OVERLAY.

	* win32/win32.c (do_spawn, do_aspawn): should return child's exit
	  status to parent.

Tue Oct 21 00:35:02 2003  NAKAMURA, Hiroshi  <nahi@ruby-lang.org>

	* test/soap/calc/*, test/soap/helloworld/*: catch the exception from
	  test server thread and recover.

Tue Oct 21 00:22:57 2003  Masatoshi SEKI  <m_seki@mva.biglobe.ne.jp>

	* test/drb/*: import drb/runit.

Mon Oct 20 23:55:47 2003  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* eval.c (rb_eval): set current node after arguments evaluation.
	  [ruby-dev:21632]

	* eval.c (rb_yield_0): set current node and keep it at local jump.

Mon Oct 20 22:01:18 2003  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* eval.c (rb_thread_cleanup): keep thread group for main thread.
	  [ruby-dev:21644]

Mon Oct 20 18:28:10 2003  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* eval.c (rb_catch): backout.

Mon Oct 20 17:31:46 2003  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (PUSH_FRAME): generate unique number to be TAG_JUMP()
	  destination.

	* eval.c (localjump_destination): use unique number in ruby_frame
	  for localjump destination.

Mon Oct 20 11:31:44 2003  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* test/ruby/test_signal.rb (test_signal): restore old trap.

Mon Oct 20 11:00:46 2003  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* gc.c (gc_sweep): loosen page free condition to avoid add_heap()
	  race condition. [ruby-dev:21633]

	* gc.c (gc_sweep): do not update malloc_limit when malloc_increase
	  is smaller than malloc_limit.

Mon Oct 20 09:45:12 2003  NAKAMURA Usaku  <usa@ruby-lang.org>

	* lib/debug.rb (debug_command): remove debug print.

Sun Oct 19 13:12:30 2003  Tanaka Akira  <akr@m17n.org>

	* lib/pathname.rb (foreachline, dir_foreach): add obsolete warning.

Sun Oct 19 00:14:22 2003  NAKAMURA, Hiroshi  <nahi@ruby-lang.org>

	* test/soap/calc/*, test/soap/helloworkd/*: changed port# of test
	  server. (17171)

Sat Oct 18 23:01:32 2003  WATANABE Hirofumi  <eban@ruby-lang.org>

	* missing/acosh.c (DBL_MANT_DIG): typo fix(ifdef -> ifndef).

Sat Oct 18 05:48:59 2003  why the lucky stiff  <why@ruby-lang.org>

	* ext/syck/rubyext.c: YAML::Syck::compile method.

	* ext/syck/syck.c: Buffer edge bug.

	* ext/syck/yaml2byte.c: YAML to bytecode converter.

	* ext/syck/yamlbyte.h: Ditto.

	* ext/syck/bytecode.c: Bytecode parser fixes to empty collections
	  and empty strings.

	* ext/syck/token.c: Ditto.

Fri Oct 17 23:07:38 2003  Akinori MUSHA  <knu@iDaemons.org>

	* ext/enumerator/enumerator.c, ext/enumerator/enumerator.txt:
	  Provide Kernel#to_enum as an alias for Kernel#enum_for.  Maybe
	  this is a better name.

Fri Oct 17 23:00:30 2003  Akinori MUSHA  <knu@iDaemons.org>

	* lib/generator.rb: Add rdoc documentation.

Fri Oct 17 22:16:42 2003  Akinori MUSHA  <knu@iDaemons.org>

	* lib/set.rb: Reword and fix Overview.

	* lib/set.rb: It is not necessary to require
	  'test/unit/ui/console/testrunner'.

Fri Oct 17 11:15:22 2003  NAKAMURA Usaku  <usa@ruby-lang.org>

	* test/ruby/test_range.rb: added.

	* MANIFEST: add test/ruby/test_range.rb.

Fri Oct 17 03:21:23 2003  William Sobel  <will.sobel@barra.com>

	* ext/socket/socket.c (make_hostent): h_aliases may be NULL.
	  (ruby-bugs:PR#1195)

	* ext/socket/socket.c (sock_s_gethostbyaddr): ditto.

Fri Oct 17 00:12:41 2003  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/lib/tk.rb: (bug fix) instance variable @frame was used
	  without initializing on TkComposite module.

Thu Oct 16 23:51:04 2003  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/lib/tk.rb: If $DEBUG == true and some exception is caused
	  in a callback operation, Ruby/Tk shows a (verbose) backtrace
	  information on the callback process.

Thu Oct 16 17:09:19 2003  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* lib/debug.rb (DEBUGGER__::Context::debug_command): do not call
	  debug_silent_eval() when $1 is not set. (ruby-bugs:PR#1194)

Thu Oct 16 16:54:57 2003  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* string.c (rb_str_upto): ("a"..."a").to_a should return [].
	  [ruby-core:01634]

Thu Oct 16 16:40:51 2003  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/lib/tk.rb:
	  Add Tk::EncodedString and Tk::UTF8_String class to support
	  characters using the \uXXXX escape to the UNICODE string.

	* ext/tk/sample/{demos-en,demos-jp}/unicodeout.rb
	  new demo-scripts (samples of Tk::UTF8_String)

	* ext/tk/sample/{demos-en,demos-jp}/widget
	  add entries for 'unicodeout.rb'

Thu Oct 16 08:38:06 2003  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* test/digest/test_digest.rb (test_eq): show failed class.

	* test/ruby/test_iterator.rb (test_break, test_return_trace_func):
	  test localjump destination.

Wed Oct 15 20:22:31 2003  NAKAMURA, Hiroshi  <nahi@ruby-lang.org>

	* lib/soap/netHttpClient.rb: use URI::HTTP#request_uri instead of
	  instance_eval('path_query').  [ruby-list:38575]

Wed Oct 15 17:24:45 2003  URABE Shyouhei  <root@mput.dip.jp>

	* lib/cgi.rb (CGI::Cookie): tiny typo fix.

Wed Oct 15 15:00:54 2003  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* eval.c (ruby_run): just return FAILURE instead of parse error
	  count.  [ruby-list:38569]

Wed Oct 15 13:17:02 2003  NAKAMURA Usaku  <usa@ruby-lang.org>

	* ext/digest/digest.c (rb_digest_base_alloc): need to initialize
	  buffer. [ruby-dev:21622]

Wed Oct 15 11:23:05 2003  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* marshal.c (w_object): dump extended modules as well.

	* marshal.c (r_object0): TYPE_USRMARSHAL should restore extended
	  modules before invoking marshal_load.  these two fixes are done
	  by Masatoshi Seki <m_seki@mva.biglobe.ne.jp>.

Wed Oct 15 09:30:34 2003  NAKAMURA Usaku  <usa@ruby-lang.org>

	* ext/enumerator/enumerator.c (enumerator_each): avoid VC++ warning.

	* ext/syck/syck.h: include stdio.h for definition of FILE.

Wed Oct 15 08:09:07 2003  why the lucky stiff  <why@ruby-lang.org>

	* ext/syck/bytecode.c: Checkin of YAML bytecode support.

	* ext/syck/gram.c: Ditto.

	* ext/syck/syck.c: Ditto.

	* ext/syck/token.c: Ditto.

	* ext/syck/handler.c: Ditto.

	* ext/syck/handler.c: Now using 'tag' rather than 'taguri' in type URIs.

	* ext/syck/rubyext.c: Ditto (on both counts).

Wed Oct 15 05:05:53 2003  Akinori MUSHA  <knu@iDaemons.org>

	* lib/generator.rb: A new library which converts an internal
	  iterator to an external iterator.

	* lib/abbrev.rb: A new library which creates an abbreviation table
	  from a list.

Wed Oct 15 04:31:51 2003  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/sample/demos-en/entry3.rb, ext/tk/sample/demos-jp/entry3.rb:
	  new demo-scripts

	* ext/tk/sample/demos-en/widget, ext/tk/sample/demos-jp/widget:
	  add entries for 'entry3.rb'

Wed Oct 15 04:31:47 2003  Akinori MUSHA  <knu@iDaemons.org>

	* test/digest/test_digest.rb: Moved from ext/digest/test.rb.

Wed Oct 15 03:53:20 2003  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/lib/tk.rb: fixed trouble on auto-load Tcl commands (enbug
	  on the last commit).

Wed Oct 15 00:25:00 2003  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* parse.y (yylex): argument parentheses preceded by spaces should
	  be warned; not error.  [ruby-talk:84103]

Wed Oct 15 00:20:15 2003  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tcltklib/tcltklib.c: replace Tcl/Tk's vwait and tkwait to
	  switch on threads smoothly and avoid seg-fault.

	* ext/tcltklib/tcltklib.c: add TclTkIp._thread_vwait and
	  _thread_tkwait for waiting on a thread. (Because Tcl/Tk's vwait
	  and tkwait command wait on an eventloop.)

	* ext/tk/lib/multi-tk.rb: support TclTkIp._thread_vwait and
	  _thread_tkwait.

	* ext/tk/lib/tk.rb: now, TkVariable#wait has 2 arguments.
	  If 1st argument is true, waits on a thread. If false, waits on
	  an eventloop. If 2nd argument is true, checks existence of
	  rootwidgets. If false, doesn't. Default is wait(true, false).

	* ext/tk/lib/tk.rb: add TkVariable#tkwait(arg) which is equal to
	  TkVariable#wait(arg, true). wait_visibility and wait_destroy
	  have an argument for waiting on a thread or an eventloop.

	* ext/tk/lib/tk.rb: improve of accessing Tcl/Tk's special variables.

	* ext/tk/lib/tkafter.rb: support 'wait on a thread' and 'wait on
	  an eventloop'.

Wed Oct 15 00:10:24 2003  NAKAMURA, Hiroshi  <nahi@ruby-lang.org>

	* lib/soap/baseData.rb: Introduce SOAPType as the common ancestor of
	  SOAPBasetype and SOAPCompoundtype.

	* lib/soap/generator.rb, lib/soap/element.rb, lib/soap/encodingstyle/*:
	  Encoding methods signature change.  Pass SOAPGenerator as a parameter.

	* lib/soap/mapping/*, test/soap/marshal/test_marshal.rb: Refactoring
	  for better marshalling/unmarshalling support.  Now I think SOAP
	  marshaller supports all kind of object graph which is supported by
	  Ruby's original marshaller.  Of course there could be bugs as always.
	  Find it.  :-)

	* lib/soap/rpc/standaloneServer.rb: Set severity threshould to INFO.
	  DEBUG is too noisy.

	* lib/xsd/datatypes.rb: DateTime#of is obsoleted.  Use DateTime#offset.

	* test/wsdl/emptycomplextype.wsdl, test/xsd/xmlschema.xml: Avoid
	  useless warning.

Tue Oct 14 19:09:35 2003  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* eval.c (ruby_finalize_0): return the given exit status unless
	  SystemExit got raised.

Tue Oct 14 11:53:49 2003  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* intern.h (ruby_stop): never return.

	* ruby.h (ruby_run): ditto.

Tue Oct 14 04:43:55 2003  Tanaka Akira  <akr@m17n.org>

	* lib/pathname.rb (realpath): make ELOOP check bit more robust.
	  (children): prepend self by default.
	  (chroot): obsoleted.

Tue Oct 14 02:29:31 2003  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* eval.c (rb_require_safe): segfault after loading .so.

Tue Oct 14 02:05:23 2003  Akinori MUSHA  <knu@iDaemons.org>

	* ext/Setup*, ext/enumerator/*: Add ext/enumerator, a helper
	  module for the Enumerable interface.

Mon Oct 13 23:55:59 2003  WATANABE Hirofumi  <eban@ruby-lang.org>

	* test/ruby/envutil.rb: use Config::CONFIG["ruby_install_name"],
	  not "ruby".

Mon Oct 13 23:57:29 2003  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* eval.c (rb_feature_p): match by classified suffix.

	* eval.c (rb_require_safe): require library in the specified safe
	  level.

	* variable.c (rb_autoload, rb_autoload_load): restore safe level
	  when autoload was called.  [ruby-dev:21338]

	* intern.h: prototypes; rb_require_safe.

	* test/runner.rb: accept non-option arguments.

Mon Oct 13 20:49:51 2003  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* string.c (str_new4): should not preserve FL_TAINT status in the
	  internal shared string. [ruby-dev:21601]

	* string.c (rb_str_new4): ditto.

	* eval.c: use EXIT_SUCCESS and EXIT_FAILURE for exit values.

	* process.c: ditto. [ruby-list:38521]

Mon Oct 13 19:51:02 2003  Koji Arai  <jca02266@nifty.ne.jp>

	* lib/debug.rb (debug_command): should enter emacs mode when
	  assigned any value to the environment variable "EMACS".
	  On Meadow, (getenv "EMACS") is "meadow".

Sun Oct 12 14:45:03 2003  WATANABE Hirofumi  <eban@ruby-lang.org>

	* ext/win32ole/extconf.rb: check "windows.h", not "windows".
	  [ruby-talk:84051]

Sat Oct 11 20:41:03 2003  Corinna Vinschen  <corinna@vinschen.de>

	* file.c (eaccess): Use access(2) on Cygwin.

Sat Oct 11 17:09:21 2003  WATANABE Hirofumi  <eban@ruby-lang.org>

	* lib/rexml/quickpath.rb (REXML::QuickPath::match):
	  escape '[' to avoid warning.

Sat Oct 11 16:08:41 2003  Tanaka Akira  <akr@m17n.org>

	* lib/pathname.rb (realpath): check existence of the file.

	* lib/pathname.rb (realpath): re-implemented.
	  (realpath_root?, realpath_rec): removed

Sat Oct 11 10:19:39 2003  Shugo Maeda  <shugo@ruby-lang.org>

	* lib/monitor.rb: handle exceptions correctly. Thanks, Gennady
	  Bystritsky.

Fri Oct 10 07:50:54 2003  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* eval.c (is_defined): inheritance line adjustment as like as
	  rb_call_super().

Fri Oct 10 01:19:00 2003  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* ext/openssl/ossl_x509name.c (ossl_x509name_initialize): add
	  optional argument to specify the DirectoryString type
	  (ASN1::UTF8STRING by default). RFC3280 deprecates PrintableString
	  for DirectoryString, and strongly requires to use UTF8String for
	  all certificates issued after December, 31 2003.

	* ext/openssl/lib/openssl/x509.rb (X509::Name::parse): ditto.

Thu Oct  9 23:50:21 2003  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* eval.c (rb_thread_start_0): prevent thread from GC.
	  [ruby-dev:21572]

Thu Oct  9 19:11:44 2003  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* eval.c (rb_thread_start_0): non-volatile should be restored from
	  volatile.

Thu Oct  9 17:43:36 2003  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* eval.c (proc_save_safe_level, proc_get_safe_level,
	  proc_set_safe_level): save/restore safe level 1..4.

Thu Oct  9 16:33:23 2003  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* marshal.c (r_object0): remove unnecessary iv restoration for
	  USRMARSHAL. [ruby-dev:21582]

	* marshal.c (w_object): dump generic instance variables from
	  a string from '_dump'.

	* variable.c (rb_generic_ivar_table): return 0 if obj's FL_EXIVAR
	  is not set.

	* time.c (time_dump): copy instance variables to dumped string, to
	  be included in the marshaled data.

	* bignum.c (rb_big2ulong): add range check to ensure round trip.

Thu Oct  9 15:45:27 2003  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* pack.c (uv_to_utf8): change message to "out of range", since
	  negative values are not "too big". [ruby-dev:21567]

Thu Oct  9 14:05:38 2003  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* eval.c (rb_set_end_proc, rb_exec_end_proc): restore safe level.
	  [ruby-dev:21557]

Thu Oct  9 10:51:04 2003  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* eval.c (rb_yield_0): no error if block is empty.

Thu Oct  9 06:43:33 2003  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* eval.c (localjump_error): id should be ID.

	* eval.c (rb_eval): nd_rval is set in copy_node_scope().

	* eval.c (rb_yield_0): unused variable.

	* eval.c (rb_yield_0): nothing to do for empty node.

	* eval.c (call_end_proc, proc_invoke): adjust backtrace in END.
	  [ruby-dev:21551]

	* eval.c (rb_thread_start_0): set the value by break as the result.
	  [ruby-dev:21552]

	* eval.c (rb_thread_start_0, rb_thread_raise, rb_callcc): save
	  variables across THREAD_SAVE_CONTEXT.

Thu Oct  9 12:05:46 2003  Eric Sunshine  <sunshine@sunshineco.com>

	* configure.in: revived NextStep, OpenStep, and Rhapsody ports which
	  had become unbuildable; enhanced --enable-fat-binary option so that
	  it accepts a list of desired architectures (rather than assuming a
	  fixed list), or defaults to a platform-appropriate list if user does
	  not provide an explicit list; made the default list of architectures
	  for MAB (fat binary) more comprehensive; now uses -fno-common even
	  when building the interpreter (in addition to using it for
	  extensions), thus allowing the interpreter to be embedded into a
	  plugin module of an external project (in addition to allowing
	  embedding directly into an application); added checks for
	  <netinet/in_systm.h> (needed by `socket' extension) and getcwd(); now
	  ensures that -I/usr/local/include is employed when extensions'
	  extconf.rb scripts invoke have_header() since extension checks on
	  NextStep and OpenStep will fail without it if the desired resource
	  resides in the /usr/local tree; fixed formatting of --help message.

	* Makefile.in: $(LIBRUBY_A) rule now deletes the archive before
	  invoking $(AR) since `ar' on Apple/NeXT can not "update" MAB archives
	  (see configure's --enable-fat-binary option); added rule for new
	  missing/getcwd.c.

	* defines.h: fixed endian handling during MAB build (see configure's
	  --enable-fat-binary option) to ensure that all portions of the
	  project see the correct WORDS_BIGENDIAN value (some extension modules
	  were getting the wrong endian setting); added missing constants
	  GETPGRP_VOID, WNOHANG, WUNTRACED, X_OK, and type pid_t for NextStep
	  and OpenStep; removed unnecessary and problematic HAVE_SYS_WAIT_H
	  define in NeXT section.

	* dir.c: do not allow NAMLEN() macro to trust dirent::d_namlen on
	  NextStep since, on some installations, this value always resolves
	  uselessly to zero.

	* dln.c: added error reporting to NextStep extension loader since the
	  previous behavior of failing silently was not useful; now ensures
	  that NSLINKMODULE_OPTION_BINDNOW compatibility constant is defined
	  for OpenStep and Rhapsody; no longer includes <mach-o/dyld.h> twice
	  on Rhapsody since this header lacks multiple-include protection,
	  which resulted in "redefinition" compilation errors.

	* main.c: also create hard reference to objc_msgSend() on NeXT
	  platforms (in addition to Apple platforms).

	* lib/mkmf.rb: now exports XCFLAGS from configure script to extension
	  makefiles so that extensions can be built MAB (see configure's
	  --enable-fat-binary option); also utilize XCFLAGS in cc_command()
	  (but not cpp_command() because MAB flags are incompatible with
	  direct invocation of `cpp').

	* ext/curses/extconf.rb: now additionally checks for presence of these
	  curses functions which are not present on NextStep or Openstep:
	  bkgd(), bkgdset(), color(), curs(), getbkgd(), init(), scrl(), set(),
	  setscrreg(), wattroff(), wattron(), wattrset(), wbkgd(), wbkgdset(),
	  wscrl(), wsetscrreg()

	* ext/curses/curses.c: added appropriate #ifdef's for additional set of
	  curses functions now checked by extconf.rb; fixed curses_bkgd() and
	  window_bkgd() to correctly return boolean result rather than numeric
	  result; fixed window_getbkgd() to correctly signal an error by
	  returning nil rather than -1.

	* ext/etc/etc.c: setup_passwd() and setup_group() now check for null
	  pointers before invoking rb_tainted_str_new2() upon fields extracted
	  from `struct passwd' and `struct group' since null pointers in some
	  fields are common on NextStep/OpenStep (especially so for the
	  `pw_comment' field) and rb_tainted_str_new2() throws an exception
	  when it receives a null pointer.

	* ext/pty/pty.c: include "util.h" for strdup()/ruby_strdup() for
	  platforms such as NextStep and OpenStep which lack strdup().

	* ext/socket/getaddrinfo.c: cast first argument of getservbyname(),
	  gethostbyaddr(), and gethostbyname() from (const char*) to non-const
	  (char*) for older platforms such as NextStep and OpenStep.

	* ext/socket/socket.c: include "util.h" for strdup()/ruby_strdup() for
	  platforms such as NextStep and OpenStep which lack strdup(); include
	  <netinet/in_systm.h> if present for NextStep and OpenStep; cast first
	  argument of gethostbyaddr() and getservbyname() from (const char*) to
	  non-const (char*) for older platforms.

	* ext/syslog/syslog.c: include "util.h" for strdup()/ruby_strdup() for
	  platforms such as NextStep and OpenStep which lack strdup().

Wed Oct  8 22:19:00 2003  Nathaniel Talbott  <ntalbott@ruby-lang.org>

	* lib/test/unit.rb: removed installation instructions.

	* lib/test/unit/ui/testrunnermediator.rb: moved the run flag to a more
	  central location.

	* lib/test/unit.rb: ditto.

	* lib/test/unit.rb: extracted the running code in to AutoRunner.

	* lib/test/unit/autorunner.rb: added.

	* lib/test/unit/collector/objectspace.rb: extracted common test
	  collection functionality in to a module.

	* lib/test/unit/collector.rb: ditto; added.

	* test/testunit/collector/test_objectspace.rb: ditto.

	* lib/test/unit/collector/dir.rb: added. Supports collecting tests out
	  of a directory structure.

	* test/testunit/collector/test_dir.rb: added.

	* test/runner.rb: simplified to use the new capabilities.

Tue Oct  7 15:23:09 2003  NAKAMURA, Hiroshi  <nahi@ruby-lang.org>

	* test/ruby/test_beginendblock.rb: add tests for nested BEGIN/END.

	* test/ruby/beginmainend.rb: add tests for nested BEGIN/END.

	* test/ruby/endblockwarn.rb: new file added to test of END-in-method
	  warning.

Tue Oct  7 12:23:47 2003  Tanaka Akira  <akr@m17n.org>

	* ext/fcntl/fcntl.c (Init_fcntl): define Fcntl::O_ACCMODE.

	* ext/socket/extconf.rb: useless assignment removed.

Tue Oct  7 09:13:24 2003  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* test/ruby/test_beginendblock.rb (test_endinmethod): END{} is now
	  allowed in eval.

Tue Oct  7 04:15:25 2003  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* parse.y (stmt): should not expand mrhs if lhs is solely starred.

Tue Oct  7 02:57:53 2003  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* parse.y (stmt): rhs of multiple assignment should not be
	  expanded using "to_a". [ruby-dev:21527]

Tue Oct  7 01:42:34 2003  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* ext/openssl/ossl_asn1.c (ossl_asn1_get_asn1type): use appropriate
	  free function for ASN1_OBJECT.

	* ext/openssl/ossl_asn1.c (ossl_asn1obj_get_sn): add new function for
	  ASN1::ObjectId#sn; it returns short name text representation of OID.

	* ext/openssl/ossl_asn1.c (ossl_asn1obj_get_ln): add new function for
	  ASN1::ObjectId#ln; it returns long name text representation of OID.

	* ext/openssl/ossl_asn1.c (ossl_asn1obj_get_oid): add new function for
	  ASN1::ObjectId#oid; it returns numerical representation of OID.

Mon Oct  6 22:59:46 2003  NAKAMURA, Hiroshi  <nahi@ruby-lang.org>

	* lib/csv.rb (IOReader, BasicWriter): call binmode when a given IO
	  respond_to?(:binmode).  record separator was wrong when you gave
	  text mode IO to Reader.parse and Writer.generate.

	* test/csv/test_csv.rb: add tests for above change.

Sun Oct  5 23:27:09 2003  Tanaka Akira  <akr@m17n.org>

	* ext/socket/extconf.rb: check recvmsg even if sendmsg is exists.

	* ext/socket/socket.c (thread_read_select): restored.

Mon Oct  6 16:23:38 2003  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* marshal.c (w_object): wrong method name in the message.

Mon Oct  6 16:02:05 2003  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* parse.y (stmt): END in method should cause warning.
	  [ruby-dev:21519]

Mon Oct  6 15:17:23 2003  NAKAMURA, Hiroshi  <nahi@ruby-lang.org>

	* test/ruby/test_iterator.rb (test_block_argument_without_paren):
	  added. (follows sample/test.rb)

Mon Oct  6 11:57:06 2003  NAKAMURA, Hiroshi  <nahi@ruby-lang.org>

	* test/ruby/test_beginendblock.rb, test/ruby/beginmainend.rb: added
	  test for eval-ed BEGIN END order.

Mon Oct  6 09:19:54 2003  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* marshal.c (w_object): should pass "weak" value to next level.
	  [ruby-dev:21496]

	* eval.c (proc_alloc): should not use cached object if klass is
	  different. [ruby-talk:83685]

Sun Oct  5 23:27:09 2003  Tanaka Akira  <akr@m17n.org>

	* lib/pathname.rb: version information is added in document.

Sun Oct  5 23:07:03 2003  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* eval.c (rb_f_END): block should be given.  [ruby-dev:21497]

Sun Oct  5 22:51:23 2003  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* lib/ext/openssl/extconf.rb: add check for some engine functions
	  unavailable in OpenSSL-0.9.6.

	* lib/ext/openssl/ossl_engine.c: ditto.

Sun Oct  5 17:56:30 2003  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* eval.c (rb_eval): fix evaluation order.  [ruby-list:38431]

Sun Oct  5 15:05:06 2003  akira yamada  <akira@ruby-lang.org>

	* test/uri/*: translated RUNIT to Test::Unit.

Sun Oct  5 14:37:39 2003  NAKAMURA, Hiroshi  <nahi@ruby-lang.org>

	* lib/xsd/datatypes.rb: Rational -> Decimal string bug fix.

	* test/soap/marshal/test_marshal.rb: ditto.

	* test/soap/calc/test_calc_cgi.rb: add Config::CONFIG["EXEEXT"] to
	  RUBYBIN.

Sun Oct  5 13:47:22 2003  NAKAMURA, Hiroshi  <nahi@ruby-lang.org>

	* test/ruby/test_beginendblock.rb, test/ruby/beginmainend.rb: add tests
	  about scope, order and allowed syntax.

Sun Oct  5 11:54:29 2003  NAKAMURA, Hiroshi  <nahi@ruby-lang.org>

	* test/ruby/envutil.rb: added.  split "rubybin" from test_system.rb.

	* test/ruby/test_system.rb: use envutil.rb

	* test/ruby/test_beginendblock.rb: added.

	* test/ruby/beginmainend.rb: added.  used in test_beginendblock.rb.

Sun Oct  5 11:23:00 2003  Nathaniel Talbott  <ntalbott@ruby-lang.org>

	* test/testunit/runit/test_testresult.rb: removed some unnecessary
	  cruft.

Sun Oct  5 11:14:00 2003  Nathaniel Talbott  <ntalbott@ruby-lang.org>

	* lib/rubyunit.rb: aliasing TestCase into the top level is
	  problematic.

	* lib/runit/assert.rb: fixed a couple of bugs caused by recent
	  refactoring in Test::Unit.

	* test/testunit/runit/*: added.

Sun Oct  5 10:55:29 2003  NAKAMURA, Hiroshi  <nahi@ruby-lang.org>

	* lib/open-uri.rb (URI::Generic#find_proxy): no_proxy support did not
	  work.  [ruby-dev:21484]

Sun Oct  5 09:52:00 2003  Nathaniel Talbott  <ntalbott@ruby-lang.org>

	* lib/test/unit/assertions.rb: will use pp for output if available.
	  Can be disabled by setting Assertions.use_pp = false.

	* test/testunit/test_assertions.rb: made a small change to exception
	  formatting.

Sun Oct  5 07:42:00 2003  Nathaniel Talbott  <ntalbott@ruby-lang.org>

	* lib/test/unit/assertions.rb: made small improvements to assertion
	  messages. Deprecated Assertions#assert_not_nil; use #assert instead.

	* test/testunit/test_assertions.rb: ditto.

	* test/testunit/util/test_procwrapper.rb: use #assert instead of
	  #assert_not_nil.

Sun Oct  5 04:10:00 2003  Nathaniel Talbott  <ntalbott@ruby-lang.org>

	* lib/test/unit/assertions.rb: refactored message building.

Sun Oct  5 03:40:22 2003  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* ext/openssl/ossl_asn1.h: global symbols should be declared
	  as external.

Sun Oct  5 03:03:20 2003  akira yamada  <akira@ruby-lang.org>

	* test/ruby/test_exception.rb (test_else): added.

Sun Oct  5 02:12:00 2003  Nathaniel Talbott  <ntalbott@ruby-lang.org>

	* lib/test/unit/assertions.rb: changed assertion messages to rely more
	  heavily on #inspect. Added backtrace filtering for exceptions in
	  assertion messages.

	* test/testunit/test_assertions.rb: ditto.

Sun Oct  5 02:12:00 2003  Masatoshi SEKI  <m_seki@mva.biglobe.ne.jp>

	* lib/drb/acl.rb, lib/drb/ssl.rb: added.

	* lib/drb/drb.rb: exit from a thread using 'break'.

Sat Oct  4 21:49:14 2003  WATANABE Hirofumi  <eban@ruby-lang.org>

	* gc.c (Init_stack): the type of space is changed to unsigned int
	  from double.  [ruby-dev:21483]

Sat Oct  4 17:52:59 2003  NAKAMURA, Hiroshi  <nahi@ruby-lang.org>

	* lib/soap/netHttpClient.rb: follow http-access2.  hosts which matches
	  ENV['no_proxy'] or ENV['NO_PROXY'] are not proxyed.
	  - [,:] separated. ("ruby-lang.org:rubyist.net")
	  - no regexp. (give "ruby-lang.org", not "*.ruby-lang.org")
	  - if you want specify host by IP address, give full address.
	    ("192.168.1.1, 192.168.1.2")

	* lib/soap/rpc/cgistub.rb: return "Status: XXX MMM" line.

	* test/runner.rb: give testsuite name.

Sat Oct  4 15:16:02 2003  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* marshal.c (w_object): instance variable dump do not cause error
	  for objects that cannot be dumped, if they traversed from
	  marshal_dump.  they are just ignored.

	* gc.c (Init_stack): cast "space" (doble value) into unsigned
	  int.  should run on PowerPC.

	* eval.c (rb_eval): should not execute else part if any exception
	  is caught. [ruby-dev:21482]

	* parse.y (f_args): should allow unparenthesized block argument.

	* parse.y (f_rest_arg): should allow unparenthesized rest
	  argument.

Sat Oct  4 14:59:51 2003  Tanaka Akira  <akr@m17n.org>

	* lib/pathname.rb (initialize): raise ArgumentError if argument has
	  '\0' character.
	  (relative_path_from): new method.
	  (each_entry): new method for replacement of dir_foreach.
	  (foreach, foreachline, dir_foreach, chdir): obsoleted.

Sat Oct  4 12:58:48 2003  akira yamada  <akira@ruby-lang.org>

	* test/uri/* (6 files): added.

Sat Oct  4 12:44:45 2003  akira yamada  <akira@ruby-lang.org>

	* lib/uri/ftp.rb, lib/uri/mailto.rb: renamed to #to_s from #to_str.

Sat Oct  4 07:33:00 2003  Nathaniel Talbott  <ntalbott@ruby-lang.org>

	* lib/test/unit/testsuite.rb: changed #<< to return self, and added
	  #delete.

	* test/testunit/test_testsuite.rb: ditto. Also slightly refactored
	  #test_size.

	* lib/test/unit/collector/objectspace.rb: collector now preserves the
	  hierarchy of suites.

	* test/testunit/collector/test_objectspace.rb: ditto.

Sat Oct  4 04:48:49 2003  why the lucky stiff  <why@ruby-lang.org>

	* ext/syck/rubyext.c: default keys handled.

	* ext/syck/syck.h: lowered default buffer size to 16k for increased
	  performance.

	* test/yaml: checkin of basic unit tests.

Sat Oct  4 04:24:19 2003  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* ext/openssl/extconf.rb: add check for X509V3_set_nconf.

	* ext/openssl/ossl_x509ext.c (ossl_x509extfactory_set_config):
	  cannot implement if X509V3_set_nconf doesn't exist.

Sat Oct  4 02:12:44 2003  NAKAMURA, Hiroshi  <nahi@ruby-lang.org>

	* lib/xsd/datatypes.rb: dump sign by itself.  under the problematic
	  platform, sprintf("%+.10g", -0.0) => +0.  sigh.

	* sample/wsdl/amazon/*: update schema ver2 to ver3.

Sat Oct  4 01:33:46 2003  Tanaka Akira  <akr@m17n.org>

	* lib/pathname.rb (initialize): duplicate and freeze argument.
	  (to_s): return duplicated string.
	  (children): new method.
	  (each_line): new alias to foreachline.

Fri Oct  3 16:13:19 2003  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* ext/openssl/ossl_asn1.c: add DER encoder and decoder.

	* ext/openssl/ossl_asn1.h: add OpenSSL::ASN1 module.

	* ext/openssl/ossl.c (Init_openssl): call Init_ossl_asn1.

	* ext/openssl/extconf.rb: check if X509_ATTRIBUTE has field "single".

	* ext/openssl/ossl_x509attr.c (ossl_x509attr_set_value): accept
	  DER encoded data argument.

	* ext/openssl/ossl_x509attr.c (ossl_x509attr_get_value): return
	  DER encoded data in OpenSSL::ASN1 types.

Fri Oct  3 13:02:00 2003  Nathaniel Talbott  <ntalbott@ruby-lang.org>

	* lib/test/unit.rb: refactored to use optparse.

	* lib/test/unit.rb: added support for selecting the output
	  level from the command-line.

	* lib/test/unit.rb: added a command-line switch to stop processing
	  the command-line, allowing arguments to be passed to tests.

	* lib/test/unit.rb: changed the method for specifying a runner or a
	  filter from the command-line.

	* lib/test/unit/collector/objectspace.rb: fixed a bug causing all
	  tests to be excluded when the filter was set to an empty array.

	* test/testunit/collector/test_objectspace.rb: ditto.

Fri Oct  3 08:14:32 2003  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* lib/irb/ruby-lex.rb (RubyLex::identify_identifier): support
	  'class ::Foo' syntax. [ruby-talk:83514]

Fri Oct  3 08:01:00 2003  Nathaniel Talbott  <ntalbott@ruby-lang.org>

	* lib/test/unit/assertions.rb: added a default message for #assert,
	  #assert_block, and #flunk.

	* test/testunit/test_assertions.rb: ditto.

	* lib/test/unit/failure.rb: failures now show a better trace of where
	  they occurred.

	* test/testunit/test_failure.rb: ditto (added).

	* lib/test/unit/testcase.rb: ditto.

	* test/testunit/test_testcase.rb: ditto.

	* lib/test/unit/util/backtracefilter.rb: added.

	* test/testunit/util/test_backtracefilter.rb: added.

	* lib/test/unit/error.rb: changed to use BacktraceFilter and improved
	  output.

	* test/testunit/test_error.rb: ditto.

Thu Oct  2 20:33:49 2003  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* ext/iconv/iconv.c (iconv_failure_initialize): conform with
	  orthodox initialization method.

	* ext/iconv/iconv.c (iconv_fail): initialize exception instance
	  from the class, and do not share instance variables with the
	  others.  [ruby-dev:21470]

Thu Oct  2 18:20:27 2003  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* time.c (Init_Time): define initialize.  [ruby-dev:21469]

Thu Oct  2 17:39:38 2003  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* ext/openssl/ossl_engine.c: add a new module OpenSSL::Engine.
	  it supports OpenSSL hardware cryptographic engine interface.

	* ext/openssl/ossl_engine.h: ditto.

	* ext/openssl/MANIFEST: add ossl_engine.c and ossl_engine.h.

	* ext/openssl/extconf.rb: add check for openssl/engine.h.

	* ext/openssl/ossl.c: call Init_ossl_engine().

	* ext/openssl/ossl.h: include openssl/engine.h.

	* ext/openssl/ossl_pkey_{rsa,dsa,dh}.c: check if underlying
	  EVP_PKEY referes engine.

Thu Oct  2 17:22:37 2003  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* time.c (time_load): restore instance variables (if any) before
	  loading from marshaled data.

Thu Oct  2 14:19:15 2003  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* ext/iconv/iconv.c (iconv_fail): now yield erred substring, and
	  set error object to $!.

	* ext/iconv/iconv.c (iconv_convert): error handler block should
	  return appended part and the rest.  if rest is nil, the
	  conversion stops.

Thu Oct  2 12:00:18 2003  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* variable.c (rb_const_defined_0): look up constants in Object as
	  well.  [ruby-dev:21458]

	* test/ruby/test_defined.rb (TestDefined::test_defined): test for
	  constants.

Thu Oct  2 11:17:00 2003  Nathaniel Talbott  <ntalbott@ruby-lang.org>

	* lib/test/unit/assertions.rb: should not capture an
	  AssertionFailedError unless explicitly requested.

	* test/testunit/test_assertions.rb: ditto.

	* test/testunit/collector/test_objectspace.rb: fixed a test failure
	  caused by methods being returned in different orders on different
	  platforms by moving test sorting from TestSuite into the locations
	  where suites are constructed. [ruby-talk:83156]

	* lib/test/unit/testcase.rb: ditto.

	* lib/test/unit/testsuite.rb: ditto.

	* lib/test/unit/collector/objectspace.rb: ditto.

Thu Oct  2 03:25:01 2003  NAKAMURA Usaku  <usa@ruby-lang.org>

	* eval.c (rb_thread_raise): prototype; avoid VC++ warning.

Thu Oct  2 01:37:34 2003  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* time.c (time_mdump): new marshal dumper. _dump is still
	  available for compatibility.

	* time.c (time_mload): new marshal loader.

	* marshal.c (w_object): preserve instance variables for objects
	  with marshal_dump.

	* marshal.c (r_object0): restore instance variables before calling
	  marshal_load.

	* error.c (rb_warn_m): always return nil.

Thu Oct  2 01:32:46 2003  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (rb_f_block_given_p): real required condition is
	  ruby_frame->prev->iter == ITER_CUR.

	* eval.c (rb_block_given_p): ditto.

	* eval.c (block_pass): update ruby_frame->iter only when previous
	  value is ITER_NOT.

Thu Oct  2 01:02:35 2003  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* variable.c (rb_const_defined_at): should exclude constants from
	  Object when TYPE(klass) == T_MODULE *and* exclude is on.
	  [ruby-dev:21458]

	* variable.c (rb_const_get_0): do not lookup constants from Object
	  when TYPE(klass) == T_MODULE *and* exclude is on.

Thu Oct  2 00:21:11 2003  NAKAMURA, Hiroshi  <nahi@ruby-lang.org>

	* test/logger/test_logger.rb: unlinking file before close causes
	  problem under win32 box.

	* lib/xsd/datatypes.rb(XSDFloat, XSDDouble): add +/- sign explicitly
	  when stringified and embedded into XML instance.  Ruby's sprintf may
	  format -0.0 as "0.0" (no minus sign) depending on underlying C
	  sprintf implementation.

	* test/xsd/test_xsd.rb, test/soap/test_basetype.rb: follow above change.

	* test/soap/calc/*: give httpd config param "CGIInterpreter".
	  "/usr/bin/env ruby" thing does not work under non-Unix boxes.

Thu Oct  2 00:25:21 2003  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* signal.c (ruby_signal_name): adjust to the prototype.

	* process.c (pst_inspect): ditto.

	* ext/etc/etc.c (etc_getgrent, Init_etc): typo.

Wed Oct  1 20:49:41 2003  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* gc.c (heaps): manage slots and limits together.  [ruby-dev:21453]

	* gc.c (add_heap): should not clear heaps slot even if realloc()
	  failed.

Wed Oct  1 20:36:49 2003  WATANABE Hirofumi  <eban@ruby-lang.org>

	* MANIFEST: add wince/mkconfig_wce.rb.

Wed Oct  1 17:22:33 2003  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* ext/etc/etc.c: add new functions: setpwent, getpwent, endpwent,
	  setgrent, getgrent, endgrent.

	* ext/socket/socket.c (sock_s_gethostbyname): do not reverse lookup.

Wed Oct  1 17:01:30 2003  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* eval.c (rb_load): Object scope had priority over required file
	  scope.  [ruby-dev:21415]

Wed Oct  1 14:09:53 2003  Takaaki Uematsu  <uema2x@jcom.home.ne.jp>

	* wince/mkconfig_wce.rb: sorry, forget to commit.

Wed Oct  1 10:08:42 2003  Takaaki Uematsu  <uema2x@jcom.home.ne.jp>

	* wince/setup.mak: add sigmarionIII SDK support.

	* wince/Makefile.sub: ditto.

	* wince/mkexports.rb: fix linker error in SH4.

	* wince/mkconfig_wce.rb: camouflage RUBY_PLATFORM for compiling ext.

Wed Oct  1 08:02:52 2003  Takaaki Uematsu  <uema2x@jcom.home.ne.jp>

	* wince/time_wce.c (time): add zero check.

Tue Sep 30 16:11:05 2003  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* Makefile.in: copy lex.c from $(srcdir) if it's not the current
	  directory.  [ruby-dev:21437]

Tue Sep 30 11:29:23 2003  Tanaka Akira  <akr@m17n.org>

	* process.c (pst_inspect): describe stopped process "stopped".

Tue Sep 30 09:31:56 2003  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* test/runner.rb: glob for directories.

Tue Sep 30 09:11:43 2003  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (rb_eval): while/until should not capture break unless
	  they are destination of the break.

Tue Sep 30 03:12:02 2003  Minero Aoki  <aamine@loveruby.net>

	* lib/net/http.rb (finish): revert to 1.93.

	* lib/net/pop.rb (finish): revert to 1.60.

	* lib/net/smtp.rb (finish): revert to 1.67.

	* lib/net/http.rb (do_start): ensure to close socket if failed to
	  start session.

	* lib/net/pop.rb (do_start): ditto.

	* lib/net/smtp.rb (do_start): ditto.

	* lib/net/smtp.rb: SMTP#started? wrongly returned false always.

Tue Sep 30 02:54:49 2003  Minero Aoki  <aamine@loveruby.net>

	* test/ruby/test_iterator.rb: new test
	  test_break__nested_loop[123].

Mon Sep 29 23:39:13 2003  Minero Aoki  <aamine@loveruby.net>

	* lib/net/http.rb (finish): does not raise IOError even if
	  !started?, to allow closing socket which was opened before
	  session started.

	* lib/net/pop.rb (finish): ditto.

	* lib/net/smtp.rb (finish): ditto.

Mon Sep 29 19:06:51 2003  WATANABE Hirofumi  <eban@ruby-lang.org>

	* ext/win32ole/extconf.rb: add windows.h checking.
	  (ruby-bugs:PR#1185)

Mon Sep 29 16:18:30 2003  NAKAMURA, Hiroshi  <nahi@ruby-lang.org>

	* lib/logger.rb: check if the given logdevice object respond_to :write
	  and :close, not is_a? IO.  duck duck.

	* test/logger/test_logger.rb: self IO.pipe reading/writing may be
	  locked by the flood.  use tempfile.

	* lib/wsdl/xmlSchema/data.rb: wrong constant reference.

Mon Sep 29 16:11:23 2003  Minero Aoki  <aamine@loveruby.net>

	* test/fileutils/test_fileutils.rb: clean up temporary symlink.
	  Patched by NaHi.  [ruby-dev:21420]

Mon Sep 29 11:16:55 2003  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (rb_thread_atfork): wrong format specifier.
	  [ruby-dev:21428]

	* process.c (pst_inspect): better description.

Mon Sep 29 02:31:44 2003  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* lib/webrick/utils.rb (Utils::su): use setgid and setuid to
	  set real and effective IDs. and setup group access list by
	  initgroups.

Sun Sep 28 11:14:19 2003  Koji Arai  <jca02266@nifty.ne.jp>

	* ext/digest/digest.c (Init_digest): `copy_object' was deprecated.
	  `initialize_copy' should be defined.

	* ext/stringio/stringio.c (Init_stringio): ditto.

Sat Sep 27 18:25:13 2003  NAKAMURA, Hiroshi  <nahi@ruby-lang.org>

	* lib/xsd/charset.rb: XSD::Charset.is_ces did return always true under
	  $KCODE = "NONE" environment.  check added.

	* test/xsd/test_xsd.rb: add tests for above fix.

Sat Sep 27 15:58:50 2003  NAKAMURA, Hiroshi  <nahi@ruby-lang.org>

	* lib/soap/rpc/cgistub.rb: make logging severity threshold higher.

	* lib/soap/rpc/standaloneServer.rb: defer WEBrick server start to give
	  a chance to reset logging severity threshold.

	* test/soap/calc/test_*, test/soap/helloworld/test_helloworld.rb: run
	  silent.

Sat Sep 27 09:44:18 2003  Minero Aoki  <aamine@loveruby.net>

	* test/fileutils/test_fileutils.rb: clear all errors on Windows.
	  [ruby-dev:21417]

	* test/fileutils/test_nowrite.rb: ditto.

Sat Sep 27 04:57:07 2003  NAKAMURA, Hiroshi  <nahi@ruby-lang.org>

	* test/ruby/test_file.rb: new file.  only asserts unlink-before-close
	  behaviour now.

	* test/soap/marshal/test_digraph.rb: should close before unlink.
	  unlink-before-close pattern is not needed here.

Sat Sep 27 03:32:37 2003  NAKAMURA, Hiroshi  <nahi@ruby-lang.org>

	* test/soap/*, test/wsdl/*, test/xsd/*: move TestCase classes into
	  each module namespace.  TestMarshal in
	  test/soap/marshal/test_marshal.rb crashed with
	  test/ruby/test_marshal.rb.

Sat Sep 27 01:30:59 2003  NAKAMURA Usaku  <usa@ruby-lang.org>

	* ext/socket/socket.c (ruby_connect): on win32, type of the 4th
	  argument of getsockopt is char *.

Fri Sep 26 18:35:40 2003  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* lib/resolv-replace.rb: 1.8 compliance.  [ruby-talk:82946]

Fri Sep 26 17:39:27 2003  NAKAMURA, Hiroshi  <nahi@ruby-lang.org>

	* test/ruby/test_marshal.rb: add test for ruby's objects.

Fri Sep 26 09:52:44 2003  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* defines.h (flush_register_windows): use volatile only for gcc on
	  Solaris.  [ruby-dev:21403]

	* lib/mkmf.rb (xsystem): use system directly to honor shell meta
	  charaters.

Fri Sep 26 00:10:13 2003  NAKAMURA, Hiroshi  <nahi@ruby-lang.org>

	* lib/README: updated.

Thu Sep 25 17:48:10 2003  NAKAMURA Usaku  <usa@ruby-lang.org>

	* ext/openssl/ossl.c (ossl_buf2str): fix type of 1st argument for
	  rb_protect.

	* ext/openssl/ossl_hmac.c (ossl_hmac_digest): should return meaningful
	  value.

Thu Sep 25 09:00:00 2003  Nathaniel Talbott  <ntalbott@ruby-lang.org>

	* lib/ostruct.rb: Added OpenStruct#==.

	* test/ostruct/test_ostruct.rb: Added.

Thu Sep 25 07:55:26 2003  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* ext/win32ole/win32ole.c, ext/openssl/ossl_pkey_dsa.c,
	  ext/openssl/ossl_pkey_rsa.c, ext/bigdecimal/bigdecimal.h: must
	  not use C++ or C99 style comment yet.  (ruby-bugs:PR#1184)

Thu Sep 25 00:23:22 2003  WATANABE Hirofumi  <eban@ruby-lang.org>

	* MANIFEST: add SOAP4R.

Thu Sep 25 00:13:15 2003  NAKAMURA, Hiroshi  <nahi@ruby-lang.org>

	* lib/soap/* (29 files): SOAP4R added.

	* lib/wsdl/* (42 files): WSDL4R added.

	* lib/xsd/* (12 files): XSD4R added.

	* test/soap/* (16 files): added.

	* test/wsdl/* (2 files): added.

	* test/xsd/* (3 files): added.

	* sample/soap/* (27 files): added.

	* sample/wsdl/* (13 files): added.

Wed Sep 24 02:08:11 2003  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* lib/webrick/httpservlet/cgihandler.rb: conform to mswin32.
	  [ruby-talk:82735], [ruby-talk:82748], [ruby-talk:82818]

Tue Sep 23 23:10:16 2003  NAKAMURA, Hiroshi  <nahi@ruby-lang.org>

	* lib/logger.rb: add Logger#<<(msg) for writing msg without any
	  formatting.

	* test/logger/test_logger.rb: ditto.

Tue Sep 23 20:47:51 2003  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* error.c (rb_warn_m): should not warn if -W0 is specified.
	  [ruby-talk:82675]

Mon Sep 22 21:28:57 2003  WATANABE Hirofumi  <eban@ruby-lang.org>

	* MANIFEST: updated.

Mon Sep 22 19:22:26 2003  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* configure.in (AC_CHECK_FUNCS): add setuid and setgid.

Mon Sep 22 12:34:55 2003  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* util.c (ruby_strtod): skip preceding zeros before counting
	  digits in the mantissa. (ruby-bugs:PR#1181)

Sun Sep 21 04:12:36 2003  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* ext/openssl/ossl_ocsp.c (ossl_ocspreq_initialize): the argument
	  should be a String.

	* ext/openssl/ossl_ocsp.c (ossl_ocspres_initialize): ditt.

	* ext/openssl/ossl_x509attr.c (ossl_x509attr_initialize): ditto.

	* ext/openssl/ossl_x509ext.c (ossl_x509ext_initialize): ditto.

	* ext/openssl/ossl_x509ext.c (ossl_x509ext_set_value): ditto.

Sat Sep 20 11:49:05 2003  NAKAMURA, Hiroshi  <nahi@ruby-lang.org>

	* lib/logger.rb: typo fixed.

	* test/logger/test_logger.rb: new file.

Fri Sep 19 11:39:00 2003  Nathaniel Talbott  <ntalbott@ruby-lang.org>

	* test/testunit/*: Added.

	* lib/test/unit.rb: Documentation update.

	* lib/test/unit/ui/console/testrunner.rb (TestRunner#initialize):
	  Ditto.

	* lib/test/unit.rb: Factored out an ObjectSpace collector.

	* lib/test/unit/collector/objectspace.rb: Ditto.

	* sample/testunit/*: Added.

Fri Sep 19 01:00:48 2003  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* lib/webrick/log.rb (BasicLog#log): get rid of as ineffectual
	  condition.

	* lib/webrick/log.rb (BasicLog#format): add "\n" to message.

Thu Sep 18 22:43:20 2003  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (proc_invoke): should push PROT_PCALL tag for orphans.

	* eval.c (proc_invoke): should update "result" for orphans.

Thu Sep 18 20:33:03 2003  Tietew  <tietew-ml-ruby-list@tietew.net>

	* parse.y (str_xquote): do not prepend escapes in
	  backqoute literals.  [ruby-list:38409]

Thu Sep 18 20:30:17 2003  Tanaka Akira  <akr@m17n.org>

	* lib/pathname.rb: update document.

Thu Sep 18 15:27:05 2003  NAKAMURA, Hiroshi  <nahi@ruby-lang.org>

	* lib/logger.rb: new file.  Logger, formerly called devel-logger or
	  Devel::Logger.

	* sample/logger/*: new file.  samples of logger.rb.

Wed Sep 17 23:41:45 2003  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (localjump_destination): should not raise ThreadError
	  exception for "break". [ruby-dev:21348]

	* eval.c (proc_invoke): use result instead of prot_tag->retval.
	  retval is no longer propagated to the ancestors.

Wed Sep 17 20:34:00 2003  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* parse.y (tokadd_string, parse_string, yylex): escaped terminator
	  is now interpreted as is.  [ruby-talk:82206]

Wed Sep 17 18:52:36 2003  Minero Aoki  <aamine@loveruby.net>

	* test/fileutils/fileassertions.rb: new file.

	* test/fileutils/test_fileutils.rb: new file.

	* test/fileutils/test_nowrite.rb: new file.

Wed Sep 17 18:51:02 2003  Minero Aoki  <aamine@loveruby.net>

	* test/strscan/test_stringscanner.rb: require test/unit.

Wed Sep 17 18:35:34 2003  Minero Aoki  <aamine@loveruby.net>

	* test/strscan/test_stringscanner.rb: new file.

Wed Sep 17 18:03:30 2003  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* ext/openssl: all files are reviewed to simplify and avoid memory leak.

	* ext/openssl/extconf.rb: add check for assert.h.

	* ext/openssl/ossl.c (ossl_buf2str): new function to convert
	  C buffer to String and free buffer.

	* ext/openssl/ossl.c (ossl_x509_ary2sk): new function to convert
	  Array of OpenSSL::X509 to STACK_OF(X509) with exception safe.

	* ext/openssl/ossl.c (ossl_to_der, ossl_to_der_if_possible): new
	  functions to convert object to DER string.

	* ext/openssl/ossl.h: ditto.

	* ext/openssl/ossl_bio.c (ossl_membio2str): new function to convert
	  BIO to String object and free BIO.

	* ext/openssl/ossl_bio.h: ditto.

	* ext/openssl/ossl_pkcs7.c (ossl_pkcs7_to_der): add for "to_der".

	* ext/openssl/ossl_x509name.c (ossl_x509name_to_der): ditto.

	* ext/openssl/ossl_x509ext.c (ossl_x509ext_to_der): ditto.

	* ext/openssl/ossl_x509ext.c (create_ext_from_array): removed
	  and reimplement in openssl/x509.rb.

	* ext/openssl/ossl_x509attr.c: reimplemented and disable some
	  method temporarily. this class doesn't work fine without ASN.1
	  data support;-) I'll rewrite in near future.

	* ext/openssl/lib/openssl/x509.c (X509::Attribute): get rid off
	  unused code.

	* ext/openssl/lib/openssl/x509.c (X509::ExtensionFactory): refine all.

Tue Sep 16 22:25:06 2003  NAKAMURA, Hiroshi  <nahi@ruby-lang.org>

	* test/csv/test_csv.rb: add negative tests of row_sep.

Tue Sep 16 18:02:36 2003  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* regex.c (re_compile_pattern): should not translate character
	  class range edge. [ruby-list:38393]

Tue Sep 16 16:47:56 2003  WATANABE Hirofumi  <eban@ruby-lang.org>

	* MANIFEST: add test/csv/mac.csv.

	* win32/Makefile.sub, bcc32/Makefile.sub (test): add phony NUL target.

Mon Sep 15 19:02:52 2003  NAKAMURA, Hiroshi  <nahi@ruby-lang.org>

	* lib/csv.rb: add extra pamameter to specify row(record) separater
	  character.  To parse Mac's CR separated CSV, do like this.
	    CSV.open("mac.csv", "r", ?,, ?\r) { |row| p row.to_a }
	  The 3rd parameter in this example ?, is for column separater and the
	  4th ?\r is for row separater.  Row separater is nil by default.  Nil
	  separater means "\r\n" or "\n".

	* test/csv/test_csv.rb: add tests for above feature.

	* test/csv/mac.csv: added.  Sample CR separated CSV file.

Fri Sep 12 22:41:48 2003  Michal Rokos  <m.rokos@sh.cvut.cz>

	* ext/openssl/ossl.c: move ASN.1 stuff to ossl_asn1.[ch]

	* ext/openssl/ossl.c: move BIO stuff to ossl_bio.[ch]

	* ext/openssl/ossl_asn1.[ch]: new files

	* ext/openssl/ossl_bio.[ch]: new files

Fri Sep 12 12:30:41 2003  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* intern.h (rb_disable_super, rb_enable_super): replace with dummy
	  expressions instead of prototypes.  the functions remain yet for
	  binary compatibility.  [ruby-talk:81758]

Fri Sep 12 12:09:54 2003  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* bignum.c (rb_big_and): convert argument using 'to_int'.

	* bignum.c (rb_big_or): ditto.

	* bignum.c (rb_big_xor): ditto.

Fri Sep 12 07:06:14 2003  David Black  <dblack@superlink.net>

	* lib/scanf.rb: Took out useless @matched_item variable; some small
	  refactoring.

Thu Sep 11 08:43:44 2003  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (rb_f_require): allow "require" on $SAFE>0, if feature
	  name is not tainted.

	* lib/rexml/parsers/baseparser.rb (REXML::Parsers::BaseParser::stream):
	  Supports StringIO.

Wed Sep 10 22:47:30 2003  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* ext/openssl/ossl.h: add a workaround for win32 platform.
	  libeay32.dll doesn't export functions defined in conf_api.h.

	* ext/openssl/ossl_config.c (ossl_config_initialize): ditto.

	* ext/openssl/ossl_config.c (ossl_config_add_value): ditto.

	* ext/openssl/ossl_config.c (set_conf_section_i): should check
	  if the argument is Array.

Wed Sep 10 22:41:54 2003  Tietew  <tietew@tietew.net>

	* eval.c (win32_get_exception_list): avoid VC7 warning.
	  [ruby-win32:577]

Tue Sep  9 10:39:51 2003  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* eval.c (struct tag): dst should be VALUE.

Tue Sep  9 10:39:51 2003  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* eval.c (localjump_destination): stop at the scope where the current
	  block was created.  [ruby-dev:21353]

Tue Sep  9 05:17:04 2003  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* ext/openssl/ossl_config.rb: avoid compile error in OpenSSL-0.9.6.

Tue Sep  9 02:41:35 2003  Michal Rokos  <m.rokos@sh.cvut.cz>

	* ext/openssl/ossl_config.c: Refine compatibility.

Tue Sep  9 01:50:45 2003  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* lib/webrick/httpserver.rb (HTTPServer#access_log): add "\n" to
	  the message.

	* lib/webrick/log.rb (BasicLog#log): add "\n" only if needed.

Mon Sep  8 22:15:33 2003  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tk/lib/multi-tk.rb: modify security check at creating
	  a new interpreter

Mon Sep  8 20:00:12 2003  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* lib/optparse.rb, lib/optparse/version.rb: search also all
	  capital versions.

Mon Sep  8 19:26:33 2003  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* ext/openssl/ossl.h: include openssl/conf.h and openssl/conf_api.h.

	* ext/openssl/ossl_config.c: refine all with backward compatibility.

	* ext/openssl/ossl_config.h: export GetConfigPtr() and DupConfigPtr().

	* ext/openssl/ossl_x509.c: added new constants under X509 module.
	  DEFAULT_CERT_AREA, DEFAULT_CERT_DIR, DEFAULT_CERT_FILE,
	  DEFAULT_CERT_DIR_ENV, DEFAULT_CERT_FILE_ENV and DEFAULT_PRIVATE_DIR.

	* ext/openssl/ossl_x509ext.c (ossl_x509extfactory_free): don't free
	  the members of the struct. it's left to GC.

	* ext/openssl/ossl_x509ext.c (ossl_x509_set_config): add for config=.

	* ext/openssl/ossl_x509ext.c (Xossl_x509extfactory_initialize):
	  add attr readers: issuer_certificate, subject_certificate,
	  subject_request, crl and config.

Mon Sep  8 18:26:41 2003  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* lib/webrick/accesslog.rb (AccessLog::setup_params): use req.port
	  instead of config[:Port] or req.request_uri.port.

	* lib/webrick/httprequest.rb (HTTPRequest#meta_vars): ditto.

	* lib/webrick/httpservlet/filehandler.rb (FileHandler#dir_list): ditto.

	* lib/webrick/config.rb: :Listen option never be used.

	* lib/webrick/server.rb (GenericServer#initialize): don't use :Listen
	  option and add warning message.

	* lib/webrick/log.rb (BasicLog#<<): shortcut of log(INFO, ...).

	* lib/webrick/httpserver.rb (HTTPServer#accesslog): use << for logging.

Sun Sep  7 16:08:28 2003  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tcltklib/tcltklib.c (lib_mainloop_core): fixed signal-trap bug

	* ext/tk/lib/*.rb: Ruby/Tk works at $SAFE == 4

Sat Sep  6 02:26:34 2003  NAKAMURA, Hiroshi  <nahi@ruby-lang.org>

	* test/ruby/test_*.rb: assert_same, assert_match, and so on.

Sat Sep  6 18:45:46 2003  Mauricio Fernandez  <batsman.geo@yahoo.com>

	* parse.y (assignable): call rb_compile_error(), not rb_bug().
	  [ruby-core:01523]

Sat Sep  6 17:40:41 2003  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* ext/openssl/ruby_missing.c: rid of unnecessary backward
	  compatibility stuff. and remove DEFINE_ALLOC_WRAPPER from
	  all sources.

	* ext/openssl/ossl_x509ext.c (X509::Extension.new): new method.

	* ext/openssl/ossl_x509ext.c (X509::Extension#oid=): new method.

	* ext/openssl/ossl_x509ext.c (X509::Extension#value=): new method.

	* ext/openssl/ossl_x509ext.c (X509::Extension#critical=): new method.

Sat Sep  6 01:23:22 2003  NAKAMURA Usaku  <usa@ruby-lang.org>

	* win32/win32.c (CreateChild): need to quote cmd if RUBYSHELL is set.

	* win32/win32.c (CreateChild): fix condition about whether to call
	  shell or not.

Sat Sep  6 00:36:20 2003  Nobuyoshi Nakada  <nobu.nokada@softhome.net>

	* Makefile.in (test): phony target.

	* lib/mkmf.rb (have_library, find_library): configure by library
	  name.

	* lib/optparse.rb (OptionParser#order, #permute, #parse): allow an
	  array as argument.

	* test/ruby/test_*.rb: moved invariants to left side in
	  assert_equal, and use assert_nil, assert_raises and so on.

	* win32/win32.c (isInternalCmd): distinguish command.com and
	  cmd.exe.

	* win32/win32.c (make_cmdvector): a character just after wildcard
	  was ignored.  [ruby-core:01518]

Fri Sep  5 20:27:08 2003  NAKAMURA, Hiroshi  <nahi@ruby-lang.org>

	* test/ruby/test_*.rb: replace 'assert(a == b)' with assert_equal(a, b)'

Fri Sep  5 18:00:51 2003  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* ext/openssl/lib/openssl/x509.rb: new method X509::Name::parse.

	* ext/openssl/ossl_digest.c: add ossl_digest_new().

	* ext/openssl/ossl_digest.h: ditto.

	* ext/openssl/ossl_cipher.c: add ossl_cipher_new().

	* ext/openssl/ossl_cipher.h: ditto.

Fri Sep  5 15:32:04 2003  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* misc/ruby-mode.el (ruby-font-lock-maybe-here-docs): should not
	  search delimiter forward if found in backward.

Fri Sep  5 13:32:48 2003  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* test/runner.rb: arguments should be keys.

Fri Sep  5 12:09:55 2003  WATANABE Hirofumi  <eban@ruby-lang.org>

	* test/ruby/test_system.rb (test_system): check existence of ruby
	  interpreter.

Fri Sep  5 11:32:17 2003  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* lib/optparse.rb (--version): fix assignment/reference order.

	* lib/optparse.rb (OptionParser#help): new; OptionParser#to_s may
	  be deprecated in future.

	* lib/optparse/version.rb (OptionParser#show_version): hide Object.

	* test/runner.rb: fix optparse usage.

	* test/runner.rb: glob all testsuits if no tests given.

Fri Sep  5 10:42:58 2003  NAKAMURA, Hiroshi  <nahi@ruby-lang.org>

	* test/runner.rb: added.  gets testcases from command line and runs it.

	* test/ruby/test_gc.rb: remove useless part which was for dumping test
	  result.

Fri Sep  5 09:28:59 2003  NAKAMURA, Hiroshi  <nahi@ruby-lang.org>

	* test/ruby/test_gc.rb: added.  splitter.rb which I made to split
	  sample/test.rb into test/ruby/test_* kindly removed GC test (the
	  last section in the original test) to reduce things to be worried.

Fri Sep  5 03:00:04 2003  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* test/ruby/test_iterator.rb (test_block_in_arg): add no block
	  given tests.

	* test/ruby/test_iterator.rb (test_ljump): uncomment LocalJumpError
	  test.

Fri Sep  5 01:10:11 2003  NAKAMURA, Hiroshi  <nahi@ruby-lang.org>

	* test/ruby: tests for ruby itself.

	* test/ruby/test_*.rb: split sample/test.rb into 28 test/unit testcases.
	  some tests could not be translates...  search '!!' mark to see it.

	* test/csv/test_csv.rb: should require 'csv', not '../lib/csv'.  test
	  runner should set load path correctly.

Fri Sep  5 01:03:59 2003  NAKAMURA, Hiroshi  <nahi@ruby-lang.org>

	* test/csv/test_csv.rb: close opened files for CSV::IOBuf explicitly.
	  opened file cannot be removed under win32 box.

Thu Sep  4 23:59:40 2003  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* parse.y (tokadd_string): newlines have no special meanings in
	  %w/%W, otherwise they are ignored only when interpolation is
	  enabled.  [ruby-dev:21325]

Thu Sep  4 19:38:25 2003  NAKAMURA, Hiroshi  <nahi@ruby-lang.org>

	* ext/io/wait/.cvsignore: added.

	* ext/openssl/.cvsignore: added.

Thu Sep  4 19:28:24 2003  NAKAMURA, Hiroshi  <nahi@ruby-lang.org>

	* sample/openssl: added.  Sample of standard distribution library
	  should be locate in sample/{module_name}/*.

	* ext/openssl/sample/*: removed.  move to sample/openssl/*.

Thu Sep  4 18:02:15 2003  NAKAMURA, Hiroshi  <nahi@ruby-lang.org>

	* test/csv/test_csv.rb: use remove_const to reduce warnings.  use
	  Dir.tmpdir to locate working files.

Thu Sep  4 17:41:31 2003  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* misc/ruby-mode.el (ruby-here-doc-beg-re): underscore also is
	  valid delimiter.

	* misc/ruby-mode.el (ruby-here-doc-end-match): must quote
	  arbitrary string to use as regexp.

	* misc/ruby-mode.el (ruby-font-lock-maybe-here-docs): must not
	  call `ruby-here-doc-end-match' unless `ruby-here-doc-beg-re'
	  matched.

Thu Sep  4 15:40:07 2003  NAKAMURA, Hiroshi  <nahi@ruby-lang.org>

	* test/csv/test_csv.rb: run on test/unit original layer.

Thu Sep  4 12:54:50 2003  why the lucky stiff  <why@ruby-lang.org>

	* ext/syck/token.c: headerless documents with root-level spacing now
	  honored.

Thu Sep  4 00:06:14 2003  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (mark_frame_adj): need to adjust argv pointer if using
	  system's alloca. [ruby-core:01503]

Wed Sep  3 21:33:20 2003  NAKAMURA, Hiroshi  <nahi@ruby-lang.org>

	* test: add test directory.  Test::Unit aware testcases and needed
	  files should be located in this directory.  dir/file name convention;
	    test/{module_name}/test_{testcase_name}.rb
	    test/{module_name}/{needed_files}
	  someday, someone will write testrunner which searches test_*.rb and
	  run testcases automatically.

	* test/csv/*: add testcase for lib/csv.rb.

Wed Sep  3 01:37:09 2003  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* io.c (rb_f_gets): should call next_argv() before type check
	  current_file. [ruby-list:38336]

Tue Sep  2 20:37:15 2003  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* ext/openssl/lib/net/protocols.rb (SSLIO#ssl_connect): warning
	  for skipping server verification.

Tue Sep  2 23:36:57 2003  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (proc_invoke): should retrieve retval when pcall is true.

Tue Sep  2 14:09:20 2003  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* ext/socket/extconf.rb: check s6_addr8 in in6_addr (Tru64 UNIX).
	  the patch is submitted by nmu <nmu@users.sourceforge.jp>.

	* ext/socket/getaddrinfo.c (getaddrinfo): should use in6_addr8 on
	  some platforms.

	* ext/socket/getnameinfo.c (getnameinfo): ditto.

Tue Sep  2 14:02:19 2003  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* ext/tcltklib/tcltklib.c (ip_invoke): fixed bug on passing a exception

	* ext/tk/lib/{tk.rb, tkcanvas.rb, tkfont.rb, tktext.rb}:
	  bug fix and improvement of font control

Tue Sep  2 09:51:36 2003  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* eval.c (rb_eval): should not handle exceptions within rescue
	  argument.  [ruby-talk:80804]

Tue Sep  2 00:44:37 2003  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* re.c (rb_memsearch): fix overrun.  [ruby-talk:80759]

Tue Sep  2 00:41:27 2003  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* ext/iconv/iconv.c (map_charset): use lower case keys.

	* ext/iconv/iconv.c (iconv_fail): just yield error and return the
	  result if a block is given.

	* ext/iconv/iconv.c (iconv_convert): yield error and append the
	  result if a block is given.

	* ext/iconv/charset_alias.rb (charset_alias): optional third
	  argument.

	* ext/iconv/charset_alias.rb (charset_alias): use CP932 instead of
	  SHIFT_JIS on cygwin.

Mon Sep  1 18:34:25 2003  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* eval.c (rb_eval): make tail recursion in ELSE clause of
	  RESCUE a jump.

Mon Sep  1 18:00:02 2003  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* parse.y (aref_args): forgot to call NEW_SPLAT(). reported by
	  Dave Butcher.

	* eval.c (Init_Thread): protect thgroup_default.  suggested by Guy
	  Decoux in [ruby-talk:80623]

Mon Sep  1 16:59:10 2003  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* eval.c (rb_thread_switch): add RESTORE_EXIT; exit by another
	  thread termination.

	* eval.c (rb_thread_start_0): should not error_print() within
	  terminated thread, because $stderr used by it might be
	  overriden now.  [ruby-dev:21280]

Sun Aug 31 22:46:55 2003  WATANABE Hirofumi  <eban@ruby-lang.org>

	* eval.c (TAG_DST()): take no argument.

	* process.c (p_gid_sw_ensure): return VALUE.

Sun Aug 31 22:27:10 2003  Hidetoshi NAGAI  <nagai@dumbo.ai.kyutech.ac.jp>

	* process.c (p_gid_sw_ensure): lack of function type

Sun Aug 31 12:25:06 2003  Nobuyoshi Nakada  <nobu.nokada@softhome.net>

	* lib/optparse.rb: --version takes an optional argument; "all" or
	  a list of package names.

Sun Aug 31 10:17:02 2003  Tadayoshi Funaba  <tadf@dotrb.org>

	* lib/date/format.rb: yyyy/mm is not an acceptable format.

	* lib/time.rb: follow above.

Sat Aug 30 14:25:43 2003  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (rb_iter_break): should not call TAG_JUMP directly.

Sat Aug 30 03:58:21 2003  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (struct BLOCK): remove BLOCKTAG, use scope instead.

	* eval.c (POP_TAG): no longer propagate retval.  retval is now set
	  directly by localjump_destination().

	* eval.c (localjump_destination): new function to cast
	  return/break local jump.

	* eval.c (rb_yield_0): stop TAG_RETURN/TAG_BREAK escaping.

Fri Aug 29 22:35:00 2003  Shigeo Kobayashi  <shigek@ruby-lang.org>

	* bigdecimal.c *.html: The 2nd arg. for add,sub,mult, and div is 0,
	  then result will be the same as +,-,*,/ respectively.

Fri Aug 29 17:30:15 2003  Hidetoshi NAGAI  <nagai@ai.kyutech.ac.jp>

	* process.c: bug fix

	* process.c: add rb_secure(2) to methods of Process::{UID,GID,Sys}

	* process.c: deny handling IDs during evaluating the block given to
	  the Process::{UID,GID}.switch method

	* ext/tcltklib/tcltklib.c: some methods have no effect if on slave-IP

	* ext/tcltklib/tcltklib.c: can create a interpreter without Tk

	* ext/tcltklib/tcltklib.c: bug fix on handling exceptions

	* ext/tcltklib/MANUAL.euc: modify

	* ext/tk/lib/tk.rb: freeze some core modules

	* ext/tk/lib/multi-tk.rb: more secure

	* ext/tk/lib/tk.rb: TkVariable.new(array) --> treat the array as the
	  Tk's list

	* ext/tk/lib/tk.rb: improve accessibility of TkVariable object

	* ext/tk/lib/tk.rb, ext/tk/lib/tkfont.rb, ext/tk/lib/tkcanvas.rb,
	  ext/tk/lib/tktext.rb: fix bug of font handling

	* ext/tk/lib/tkfont.rb: TkFont.new() accepts compound fonts

Thu Aug 28 22:07:12 2003  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* variable.c (rb_autoload_load): call const_missing if autoloading
	  constant is not defined to allow hook.

	* eval.c (rb_eval): use rb_const_get_from() instead of
	  rb_const_get_at().

	* eval.c (is_defined): forgot to check NODE_COLON3.

Thu Aug 28 17:30:24 2003  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* variable.c (rb_const_get_0): should check constants defined in
	  included modules, if klass is Object. [ruby-talk:79302]

	* numeric.c (check_uint): check should be done using UINT_MAX, not
	  INT_MAX. this fix is submitted by Lyle Johnson
	  <lyle@knology.net> in [ruby-core:01486]

Thu Aug 28 05:02:52 2003  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* parse.y (singleton): typo fixed (ruby-bugs-ja:PR#562)

Thu Aug 28 02:37:45 2003  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (rb_eval): *a = [1,2] now assigns [[1,2]] to a.
	  consistent with *a = [1], which set [[1]] to a.

	* node.h: merge NODE_RESTARY to NODE_SPLAT.

	* parse.y: rules simplified a bit by removing NODE_RESTARY.

	* sample/test.rb: updated for new assignment behavior.

Wed Aug 27 22:33:24 2003  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* error.c (rb_bug): should not use other methods; this function is
	  not for ordinary use.  [ruby-dev:21259]

Wed Aug 27 15:07:57 2003  Minero Aoki  <aamine@loveruby.net>

	* lib/net/smtp.rb (check_response): AUTH CRAM-MD5 returns 334
	  response. [ruby-list:38279]

Wed Aug 27 05:10:15 2003  NAKAMURA Usaku  <usa@ruby-lang.org>

	* win32/win32.c (map_errno): support winsock error.

	* win32/win32.c (pipe_exec, CreateChild, poll_child_status, waitpid,
	  kill, link, rb_w32_rename, unixtime_to_filetime, rb_w32_utime):
	  pass errno to map_errno().

	* win32/win32.c (rb_w32_select, rb_w32_accept, rb_w32_bind,
	  rb_w32_connect, rb_w32_getpeername, rb_w32_getsockname,
	  rb_w32_getsockopt, rb_w32_ioctlsocket, rb_w32_listen, rb_w32_recv,
	  rb_w32_recvfrom, rb_w32_send, rb_w32_sendto, rb_w32_setsockopt,
	  rb_w32_shutdown, rb_w32_socket, rb_w32_gethostbyaddr,
	  rb_w32_gethostbyname, rb_w32_gethostname, rb_w32_getprotobyname,
	  rb_w32_getprotobynumber, rb_w32_getservbyname, rb_w32_getservbyport,
	  rb_w32_fclose, rb_w32_close): use map_errno().

	* win32/win32.h: add winsock errors.

Tue Aug 26 23:53:23 2003  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* lib/ostruct.rb (OpenStruct::method_missing): prohibit modifying
	  frozen OpenStruct. [ruby-talk:80214]

Tue Aug 26 20:03:50 2003  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* lib/mkmf.rb (create_tmpsrc): add the hook for source.
	  [ruby-list:38122]

Tue Aug 26 15:59:53 2003  why the lucky stiff  <why@ruby-lang.org>

	* implicit.c (syck_type_id_to_taguri): corrected detection of
	  x-private types.

Sun Aug 24 01:02:48 2003  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* file.c (file_expand_path): performance improvement.
	  [ruby-talk:79748]

Sat Aug 23 23:41:16 2003  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* file.c (rb_file_s_expand_path): avoid calling rb_scan_args() for
	  apparent cases. [ruby-talk:79748]

Sat Aug 23 18:56:53 2003  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* ext/nkf/nkf.c (rb_nkf_putchar): should use rb_str_resize() to just
	  resize a string, rb_str_cat() disallows NULL.  [ruby-dev:21237]

Sat Aug 23 16:48:41 2003  Keiju Ishitsuka  <keiju@ishitsuka.com>

	* lib/irb/ruby-lex.rb: bug fix for "foo" !~ /bar/. [ruby-talk:79942]

Sat Aug 23 15:59:58 2003  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* eval.c (rb_eval, rb_iterate, block_pass): reduce PUSH/POP_TAG and
	  EXEC_TAG() for retry.  [ruby-dev:21216]

Sat Aug 23 02:32:33 2003  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (rb_yield_splat): should check if "values" is array.

	* enum.c (each_with_index_i): typo.

Fri Aug 22 17:07:05 2003  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* enum.c (inject_i): use rb_yield_values.

	* enum.c (each_with_index_i): ditto.

	* eval.c (rb_yield_splat): new function to call "yield *values".

	* string.c (rb_str_scan): use rb_yield_splat().

Fri Aug 22 06:13:22 2003  why the lucky stiff  <why@ruby-lang.org>

	* ext/syck/rubyext.c: refactoring of the transfer method
	  dispatch.  added yaml_org_handler for faster dispatch of
	  transfers to base types.

	* lib/yaml/rubytypes.rb: removed handling of builtins from
	  Ruby library.

	* ext/syck/token.c: quoted and block scalars are now implicit !str

	* ext/syck/implicit.c: empty string detected as !null.

Fri Aug 22 01:00:31 2003  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* eval.c (block_pass): improve passing current block.

Fri Aug 22 00:13:00 2003  Shigeo Kobayashi  <shigek@ruby-lang.org>

	* ext/bigdecimal/bigdecimal.c: Int. overflow bug in multiplication
	  fixed, and VpNmlz() speed up.

Wed Aug 20 16:44:49 2003  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* ext/socket/socket.c (ruby_connect): many systems seem to have
	  a problem in select() after EINPROGRESS.  [ruby-list:38080]

Wed Aug 20 01:31:17 2003  why the lucky stiff  <why@ruby-lang.org>

	* ext/syck/syck.h: Parser definition problems on HP-UX.
	  [ruby-talk:79389]

	* ext/syck/handler.c (syck_hdlr_get_anchor): Memory leak.

	* ext/syck/syck.s (syck_io_file_read): Bad arguments to fread.

	* ext/syck/rubyext.c: Tainting issues.

Tue Aug 19 23:20:00 2003  Shigeo Kobayashi  <shigek@ruby-lang.org>

	* ext/bigdecimal/bigdecimal.c .h .html: to_s("+") implemented.

	* ext/bigdecimal/lib/bigdecimal/math.rb: E implemented.

Tue Aug 19 07:47:09 2003  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* lib/webrick/ssl.rb: new file; SSL/TLS enhancement for GenericServer.

	* lib/webrick/https.rb: SSLSocket handling is moved to webrick/ssl.rb.

	* lib/webrick/compat.rb (File::fnmatch): remove old migration code.

	* lib/webrick/httpserver.rb (HTTPServer#run): ditto.

	* lib/webrick/server.rb (GenericServer#listen): the body of this
	  method is pull out as Utils::create_lisnteners.

	* lib/webrick/utils.rb (Utils::create_lisnteners): new method.

	* lib/webrick/server.rb (GenericServer#start): should rescue
	  unknown errors. and refine comments.

	* ext/openssl/lib/openssl/ssl.rb (SSLServer#accept): should close
	  socket if SSLSocket raises error.

Tue Aug 19 11:19:33 2003  Shugo Maeda  <shugo@ruby-lang.org>

	* io.c (next_argv): should not call GetOpenFile() if rb_stdout is
	  not a IO (T_FILE).

Tue Aug 19 07:47:09 2003  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* ext/openssl/ossl_ssl.c: sync_close is moved to SSLSocket as
	  a builtin.

	* ext/openssl/lib/openssl/buffering.rb (Buffering#close): ditto.

	* ext/openssl/lib/openssl/buffering.rb (Buffering#puts): should
	  add a return to the tails of each line.

	* ext/openssl/lib/openssl/ssl.rb: new class OpenSSL::SSL::SSLServer.

	* ext/openssl/lib/net/protocols.rb (SSLIO#ssl_connect): use sync_close.

	* ext/openssl/sample/echo_svr.rb: use SSLServer.

	* ext/openssl/sample/echo_cli.rb: add example of SSLSocket#sync_close.

Tue Aug 19 01:24:34 2003  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* ext/curses/curses.c (_XOPEN_SOURCE_EXTENDED): Mac OS X standard
	  headers are inconsistent at this macro.  [ruby-core:01432]

	* ext/curses/extconf.rb: check if _XOPEN_SOURCE_EXTENDED breaks.

	* ext/tcltklib/stubs.c: Status macro in X11/Xthreads.h bothers
	  winspool.h

	* instruby.rb: make list at first instead of iterator.
	  [ruby-talk:79347]

Mon Aug 18 11:23:11 2003  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* dir.c (glob_helper): preserve raw order for **.

Sun Aug 17 23:39:55 2003  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* ext/openssl/extconf.rb (HAVE_VA_ARGS_MACRO): need to compile.

Sun Aug 17 17:10:03 2003  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* ext/openssl/lib/openssl/ssl.rb (SSLSocket#sync_close=): add a
	  method to specify if the underlying IO will be closed in
	  SSLSocket#close.

	* ext/openssl/lib/openssl/buffering.rb: add forwarders to
	  setsockopt, getsockopt and fcntl.

	* ext/openssl/lib/net/protocols.rb: enable sync for SSLSocket.

Sun Aug 17 11:32:04 2003  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* ext/extmk.rb (extmake): should not force to remake Makefile when
	  installation and so on.

Sat Aug 16 23:58:18 2003  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* marshal.c (w_symbol, w_object): get rid of warnings.

	* re.c (rb_memsearch): ditto.

	* time.c (time_dump): ditto.

	* ext/extmk.rb (extmake): not continue making when extconf.rb
	  failed.

	* ext/openssl/extconf.rb: check __VA_ARGS__ macro more precisely.

	* ext/openssl/ossl.h: remove version.h dependency.

	* ext/openssl/ruby_missing.h: ditto.

	* lib/mkmf.rb (pkg_config): use --libs output except with
	  only-L for other options.  [ruby-list:38099]

	* lib/mkmf.rb (create_makefile): separate rule for static
	  library from shared object.

	* win32/Makefile.sub, bcc32/Makefile.sub, wince/Makefile.sub:
	  define exec_prefix and libdir.

Fri Aug 15 23:15:00 2003  Shigeo Kobayashi  <shigek@ruby-lang.org>

	* ext/bigdecimal/bigdecimal.c .h: Bug in combination of limit & div
	  method fixed.

	* ext/bigdecimal/lib/bigdecimal/math.rb: atan() & sqrt() added.

Fri Aug 15 12:01:43 2003  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* configure.in (HUGE_ST_INO): check whether struct stat.st_ino
	  is larger than long.  [ruby-dev:21194]
	  http://www.geocities.co.jp/SiliconValley-PaloAlto/1409/ruby/beos.html

	* error.c (syserr_eqq): errno might exceed Fixnum limit.

	* error.c (Init_Exception): moved base initialization from
	  init_syserr().

	* inits.c (rb_call_inits): postpone initializing errnos until
	  Bignum is available.

Fri Aug 15 12:01:43 2003  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* ext/curses/curses.c (_XOPEN_SOURCE_EXTENDED): needed to let
	  keyname() and so on be declared.

	* ext/curses/curses.c (curses_resizeterm, window_resize):
	  arguments conflicted with macros in term.h.

	* ext/curses/curses.c (Curses module methods): ensure
	  initialized.  [ruby-dev:21191]

Fri Aug 15 02:08:53 2003  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* gc.c (id2ref): recycle check should be done by klass == 0.
	  [ruby-core:01408]

Fri Aug 15 01:34:23 2003  Michal Rokos  <m.rokos@sh.cvut.cz>

	* ext/openssl/ossl_pkey.c: move generate_cb here

	* ext/openssl/ossl_pkey_{dh|dsa|rsa}.c: adapt to this cb

	* ext/openssl/openssl_missing.[ch]: add (0.9.6x, x<j) missing BN funcs

	* ext/openssl/ossl_bn.c: use supplied funcs from openssl_missing.c

Fri Aug 15 00:38:00 2003  Shigeo Kobayashi  <shigek@ruby-lang.org>

	* ext/bigdecimal/bigdecimal.c: Bug in div method fixed.

	* ext/bigdecimal/lib/bigdecimal/math.rb: Newly added.

	* ext/bigdecimal/sample/pi.rb: Changed so as to use math.rb.

Thu Aug 14 21:19:14 2003  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (Init_Thread): Continuation#[] added.  [ruby-talk:79028]

Thu Aug 14 20:03:34 2003  Masaki Suketa  <masaki.suketa@nifty.ne.jp>

	* ext/win32ole/win32ole.c (OLE_FREE): should not call
	  ole_message_loop.

	* ext/win32ole/win32ole.c (ole_event_free): ditto.

	* ext/win32ole/win32ole.c (ole_initialize): stop calling
	  OleUninitialize at exit.

Thu Aug 14 11:27:37 2003  NAKAMURA Usaku  <usa@ruby-lang.org>

	* gc.c (rb_data_object_alloc): check type of 1st argument.
	  [ruby-dev:21192]

Thu Aug 14 00:21:14 2003  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* parse.y (mlhs_node): should allow "::Foo" (colon3) as lhs.

	* parse.y (lhs): ditto.

	* parse.y (yylex): should return tCOLON3 right after kCLASS.
	  [ruby-talk:78918]

	* error.c (exc_initialize): was converting argument to string too
	  eagerly.  Only check was needed. [ruby-talk:78958]

Wed Aug 13 23:31:00 2003  Shigeo Kobayashi  <shigek@ruby-lang.org>

	* ext/bigdecimal/bigdecimal.c .h .html: Ambiguity of
	  BigDecimal::limit removed.

Wed Aug 13 19:21:34 2003  Christian Neukirchen  <chneukirchen@yahoo.de>

	* lib/webrick/https.rb (HTTPServer#run): should set syncing-mode
	  to SSLSocket. [ruby-talk:78919]

Wed Aug 13 18:13:49 2003  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (POP_BLOCK): turn on BLOCK_LEFT flag when leaving block.

	* eval.c (proc_invoke): unpack return/break destination when block
	  is already left.

Wed Aug 13 15:58:31 2003  WATANABE Hirofumi  <eban@ruby-lang.org>

	* object.c (rb_class_s_alloc): add function prototype to avoid VC++
	  warning.

Wed Aug 13 13:50:59 2003  NAKAMURA Usaku  <usa@ruby-lang.org>

	* ext/Win32API/Win32API.c (Win32API_initialize): should pass some
	  class to first argument of Data_Wrap_Struct(). (ruby-bugs:PR#1109)

Tue Aug 12 16:55:11 2003  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* Makefile.in: static link libraries to LIBRUBY_SO with static linked
	  ext.  [ruby-dev:21157]

	* ext/extmk.rb (extmake): sort extension library initialization order.

	* ext/extmk.rb (extmake): compact $extlibs.

Tue Aug 12 02:48:56 2003  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (THREAD_SAVE_CONTEXT): should explicitly turn off the
	  flag before calling getcontext(2).

	* eval.c (struct thread): add member to save backing store on
	  IA64. (ruby-bugs PR1086)

	* eval.c (thread_mark): mark IA64 backing store region.

	* eval.c (thread_free): free saved IA64 backing store.

	* eval.c (rb_thread_save_context): save IA64 backing store as well.

	* eval.c (rb_thread_restore_context): restore IA64 backing store.

	* eval.c (THREAD_ALLOC): initialize IA64 members.

Mon Aug 11 22:31:50 2003  NAKAMURA, Hiroshi  <nahi@ruby-lang.org>

	* lib/debug.rb(debug_command): inspection command should inspect
	  resulting value even if it's nil.  [ruby-dev:21180] by OMAE, jun
	  <jun66j5@ybb.ne.jp>.

	* lib/debug.rb(debug_command): incomplete regexp.

Mon Aug 11 17:33:07 2003  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (rb_call_super): do not use rb_block_given_p() for
	  check. [ruby-talk:78656]

	* eval.c (BEGIN_CALLARGS): push ITER_NOT only when ITER_PRE.

Sun Aug 10 10:43:05 2003  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* ext/openssl/lib/openssl/buffering.rb: increase BLOCK_SIZE
	  from 1k to 16k bytes. [ruby-talk:78603]

	* ext/openssl/ossl_ssl.c (ossl_sslctx_s_alloc): enable
	  partial write to allow interruption in SSLSocket#write.

Sun Aug 10 00:34:16 2003  WATANABE Hirofumi  <eban@ruby-lang.org>

	* cygwin/GNUmakefile: remove unnecessary '--drive-name=$(CC)'
	  for ccache.

Sat Aug  9 10:36:21 2003  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* marshal.c (w_object): do not dump generic instance variable when
	  marshal_dump is defined.

Sat Aug  9 00:35:00 2003  Shigeo Kobayashi  <shigek@ruby-lang.org>

	* ext/bigdecimal.c: F style output(like 1234.56789) implemented
	  to to_s method.
	* ext/bigdecimal_??.html: F style output(like 1234.56789)
	  implemented to to_s method.

Fri Aug  8 12:33:17 2003  WATANABE Hirofumi  <eban@ruby-lang.org>

	* bcc32/Makefile.sub: rubyw.exe should be a Windows GUI program.
	  add the -aa option to WLDFLAGS.

Fri Aug  8 11:29:26 2003  Koji Arai  <jca02266@nifty.ne.jp>

	* marshal.c (w_object): should set `c_arg' at first.

Fri Aug  8 03:22:28 2003  GOTOU Yuuzou  <gotoyuzo@notwork.org>

	* lib/webrick/httputils.rb (FormData#list): should not take
	  a side effect for the receiver.

Thu Aug  7 14:40:37 2003  WATANABE Hirofumi  <eban@ruby-lang.org>

	* cygwin/GNUmakefile: better --disbale-shared option support.

	* cygwin/GNUmakefile: add forwarding DLL target for cygwin.

Thu Aug  7 14:21:05 2003  Corinna Vinschen  <vinschen@redhat.com>

	* configure.in: Fix Cygwin specific naming of libraries to
	  be net distribution compliant. (ruby-bugs:PR#1077)
	  cygwin-ruby18.dll -> cygruby18.dll

Thu Aug  7 12:51:38 2003  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (rb_f_at_exit): should not be called without a block.
	  block_given check added.

Thu Aug  7 06:46:06 2003  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (rb_call0): forgot to pop ruby_class.

	* eval.c (rb_call0): update ruby_class as well as ruby_cref.
	  (ruby-bugs-ja:PR#540)

Thu Aug  7 04:52:50 2003  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (rb_yield_0): remove ruby_frame->cbase and unify to
	  ruby_cref.  [ruby-talk:78141]

Thu Aug  7 04:19:15 2003  Akinori MUSHA  <knu@iDaemons.org>

	* gc.c: FreeBSD/ia64's mcontext_t is a bit different from that of
	  Linux/ia64.  This makes gc.c compile but miniruby coredumps for
	  the moment.

Thu Aug  7 00:15:00 2003  Shigeo Kobayashi  <shigek@ruby-lang.org>

	* ext/bigdecimal.c: Comparison results adjusted to Float's.
	* ext/bigdecimal.c: Use rb_num_coerce_????(x,y) instead of own.

Wed Aug  6 22:58:00 2003  Nathaniel Talbott  <ntalbott@ruby-lang.org>

	* lib/test/unit/testcase.rb: Added equality checking.
	* lib/test/unit/testsuite.rb: Added equality checking.
	* lib/test/unit/assertions.rb: Fixed a warning.

Wed Aug  6 17:28:10 2003  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* ext/extmk.rb (extmake): pass LIBPATH to make ruby.  [ruby-dev:21137]

	* ext/extmk.rb (extmake): set library name as source file name in
	  Init_ext().  [ruby-dev:21137]

	* lib/mkmf.rb (Logging::postpone): postpone logging messages after
	  heading message as the result of the block.

	* lib/mkmf.rb (macro_defined?): append newline to src unless ended
	  with it.

	* lib/mkmf.rb (have_library): treat nil function name as "main".
	  (ruby-bugs:PR#1083)

	* lib/mkmf.rb (pkg_config): should append additional libraries to
	  $libs but not $LIBS.  [ruby-dev:21137]

	* ext/io/wait/extconf.rb: check DOSISH macro instead of platform.

	* ext/digest/sha1/extconf.rb: have_library already appends library
	  name.

Wed Aug  6 17:23:57 2003  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c: initialize /* OK */ variables by Qnil to stop warnings.

Wed Aug  6 04:58:32 2003  NAKAMURA Usaku  <usa@ruby-lang.org>

	* ext/Setup*: add io/wait and openssl.

Wed Aug  6 01:13:38 2003  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* eval.c (rb_f_autoload): use ruby_cbase instead of ruby_class.

	* eval.c (rb_f_autoload_p): ditto.

	* class.c (rb_mod_init_copy): no longer implements independent
	  clone and dup methods.  override "initialize_copy" instead.
	  [ruby-core:01352]

	* object.c (rb_class_s_alloc): define Class allocation function.
	  this makes Classes to follow clone framework that uses
	  initialize_copy.

	* object.c (rb_class_initialize): separate instantiation and
	  initialization.

	* object.c (rb_obj_alloc): prohibit instantiation from
	  uninitialized class.

	* object.c (rb_class_superclass): check uninitialized class.

	* array.c (rb_ary_fill): wrong index processing with block.  this
	  fix was done by Koji Arai <JCA02266@nifty.ne.jp> [ruby-list:38029]

	* marshal.c (w_object): should preserve generic ivar for nil,
	  true, false, symbols, and fixnums.

	* marshal.c (w_uclass): base_klass check should be done after
	  rb_class_real().

Wed Aug  6 01:18:50 2003  Minero Aoki  <aamine@loveruby.net>

	* lib/net/http.rb: update document.

	* lib/net/pop.rb: ditto.

	* lib/net/protocol.rb: ditto.

Wed Aug  6 00:48:37 2003  Koji Arai  <jca02266@nifty.ne.jp>

	* marshal.c (w_object): should recommend marshal_dump rather than
	  _dump_data.

Tue Aug  5 17:58:57 2003  WATANABE Hirofumi  <eban@ruby-lang.org>

	* lib/fileutils.rb (install): should preserve timestamp only.

Tue Aug  5 17:31:59 2003  Ian Macdonald  <ian@caliban.org>

	* lib/shell/command-processor.rb (Shell::CommandProcessor::rmdir):
	  simple typo.

Tue Aug  5 15:47:34 2003  Nobuyoshi Nakada  <nobu@ruby-lang.org>

	* eval.c (rb_load): should preserve current source file/line.

Tue Aug  5 10:04:42 2003  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* string.c (str_new4): ptr may refer null_str.

Mon Aug  4 17:25:18 2003  Yukihiro Matsumoto  <matz@ruby-lang.org>

	* stable version 1.8.0 released.

For the changes before 1.8.0, see doc/ChangeLog-1.8.0

Local variables:
add-log-time-format: (lambda ()
  (let* ((time (current-time))
	 (diff (+ (cadr time) 32400))
	 (lo (% diff 65536))
	 (hi  (+ (car time) (/ diff 65536))))
  (format-time-string "%a %b %e %H:%M:%S %Y" (list hi lo) t)))
indent-tabs-mode: t
tab-width: 8
end:
